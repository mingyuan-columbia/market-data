2025-12-21 23:56:14,315 INFO [__main__] Loaded config from config.yaml
2025-12-21 23:56:14,316 INFO [__main__]   Parquet root: /home/mingyuan/data/taq/parquet_raw
2025-12-21 23:56:14,316 INFO [__main__]   CSV root: None
2025-12-21 23:56:14,316 INFO [__main__] No --symbols provided. Fetching S&P 500 constituents + top ETFs...
2025-12-21 23:56:14,316 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-21 23:56:15,489 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-21 23:56:15,489 INFO [src.stage_a.wrds_extractor] Fetching S&P 500 constituents as of 2024-06-12...
2025-12-21 23:56:15,584 INFO [src.stage_a.wrds_extractor] ✓ Found 503 S&P 500 stocks
2025-12-21 23:56:15,584 INFO [src.stage_a.wrds_extractor] Adding 16 top ETFs...
2025-12-21 23:56:15,584 INFO [src.stage_a.wrds_extractor] ✓ Total symbols: 519 (503 stocks + 16 ETFs)
2025-12-21 23:56:15,584 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-21 23:56:15,584 INFO [__main__] Will process 519 symbols (S&P 500 + ETFs)
2025-12-21 23:56:15,584 INFO [__main__] Extracting default data types: trades, nbbo
2025-12-21 23:56:15,584 INFO [src.stage_a.stage_a] ================================================================================
2025-12-21 23:56:15,584 INFO [src.stage_a.stage_a] Stage A: Extract raw data for date range 2024-06-12 to 2024-12-31 (inclusive)
2025-12-21 23:56:15,584 INFO [src.stage_a.stage_a] Symbols: 519
2025-12-21 23:56:15,584 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-21 23:56:15,584 INFO [src.stage_a.stage_a] ================================================================================
2025-12-21 23:56:15,584 INFO [src.stage_a.stage_a] Total dates in range: 203
2025-12-21 23:56:15,584 INFO [src.stage_a.stage_a] Trading days (weekdays): 145
2025-12-21 23:56:15,584 INFO [src.stage_a.stage_a] 
Checking TAQ table availability...
2025-12-21 23:56:15,584 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-21 23:56:16,653 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-21 23:56:16,765 INFO [src.stage_a.stage_a]   ✓ 2024-06-12: Tables available
2025-12-21 23:56:16,869 INFO [src.stage_a.stage_a]   ✓ 2024-06-13: Tables available
2025-12-21 23:56:16,957 INFO [src.stage_a.stage_a]   ✓ 2024-06-14: Tables available
2025-12-21 23:56:17,040 INFO [src.stage_a.stage_a]   ✓ 2024-06-17: Tables available
2025-12-21 23:56:17,127 INFO [src.stage_a.stage_a]   ✓ 2024-06-18: Tables available
2025-12-21 23:56:17,149 INFO [src.stage_a.stage_a]   ✗ 2024-06-19: Tables not available (skipping)
2025-12-21 23:56:17,247 INFO [src.stage_a.stage_a]   ✓ 2024-06-20: Tables available
2025-12-21 23:56:17,338 INFO [src.stage_a.stage_a]   ✓ 2024-06-21: Tables available
2025-12-21 23:56:17,554 INFO [src.stage_a.stage_a]   ✓ 2024-06-24: Tables available
2025-12-21 23:56:17,802 INFO [src.stage_a.stage_a]   ✓ 2024-06-25: Tables available
2025-12-21 23:56:18,023 INFO [src.stage_a.stage_a]   ✓ 2024-06-26: Tables available
2025-12-21 23:56:18,253 INFO [src.stage_a.stage_a]   ✓ 2024-06-27: Tables available
2025-12-21 23:56:18,480 INFO [src.stage_a.stage_a]   ✓ 2024-06-28: Tables available
2025-12-21 23:56:18,713 INFO [src.stage_a.stage_a]   ✓ 2024-07-01: Tables available
2025-12-21 23:56:18,823 INFO [src.stage_a.stage_a]   ✓ 2024-07-02: Tables available
2025-12-21 23:56:19,077 INFO [src.stage_a.stage_a]   ✓ 2024-07-03: Tables available
2025-12-21 23:56:19,108 INFO [src.stage_a.stage_a]   ✗ 2024-07-04: Tables not available (skipping)
2025-12-21 23:56:19,315 INFO [src.stage_a.stage_a]   ✓ 2024-07-05: Tables available
2025-12-21 23:56:19,536 INFO [src.stage_a.stage_a]   ✓ 2024-07-08: Tables available
2025-12-21 23:56:19,736 INFO [src.stage_a.stage_a]   ✓ 2024-07-09: Tables available
2025-12-21 23:56:19,979 INFO [src.stage_a.stage_a]   ✓ 2024-07-10: Tables available
2025-12-21 23:56:20,184 INFO [src.stage_a.stage_a]   ✓ 2024-07-11: Tables available
2025-12-21 23:56:20,375 INFO [src.stage_a.stage_a]   ✓ 2024-07-12: Tables available
2025-12-21 23:56:20,614 INFO [src.stage_a.stage_a]   ✓ 2024-07-15: Tables available
2025-12-21 23:56:20,857 INFO [src.stage_a.stage_a]   ✓ 2024-07-16: Tables available
2025-12-21 23:56:21,082 INFO [src.stage_a.stage_a]   ✓ 2024-07-17: Tables available
2025-12-21 23:56:21,324 INFO [src.stage_a.stage_a]   ✓ 2024-07-18: Tables available
2025-12-21 23:56:21,586 INFO [src.stage_a.stage_a]   ✓ 2024-07-19: Tables available
2025-12-21 23:56:21,782 INFO [src.stage_a.stage_a]   ✓ 2024-07-22: Tables available
2025-12-21 23:56:22,013 INFO [src.stage_a.stage_a]   ✓ 2024-07-23: Tables available
2025-12-21 23:56:22,248 INFO [src.stage_a.stage_a]   ✓ 2024-07-24: Tables available
2025-12-21 23:56:22,482 INFO [src.stage_a.stage_a]   ✓ 2024-07-25: Tables available
2025-12-21 23:56:22,718 INFO [src.stage_a.stage_a]   ✓ 2024-07-26: Tables available
2025-12-21 23:56:22,830 INFO [src.stage_a.stage_a]   ✓ 2024-07-29: Tables available
2025-12-21 23:56:23,069 INFO [src.stage_a.stage_a]   ✓ 2024-07-30: Tables available
2025-12-21 23:56:23,304 INFO [src.stage_a.stage_a]   ✓ 2024-07-31: Tables available
2025-12-21 23:56:23,551 INFO [src.stage_a.stage_a]   ✓ 2024-08-01: Tables available
2025-12-21 23:56:23,782 INFO [src.stage_a.stage_a]   ✓ 2024-08-02: Tables available
2025-12-21 23:56:24,007 INFO [src.stage_a.stage_a]   ✓ 2024-08-05: Tables available
2025-12-21 23:56:24,243 INFO [src.stage_a.stage_a]   ✓ 2024-08-06: Tables available
2025-12-21 23:56:24,471 INFO [src.stage_a.stage_a]   ✓ 2024-08-07: Tables available
2025-12-21 23:56:24,706 INFO [src.stage_a.stage_a]   ✓ 2024-08-08: Tables available
2025-12-21 23:56:24,940 INFO [src.stage_a.stage_a]   ✓ 2024-08-09: Tables available
2025-12-21 23:56:25,164 INFO [src.stage_a.stage_a]   ✓ 2024-08-12: Tables available
2025-12-21 23:56:25,400 INFO [src.stage_a.stage_a]   ✓ 2024-08-13: Tables available
2025-12-21 23:56:25,639 INFO [src.stage_a.stage_a]   ✓ 2024-08-14: Tables available
2025-12-21 23:56:25,868 INFO [src.stage_a.stage_a]   ✓ 2024-08-15: Tables available
2025-12-21 23:56:26,116 INFO [src.stage_a.stage_a]   ✓ 2024-08-16: Tables available
2025-12-21 23:56:26,344 INFO [src.stage_a.stage_a]   ✓ 2024-08-19: Tables available
2025-12-21 23:56:26,590 INFO [src.stage_a.stage_a]   ✓ 2024-08-20: Tables available
2025-12-21 23:56:26,828 INFO [src.stage_a.stage_a]   ✓ 2024-08-21: Tables available
2025-12-21 23:56:27,059 INFO [src.stage_a.stage_a]   ✓ 2024-08-22: Tables available
2025-12-21 23:56:27,298 INFO [src.stage_a.stage_a]   ✓ 2024-08-23: Tables available
2025-12-21 23:56:27,518 INFO [src.stage_a.stage_a]   ✓ 2024-08-26: Tables available
2025-12-21 23:56:27,600 INFO [src.stage_a.stage_a]   ✓ 2024-08-27: Tables available
2025-12-21 23:56:27,811 INFO [src.stage_a.stage_a]   ✓ 2024-08-28: Tables available
2025-12-21 23:56:28,047 INFO [src.stage_a.stage_a]   ✓ 2024-08-29: Tables available
2025-12-21 23:56:28,288 INFO [src.stage_a.stage_a]   ✓ 2024-08-30: Tables available
2025-12-21 23:56:28,316 INFO [src.stage_a.stage_a]   ✗ 2024-09-02: Tables not available (skipping)
2025-12-21 23:56:28,513 INFO [src.stage_a.stage_a]   ✓ 2024-09-03: Tables available
2025-12-21 23:56:28,747 INFO [src.stage_a.stage_a]   ✓ 2024-09-04: Tables available
2025-12-21 23:56:28,977 INFO [src.stage_a.stage_a]   ✓ 2024-09-05: Tables available
2025-12-21 23:56:29,213 INFO [src.stage_a.stage_a]   ✓ 2024-09-06: Tables available
2025-12-21 23:56:29,455 INFO [src.stage_a.stage_a]   ✓ 2024-09-09: Tables available
2025-12-21 23:56:29,681 INFO [src.stage_a.stage_a]   ✓ 2024-09-10: Tables available
2025-12-21 23:56:29,883 INFO [src.stage_a.stage_a]   ✓ 2024-09-11: Tables available
2025-12-21 23:56:30,116 INFO [src.stage_a.stage_a]   ✓ 2024-09-12: Tables available
2025-12-21 23:56:30,192 INFO [src.stage_a.stage_a]   ✓ 2024-09-13: Tables available
2025-12-21 23:56:30,412 INFO [src.stage_a.stage_a]   ✓ 2024-09-16: Tables available
2025-12-21 23:56:30,636 INFO [src.stage_a.stage_a]   ✓ 2024-09-17: Tables available
2025-12-21 23:56:30,879 INFO [src.stage_a.stage_a]   ✓ 2024-09-18: Tables available
2025-12-21 23:56:31,112 INFO [src.stage_a.stage_a]   ✓ 2024-09-19: Tables available
2025-12-21 23:56:31,349 INFO [src.stage_a.stage_a]   ✓ 2024-09-20: Tables available
2025-12-21 23:56:31,575 INFO [src.stage_a.stage_a]   ✓ 2024-09-23: Tables available
2025-12-21 23:56:31,772 INFO [src.stage_a.stage_a]   ✓ 2024-09-24: Tables available
2025-12-21 23:56:31,840 INFO [src.stage_a.stage_a]   ✓ 2024-09-25: Tables available
2025-12-21 23:56:32,063 INFO [src.stage_a.stage_a]   ✓ 2024-09-26: Tables available
2025-12-21 23:56:32,284 INFO [src.stage_a.stage_a]   ✓ 2024-09-27: Tables available
2025-12-21 23:56:32,481 INFO [src.stage_a.stage_a]   ✓ 2024-09-30: Tables available
2025-12-21 23:56:32,726 INFO [src.stage_a.stage_a]   ✓ 2024-10-01: Tables available
2025-12-21 23:56:32,796 INFO [src.stage_a.stage_a]   ✓ 2024-10-02: Tables available
2025-12-21 23:56:33,011 INFO [src.stage_a.stage_a]   ✓ 2024-10-03: Tables available
2025-12-21 23:56:33,231 INFO [src.stage_a.stage_a]   ✓ 2024-10-04: Tables available
2025-12-21 23:56:33,417 INFO [src.stage_a.stage_a]   ✓ 2024-10-07: Tables available
2025-12-21 23:56:33,483 INFO [src.stage_a.stage_a]   ✓ 2024-10-08: Tables available
2025-12-21 23:56:33,669 INFO [src.stage_a.stage_a]   ✓ 2024-10-09: Tables available
2025-12-21 23:56:33,870 INFO [src.stage_a.stage_a]   ✓ 2024-10-10: Tables available
2025-12-21 23:56:34,042 INFO [src.stage_a.stage_a]   ✓ 2024-10-11: Tables available
2025-12-21 23:56:34,244 INFO [src.stage_a.stage_a]   ✓ 2024-10-14: Tables available
2025-12-21 23:56:34,326 INFO [src.stage_a.stage_a]   ✓ 2024-10-15: Tables available
2025-12-21 23:56:34,536 INFO [src.stage_a.stage_a]   ✓ 2024-10-16: Tables available
2025-12-21 23:56:34,737 INFO [src.stage_a.stage_a]   ✓ 2024-10-17: Tables available
2025-12-21 23:56:34,811 INFO [src.stage_a.stage_a]   ✓ 2024-10-18: Tables available
2025-12-21 23:56:34,981 INFO [src.stage_a.stage_a]   ✓ 2024-10-21: Tables available
2025-12-21 23:56:35,164 INFO [src.stage_a.stage_a]   ✓ 2024-10-22: Tables available
2025-12-21 23:56:35,234 INFO [src.stage_a.stage_a]   ✓ 2024-10-23: Tables available
2025-12-21 23:56:35,410 INFO [src.stage_a.stage_a]   ✓ 2024-10-24: Tables available
2025-12-21 23:56:35,579 INFO [src.stage_a.stage_a]   ✓ 2024-10-25: Tables available
2025-12-21 23:56:35,652 INFO [src.stage_a.stage_a]   ✓ 2024-10-28: Tables available
2025-12-21 23:56:35,823 INFO [src.stage_a.stage_a]   ✓ 2024-10-29: Tables available
2025-12-21 23:56:36,000 INFO [src.stage_a.stage_a]   ✓ 2024-10-30: Tables available
2025-12-21 23:56:36,197 INFO [src.stage_a.stage_a]   ✓ 2024-10-31: Tables available
2025-12-21 23:56:36,411 INFO [src.stage_a.stage_a]   ✓ 2024-11-01: Tables available
2025-12-21 23:56:36,487 INFO [src.stage_a.stage_a]   ✓ 2024-11-04: Tables available
2025-12-21 23:56:36,643 INFO [src.stage_a.stage_a]   ✓ 2024-11-05: Tables available
2025-12-21 23:56:36,817 INFO [src.stage_a.stage_a]   ✓ 2024-11-06: Tables available
2025-12-21 23:56:36,875 INFO [src.stage_a.stage_a]   ✓ 2024-11-07: Tables available
2025-12-21 23:56:37,064 INFO [src.stage_a.stage_a]   ✓ 2024-11-08: Tables available
2025-12-21 23:56:37,246 INFO [src.stage_a.stage_a]   ✓ 2024-11-11: Tables available
2025-12-21 23:56:37,318 INFO [src.stage_a.stage_a]   ✓ 2024-11-12: Tables available
2025-12-21 23:56:37,505 INFO [src.stage_a.stage_a]   ✓ 2024-11-13: Tables available
2025-12-21 23:56:37,699 INFO [src.stage_a.stage_a]   ✓ 2024-11-14: Tables available
2025-12-21 23:56:37,892 INFO [src.stage_a.stage_a]   ✓ 2024-11-15: Tables available
2025-12-21 23:56:37,965 INFO [src.stage_a.stage_a]   ✓ 2024-11-18: Tables available
2025-12-21 23:56:38,131 INFO [src.stage_a.stage_a]   ✓ 2024-11-19: Tables available
2025-12-21 23:56:38,305 INFO [src.stage_a.stage_a]   ✓ 2024-11-20: Tables available
2025-12-21 23:56:38,373 INFO [src.stage_a.stage_a]   ✓ 2024-11-21: Tables available
2025-12-21 23:56:38,554 INFO [src.stage_a.stage_a]   ✓ 2024-11-22: Tables available
2025-12-21 23:56:38,730 INFO [src.stage_a.stage_a]   ✓ 2024-11-25: Tables available
2025-12-21 23:56:38,804 INFO [src.stage_a.stage_a]   ✓ 2024-11-26: Tables available
2025-12-21 23:56:38,878 INFO [src.stage_a.stage_a]   ✓ 2024-11-27: Tables available
2025-12-21 23:56:38,919 INFO [src.stage_a.stage_a]   ✗ 2024-11-28: Tables not available (skipping)
2025-12-21 23:56:39,067 INFO [src.stage_a.stage_a]   ✓ 2024-11-29: Tables available
2025-12-21 23:56:39,238 INFO [src.stage_a.stage_a]   ✓ 2024-12-02: Tables available
2025-12-21 23:56:39,301 INFO [src.stage_a.stage_a]   ✓ 2024-12-03: Tables available
2025-12-21 23:56:39,475 INFO [src.stage_a.stage_a]   ✓ 2024-12-04: Tables available
2025-12-21 23:56:39,654 INFO [src.stage_a.stage_a]   ✓ 2024-12-05: Tables available
2025-12-21 23:56:39,717 INFO [src.stage_a.stage_a]   ✓ 2024-12-06: Tables available
2025-12-21 23:56:39,895 INFO [src.stage_a.stage_a]   ✓ 2024-12-09: Tables available
2025-12-21 23:56:40,074 INFO [src.stage_a.stage_a]   ✓ 2024-12-10: Tables available
2025-12-21 23:56:40,128 INFO [src.stage_a.stage_a]   ✓ 2024-12-11: Tables available
2025-12-21 23:56:40,318 INFO [src.stage_a.stage_a]   ✓ 2024-12-12: Tables available
2025-12-21 23:56:40,494 INFO [src.stage_a.stage_a]   ✓ 2024-12-13: Tables available
2025-12-21 23:56:40,549 INFO [src.stage_a.stage_a]   ✓ 2024-12-16: Tables available
2025-12-21 23:56:40,711 INFO [src.stage_a.stage_a]   ✓ 2024-12-17: Tables available
2025-12-21 23:56:40,777 INFO [src.stage_a.stage_a]   ✓ 2024-12-18: Tables available
2025-12-21 23:56:40,962 INFO [src.stage_a.stage_a]   ✓ 2024-12-19: Tables available
2025-12-21 23:56:41,138 INFO [src.stage_a.stage_a]   ✓ 2024-12-20: Tables available
2025-12-21 23:56:41,208 INFO [src.stage_a.stage_a]   ✓ 2024-12-23: Tables available
2025-12-21 23:56:41,382 INFO [src.stage_a.stage_a]   ✓ 2024-12-24: Tables available
2025-12-21 23:56:41,412 INFO [src.stage_a.stage_a]   ✗ 2024-12-25: Tables not available (skipping)
2025-12-21 23:56:41,593 INFO [src.stage_a.stage_a]   ✓ 2024-12-26: Tables available
2025-12-21 23:56:41,767 INFO [src.stage_a.stage_a]   ✓ 2024-12-27: Tables available
2025-12-21 23:56:41,832 INFO [src.stage_a.stage_a]   ✓ 2024-12-30: Tables available
2025-12-21 23:56:42,014 INFO [src.stage_a.stage_a]   ✓ 2024-12-31: Tables available
2025-12-21 23:56:42,015 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-21 23:56:42,015 INFO [src.stage_a.stage_a] 
Found 140 dates with available TAQ tables
2025-12-21 23:56:42,015 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-21 23:56:42,015 INFO [src.stage_a.stage_a] Processing date 1/140: 2024-06-12
2025-12-21 23:56:42,015 INFO [src.stage_a.stage_a] ================================================================================
2025-12-21 23:56:42,015 INFO [src.stage_a.stage_a] ================================================================================
2025-12-21 23:56:42,015 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-06-12 (519 symbols)
2025-12-21 23:56:42,015 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-21 23:56:42,015 INFO [src.stage_a.stage_a] ================================================================================
2025-12-21 23:56:42,015 INFO [src.stage_a.stage_a] Extract run ID: 73033464-2eb1-4c38-b2fe-e457f45131ee
2025-12-21 23:56:42,031 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-21 23:56:42,031 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-21 23:56:42,031 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-21 23:56:42,031 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-21 23:56:42,031 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-21 23:56:42,031 INFO [src.stage_a.stage_a] ================================================================================
2025-12-21 23:56:42,031 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-21 23:56:42,031 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-21 23:56:42,031 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-21 23:56:43,101 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-21 23:56:43,101 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-06-12...
2025-12-21 23:56:43,134 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240612 for 519 symbols
2025-12-21 23:58:11,233 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,591,113 trades
2025-12-21 23:58:11,233 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,591,113 rows
2025-12-21 23:58:50,983 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,107,571 trades
2025-12-21 23:58:50,990 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,107,571 rows
2025-12-21 23:59:28,722 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,224,061 trades
2025-12-21 23:59:28,722 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,224,061 rows
2025-12-21 23:59:59,472 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,844,689 trades
2025-12-21 23:59:59,473 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,844,689 rows
2025-12-22 00:00:51,610 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,683,306 trades
2025-12-22 00:00:51,610 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,683,306 rows
2025-12-22 00:01:34,958 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,439,582 trades
2025-12-22 00:01:34,958 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,439,582 rows
2025-12-22 00:03:11,686 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,878,529 trades
2025-12-22 00:03:11,687 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,878,529 rows
2025-12-22 00:03:59,982 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,893,462 trades
2025-12-22 00:03:59,999 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,893,462 rows
2025-12-22 00:04:39,499 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,429,928 trades
2025-12-22 00:04:39,499 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,429,928 rows
2025-12-22 00:05:31,970 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,403,828 trades
2025-12-22 00:05:31,970 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,403,828 rows
2025-12-22 00:05:32,406 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 29,496,069 total rows written
2025-12-22 00:05:50,034 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,261,208 trades
2025-12-22 00:05:50,039 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,261,208 rows
2025-12-22 00:05:50,411 INFO [src.stage_a.parquet_writer] ✓ Wrote 30,757,277 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-06-12
2025-12-22 00:05:50,415 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 00:05:50,415 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 00:05:50,415 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 00:05:50,415 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 00:05:50,415 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 00:05:50,415 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 00:05:50,415 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 00:05:51,820 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 00:05:51,820 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-06-12...
2025-12-22 00:05:51,859 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240612 for 519 symbols
2025-12-22 00:06:46,788 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,026,069 NBBO records
2025-12-22 00:06:46,788 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,026,069 rows
2025-12-22 00:07:23,153 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,123,759 NBBO records
2025-12-22 00:07:23,153 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,123,759 rows
2025-12-22 00:08:23,521 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,422,874 NBBO records
2025-12-22 00:08:23,521 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,422,874 rows
2025-12-22 00:08:59,005 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,894,273 NBBO records
2025-12-22 00:08:59,005 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,894,273 rows
2025-12-22 00:09:43,789 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,086,899 NBBO records
2025-12-22 00:09:43,790 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,086,899 rows
2025-12-22 00:10:33,594 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,241,036 NBBO records
2025-12-22 00:10:33,594 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,241,036 rows
2025-12-22 00:11:24,919 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,692,813 NBBO records
2025-12-22 00:11:24,920 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,692,813 rows
2025-12-22 00:12:26,131 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,681,881 NBBO records
2025-12-22 00:12:26,132 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,681,881 rows
2025-12-22 00:13:14,320 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,607,668 NBBO records
2025-12-22 00:13:14,321 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,607,668 rows
2025-12-22 00:14:03,802 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,080,742 NBBO records
2025-12-22 00:14:03,803 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,080,742 rows
2025-12-22 00:14:04,127 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 42,858,014 total rows written
2025-12-22 00:15:31,716 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,549,793 NBBO records
2025-12-22 00:15:31,716 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,549,793 rows
2025-12-22 00:15:32,382 INFO [src.stage_a.parquet_writer] ✓ Wrote 50,407,807 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-06-12
2025-12-22 00:15:32,386 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 00:15:32,386 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 00:15:32,386 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 00:15:32,386 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 00:15:32,386 INFO [src.stage_a.stage_a] Trades: 30,757,277 rows
2025-12-22 00:15:32,386 INFO [src.stage_a.stage_a] Nbbo: 50,407,807 rows
2025-12-22 00:15:32,386 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 00:15:32,386 INFO [src.stage_a.stage_a] Processing date 2/140: 2024-06-13
2025-12-22 00:15:32,386 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 00:15:32,386 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 00:15:32,386 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-06-13 (519 symbols)
2025-12-22 00:15:32,386 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 00:15:32,386 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 00:15:32,386 INFO [src.stage_a.stage_a] Extract run ID: 8a11e630-c63b-4a86-9b35-bf611828316e
2025-12-22 00:15:32,395 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 00:15:32,395 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 00:15:32,395 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 00:15:32,395 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 00:15:32,395 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 00:15:32,395 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 00:15:32,395 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 00:15:32,395 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 00:15:32,395 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 00:15:33,480 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 00:15:33,480 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-06-13...
2025-12-22 00:15:33,530 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240613 for 519 symbols
2025-12-22 00:16:27,307 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,741,704 trades
2025-12-22 00:16:27,307 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,741,704 rows
2025-12-22 00:16:54,486 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,694,927 trades
2025-12-22 00:16:54,490 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,694,927 rows
2025-12-22 00:17:22,444 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,944,615 trades
2025-12-22 00:17:22,444 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,944,615 rows
2025-12-22 00:17:50,676 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,563,566 trades
2025-12-22 00:17:50,676 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,563,566 rows
2025-12-22 00:19:21,416 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,268,856 trades
2025-12-22 00:19:21,416 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,268,856 rows
2025-12-22 00:21:08,772 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,884,208 trades
2025-12-22 00:21:08,773 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,884,208 rows
2025-12-22 00:23:58,021 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,120,158 trades
2025-12-22 00:23:58,021 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,120,158 rows
2025-12-22 00:24:29,684 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,245,395 trades
2025-12-22 00:24:29,685 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,245,395 rows
2025-12-22 00:25:07,474 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,141,756 trades
2025-12-22 00:25:07,474 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,141,756 rows
2025-12-22 00:27:40,902 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,163,667 trades
2025-12-22 00:27:40,903 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,163,667 rows
2025-12-22 00:27:41,301 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 24,768,852 total rows written
2025-12-22 00:28:57,887 INFO [src.stage_a.wrds_extractor]   Chunk 11: 975,541 trades
2025-12-22 00:28:57,892 INFO [src.stage_a.parquet_writer]   Chunk 11: 975,541 rows
2025-12-22 00:28:58,199 INFO [src.stage_a.parquet_writer] ✓ Wrote 25,744,393 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-06-13
2025-12-22 00:28:58,200 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 00:28:58,200 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 00:28:58,200 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 00:28:58,200 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 00:28:58,200 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 00:28:58,200 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 00:28:58,200 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 00:29:00,365 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 00:29:00,365 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-06-13...
2025-12-22 00:29:00,418 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240613 for 519 symbols
2025-12-22 00:30:55,817 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,585,212 NBBO records
2025-12-22 00:30:55,817 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,585,212 rows
2025-12-22 00:31:27,432 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,130,374 NBBO records
2025-12-22 00:31:27,432 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,130,374 rows
2025-12-22 00:32:01,781 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,078,253 NBBO records
2025-12-22 00:32:01,781 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,078,253 rows
2025-12-22 00:32:25,882 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,129,416 NBBO records
2025-12-22 00:32:25,882 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,129,416 rows
2025-12-22 00:32:55,795 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,938,196 NBBO records
2025-12-22 00:32:55,795 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,938,196 rows
2025-12-22 00:33:30,883 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,037,423 NBBO records
2025-12-22 00:33:30,883 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,037,423 rows
2025-12-22 00:34:10,770 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,605,340 NBBO records
2025-12-22 00:34:10,770 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,605,340 rows
2025-12-22 00:35:00,453 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,648,473 NBBO records
2025-12-22 00:35:00,453 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,648,473 rows
2025-12-22 00:35:36,247 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,644,152 NBBO records
2025-12-22 00:35:36,248 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,644,152 rows
2025-12-22 00:36:11,607 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,190,922 NBBO records
2025-12-22 00:36:11,607 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,190,922 rows
2025-12-22 00:36:11,893 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 31,987,761 total rows written
2025-12-22 00:37:06,596 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,957,273 NBBO records
2025-12-22 00:37:06,596 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,957,273 rows
2025-12-22 00:37:07,083 INFO [src.stage_a.parquet_writer] ✓ Wrote 36,945,034 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-06-13
2025-12-22 00:37:07,090 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 00:37:07,090 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 00:37:07,090 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 00:37:07,090 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 00:37:07,090 INFO [src.stage_a.stage_a] Trades: 25,744,393 rows
2025-12-22 00:37:07,090 INFO [src.stage_a.stage_a] Nbbo: 36,945,034 rows
2025-12-22 00:37:07,090 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 00:37:07,090 INFO [src.stage_a.stage_a] Processing date 3/140: 2024-06-14
2025-12-22 00:37:07,090 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 00:37:07,090 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 00:37:07,090 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-06-14 (519 symbols)
2025-12-22 00:37:07,090 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 00:37:07,090 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 00:37:07,090 INFO [src.stage_a.stage_a] Extract run ID: 6037b5e6-3369-4c5c-8795-bc62eecc60ec
2025-12-22 00:37:07,098 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 00:37:07,098 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 00:37:07,098 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 00:37:07,098 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 00:37:07,098 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 00:37:07,098 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 00:37:07,098 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 00:37:07,098 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 00:37:07,098 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 00:37:08,295 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 00:37:08,295 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-06-14...
2025-12-22 00:37:08,365 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240614 for 519 symbols
2025-12-22 00:38:19,546 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,327,371 trades
2025-12-22 00:38:19,546 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,327,371 rows
2025-12-22 00:38:50,316 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,788,801 trades
2025-12-22 00:38:50,317 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,788,801 rows
2025-12-22 00:39:27,925 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,872,761 trades
2025-12-22 00:39:27,926 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,872,761 rows
2025-12-22 00:39:59,231 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,572,037 trades
2025-12-22 00:39:59,232 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,572,037 rows
2025-12-22 00:40:34,104 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,196,629 trades
2025-12-22 00:40:34,105 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,196,629 rows
2025-12-22 00:41:07,329 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,880,592 trades
2025-12-22 00:41:07,329 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,880,592 rows
2025-12-22 00:42:25,989 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,354,010 trades
2025-12-22 00:42:25,990 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,354,010 rows
2025-12-22 00:43:02,113 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,129,352 trades
2025-12-22 00:43:02,114 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,129,352 rows
2025-12-22 00:43:34,682 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,028,567 trades
2025-12-22 00:43:34,684 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,028,567 rows
2025-12-22 00:44:27,647 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,698,447 trades
2025-12-22 00:44:27,658 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,698,447 rows
2025-12-22 00:44:28,041 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,848,567 total rows written
2025-12-22 00:44:42,625 INFO [src.stage_a.wrds_extractor]   Chunk 11: 952,867 trades
2025-12-22 00:44:42,625 INFO [src.stage_a.parquet_writer]   Chunk 11: 952,867 rows
2025-12-22 00:44:42,932 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,801,434 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-06-14
2025-12-22 00:44:42,932 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 00:44:42,932 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 00:44:42,932 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 00:44:42,932 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 00:44:42,932 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 00:44:42,932 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 00:44:42,932 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 00:44:43,988 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 00:44:43,988 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-06-14...
2025-12-22 00:44:44,039 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240614 for 519 symbols
2025-12-22 00:45:28,433 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,313,734 NBBO records
2025-12-22 00:45:28,434 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,313,734 rows
2025-12-22 00:45:54,343 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,948,922 NBBO records
2025-12-22 00:45:54,343 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,948,922 rows
2025-12-22 00:46:25,472 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,003,255 NBBO records
2025-12-22 00:46:25,472 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,003,255 rows
2025-12-22 00:46:48,228 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,926,602 NBBO records
2025-12-22 00:46:48,228 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,926,602 rows
2025-12-22 00:47:25,802 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,865,856 NBBO records
2025-12-22 00:47:25,803 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,865,856 rows
2025-12-22 00:48:11,332 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,756,275 NBBO records
2025-12-22 00:48:11,332 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,756,275 rows
2025-12-22 00:48:59,930 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,654,215 NBBO records
2025-12-22 00:48:59,930 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,654,215 rows
2025-12-22 00:49:58,602 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,211,234 NBBO records
2025-12-22 00:49:58,602 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,211,234 rows
2025-12-22 00:50:35,109 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,265,867 NBBO records
2025-12-22 00:50:35,109 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,265,867 rows
2025-12-22 00:51:01,670 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,636,759 NBBO records
2025-12-22 00:51:01,670 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,636,759 rows
2025-12-22 00:51:01,931 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 29,582,719 total rows written
2025-12-22 00:51:51,729 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,197,328 NBBO records
2025-12-22 00:51:51,729 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,197,328 rows
2025-12-22 00:51:52,155 INFO [src.stage_a.parquet_writer] ✓ Wrote 33,780,047 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-06-14
2025-12-22 00:51:52,161 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 00:51:52,161 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 00:51:52,161 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 00:51:52,161 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 00:51:52,161 INFO [src.stage_a.stage_a] Trades: 24,801,434 rows
2025-12-22 00:51:52,161 INFO [src.stage_a.stage_a] Nbbo: 33,780,047 rows
2025-12-22 00:51:52,161 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 00:51:52,161 INFO [src.stage_a.stage_a] Processing date 4/140: 2024-06-17
2025-12-22 00:51:52,161 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 00:51:52,161 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 00:51:52,161 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-06-17 (519 symbols)
2025-12-22 00:51:52,161 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 00:51:52,161 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 00:51:52,161 INFO [src.stage_a.stage_a] Extract run ID: 722b521a-bdcb-4e0c-8dad-9156d005aa5c
2025-12-22 00:51:52,170 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 00:51:52,170 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 00:51:52,170 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 00:51:52,170 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 00:51:52,170 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 00:51:52,170 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 00:51:52,170 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 00:51:52,170 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 00:51:52,170 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 00:51:53,193 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 00:51:53,193 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-06-17...
2025-12-22 00:51:53,243 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240617 for 519 symbols
2025-12-22 00:53:00,070 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,978,211 trades
2025-12-22 00:53:00,070 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,978,211 rows
2025-12-22 00:53:33,270 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,943,178 trades
2025-12-22 00:53:33,273 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,943,178 rows
2025-12-22 00:54:04,294 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,037,235 trades
2025-12-22 00:54:04,294 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,037,235 rows
2025-12-22 00:54:29,438 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,665,342 trades
2025-12-22 00:54:29,439 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,665,342 rows
2025-12-22 00:55:08,085 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,416,382 trades
2025-12-22 00:55:08,086 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,416,382 rows
2025-12-22 00:55:41,803 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,102,349 trades
2025-12-22 00:55:41,803 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,102,349 rows
2025-12-22 00:56:57,351 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,715,027 trades
2025-12-22 00:56:57,351 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,715,027 rows
2025-12-22 00:57:34,742 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,393,797 trades
2025-12-22 00:57:34,755 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,393,797 rows
2025-12-22 00:58:09,287 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,332,465 trades
2025-12-22 00:58:09,287 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,332,465 rows
2025-12-22 00:59:01,042 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,194,275 trades
2025-12-22 00:59:01,042 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,194,275 rows
2025-12-22 00:59:01,473 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,778,261 total rows written
2025-12-22 00:59:18,203 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,102,259 trades
2025-12-22 00:59:18,205 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,102,259 rows
2025-12-22 00:59:18,537 INFO [src.stage_a.parquet_writer] ✓ Wrote 27,880,520 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-06-17
2025-12-22 00:59:18,538 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 00:59:18,538 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 00:59:18,538 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 00:59:18,538 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 00:59:18,538 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 00:59:18,538 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 00:59:18,538 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 00:59:19,600 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 00:59:19,601 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-06-17...
2025-12-22 00:59:19,636 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240617 for 519 symbols
2025-12-22 00:59:59,677 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,598,755 NBBO records
2025-12-22 00:59:59,677 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,598,755 rows
2025-12-22 01:00:25,129 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,142,696 NBBO records
2025-12-22 01:00:25,129 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,142,696 rows
2025-12-22 01:00:55,591 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,997,383 NBBO records
2025-12-22 01:00:55,591 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,997,383 rows
2025-12-22 01:01:22,278 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,017,546 NBBO records
2025-12-22 01:01:22,278 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,017,546 rows
2025-12-22 01:01:52,701 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,012,494 NBBO records
2025-12-22 01:01:52,701 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,012,494 rows
2025-12-22 01:02:38,104 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,143,462 NBBO records
2025-12-22 01:02:38,104 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,143,462 rows
2025-12-22 01:03:23,457 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,654,061 NBBO records
2025-12-22 01:03:23,457 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,654,061 rows
2025-12-22 01:04:15,538 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,659,156 NBBO records
2025-12-22 01:04:15,539 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,659,156 rows
2025-12-22 01:04:55,395 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,302,926 NBBO records
2025-12-22 01:04:55,396 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,302,926 rows
2025-12-22 01:05:28,289 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,906,714 NBBO records
2025-12-22 01:05:28,289 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,906,714 rows
2025-12-22 01:05:28,548 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 31,435,193 total rows written
2025-12-22 01:06:22,035 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,971,154 NBBO records
2025-12-22 01:06:22,035 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,971,154 rows
2025-12-22 01:06:22,505 INFO [src.stage_a.parquet_writer] ✓ Wrote 36,406,347 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-06-17
2025-12-22 01:06:22,508 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 01:06:22,508 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 01:06:22,508 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 01:06:22,508 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 01:06:22,508 INFO [src.stage_a.stage_a] Trades: 27,880,520 rows
2025-12-22 01:06:22,508 INFO [src.stage_a.stage_a] Nbbo: 36,406,347 rows
2025-12-22 01:06:22,509 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 01:06:22,509 INFO [src.stage_a.stage_a] Processing date 5/140: 2024-06-18
2025-12-22 01:06:22,509 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 01:06:22,509 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 01:06:22,509 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-06-18 (519 symbols)
2025-12-22 01:06:22,509 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 01:06:22,509 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 01:06:22,509 INFO [src.stage_a.stage_a] Extract run ID: 22470fe7-7eb0-48f6-8a0d-281ae80a55e6
2025-12-22 01:06:22,517 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 01:06:22,517 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 01:06:22,517 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 01:06:22,517 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 01:06:22,517 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 01:06:22,517 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 01:06:22,517 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 01:06:22,517 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 01:06:22,517 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 01:06:23,826 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 01:06:23,827 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-06-18...
2025-12-22 01:06:23,889 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240618 for 519 symbols
2025-12-22 01:07:25,172 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,702,936 trades
2025-12-22 01:07:25,172 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,702,936 rows
2025-12-22 01:08:01,629 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,949,771 trades
2025-12-22 01:08:01,630 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,949,771 rows
2025-12-22 01:08:32,762 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,918,118 trades
2025-12-22 01:08:32,762 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,918,118 rows
2025-12-22 01:09:00,044 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,621,011 trades
2025-12-22 01:09:00,045 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,621,011 rows
2025-12-22 01:09:45,779 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,592,566 trades
2025-12-22 01:09:45,780 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,592,566 rows
2025-12-22 01:10:18,940 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,023,223 trades
2025-12-22 01:10:18,941 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,023,223 rows
2025-12-22 01:11:40,301 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,928,220 trades
2025-12-22 01:11:40,301 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,928,220 rows
2025-12-22 01:12:15,269 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,299,067 trades
2025-12-22 01:12:15,271 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,299,067 rows
2025-12-22 01:12:49,840 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,209,766 trades
2025-12-22 01:12:49,841 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,209,766 rows
2025-12-22 01:13:35,103 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,770,081 trades
2025-12-22 01:13:35,103 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,770,081 rows
2025-12-22 01:13:35,476 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,014,759 total rows written
2025-12-22 01:13:49,554 INFO [src.stage_a.wrds_extractor]   Chunk 11: 980,112 trades
2025-12-22 01:13:49,568 INFO [src.stage_a.parquet_writer]   Chunk 11: 980,112 rows
2025-12-22 01:13:49,864 INFO [src.stage_a.parquet_writer] ✓ Wrote 26,994,871 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-06-18
2025-12-22 01:13:49,865 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 01:13:49,865 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 01:13:49,865 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 01:13:49,865 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 01:13:49,865 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 01:13:49,865 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 01:13:49,865 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 01:13:51,054 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 01:13:51,054 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-06-18...
2025-12-22 01:13:51,102 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240618 for 519 symbols
2025-12-22 01:14:28,700 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,236,836 NBBO records
2025-12-22 01:14:28,700 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,236,836 rows
2025-12-22 01:14:52,238 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,102,350 NBBO records
2025-12-22 01:14:52,238 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,102,350 rows
2025-12-22 01:15:25,007 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,571,777 NBBO records
2025-12-22 01:15:25,007 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,571,777 rows
2025-12-22 01:15:47,327 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,871,202 NBBO records
2025-12-22 01:15:47,328 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,871,202 rows
2025-12-22 01:16:22,368 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,979,425 NBBO records
2025-12-22 01:16:22,368 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,979,425 rows
2025-12-22 01:16:52,451 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,814,367 NBBO records
2025-12-22 01:16:52,451 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,814,367 rows
2025-12-22 01:17:31,419 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,566,450 NBBO records
2025-12-22 01:17:31,419 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,566,450 rows
2025-12-22 01:18:17,754 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,052,102 NBBO records
2025-12-22 01:18:17,754 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,052,102 rows
2025-12-22 01:18:49,902 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,087,907 NBBO records
2025-12-22 01:18:49,902 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,087,907 rows
2025-12-22 01:19:18,349 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,615,287 NBBO records
2025-12-22 01:19:18,349 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,615,287 rows
2025-12-22 01:19:18,592 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 28,897,703 total rows written
2025-12-22 01:20:08,348 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,327,337 NBBO records
2025-12-22 01:20:08,348 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,327,337 rows
2025-12-22 01:20:08,761 INFO [src.stage_a.parquet_writer] ✓ Wrote 33,225,040 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-06-18
2025-12-22 01:20:08,767 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 01:20:08,767 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 01:20:08,767 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 01:20:08,767 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 01:20:08,767 INFO [src.stage_a.stage_a] Trades: 26,994,871 rows
2025-12-22 01:20:08,767 INFO [src.stage_a.stage_a] Nbbo: 33,225,040 rows
2025-12-22 01:20:08,767 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 01:20:08,767 INFO [src.stage_a.stage_a] Processing date 6/140: 2024-06-20
2025-12-22 01:20:08,767 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 01:20:08,767 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 01:20:08,767 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-06-20 (519 symbols)
2025-12-22 01:20:08,767 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 01:20:08,767 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 01:20:08,767 INFO [src.stage_a.stage_a] Extract run ID: 7091a84c-5fd5-45c3-96b5-c5c270844e87
2025-12-22 01:20:08,775 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 01:20:08,775 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 01:20:08,775 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 01:20:08,775 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 01:20:08,775 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 01:20:08,775 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 01:20:08,775 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 01:20:08,775 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 01:20:08,775 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 01:20:10,121 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 01:20:10,122 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-06-20...
2025-12-22 01:20:10,192 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240620 for 519 symbols
2025-12-22 01:21:36,920 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,382,711 trades
2025-12-22 01:21:36,920 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,382,711 rows
2025-12-22 01:22:23,736 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,972,550 trades
2025-12-22 01:22:23,738 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,972,550 rows
2025-12-22 01:23:08,277 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,302,945 trades
2025-12-22 01:23:08,279 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,302,945 rows
2025-12-22 01:23:46,810 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,822,922 trades
2025-12-22 01:23:46,811 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,822,922 rows
2025-12-22 01:24:44,864 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,716,095 trades
2025-12-22 01:24:44,865 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,716,095 rows
2025-12-22 01:25:24,666 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,313,060 trades
2025-12-22 01:25:24,666 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,313,060 rows
2025-12-22 01:27:28,503 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,794,145 trades
2025-12-22 01:27:28,503 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,794,145 rows
2025-12-22 01:28:14,343 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,586,155 trades
2025-12-22 01:28:14,347 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,586,155 rows
2025-12-22 01:29:00,127 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,650,937 trades
2025-12-22 01:29:00,128 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,650,937 rows
2025-12-22 01:29:47,461 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,886,283 trades
2025-12-22 01:29:47,461 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,886,283 rows
2025-12-22 01:29:47,884 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 30,427,803 total rows written
2025-12-22 01:30:05,424 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,160,027 trades
2025-12-22 01:30:05,426 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,160,027 rows
2025-12-22 01:30:05,760 INFO [src.stage_a.parquet_writer] ✓ Wrote 31,587,830 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-06-20
2025-12-22 01:30:05,760 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 01:30:05,760 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 01:30:05,760 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 01:30:05,761 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 01:30:05,761 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 01:30:05,761 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 01:30:05,761 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 01:30:06,819 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 01:30:06,819 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-06-20...
2025-12-22 01:30:06,861 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240620 for 519 symbols
2025-12-22 01:30:49,960 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,164,046 NBBO records
2025-12-22 01:30:49,960 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,164,046 rows
2025-12-22 01:31:13,321 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,336,533 NBBO records
2025-12-22 01:31:13,322 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,336,533 rows
2025-12-22 01:31:55,941 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,950,424 NBBO records
2025-12-22 01:31:55,942 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,950,424 rows
2025-12-22 01:32:25,075 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,281,556 NBBO records
2025-12-22 01:32:25,075 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,281,556 rows
2025-12-22 01:33:03,329 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,616,506 NBBO records
2025-12-22 01:33:03,329 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,616,506 rows
2025-12-22 01:33:42,820 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,598,133 NBBO records
2025-12-22 01:33:42,820 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,598,133 rows
2025-12-22 01:34:39,918 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,811,009 NBBO records
2025-12-22 01:34:39,918 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,811,009 rows
2025-12-22 01:35:36,426 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,408,378 NBBO records
2025-12-22 01:35:36,427 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,408,378 rows
2025-12-22 01:36:24,686 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,197,877 NBBO records
2025-12-22 01:36:24,687 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,197,877 rows
2025-12-22 01:36:56,731 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,176,269 NBBO records
2025-12-22 01:36:56,731 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,176,269 rows
2025-12-22 01:36:57,042 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 37,540,731 total rows written
2025-12-22 01:38:01,449 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,949,450 NBBO records
2025-12-22 01:38:01,449 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,949,450 rows
2025-12-22 01:38:01,969 INFO [src.stage_a.parquet_writer] ✓ Wrote 43,490,181 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-06-20
2025-12-22 01:38:01,975 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 01:38:01,975 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 01:38:01,975 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 01:38:01,975 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 01:38:01,975 INFO [src.stage_a.stage_a] Trades: 31,587,830 rows
2025-12-22 01:38:01,975 INFO [src.stage_a.stage_a] Nbbo: 43,490,181 rows
2025-12-22 01:38:01,975 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 01:38:01,975 INFO [src.stage_a.stage_a] Processing date 7/140: 2024-06-21
2025-12-22 01:38:01,975 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 01:38:01,975 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 01:38:01,975 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-06-21 (519 symbols)
2025-12-22 01:38:01,975 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 01:38:01,975 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 01:38:01,975 INFO [src.stage_a.stage_a] Extract run ID: a5cb3970-8f80-4582-bf6e-493801dcc300
2025-12-22 01:38:01,983 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 01:38:01,983 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 01:38:01,983 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 01:38:01,983 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 01:38:01,983 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 01:38:01,983 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 01:38:01,983 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 01:38:01,983 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 01:38:01,983 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 01:38:03,114 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 01:38:03,114 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-06-21...
2025-12-22 01:38:03,163 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240621 for 519 symbols
2025-12-22 01:39:02,440 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,682,048 trades
2025-12-22 01:39:02,440 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,682,048 rows
2025-12-22 01:39:35,975 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,955,970 trades
2025-12-22 01:39:35,975 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,955,970 rows
2025-12-22 01:40:10,912 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,217,700 trades
2025-12-22 01:40:10,912 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,217,700 rows
2025-12-22 01:40:39,071 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,810,082 trades
2025-12-22 01:40:39,072 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,810,082 rows
2025-12-22 01:41:25,428 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,876,718 trades
2025-12-22 01:41:25,428 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,876,718 rows
2025-12-22 01:41:59,999 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,210,834 trades
2025-12-22 01:41:59,999 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,210,834 rows
2025-12-22 01:43:39,891 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,000,679 trades
2025-12-22 01:43:39,891 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,000,679 rows
2025-12-22 01:44:29,397 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,436,947 trades
2025-12-22 01:44:29,403 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,436,947 rows
2025-12-22 01:45:09,444 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,396,864 trades
2025-12-22 01:45:09,444 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,396,864 rows
2025-12-22 01:45:55,594 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,772,000 trades
2025-12-22 01:45:55,595 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,772,000 rows
2025-12-22 01:45:55,978 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 28,359,842 total rows written
2025-12-22 01:46:17,484 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,120,360 trades
2025-12-22 01:46:17,484 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,120,360 rows
2025-12-22 01:46:17,798 INFO [src.stage_a.parquet_writer] ✓ Wrote 29,480,202 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-06-21
2025-12-22 01:46:17,799 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 01:46:17,799 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 01:46:17,799 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 01:46:17,799 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 01:46:17,799 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 01:46:17,799 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 01:46:17,799 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 01:46:18,918 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 01:46:18,919 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-06-21...
2025-12-22 01:46:18,988 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240621 for 519 symbols
2025-12-22 01:46:57,431 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,797,115 NBBO records
2025-12-22 01:46:57,431 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,797,115 rows
2025-12-22 01:47:25,720 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,359,736 NBBO records
2025-12-22 01:47:25,721 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,359,736 rows
2025-12-22 01:48:05,954 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,508,964 NBBO records
2025-12-22 01:48:05,954 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,508,964 rows
2025-12-22 01:48:28,286 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,318,150 NBBO records
2025-12-22 01:48:28,286 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,318,150 rows
2025-12-22 01:49:07,521 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,750,572 NBBO records
2025-12-22 01:49:07,521 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,750,572 rows
2025-12-22 01:49:39,491 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,213,424 NBBO records
2025-12-22 01:49:39,491 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,213,424 rows
2025-12-22 01:50:30,394 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,679,344 NBBO records
2025-12-22 01:50:30,394 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,679,344 rows
2025-12-22 01:51:18,068 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,273,293 NBBO records
2025-12-22 01:51:18,069 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,273,293 rows
2025-12-22 01:51:58,252 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,435,090 NBBO records
2025-12-22 01:51:58,252 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,435,090 rows
2025-12-22 01:52:28,124 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,160,541 NBBO records
2025-12-22 01:52:28,124 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,160,541 rows
2025-12-22 01:52:28,396 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 34,496,229 total rows written
2025-12-22 01:53:20,114 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,182,073 NBBO records
2025-12-22 01:53:20,114 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,182,073 rows
2025-12-22 01:53:20,618 INFO [src.stage_a.parquet_writer] ✓ Wrote 39,678,302 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-06-21
2025-12-22 01:53:20,623 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 01:53:20,623 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 01:53:20,623 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 01:53:20,623 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 01:53:20,623 INFO [src.stage_a.stage_a] Trades: 29,480,202 rows
2025-12-22 01:53:20,623 INFO [src.stage_a.stage_a] Nbbo: 39,678,302 rows
2025-12-22 01:53:20,623 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 01:53:20,623 INFO [src.stage_a.stage_a] Processing date 8/140: 2024-06-24
2025-12-22 01:53:20,623 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 01:53:20,623 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 01:53:20,623 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-06-24 (519 symbols)
2025-12-22 01:53:20,623 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 01:53:20,623 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 01:53:20,623 INFO [src.stage_a.stage_a] Extract run ID: db01e84d-d926-4837-8dd6-d340b5ae802d
2025-12-22 01:53:20,631 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 01:53:20,631 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 01:53:20,631 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 01:53:20,631 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 01:53:20,631 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 01:53:20,631 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 01:53:20,631 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 01:53:20,631 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 01:53:20,631 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 01:53:21,691 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 01:53:21,691 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-06-24...
2025-12-22 01:53:21,759 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240624 for 519 symbols
2025-12-22 01:54:30,165 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,674,585 trades
2025-12-22 01:54:30,165 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,674,585 rows
2025-12-22 01:54:58,133 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,888,145 trades
2025-12-22 01:54:58,134 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,888,145 rows
2025-12-22 01:55:29,706 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,967,439 trades
2025-12-22 01:55:29,706 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,967,439 rows
2025-12-22 01:56:09,585 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,742,164 trades
2025-12-22 01:56:09,586 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,742,164 rows
2025-12-22 01:56:54,755 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,449,558 trades
2025-12-22 01:56:54,755 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,449,558 rows
2025-12-22 01:57:32,836 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,119,335 trades
2025-12-22 01:57:32,836 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,119,335 rows
2025-12-22 01:59:34,048 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,168,284 trades
2025-12-22 01:59:34,048 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,168,284 rows
2025-12-22 02:00:30,247 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,428,976 trades
2025-12-22 02:00:30,248 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,428,976 rows
2025-12-22 02:01:23,117 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,398,113 trades
2025-12-22 02:01:23,117 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,398,113 rows
2025-12-22 02:02:18,264 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,789,485 trades
2025-12-22 02:02:18,265 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,789,485 rows
2025-12-22 02:02:18,646 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 27,626,084 total rows written
2025-12-22 02:02:42,375 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,086,184 trades
2025-12-22 02:02:42,375 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,086,184 rows
2025-12-22 02:02:42,705 INFO [src.stage_a.parquet_writer] ✓ Wrote 28,712,268 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-06-24
2025-12-22 02:02:42,706 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 02:02:42,706 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 02:02:42,706 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 02:02:42,706 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 02:02:42,706 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 02:02:42,706 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 02:02:42,706 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 02:02:44,013 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 02:02:44,014 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-06-24...
2025-12-22 02:02:44,632 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240624 for 519 symbols
2025-12-22 02:03:36,188 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,035,415 NBBO records
2025-12-22 02:03:36,188 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,035,415 rows
2025-12-22 02:04:03,272 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,435,602 NBBO records
2025-12-22 02:04:03,272 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,435,602 rows
2025-12-22 02:04:39,455 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,622,103 NBBO records
2025-12-22 02:04:39,456 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,622,103 rows
2025-12-22 02:05:01,985 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,203,943 NBBO records
2025-12-22 02:05:01,985 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,203,943 rows
2025-12-22 02:05:34,583 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,290,117 NBBO records
2025-12-22 02:05:34,583 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,290,117 rows
2025-12-22 02:06:06,736 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,298,406 NBBO records
2025-12-22 02:06:06,736 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,298,406 rows
2025-12-22 02:06:54,185 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,925,665 NBBO records
2025-12-22 02:06:54,185 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,925,665 rows
2025-12-22 02:07:45,408 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,935,276 NBBO records
2025-12-22 02:07:45,409 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,935,276 rows
2025-12-22 02:08:20,179 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,720,289 NBBO records
2025-12-22 02:08:20,181 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,720,289 rows
2025-12-22 02:08:49,569 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,117,970 NBBO records
2025-12-22 02:08:49,569 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,117,970 rows
2025-12-22 02:08:49,868 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 35,584,786 total rows written
2025-12-22 02:09:37,663 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,099,350 NBBO records
2025-12-22 02:09:37,663 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,099,350 rows
2025-12-22 02:09:38,189 INFO [src.stage_a.parquet_writer] ✓ Wrote 40,684,136 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-06-24
2025-12-22 02:09:38,198 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 02:09:38,198 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 02:09:38,198 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 02:09:38,198 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 02:09:38,198 INFO [src.stage_a.stage_a] Trades: 28,712,268 rows
2025-12-22 02:09:38,198 INFO [src.stage_a.stage_a] Nbbo: 40,684,136 rows
2025-12-22 02:09:38,198 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 02:09:38,198 INFO [src.stage_a.stage_a] Processing date 9/140: 2024-06-25
2025-12-22 02:09:38,198 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 02:09:38,198 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 02:09:38,198 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-06-25 (519 symbols)
2025-12-22 02:09:38,198 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 02:09:38,198 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 02:09:38,198 INFO [src.stage_a.stage_a] Extract run ID: 24a029c8-e806-452b-bc01-f0e143502ac4
2025-12-22 02:09:38,206 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 02:09:38,206 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 02:09:38,206 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 02:09:38,206 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 02:09:38,206 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 02:09:38,206 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 02:09:38,206 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 02:09:38,206 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 02:09:38,206 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 02:09:39,224 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 02:09:39,224 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-06-25...
2025-12-22 02:09:39,281 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240625 for 519 symbols
2025-12-22 02:10:21,235 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,926,424 trades
2025-12-22 02:10:21,235 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,926,424 rows
2025-12-22 02:10:51,105 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,968,198 trades
2025-12-22 02:10:51,105 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,968,198 rows
2025-12-22 02:11:16,748 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,741,126 trades
2025-12-22 02:11:16,748 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,741,126 rows
2025-12-22 02:11:38,814 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,497,411 trades
2025-12-22 02:11:38,815 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,497,411 rows
2025-12-22 02:12:12,990 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,271,923 trades
2025-12-22 02:12:12,991 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,271,923 rows
2025-12-22 02:12:39,958 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,814,776 trades
2025-12-22 02:12:39,958 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,814,776 rows
2025-12-22 02:13:53,100 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,930,256 trades
2025-12-22 02:13:53,101 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,930,256 rows
2025-12-22 02:14:25,798 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,125,152 trades
2025-12-22 02:14:25,806 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,125,152 rows
2025-12-22 02:14:55,241 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,958,311 trades
2025-12-22 02:14:55,246 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,958,311 rows
2025-12-22 02:15:35,135 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,656,002 trades
2025-12-22 02:15:35,137 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,656,002 rows
2025-12-22 02:15:35,520 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,889,579 total rows written
2025-12-22 02:15:48,496 INFO [src.stage_a.wrds_extractor]   Chunk 11: 935,374 trades
2025-12-22 02:15:48,496 INFO [src.stage_a.parquet_writer]   Chunk 11: 935,374 rows
2025-12-22 02:15:48,846 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,824,953 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-06-25
2025-12-22 02:15:48,847 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 02:15:48,847 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 02:15:48,847 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 02:15:48,847 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 02:15:48,847 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 02:15:48,847 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 02:15:48,847 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 02:15:50,217 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 02:15:50,217 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-06-25...
2025-12-22 02:15:50,299 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240625 for 519 symbols
2025-12-22 02:16:19,828 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,085,385 NBBO records
2025-12-22 02:16:19,828 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,085,385 rows
2025-12-22 02:16:41,030 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,214,601 NBBO records
2025-12-22 02:16:41,030 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,214,601 rows
2025-12-22 02:17:10,984 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,141,294 NBBO records
2025-12-22 02:17:10,984 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,141,294 rows
2025-12-22 02:17:29,544 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,950,764 NBBO records
2025-12-22 02:17:29,544 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,950,764 rows
2025-12-22 02:17:59,356 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,035,528 NBBO records
2025-12-22 02:17:59,356 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,035,528 rows
2025-12-22 02:18:27,780 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,946,575 NBBO records
2025-12-22 02:18:27,780 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,946,575 rows
2025-12-22 02:19:08,463 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,191,474 NBBO records
2025-12-22 02:19:08,464 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,191,474 rows
2025-12-22 02:19:44,631 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,880,974 NBBO records
2025-12-22 02:19:44,631 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,880,974 rows
2025-12-22 02:20:15,622 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,181,874 NBBO records
2025-12-22 02:20:15,622 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,181,874 rows
2025-12-22 02:20:43,378 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,888,492 NBBO records
2025-12-22 02:20:43,378 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,888,492 rows
2025-12-22 02:20:43,651 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 30,516,961 total rows written
2025-12-22 02:21:30,058 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,505,078 NBBO records
2025-12-22 02:21:30,058 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,505,078 rows
2025-12-22 02:21:30,531 INFO [src.stage_a.parquet_writer] ✓ Wrote 35,022,039 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-06-25
2025-12-22 02:21:30,537 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 02:21:30,537 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 02:21:30,537 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 02:21:30,537 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 02:21:30,537 INFO [src.stage_a.stage_a] Trades: 24,824,953 rows
2025-12-22 02:21:30,537 INFO [src.stage_a.stage_a] Nbbo: 35,022,039 rows
2025-12-22 02:21:30,537 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 02:21:30,537 INFO [src.stage_a.stage_a] Processing date 10/140: 2024-06-26
2025-12-22 02:21:30,537 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 02:21:30,537 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 02:21:30,537 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-06-26 (519 symbols)
2025-12-22 02:21:30,537 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 02:21:30,537 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 02:21:30,537 INFO [src.stage_a.stage_a] Extract run ID: 6689b491-c381-4444-868b-2dedc0e9fb5b
2025-12-22 02:21:30,545 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 02:21:30,545 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 02:21:30,545 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 02:21:30,545 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 02:21:30,545 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 02:21:30,545 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 02:21:30,546 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 02:21:30,546 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 02:21:30,546 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 02:21:31,599 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 02:21:31,599 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-06-26...
2025-12-22 02:21:31,656 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240626 for 519 symbols
2025-12-22 02:22:23,779 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,428,926 trades
2025-12-22 02:22:23,779 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,428,926 rows
2025-12-22 02:22:52,979 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,876,819 trades
2025-12-22 02:22:52,985 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,876,819 rows
2025-12-22 02:23:24,887 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,058,962 trades
2025-12-22 02:23:24,887 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,058,962 rows
2025-12-22 02:23:49,295 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,608,755 trades
2025-12-22 02:23:49,295 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,608,755 rows
2025-12-22 02:24:23,733 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,161,972 trades
2025-12-22 02:24:23,734 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,161,972 rows
2025-12-22 02:24:52,253 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,852,944 trades
2025-12-22 02:24:52,253 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,852,944 rows
2025-12-22 02:26:03,391 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,721,887 trades
2025-12-22 02:26:03,391 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,721,887 rows
2025-12-22 02:26:37,086 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,126,637 trades
2025-12-22 02:26:37,089 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,126,637 rows
2025-12-22 02:27:07,493 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,955,863 trades
2025-12-22 02:27:07,493 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,955,863 rows
2025-12-22 02:27:51,549 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,944,025 trades
2025-12-22 02:27:51,549 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,944,025 rows
2025-12-22 02:27:51,969 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 24,736,790 total rows written
2025-12-22 02:28:04,420 INFO [src.stage_a.wrds_extractor]   Chunk 11: 871,869 trades
2025-12-22 02:28:04,421 INFO [src.stage_a.parquet_writer]   Chunk 11: 871,869 rows
2025-12-22 02:28:04,728 INFO [src.stage_a.parquet_writer] ✓ Wrote 25,608,659 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-06-26
2025-12-22 02:28:04,729 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 02:28:04,729 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 02:28:04,729 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 02:28:04,729 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 02:28:04,729 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 02:28:04,729 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 02:28:04,729 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 02:28:05,786 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 02:28:05,786 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-06-26...
2025-12-22 02:28:05,842 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240626 for 519 symbols
2025-12-22 02:28:39,682 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,499,673 NBBO records
2025-12-22 02:28:39,682 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,499,673 rows
2025-12-22 02:29:00,500 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,054,895 NBBO records
2025-12-22 02:29:00,500 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,054,895 rows
2025-12-22 02:29:34,290 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,578,199 NBBO records
2025-12-22 02:29:34,290 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,578,199 rows
2025-12-22 02:29:52,840 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,856,481 NBBO records
2025-12-22 02:29:52,840 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,856,481 rows
2025-12-22 02:30:20,312 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,864,923 NBBO records
2025-12-22 02:30:20,312 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,864,923 rows
2025-12-22 02:30:47,472 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,763,682 NBBO records
2025-12-22 02:30:47,472 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,763,682 rows
2025-12-22 02:31:27,947 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,017,626 NBBO records
2025-12-22 02:31:27,947 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,017,626 rows
2025-12-22 02:32:10,432 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,423,346 NBBO records
2025-12-22 02:32:10,433 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,423,346 rows
2025-12-22 02:32:40,903 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,152,329 NBBO records
2025-12-22 02:32:40,904 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,152,329 rows
2025-12-22 02:33:08,963 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,956,407 NBBO records
2025-12-22 02:33:08,963 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,956,407 rows
2025-12-22 02:33:09,238 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 31,167,561 total rows written
2025-12-22 02:33:52,171 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,625,109 NBBO records
2025-12-22 02:33:52,171 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,625,109 rows
2025-12-22 02:33:52,627 INFO [src.stage_a.parquet_writer] ✓ Wrote 35,792,670 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-06-26
2025-12-22 02:33:52,630 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 02:33:52,630 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 02:33:52,630 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 02:33:52,630 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 02:33:52,630 INFO [src.stage_a.stage_a] Trades: 25,608,659 rows
2025-12-22 02:33:52,630 INFO [src.stage_a.stage_a] Nbbo: 35,792,670 rows
2025-12-22 02:33:52,630 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 02:33:52,630 INFO [src.stage_a.stage_a] Processing date 11/140: 2024-06-27
2025-12-22 02:33:52,630 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 02:33:52,630 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 02:33:52,630 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-06-27 (519 symbols)
2025-12-22 02:33:52,631 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 02:33:52,631 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 02:33:52,631 INFO [src.stage_a.stage_a] Extract run ID: 8a2d6fd6-e53f-4bb5-8f41-3cd445693b9b
2025-12-22 02:33:52,639 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 02:33:52,639 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 02:33:52,639 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 02:33:52,639 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 02:33:52,639 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 02:33:52,639 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 02:33:52,639 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 02:33:52,639 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 02:33:52,639 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 02:33:53,694 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 02:33:53,694 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-06-27...
2025-12-22 02:33:53,757 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240627 for 519 symbols
2025-12-22 02:34:41,743 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,261,059 trades
2025-12-22 02:34:41,743 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,261,059 rows
2025-12-22 02:35:09,979 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,810,768 trades
2025-12-22 02:35:09,979 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,810,768 rows
2025-12-22 02:35:42,498 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,190,141 trades
2025-12-22 02:35:42,498 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,190,141 rows
2025-12-22 02:36:04,785 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,526,767 trades
2025-12-22 02:36:04,785 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,526,767 rows
2025-12-22 02:36:41,820 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,284,857 trades
2025-12-22 02:36:41,820 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,284,857 rows
2025-12-22 02:37:08,426 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,785,007 trades
2025-12-22 02:37:08,426 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,785,007 rows
2025-12-22 02:38:13,019 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,426,605 trades
2025-12-22 02:38:13,019 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,426,605 rows
2025-12-22 02:38:44,512 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,144,983 trades
2025-12-22 02:38:44,515 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,144,983 rows
2025-12-22 02:39:14,261 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,979,118 trades
2025-12-22 02:39:14,261 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,979,118 rows
2025-12-22 02:39:57,755 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,978,789 trades
2025-12-22 02:39:57,759 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,978,789 rows
2025-12-22 02:39:58,164 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 24,388,094 total rows written
2025-12-22 02:40:09,984 INFO [src.stage_a.wrds_extractor]   Chunk 11: 846,146 trades
2025-12-22 02:40:09,984 INFO [src.stage_a.parquet_writer]   Chunk 11: 846,146 rows
2025-12-22 02:40:10,257 INFO [src.stage_a.parquet_writer] ✓ Wrote 25,234,240 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-06-27
2025-12-22 02:40:10,258 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 02:40:10,258 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 02:40:10,258 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 02:40:10,258 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 02:40:10,258 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 02:40:10,258 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 02:40:10,258 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 02:40:11,614 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 02:40:11,614 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-06-27...
2025-12-22 02:40:11,677 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240627 for 519 symbols
2025-12-22 02:40:43,762 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,497,992 NBBO records
2025-12-22 02:40:43,762 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,497,992 rows
2025-12-22 02:41:03,208 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,000,141 NBBO records
2025-12-22 02:41:03,208 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,000,141 rows
2025-12-22 02:41:36,438 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,558,780 NBBO records
2025-12-22 02:41:36,439 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,558,780 rows
2025-12-22 02:41:54,194 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,878,062 NBBO records
2025-12-22 02:41:54,195 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,878,062 rows
2025-12-22 02:42:22,561 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,030,799 NBBO records
2025-12-22 02:42:22,561 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,030,799 rows
2025-12-22 02:42:48,642 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,810,657 NBBO records
2025-12-22 02:42:48,642 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,810,657 rows
2025-12-22 02:43:24,934 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,868,994 NBBO records
2025-12-22 02:43:24,934 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,868,994 rows
2025-12-22 02:44:05,127 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,399,525 NBBO records
2025-12-22 02:44:05,127 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,399,525 rows
2025-12-22 02:44:38,764 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,590,461 NBBO records
2025-12-22 02:44:38,764 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,590,461 rows
2025-12-22 02:45:07,909 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,156,581 NBBO records
2025-12-22 02:45:07,909 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,156,581 rows
2025-12-22 02:45:08,197 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 31,791,992 total rows written
2025-12-22 02:45:47,272 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,407,151 NBBO records
2025-12-22 02:45:47,272 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,407,151 rows
2025-12-22 02:45:47,713 INFO [src.stage_a.parquet_writer] ✓ Wrote 36,199,143 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-06-27
2025-12-22 02:45:47,717 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 02:45:47,717 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 02:45:47,717 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 02:45:47,717 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 02:45:47,717 INFO [src.stage_a.stage_a] Trades: 25,234,240 rows
2025-12-22 02:45:47,717 INFO [src.stage_a.stage_a] Nbbo: 36,199,143 rows
2025-12-22 02:45:47,717 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 02:45:47,717 INFO [src.stage_a.stage_a] Processing date 12/140: 2024-06-28
2025-12-22 02:45:47,717 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 02:45:47,717 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 02:45:47,717 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-06-28 (519 symbols)
2025-12-22 02:45:47,717 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 02:45:47,717 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 02:45:47,717 INFO [src.stage_a.stage_a] Extract run ID: 983bd5f1-aeee-4f92-bc90-7a75f45851ec
2025-12-22 02:45:47,725 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 02:45:47,725 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 02:45:47,725 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 02:45:47,725 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 02:45:47,725 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 02:45:47,725 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 02:45:47,725 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 02:45:47,725 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 02:45:47,725 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 02:45:48,996 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 02:45:48,996 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-06-28...
2025-12-22 02:45:49,092 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240628 for 519 symbols
2025-12-22 02:46:40,593 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,653,135 trades
2025-12-22 02:46:40,594 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,653,135 rows
2025-12-22 02:47:13,187 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,084,443 trades
2025-12-22 02:47:13,189 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,084,443 rows
2025-12-22 02:47:50,457 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,449,605 trades
2025-12-22 02:47:50,457 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,449,605 rows
2025-12-22 02:48:22,413 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,943,226 trades
2025-12-22 02:48:22,413 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,943,226 rows
2025-12-22 02:49:02,330 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,620,623 trades
2025-12-22 02:49:02,330 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,620,623 rows
2025-12-22 02:49:34,759 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,196,795 trades
2025-12-22 02:49:34,759 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,196,795 rows
2025-12-22 02:50:58,884 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,573,841 trades
2025-12-22 02:50:58,884 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,573,841 rows
2025-12-22 02:51:36,148 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,508,531 trades
2025-12-22 02:51:36,154 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,508,531 rows
2025-12-22 02:52:14,758 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,613,972 trades
2025-12-22 02:52:14,758 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,613,972 rows
2025-12-22 02:53:03,766 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,401,160 trades
2025-12-22 02:53:03,766 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,401,160 rows
2025-12-22 02:53:04,223 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 29,045,331 total rows written
2025-12-22 02:53:19,025 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,066,191 trades
2025-12-22 02:53:19,039 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,066,191 rows
2025-12-22 02:53:19,379 INFO [src.stage_a.parquet_writer] ✓ Wrote 30,111,522 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-06-28
2025-12-22 02:53:19,380 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 02:53:19,380 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 02:53:19,380 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 02:53:19,380 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 02:53:19,380 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 02:53:19,380 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 02:53:19,380 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 02:53:20,510 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 02:53:20,510 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-06-28...
2025-12-22 02:53:20,579 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240628 for 519 symbols
2025-12-22 02:54:03,480 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,241,979 NBBO records
2025-12-22 02:54:03,480 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,241,979 rows
2025-12-22 02:54:30,151 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,627,965 NBBO records
2025-12-22 02:54:30,151 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,627,965 rows
2025-12-22 02:55:11,669 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,286,941 NBBO records
2025-12-22 02:55:11,669 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,286,941 rows
2025-12-22 02:55:38,878 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,784,072 NBBO records
2025-12-22 02:55:38,878 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,784,072 rows
2025-12-22 02:56:15,321 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,716,191 NBBO records
2025-12-22 02:56:15,321 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,716,191 rows
2025-12-22 02:56:53,812 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,017,196 NBBO records
2025-12-22 02:56:53,813 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,017,196 rows
2025-12-22 02:57:41,063 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,864,847 NBBO records
2025-12-22 02:57:41,063 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,864,847 rows
2025-12-22 02:58:37,880 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,519,301 NBBO records
2025-12-22 02:58:37,881 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,519,301 rows
2025-12-22 02:59:20,546 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,446,236 NBBO records
2025-12-22 02:59:20,547 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,446,236 rows
2025-12-22 02:59:58,020 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,973,074 NBBO records
2025-12-22 02:59:58,021 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,973,074 rows
2025-12-22 02:59:58,358 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 40,477,802 total rows written
2025-12-22 03:00:51,863 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,724,245 NBBO records
2025-12-22 03:00:51,863 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,724,245 rows
2025-12-22 03:00:52,405 INFO [src.stage_a.parquet_writer] ✓ Wrote 46,202,047 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-06-28
2025-12-22 03:00:52,411 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 03:00:52,411 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 03:00:52,411 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 03:00:52,411 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:00:52,411 INFO [src.stage_a.stage_a] Trades: 30,111,522 rows
2025-12-22 03:00:52,411 INFO [src.stage_a.stage_a] Nbbo: 46,202,047 rows
2025-12-22 03:00:52,411 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 03:00:52,411 INFO [src.stage_a.stage_a] Processing date 13/140: 2024-07-01
2025-12-22 03:00:52,411 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:00:52,411 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:00:52,411 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-07-01 (519 symbols)
2025-12-22 03:00:52,411 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 03:00:52,411 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:00:52,411 INFO [src.stage_a.stage_a] Extract run ID: 5a451cb7-0873-499f-9cd3-9addc16adb56
2025-12-22 03:00:52,419 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 03:00:52,419 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 03:00:52,419 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 03:00:52,419 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 03:00:52,419 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 03:00:52,419 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:00:52,419 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 03:00:52,419 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 03:00:52,419 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 03:00:53,733 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 03:00:53,733 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-01...
2025-12-22 03:00:53,829 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240701 for 519 symbols
2025-12-22 03:01:43,440 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,399,852 trades
2025-12-22 03:01:43,440 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,399,852 rows
2025-12-22 03:02:13,733 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,895,506 trades
2025-12-22 03:02:13,734 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,895,506 rows
2025-12-22 03:02:45,715 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,115,517 trades
2025-12-22 03:02:45,715 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,115,517 rows
2025-12-22 03:03:09,397 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,558,341 trades
2025-12-22 03:03:09,397 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,558,341 rows
2025-12-22 03:03:47,113 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,213,275 trades
2025-12-22 03:03:47,113 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,213,275 rows
2025-12-22 03:04:18,993 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,019,879 trades
2025-12-22 03:04:18,994 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,019,879 rows
2025-12-22 03:05:32,431 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,802,515 trades
2025-12-22 03:05:32,431 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,802,515 rows
2025-12-22 03:06:07,635 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,199,306 trades
2025-12-22 03:06:07,647 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,199,306 rows
2025-12-22 03:06:41,245 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,146,838 trades
2025-12-22 03:06:41,250 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,146,838 rows
2025-12-22 03:07:34,029 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,523,570 trades
2025-12-22 03:07:34,029 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,523,570 rows
2025-12-22 03:07:34,492 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,874,599 total rows written
2025-12-22 03:07:48,099 INFO [src.stage_a.wrds_extractor]   Chunk 11: 971,630 trades
2025-12-22 03:07:48,105 INFO [src.stage_a.parquet_writer]   Chunk 11: 971,630 rows
2025-12-22 03:07:48,450 INFO [src.stage_a.parquet_writer] ✓ Wrote 26,846,229 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-01
2025-12-22 03:07:48,451 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 03:07:48,451 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 03:07:48,451 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 03:07:48,451 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:07:48,451 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 03:07:48,451 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 03:07:48,451 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 03:07:49,681 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 03:07:49,681 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-01...
2025-12-22 03:07:49,738 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240701 for 519 symbols
2025-12-22 03:08:25,809 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,939,128 NBBO records
2025-12-22 03:08:25,809 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,939,128 rows
2025-12-22 03:08:48,158 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,426,838 NBBO records
2025-12-22 03:08:48,159 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,426,838 rows
2025-12-22 03:09:21,969 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,706,942 NBBO records
2025-12-22 03:09:21,969 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,706,942 rows
2025-12-22 03:09:43,274 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,198,851 NBBO records
2025-12-22 03:09:43,274 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,198,851 rows
2025-12-22 03:10:13,697 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,276,997 NBBO records
2025-12-22 03:10:13,697 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,276,997 rows
2025-12-22 03:10:45,542 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,382,898 NBBO records
2025-12-22 03:10:45,542 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,382,898 rows
2025-12-22 03:11:23,176 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,064,736 NBBO records
2025-12-22 03:11:23,177 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,064,736 rows
2025-12-22 03:12:11,971 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,202,472 NBBO records
2025-12-22 03:12:11,972 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,202,472 rows
2025-12-22 03:12:49,781 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,053,915 NBBO records
2025-12-22 03:12:49,782 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,053,915 rows
2025-12-22 03:13:21,171 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,436,637 NBBO records
2025-12-22 03:13:21,172 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,436,637 rows
2025-12-22 03:13:21,457 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 35,689,414 total rows written
2025-12-22 03:14:08,334 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,185,226 NBBO records
2025-12-22 03:14:08,334 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,185,226 rows
2025-12-22 03:14:08,808 INFO [src.stage_a.parquet_writer] ✓ Wrote 40,874,640 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-01
2025-12-22 03:14:08,814 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 03:14:08,814 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 03:14:08,814 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 03:14:08,814 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:14:08,814 INFO [src.stage_a.stage_a] Trades: 26,846,229 rows
2025-12-22 03:14:08,814 INFO [src.stage_a.stage_a] Nbbo: 40,874,640 rows
2025-12-22 03:14:08,814 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 03:14:08,814 INFO [src.stage_a.stage_a] Processing date 14/140: 2024-07-02
2025-12-22 03:14:08,814 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:14:08,814 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:14:08,814 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-07-02 (519 symbols)
2025-12-22 03:14:08,814 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 03:14:08,814 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:14:08,814 INFO [src.stage_a.stage_a] Extract run ID: 8ba37bad-8c45-4102-8dbc-7cfd7ff5d17f
2025-12-22 03:14:08,822 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 03:14:08,822 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 03:14:08,823 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 03:14:08,823 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 03:14:08,823 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 03:14:08,823 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:14:08,823 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 03:14:08,823 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 03:14:08,823 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 03:14:09,845 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 03:14:09,845 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-02...
2025-12-22 03:14:09,913 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240702 for 519 symbols
2025-12-22 03:14:56,503 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,090,185 trades
2025-12-22 03:14:56,504 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,090,185 rows
2025-12-22 03:15:20,378 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,624,169 trades
2025-12-22 03:15:20,378 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,624,169 rows
2025-12-22 03:15:46,295 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,875,228 trades
2025-12-22 03:15:46,296 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,875,228 rows
2025-12-22 03:16:06,571 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,428,050 trades
2025-12-22 03:16:06,571 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,428,050 rows
2025-12-22 03:16:38,474 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,049,037 trades
2025-12-22 03:16:38,474 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,049,037 rows
2025-12-22 03:17:05,638 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,836,732 trades
2025-12-22 03:17:05,638 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,836,732 rows
2025-12-22 03:17:59,823 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,792,171 trades
2025-12-22 03:17:59,823 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,792,171 rows
2025-12-22 03:18:28,669 INFO [src.stage_a.wrds_extractor]   Chunk 8: 1,985,592 trades
2025-12-22 03:18:28,672 INFO [src.stage_a.parquet_writer]   Chunk 8: 1,985,592 rows
2025-12-22 03:18:56,020 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,870,066 trades
2025-12-22 03:18:56,021 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,870,066 rows
2025-12-22 03:19:50,186 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,842,379 trades
2025-12-22 03:19:50,186 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,842,379 rows
2025-12-22 03:19:50,654 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,393,609 total rows written
2025-12-22 03:20:03,276 INFO [src.stage_a.wrds_extractor]   Chunk 11: 915,310 trades
2025-12-22 03:20:03,282 INFO [src.stage_a.parquet_writer]   Chunk 11: 915,310 rows
2025-12-22 03:20:03,591 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,308,919 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-02
2025-12-22 03:20:03,592 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 03:20:03,592 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 03:20:03,592 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 03:20:03,592 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:20:03,592 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 03:20:03,592 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 03:20:03,592 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 03:20:04,818 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 03:20:04,818 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-02...
2025-12-22 03:20:04,882 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240702 for 519 symbols
2025-12-22 03:20:37,755 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,406,038 NBBO records
2025-12-22 03:20:37,755 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,406,038 rows
2025-12-22 03:20:56,733 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,905,881 NBBO records
2025-12-22 03:20:56,733 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,905,881 rows
2025-12-22 03:21:26,963 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,279,761 NBBO records
2025-12-22 03:21:26,963 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,279,761 rows
2025-12-22 03:21:45,205 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,902,818 NBBO records
2025-12-22 03:21:45,205 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,902,818 rows
2025-12-22 03:22:12,471 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,868,743 NBBO records
2025-12-22 03:22:12,471 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,868,743 rows
2025-12-22 03:22:39,728 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,899,389 NBBO records
2025-12-22 03:22:39,728 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,899,389 rows
2025-12-22 03:23:12,335 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,462,886 NBBO records
2025-12-22 03:23:12,335 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,462,886 rows
2025-12-22 03:23:53,174 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,197,200 NBBO records
2025-12-22 03:23:53,174 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,197,200 rows
2025-12-22 03:24:25,896 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,468,768 NBBO records
2025-12-22 03:24:25,897 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,468,768 rows
2025-12-22 03:25:02,518 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,420,124 NBBO records
2025-12-22 03:25:02,518 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,420,124 rows
2025-12-22 03:25:02,805 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 30,811,608 total rows written
2025-12-22 03:25:45,568 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,677,137 NBBO records
2025-12-22 03:25:45,569 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,677,137 rows
2025-12-22 03:25:46,017 INFO [src.stage_a.parquet_writer] ✓ Wrote 35,488,745 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-02
2025-12-22 03:25:46,023 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 03:25:46,023 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 03:25:46,023 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 03:25:46,023 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:25:46,023 INFO [src.stage_a.stage_a] Trades: 24,308,919 rows
2025-12-22 03:25:46,023 INFO [src.stage_a.stage_a] Nbbo: 35,488,745 rows
2025-12-22 03:25:46,023 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 03:25:46,023 INFO [src.stage_a.stage_a] Processing date 15/140: 2024-07-03
2025-12-22 03:25:46,023 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:25:46,023 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:25:46,023 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-07-03 (519 symbols)
2025-12-22 03:25:46,023 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 03:25:46,023 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:25:46,023 INFO [src.stage_a.stage_a] Extract run ID: 8443874a-60bc-48e1-a92b-88f90e3aeb9c
2025-12-22 03:25:46,031 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 03:25:46,031 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 03:25:46,031 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 03:25:46,031 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 03:25:46,031 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 03:25:46,031 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:25:46,031 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 03:25:46,031 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 03:25:46,031 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 03:25:47,195 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 03:25:47,196 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-03...
2025-12-22 03:25:47,287 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240703 for 519 symbols
2025-12-22 03:26:19,035 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,287,875 trades
2025-12-22 03:26:19,035 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,287,875 rows
2025-12-22 03:26:34,984 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,035,523 trades
2025-12-22 03:26:34,985 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,035,523 rows
2025-12-22 03:26:52,257 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,207,655 trades
2025-12-22 03:26:52,257 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,207,655 rows
2025-12-22 03:27:06,452 INFO [src.stage_a.wrds_extractor]   Chunk 4: 976,733 trades
2025-12-22 03:27:06,452 INFO [src.stage_a.parquet_writer]   Chunk 4: 976,733 rows
2025-12-22 03:27:27,038 INFO [src.stage_a.wrds_extractor]   Chunk 5: 1,376,304 trades
2025-12-22 03:27:27,038 INFO [src.stage_a.parquet_writer]   Chunk 5: 1,376,304 rows
2025-12-22 03:27:45,381 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,253,828 trades
2025-12-22 03:27:45,381 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,253,828 rows
2025-12-22 03:28:30,231 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,182,701 trades
2025-12-22 03:28:30,231 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,182,701 rows
2025-12-22 03:28:52,096 INFO [src.stage_a.wrds_extractor]   Chunk 8: 1,456,522 trades
2025-12-22 03:28:52,096 INFO [src.stage_a.parquet_writer]   Chunk 8: 1,456,522 rows
2025-12-22 03:29:11,394 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,282,503 trades
2025-12-22 03:29:11,394 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,282,503 rows
2025-12-22 03:29:53,213 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,951,417 trades
2025-12-22 03:29:53,213 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,951,417 rows
2025-12-22 03:29:53,589 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 17,011,061 total rows written
2025-12-22 03:30:04,775 INFO [src.stage_a.wrds_extractor]   Chunk 11: 662,606 trades
2025-12-22 03:30:04,776 INFO [src.stage_a.parquet_writer]   Chunk 11: 662,606 rows
2025-12-22 03:30:05,005 INFO [src.stage_a.parquet_writer] ✓ Wrote 17,673,667 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-03
2025-12-22 03:30:05,006 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 03:30:05,006 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 03:30:05,006 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 03:30:05,006 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:30:05,006 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 03:30:05,006 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 03:30:05,006 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 03:30:06,216 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 03:30:06,216 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-03...
2025-12-22 03:30:06,294 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240703 for 519 symbols
2025-12-22 03:30:28,233 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,193,429 NBBO records
2025-12-22 03:30:28,233 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,193,429 rows
2025-12-22 03:30:42,169 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,378,132 NBBO records
2025-12-22 03:30:42,169 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,378,132 rows
2025-12-22 03:31:02,545 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,112,403 NBBO records
2025-12-22 03:31:02,545 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,112,403 rows
2025-12-22 03:31:15,707 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,303,830 NBBO records
2025-12-22 03:31:15,707 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,303,830 rows
2025-12-22 03:31:34,654 INFO [src.stage_a.wrds_extractor]   Chunk 5: 1,911,601 NBBO records
2025-12-22 03:31:34,654 INFO [src.stage_a.parquet_writer]   Chunk 5: 1,911,601 rows
2025-12-22 03:31:54,333 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,046,433 NBBO records
2025-12-22 03:31:54,333 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,046,433 rows
2025-12-22 03:32:19,031 INFO [src.stage_a.wrds_extractor]   Chunk 7: 2,567,698 NBBO records
2025-12-22 03:32:19,031 INFO [src.stage_a.parquet_writer]   Chunk 7: 2,567,698 rows
2025-12-22 03:32:45,641 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,780,700 NBBO records
2025-12-22 03:32:45,641 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,780,700 rows
2025-12-22 03:33:05,848 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,980,241 NBBO records
2025-12-22 03:33:05,848 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,980,241 rows
2025-12-22 03:33:29,081 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,387,776 NBBO records
2025-12-22 03:33:29,081 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,387,776 rows
2025-12-22 03:33:29,305 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 20,662,243 total rows written
2025-12-22 03:33:54,113 INFO [src.stage_a.wrds_extractor]   Chunk 11: 2,709,955 NBBO records
2025-12-22 03:33:54,114 INFO [src.stage_a.parquet_writer]   Chunk 11: 2,709,955 rows
2025-12-22 03:33:54,416 INFO [src.stage_a.parquet_writer] ✓ Wrote 23,372,198 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-03
2025-12-22 03:33:54,418 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 03:33:54,418 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 03:33:54,418 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 03:33:54,418 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:33:54,418 INFO [src.stage_a.stage_a] Trades: 17,673,667 rows
2025-12-22 03:33:54,418 INFO [src.stage_a.stage_a] Nbbo: 23,372,198 rows
2025-12-22 03:33:54,418 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 03:33:54,418 INFO [src.stage_a.stage_a] Processing date 16/140: 2024-07-05
2025-12-22 03:33:54,418 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:33:54,418 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:33:54,418 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-07-05 (519 symbols)
2025-12-22 03:33:54,418 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 03:33:54,418 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:33:54,418 INFO [src.stage_a.stage_a] Extract run ID: f56060e1-f0a3-49d8-94b7-1aec26487efc
2025-12-22 03:33:54,426 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 03:33:54,426 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 03:33:54,426 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 03:33:54,426 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 03:33:54,426 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 03:33:54,426 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:33:54,426 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 03:33:54,426 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 03:33:54,426 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 03:33:55,903 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 03:33:55,903 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-05...
2025-12-22 03:33:56,018 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240705 for 519 symbols
2025-12-22 03:34:43,065 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,267,347 trades
2025-12-22 03:34:43,065 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,267,347 rows
2025-12-22 03:35:07,006 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,583,896 trades
2025-12-22 03:35:07,006 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,583,896 rows
2025-12-22 03:35:32,650 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,743,557 trades
2025-12-22 03:35:32,650 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,743,557 rows
2025-12-22 03:35:52,920 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,334,881 trades
2025-12-22 03:35:52,921 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,334,881 rows
2025-12-22 03:36:24,810 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,083,010 trades
2025-12-22 03:36:24,810 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,083,010 rows
2025-12-22 03:36:50,395 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,722,998 trades
2025-12-22 03:36:50,395 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,722,998 rows
2025-12-22 03:37:53,299 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,256,032 trades
2025-12-22 03:37:53,299 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,256,032 rows
2025-12-22 03:38:21,982 INFO [src.stage_a.wrds_extractor]   Chunk 8: 1,919,369 trades
2025-12-22 03:38:21,987 INFO [src.stage_a.parquet_writer]   Chunk 8: 1,919,369 rows
2025-12-22 03:38:48,918 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,807,411 trades
2025-12-22 03:38:48,918 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,807,411 rows
2025-12-22 03:39:36,258 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,285,489 trades
2025-12-22 03:39:36,259 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,285,489 rows
2025-12-22 03:39:36,686 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,003,990 total rows written
2025-12-22 03:39:48,411 INFO [src.stage_a.wrds_extractor]   Chunk 11: 845,994 trades
2025-12-22 03:39:48,414 INFO [src.stage_a.parquet_writer]   Chunk 11: 845,994 rows
2025-12-22 03:39:48,706 INFO [src.stage_a.parquet_writer] ✓ Wrote 23,849,984 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-05
2025-12-22 03:39:48,707 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 03:39:48,707 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 03:39:48,707 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 03:39:48,707 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:39:48,707 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 03:39:48,707 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 03:39:48,707 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 03:39:49,915 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 03:39:49,915 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-05...
2025-12-22 03:39:49,976 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240705 for 519 symbols
2025-12-22 03:40:18,419 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,918,739 NBBO records
2025-12-22 03:40:18,419 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,918,739 rows
2025-12-22 03:40:37,806 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,897,909 NBBO records
2025-12-22 03:40:37,806 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,897,909 rows
2025-12-22 03:41:03,756 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,674,941 NBBO records
2025-12-22 03:41:03,756 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,674,941 rows
2025-12-22 03:41:20,971 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,731,046 NBBO records
2025-12-22 03:41:20,971 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,731,046 rows
2025-12-22 03:42:03,132 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,640,489 NBBO records
2025-12-22 03:42:03,132 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,640,489 rows
2025-12-22 03:42:31,398 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,769,728 NBBO records
2025-12-22 03:42:31,398 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,769,728 rows
2025-12-22 03:43:08,958 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,552,459 NBBO records
2025-12-22 03:43:08,958 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,552,459 rows
2025-12-22 03:43:48,956 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,871,203 NBBO records
2025-12-22 03:43:48,957 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,871,203 rows
2025-12-22 03:44:20,330 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,822,008 NBBO records
2025-12-22 03:44:20,330 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,822,008 rows
2025-12-22 03:44:50,584 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,851,191 NBBO records
2025-12-22 03:44:50,584 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,851,191 rows
2025-12-22 03:44:50,851 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 27,729,713 total rows written
2025-12-22 03:45:26,096 INFO [src.stage_a.wrds_extractor]   Chunk 11: 3,730,827 NBBO records
2025-12-22 03:45:26,097 INFO [src.stage_a.parquet_writer]   Chunk 11: 3,730,827 rows
2025-12-22 03:45:26,492 INFO [src.stage_a.parquet_writer] ✓ Wrote 31,460,540 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-05
2025-12-22 03:45:26,497 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 03:45:26,497 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 03:45:26,497 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 03:45:26,497 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:45:26,497 INFO [src.stage_a.stage_a] Trades: 23,849,984 rows
2025-12-22 03:45:26,497 INFO [src.stage_a.stage_a] Nbbo: 31,460,540 rows
2025-12-22 03:45:26,497 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 03:45:26,497 INFO [src.stage_a.stage_a] Processing date 17/140: 2024-07-08
2025-12-22 03:45:26,497 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:45:26,497 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:45:26,497 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-07-08 (519 symbols)
2025-12-22 03:45:26,497 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 03:45:26,497 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:45:26,497 INFO [src.stage_a.stage_a] Extract run ID: a0438e74-86d7-4af9-8227-83e9e8fa8451
2025-12-22 03:45:26,505 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 03:45:26,505 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 03:45:26,505 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 03:45:26,505 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 03:45:26,505 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 03:45:26,505 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:45:26,505 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 03:45:26,505 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 03:45:26,505 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 03:45:27,622 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 03:45:27,622 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-08...
2025-12-22 03:45:27,681 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240708 for 519 symbols
2025-12-22 03:46:13,362 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,191,036 trades
2025-12-22 03:46:13,362 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,191,036 rows
2025-12-22 03:46:36,802 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,654,458 trades
2025-12-22 03:46:36,802 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,654,458 rows
2025-12-22 03:47:02,666 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,884,880 trades
2025-12-22 03:47:02,667 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,884,880 rows
2025-12-22 03:47:26,258 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,372,426 trades
2025-12-22 03:47:26,259 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,372,426 rows
2025-12-22 03:48:01,777 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,382,745 trades
2025-12-22 03:48:01,777 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,382,745 rows
2025-12-22 03:48:26,327 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,744,962 trades
2025-12-22 03:48:26,327 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,744,962 rows
2025-12-22 03:49:29,467 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,325,543 trades
2025-12-22 03:49:29,467 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,325,543 rows
2025-12-22 03:49:58,668 INFO [src.stage_a.wrds_extractor]   Chunk 8: 1,994,786 trades
2025-12-22 03:49:58,673 INFO [src.stage_a.parquet_writer]   Chunk 8: 1,994,786 rows
2025-12-22 03:50:25,865 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,929,599 trades
2025-12-22 03:50:25,869 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,929,599 rows
2025-12-22 03:51:11,894 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,281,802 trades
2025-12-22 03:51:11,894 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,281,802 rows
2025-12-22 03:51:12,311 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,762,237 total rows written
2025-12-22 03:51:23,474 INFO [src.stage_a.wrds_extractor]   Chunk 11: 840,174 trades
2025-12-22 03:51:23,477 INFO [src.stage_a.parquet_writer]   Chunk 11: 840,174 rows
2025-12-22 03:51:23,773 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,602,411 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-08
2025-12-22 03:51:23,773 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 03:51:23,773 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 03:51:23,773 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 03:51:23,773 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:51:23,774 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 03:51:23,774 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 03:51:23,774 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 03:51:24,903 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 03:51:24,904 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-08...
2025-12-22 03:51:24,955 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240708 for 519 symbols
2025-12-22 03:51:56,031 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,282,287 NBBO records
2025-12-22 03:51:56,031 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,282,287 rows
2025-12-22 03:52:17,046 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,157,133 NBBO records
2025-12-22 03:52:17,046 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,157,133 rows
2025-12-22 03:52:47,900 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,221,790 NBBO records
2025-12-22 03:52:47,900 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,221,790 rows
2025-12-22 03:53:06,298 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,837,268 NBBO records
2025-12-22 03:53:06,298 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,837,268 rows
2025-12-22 03:53:38,722 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,371,661 NBBO records
2025-12-22 03:53:38,723 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,371,661 rows
2025-12-22 03:54:06,878 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,911,572 NBBO records
2025-12-22 03:54:06,878 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,911,572 rows
2025-12-22 03:54:47,653 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,857,075 NBBO records
2025-12-22 03:54:47,654 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,857,075 rows
2025-12-22 03:55:20,220 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,478,148 NBBO records
2025-12-22 03:55:20,220 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,478,148 rows
2025-12-22 03:55:45,835 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,678,382 NBBO records
2025-12-22 03:55:45,835 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,678,382 rows
2025-12-22 03:56:16,570 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,271,136 NBBO records
2025-12-22 03:56:16,570 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,271,136 rows
2025-12-22 03:56:16,847 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 30,066,452 total rows written
2025-12-22 03:56:52,109 INFO [src.stage_a.wrds_extractor]   Chunk 11: 3,782,238 NBBO records
2025-12-22 03:56:52,109 INFO [src.stage_a.parquet_writer]   Chunk 11: 3,782,238 rows
2025-12-22 03:56:52,487 INFO [src.stage_a.parquet_writer] ✓ Wrote 33,848,690 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-08
2025-12-22 03:56:52,491 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 03:56:52,491 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 03:56:52,491 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 03:56:52,491 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:56:52,491 INFO [src.stage_a.stage_a] Trades: 24,602,411 rows
2025-12-22 03:56:52,491 INFO [src.stage_a.stage_a] Nbbo: 33,848,690 rows
2025-12-22 03:56:52,491 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 03:56:52,491 INFO [src.stage_a.stage_a] Processing date 18/140: 2024-07-09
2025-12-22 03:56:52,491 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:56:52,491 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:56:52,491 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-07-09 (519 symbols)
2025-12-22 03:56:52,491 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 03:56:52,491 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:56:52,491 INFO [src.stage_a.stage_a] Extract run ID: 94daabaa-0f6a-4b69-a743-bcc42f9794f1
2025-12-22 03:56:52,499 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 03:56:52,499 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 03:56:52,499 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 03:56:52,499 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 03:56:52,499 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 03:56:52,499 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 03:56:52,499 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 03:56:52,499 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 03:56:52,499 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 03:56:53,602 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 03:56:53,602 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-09...
2025-12-22 03:56:53,668 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240709 for 519 symbols
2025-12-22 03:57:33,499 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,944,903 trades
2025-12-22 03:57:33,499 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,944,903 rows
2025-12-22 03:57:58,199 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,676,028 trades
2025-12-22 03:57:58,199 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,676,028 rows
2025-12-22 03:58:25,457 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,978,015 trades
2025-12-22 03:58:25,457 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,978,015 rows
2025-12-22 03:58:46,417 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,383,979 trades
2025-12-22 03:58:46,418 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,383,979 rows
2025-12-22 03:59:21,639 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,316,925 trades
2025-12-22 03:59:21,640 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,316,925 rows
2025-12-22 03:59:55,537 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,725,139 trades
2025-12-22 03:59:55,537 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,725,139 rows
2025-12-22 04:01:05,983 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,543,300 trades
2025-12-22 04:01:05,983 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,543,300 rows
2025-12-22 04:01:40,008 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,062,976 trades
2025-12-22 04:01:40,022 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,062,976 rows
2025-12-22 04:02:06,674 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,830,654 trades
2025-12-22 04:02:06,674 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,830,654 rows
2025-12-22 04:02:51,948 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,206,226 trades
2025-12-22 04:02:51,956 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,206,226 rows
2025-12-22 04:02:52,380 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,668,145 total rows written
2025-12-22 04:03:03,380 INFO [src.stage_a.wrds_extractor]   Chunk 11: 808,287 trades
2025-12-22 04:03:03,380 INFO [src.stage_a.parquet_writer]   Chunk 11: 808,287 rows
2025-12-22 04:03:03,682 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,476,432 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-09
2025-12-22 04:03:03,683 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 04:03:03,683 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 04:03:03,683 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 04:03:03,683 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 04:03:03,683 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 04:03:03,683 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 04:03:03,683 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 04:03:05,216 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 04:03:05,216 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-09...
2025-12-22 04:03:05,277 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240709 for 519 symbols
2025-12-22 04:03:44,130 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,180,406 NBBO records
2025-12-22 04:03:44,131 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,180,406 rows
2025-12-22 04:04:06,629 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,984,454 NBBO records
2025-12-22 04:04:06,630 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,984,454 rows
2025-12-22 04:04:37,735 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,035,201 NBBO records
2025-12-22 04:04:37,735 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,035,201 rows
2025-12-22 04:04:57,201 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,813,997 NBBO records
2025-12-22 04:04:57,201 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,813,997 rows
2025-12-22 04:05:33,264 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,128,318 NBBO records
2025-12-22 04:05:33,264 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,128,318 rows
2025-12-22 04:05:59,215 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,591,580 NBBO records
2025-12-22 04:05:59,215 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,591,580 rows
2025-12-22 04:06:36,820 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,791,334 NBBO records
2025-12-22 04:06:36,821 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,791,334 rows
2025-12-22 04:07:16,095 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,980,481 NBBO records
2025-12-22 04:07:16,095 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,980,481 rows
2025-12-22 04:07:44,053 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,763,529 NBBO records
2025-12-22 04:07:44,053 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,763,529 rows
2025-12-22 04:08:13,459 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,972,417 NBBO records
2025-12-22 04:08:13,459 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,972,417 rows
2025-12-22 04:08:13,713 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 29,241,717 total rows written
2025-12-22 04:08:52,268 INFO [src.stage_a.wrds_extractor]   Chunk 11: 3,882,088 NBBO records
2025-12-22 04:08:52,268 INFO [src.stage_a.parquet_writer]   Chunk 11: 3,882,088 rows
2025-12-22 04:08:52,699 INFO [src.stage_a.parquet_writer] ✓ Wrote 33,123,805 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-09
2025-12-22 04:08:52,706 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 04:08:52,706 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 04:08:52,706 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 04:08:52,706 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 04:08:52,706 INFO [src.stage_a.stage_a] Trades: 24,476,432 rows
2025-12-22 04:08:52,706 INFO [src.stage_a.stage_a] Nbbo: 33,123,805 rows
2025-12-22 04:08:52,706 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 04:08:52,706 INFO [src.stage_a.stage_a] Processing date 19/140: 2024-07-10
2025-12-22 04:08:52,706 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 04:08:52,706 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 04:08:52,706 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-07-10 (519 symbols)
2025-12-22 04:08:52,706 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 04:08:52,706 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 04:08:52,706 INFO [src.stage_a.stage_a] Extract run ID: 78a24abc-d07f-4e02-a1f2-ba829402ae1e
2025-12-22 04:08:52,714 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 04:08:52,714 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 04:08:52,714 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 04:08:52,714 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 04:08:52,714 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 04:08:52,714 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 04:08:52,714 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 04:08:52,714 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 04:08:52,714 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 04:08:53,845 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 04:08:53,846 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-10...
2025-12-22 04:08:53,932 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240710 for 519 symbols
2025-12-22 04:09:41,271 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,363,400 trades
2025-12-22 04:09:41,272 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,363,400 rows
2025-12-22 04:10:03,869 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,501,660 trades
2025-12-22 04:10:03,870 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,501,660 rows
2025-12-22 04:10:31,762 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,977,527 trades
2025-12-22 04:10:31,762 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,977,527 rows
2025-12-22 04:10:50,865 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,318,975 trades
2025-12-22 04:10:50,865 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,318,975 rows
2025-12-22 04:11:20,675 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,070,765 trades
2025-12-22 04:11:20,675 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,070,765 rows
2025-12-22 04:11:47,840 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,849,980 trades
2025-12-22 04:11:47,840 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,849,980 rows
2025-12-22 04:12:46,723 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,182,667 trades
2025-12-22 04:12:46,724 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,182,667 rows
2025-12-22 04:13:14,544 INFO [src.stage_a.wrds_extractor]   Chunk 8: 1,970,093 trades
2025-12-22 04:13:14,556 INFO [src.stage_a.parquet_writer]   Chunk 8: 1,970,093 rows
2025-12-22 04:13:42,831 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,895,855 trades
2025-12-22 04:13:42,831 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,895,855 rows
2025-12-22 04:14:25,652 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,083,934 trades
2025-12-22 04:14:25,652 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,083,934 rows
2025-12-22 04:14:26,083 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,214,856 total rows written
2025-12-22 04:14:37,589 INFO [src.stage_a.wrds_extractor]   Chunk 11: 823,960 trades
2025-12-22 04:14:37,589 INFO [src.stage_a.parquet_writer]   Chunk 11: 823,960 rows
2025-12-22 04:14:37,890 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,038,816 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-10
2025-12-22 04:14:37,891 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 04:14:37,891 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 04:14:37,891 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 04:14:37,891 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 04:14:37,891 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 04:14:37,891 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 04:14:37,891 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 04:14:38,981 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 04:14:38,981 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-10...
2025-12-22 04:14:39,035 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240710 for 519 symbols
2025-12-22 04:15:09,320 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,286,083 NBBO records
2025-12-22 04:15:09,320 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,286,083 rows
2025-12-22 04:15:27,877 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,903,752 NBBO records
2025-12-22 04:15:27,878 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,903,752 rows
2025-12-22 04:15:57,996 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,337,286 NBBO records
2025-12-22 04:15:57,996 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,337,286 rows
2025-12-22 04:16:14,682 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,735,906 NBBO records
2025-12-22 04:16:14,682 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,735,906 rows
2025-12-22 04:16:38,907 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,525,300 NBBO records
2025-12-22 04:16:38,907 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,525,300 rows
2025-12-22 04:17:10,006 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,905,306 NBBO records
2025-12-22 04:17:10,006 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,905,306 rows
2025-12-22 04:17:44,230 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,654,826 NBBO records
2025-12-22 04:17:44,230 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,654,826 rows
2025-12-22 04:18:17,135 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,515,246 NBBO records
2025-12-22 04:18:17,135 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,515,246 rows
2025-12-22 04:18:42,090 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,609,593 NBBO records
2025-12-22 04:18:42,090 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,609,593 rows
2025-12-22 04:19:11,040 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,076,441 NBBO records
2025-12-22 04:19:11,040 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,076,441 rows
2025-12-22 04:19:11,325 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 28,549,739 total rows written
2025-12-22 04:19:43,809 INFO [src.stage_a.wrds_extractor]   Chunk 11: 3,515,285 NBBO records
2025-12-22 04:19:43,810 INFO [src.stage_a.parquet_writer]   Chunk 11: 3,515,285 rows
2025-12-22 04:19:44,198 INFO [src.stage_a.parquet_writer] ✓ Wrote 32,065,024 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-10
2025-12-22 04:19:44,200 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 04:19:44,200 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 04:19:44,201 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 04:19:44,201 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 04:19:44,201 INFO [src.stage_a.stage_a] Trades: 24,038,816 rows
2025-12-22 04:19:44,201 INFO [src.stage_a.stage_a] Nbbo: 32,065,024 rows
2025-12-22 04:19:44,201 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 04:19:44,201 INFO [src.stage_a.stage_a] Processing date 20/140: 2024-07-11
2025-12-22 04:19:44,201 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 04:19:44,201 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 04:19:44,201 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-07-11 (519 symbols)
2025-12-22 04:19:44,201 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 04:19:44,201 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 04:19:44,201 INFO [src.stage_a.stage_a] Extract run ID: a8df106d-c83f-454b-bde3-9858b375339d
2025-12-22 04:19:44,209 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 04:19:44,209 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 04:19:44,209 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 04:19:44,209 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 04:19:44,209 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 04:19:44,209 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 04:19:44,209 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 04:19:44,209 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 04:19:44,209 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 04:19:45,366 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 04:19:45,366 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-11...
2025-12-22 04:19:45,431 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240711 for 519 symbols
2025-12-22 04:20:41,090 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,882,427 trades
2025-12-22 04:20:41,090 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,882,427 rows
2025-12-22 04:21:11,735 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,013,121 trades
2025-12-22 04:21:11,737 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,013,121 rows
2025-12-22 04:21:46,242 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,454,921 trades
2025-12-22 04:21:46,242 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,454,921 rows
2025-12-22 04:22:20,983 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,610,788 trades
2025-12-22 04:22:20,983 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,610,788 rows
2025-12-22 04:23:03,901 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,614,568 trades
2025-12-22 04:23:03,901 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,614,568 rows
2025-12-22 04:23:41,423 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,308,104 trades
2025-12-22 04:23:41,424 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,308,104 rows
2025-12-22 04:25:21,928 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,065,478 trades
2025-12-22 04:25:21,928 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,065,478 rows
2025-12-22 04:26:01,079 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,606,754 trades
2025-12-22 04:26:01,082 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,606,754 rows
2025-12-22 04:26:33,746 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,181,146 trades
2025-12-22 04:26:33,746 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,181,146 rows
2025-12-22 04:27:42,753 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,458,021 trades
2025-12-22 04:27:42,754 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,458,021 rows
2025-12-22 04:27:43,265 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 30,195,328 total rows written
2025-12-22 04:28:03,227 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,138,326 trades
2025-12-22 04:28:03,246 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,138,326 rows
2025-12-22 04:28:03,633 INFO [src.stage_a.parquet_writer] ✓ Wrote 31,333,654 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-11
2025-12-22 04:28:03,645 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 04:28:03,645 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 04:28:03,645 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 04:28:03,645 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 04:28:03,645 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 04:28:03,645 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 04:28:03,645 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 04:28:04,659 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 04:28:04,660 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-11...
2025-12-22 04:28:04,706 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240711 for 519 symbols
2025-12-22 04:28:56,462 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,861,775 NBBO records
2025-12-22 04:28:56,462 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,861,775 rows
2025-12-22 04:29:35,664 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,818,114 NBBO records
2025-12-22 04:29:35,665 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,818,114 rows
2025-12-22 04:30:23,500 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,677,838 NBBO records
2025-12-22 04:30:23,501 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,677,838 rows
2025-12-22 04:30:48,669 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,456,918 NBBO records
2025-12-22 04:30:48,670 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,456,918 rows
2025-12-22 04:31:30,471 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,996,601 NBBO records
2025-12-22 04:31:30,471 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,996,601 rows
2025-12-22 04:32:14,892 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,344,464 NBBO records
2025-12-22 04:32:14,892 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,344,464 rows
2025-12-22 04:33:16,350 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,169,306 NBBO records
2025-12-22 04:33:16,350 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,169,306 rows
2025-12-22 04:34:13,891 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,649,195 NBBO records
2025-12-22 04:34:13,892 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,649,195 rows
2025-12-22 04:34:53,940 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,162,330 NBBO records
2025-12-22 04:34:53,941 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,162,330 rows
2025-12-22 04:35:36,107 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,492,481 NBBO records
2025-12-22 04:35:36,107 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,492,481 rows
2025-12-22 04:35:36,444 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 43,629,022 total rows written
2025-12-22 04:36:35,419 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,017,168 NBBO records
2025-12-22 04:36:35,420 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,017,168 rows
2025-12-22 04:36:35,975 INFO [src.stage_a.parquet_writer] ✓ Wrote 49,646,190 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-11
2025-12-22 04:36:35,983 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 04:36:35,983 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 04:36:35,983 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 04:36:35,983 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 04:36:35,983 INFO [src.stage_a.stage_a] Trades: 31,333,654 rows
2025-12-22 04:36:35,983 INFO [src.stage_a.stage_a] Nbbo: 49,646,190 rows
2025-12-22 04:36:35,983 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 04:36:35,983 INFO [src.stage_a.stage_a] Processing date 21/140: 2024-07-12
2025-12-22 04:36:35,983 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 04:36:35,983 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 04:36:35,983 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-07-12 (519 symbols)
2025-12-22 04:36:35,983 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 04:36:35,983 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 04:36:35,983 INFO [src.stage_a.stage_a] Extract run ID: 046d1e56-6196-4e65-abba-e5495c3325d3
2025-12-22 04:36:35,991 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 04:36:35,991 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 04:36:35,991 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 04:36:35,991 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 04:36:35,991 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 04:36:35,991 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 04:36:35,991 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 04:36:35,991 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 04:36:35,991 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 04:36:37,002 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 04:36:37,002 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-12...
2025-12-22 04:36:37,051 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240712 for 519 symbols
2025-12-22 04:37:19,722 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,165,184 trades
2025-12-22 04:37:19,722 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,165,184 rows
2025-12-22 04:37:49,124 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,009,049 trades
2025-12-22 04:37:49,124 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,009,049 rows
2025-12-22 04:38:17,669 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,023,409 trades
2025-12-22 04:38:17,669 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,023,409 rows
2025-12-22 04:38:39,883 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,621,686 trades
2025-12-22 04:38:39,884 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,621,686 rows
2025-12-22 04:39:14,153 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,446,916 trades
2025-12-22 04:39:14,153 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,446,916 rows
2025-12-22 04:39:43,716 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,080,913 trades
2025-12-22 04:39:43,716 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,080,913 rows
2025-12-22 04:40:48,797 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,516,505 trades
2025-12-22 04:40:48,797 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,516,505 rows
2025-12-22 04:41:19,886 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,218,140 trades
2025-12-22 04:41:19,899 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,218,140 rows
2025-12-22 04:41:48,914 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,068,701 trades
2025-12-22 04:41:48,914 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,068,701 rows
2025-12-22 04:42:40,888 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,682,615 trades
2025-12-22 04:42:40,888 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,682,615 rows
2025-12-22 04:42:41,340 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,833,118 total rows written
2025-12-22 04:42:53,325 INFO [src.stage_a.wrds_extractor]   Chunk 11: 907,217 trades
2025-12-22 04:42:53,330 INFO [src.stage_a.parquet_writer]   Chunk 11: 907,217 rows
2025-12-22 04:42:53,618 INFO [src.stage_a.parquet_writer] ✓ Wrote 26,740,335 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-12
2025-12-22 04:42:53,619 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 04:42:53,619 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 04:42:53,619 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 04:42:53,619 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 04:42:53,619 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 04:42:53,619 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 04:42:53,619 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 04:42:54,636 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 04:42:54,636 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-12...
2025-12-22 04:42:54,683 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240712 for 519 symbols
2025-12-22 04:43:31,199 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,666,003 NBBO records
2025-12-22 04:43:31,199 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,666,003 rows
2025-12-22 04:43:55,017 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,360,787 NBBO records
2025-12-22 04:43:55,017 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,360,787 rows
2025-12-22 04:44:31,021 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,731,248 NBBO records
2025-12-22 04:44:31,021 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,731,248 rows
2025-12-22 04:44:50,189 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,973,698 NBBO records
2025-12-22 04:44:50,189 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,973,698 rows
2025-12-22 04:45:23,057 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,429,420 NBBO records
2025-12-22 04:45:23,057 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,429,420 rows
2025-12-22 04:45:56,094 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,484,801 NBBO records
2025-12-22 04:45:56,095 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,484,801 rows
2025-12-22 04:46:45,011 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,517,565 NBBO records
2025-12-22 04:46:45,011 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,517,565 rows
2025-12-22 04:47:26,724 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,391,848 NBBO records
2025-12-22 04:47:26,724 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,391,848 rows
2025-12-22 04:47:58,670 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,343,548 NBBO records
2025-12-22 04:47:58,670 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,343,548 rows
2025-12-22 04:48:31,648 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,397,553 NBBO records
2025-12-22 04:48:31,648 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,397,553 rows
2025-12-22 04:48:31,941 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 34,296,471 total rows written
2025-12-22 04:49:11,407 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,267,422 NBBO records
2025-12-22 04:49:11,407 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,267,422 rows
2025-12-22 04:49:11,842 INFO [src.stage_a.parquet_writer] ✓ Wrote 38,563,893 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-12
2025-12-22 04:49:11,848 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 04:49:11,848 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 04:49:11,848 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 04:49:11,848 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 04:49:11,848 INFO [src.stage_a.stage_a] Trades: 26,740,335 rows
2025-12-22 04:49:11,848 INFO [src.stage_a.stage_a] Nbbo: 38,563,893 rows
2025-12-22 04:49:11,848 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 04:49:11,848 INFO [src.stage_a.stage_a] Processing date 22/140: 2024-07-15
2025-12-22 04:49:11,848 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 04:49:11,848 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 04:49:11,848 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-07-15 (519 symbols)
2025-12-22 04:49:11,848 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 04:49:11,848 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 04:49:11,848 INFO [src.stage_a.stage_a] Extract run ID: fd54547b-47c8-45cb-a122-eb125f9d7d6f
2025-12-22 04:49:11,856 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 04:49:11,856 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 04:49:11,856 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 04:49:11,856 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 04:49:11,856 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 04:49:11,856 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 04:49:11,856 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 04:49:11,856 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 04:49:11,856 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 04:49:13,004 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 04:49:13,004 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-15...
2025-12-22 04:49:13,062 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240715 for 519 symbols
2025-12-22 04:50:00,877 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,431,826 trades
2025-12-22 04:50:00,877 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,431,826 rows
2025-12-22 04:50:29,422 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,964,583 trades
2025-12-22 04:50:29,423 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,964,583 rows
2025-12-22 04:50:59,166 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,096,326 trades
2025-12-22 04:50:59,166 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,096,326 rows
2025-12-22 04:51:23,319 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,706,930 trades
2025-12-22 04:51:23,319 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,706,930 rows
2025-12-22 04:51:58,325 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,276,304 trades
2025-12-22 04:51:58,325 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,276,304 rows
2025-12-22 04:52:28,186 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,013,864 trades
2025-12-22 04:52:28,186 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,013,864 rows
2025-12-22 04:53:33,215 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,451,522 trades
2025-12-22 04:53:33,215 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,451,522 rows
2025-12-22 04:54:05,545 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,215,824 trades
2025-12-22 04:54:05,546 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,215,824 rows
2025-12-22 04:54:38,917 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,304,106 trades
2025-12-22 04:54:38,918 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,304,106 rows
2025-12-22 04:55:30,886 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,549,157 trades
2025-12-22 04:55:30,886 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,549,157 rows
2025-12-22 04:55:31,329 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,010,442 total rows written
2025-12-22 04:55:44,980 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,026,482 trades
2025-12-22 04:55:44,983 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,026,482 rows
2025-12-22 04:55:45,333 INFO [src.stage_a.parquet_writer] ✓ Wrote 27,036,924 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-15
2025-12-22 04:55:45,334 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 04:55:45,334 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 04:55:45,334 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 04:55:45,334 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 04:55:45,334 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 04:55:45,334 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 04:55:45,334 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 04:55:46,362 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 04:55:46,362 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-15...
2025-12-22 04:55:46,410 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240715 for 519 symbols
2025-12-22 04:56:27,032 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,228,322 NBBO records
2025-12-22 04:56:27,032 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,228,322 rows
2025-12-22 04:56:51,160 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,420,793 NBBO records
2025-12-22 04:56:51,160 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,420,793 rows
2025-12-22 04:57:30,434 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,076,891 NBBO records
2025-12-22 04:57:30,435 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,076,891 rows
2025-12-22 04:57:52,007 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,203,743 NBBO records
2025-12-22 04:57:52,007 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,203,743 rows
2025-12-22 04:58:23,169 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,258,566 NBBO records
2025-12-22 04:58:23,169 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,258,566 rows
2025-12-22 04:58:58,444 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,589,992 NBBO records
2025-12-22 04:58:58,444 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,589,992 rows
2025-12-22 04:59:44,350 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,748,912 NBBO records
2025-12-22 04:59:44,350 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,748,912 rows
2025-12-22 05:00:31,596 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,873,778 NBBO records
2025-12-22 05:00:31,597 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,873,778 rows
2025-12-22 05:01:15,470 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,159,018 NBBO records
2025-12-22 05:01:15,471 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,159,018 rows
2025-12-22 05:01:50,156 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,500,946 NBBO records
2025-12-22 05:01:50,156 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,500,946 rows
2025-12-22 05:01:50,443 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 37,060,961 total rows written
2025-12-22 05:02:38,940 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,134,955 NBBO records
2025-12-22 05:02:38,940 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,134,955 rows
2025-12-22 05:02:39,433 INFO [src.stage_a.parquet_writer] ✓ Wrote 42,195,916 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-15
2025-12-22 05:02:39,436 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 05:02:39,436 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 05:02:39,436 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 05:02:39,436 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 05:02:39,436 INFO [src.stage_a.stage_a] Trades: 27,036,924 rows
2025-12-22 05:02:39,436 INFO [src.stage_a.stage_a] Nbbo: 42,195,916 rows
2025-12-22 05:02:39,436 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 05:02:39,436 INFO [src.stage_a.stage_a] Processing date 23/140: 2024-07-16
2025-12-22 05:02:39,436 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 05:02:39,436 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 05:02:39,436 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-07-16 (519 symbols)
2025-12-22 05:02:39,436 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 05:02:39,436 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 05:02:39,436 INFO [src.stage_a.stage_a] Extract run ID: b79e5b98-1a65-41cc-abbd-d68fec537a7c
2025-12-22 05:02:39,444 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 05:02:39,444 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 05:02:39,444 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 05:02:39,444 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 05:02:39,444 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 05:02:39,444 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 05:02:39,444 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 05:02:39,444 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 05:02:39,444 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 05:02:40,943 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 05:02:40,943 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-16...
2025-12-22 05:02:41,024 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240716 for 519 symbols
2025-12-22 05:03:27,892 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,183,267 trades
2025-12-22 05:03:27,892 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,183,267 rows
2025-12-22 05:04:02,230 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,252,854 trades
2025-12-22 05:04:02,230 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,252,854 rows
2025-12-22 05:04:33,995 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,195,859 trades
2025-12-22 05:04:33,995 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,195,859 rows
2025-12-22 05:04:58,858 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,706,377 trades
2025-12-22 05:04:58,858 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,706,377 rows
2025-12-22 05:05:33,805 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,411,755 trades
2025-12-22 05:05:33,806 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,411,755 rows
2025-12-22 05:06:06,728 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,279,609 trades
2025-12-22 05:06:06,728 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,279,609 rows
2025-12-22 05:07:15,174 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,624,642 trades
2025-12-22 05:07:15,174 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,624,642 rows
2025-12-22 05:07:47,228 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,184,837 trades
2025-12-22 05:07:47,232 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,184,837 rows
2025-12-22 05:08:22,449 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,373,480 trades
2025-12-22 05:08:22,482 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,373,480 rows
2025-12-22 05:09:13,121 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,509,920 trades
2025-12-22 05:09:13,121 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,509,920 rows
2025-12-22 05:09:13,555 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,722,600 total rows written
2025-12-22 05:09:27,093 INFO [src.stage_a.wrds_extractor]   Chunk 11: 973,967 trades
2025-12-22 05:09:27,099 INFO [src.stage_a.parquet_writer]   Chunk 11: 973,967 rows
2025-12-22 05:09:27,442 INFO [src.stage_a.parquet_writer] ✓ Wrote 27,696,567 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-16
2025-12-22 05:09:27,444 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 05:09:27,444 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 05:09:27,444 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 05:09:27,444 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 05:09:27,444 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 05:09:27,444 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 05:09:27,444 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 05:09:28,500 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 05:09:28,500 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-16...
2025-12-22 05:09:28,571 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240716 for 519 symbols
2025-12-22 05:10:06,634 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,880,114 NBBO records
2025-12-22 05:10:06,634 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,880,114 rows
2025-12-22 05:10:33,231 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,684,508 NBBO records
2025-12-22 05:10:33,231 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,684,508 rows
2025-12-22 05:11:10,992 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,977,005 NBBO records
2025-12-22 05:11:10,992 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,977,005 rows
2025-12-22 05:11:32,540 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,175,607 NBBO records
2025-12-22 05:11:32,540 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,175,607 rows
2025-12-22 05:12:03,271 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,177,695 NBBO records
2025-12-22 05:12:03,271 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,177,695 rows
2025-12-22 05:12:38,680 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,655,433 NBBO records
2025-12-22 05:12:38,680 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,655,433 rows
2025-12-22 05:13:25,952 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,942,018 NBBO records
2025-12-22 05:13:25,952 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,942,018 rows
2025-12-22 05:14:11,723 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,690,263 NBBO records
2025-12-22 05:14:11,724 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,690,263 rows
2025-12-22 05:14:51,461 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,084,485 NBBO records
2025-12-22 05:14:51,462 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,084,485 rows
2025-12-22 05:15:23,724 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,422,928 NBBO records
2025-12-22 05:15:23,724 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,422,928 rows
2025-12-22 05:15:24,021 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 36,690,056 total rows written
2025-12-22 05:16:12,398 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,168,396 NBBO records
2025-12-22 05:16:12,398 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,168,396 rows
2025-12-22 05:16:12,905 INFO [src.stage_a.parquet_writer] ✓ Wrote 41,858,452 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-16
2025-12-22 05:16:12,912 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 05:16:12,912 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 05:16:12,912 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 05:16:12,912 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 05:16:12,912 INFO [src.stage_a.stage_a] Trades: 27,696,567 rows
2025-12-22 05:16:12,912 INFO [src.stage_a.stage_a] Nbbo: 41,858,452 rows
2025-12-22 05:16:12,912 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 05:16:12,912 INFO [src.stage_a.stage_a] Processing date 24/140: 2024-07-17
2025-12-22 05:16:12,912 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 05:16:12,912 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 05:16:12,912 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-07-17 (519 symbols)
2025-12-22 05:16:12,912 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 05:16:12,912 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 05:16:12,912 INFO [src.stage_a.stage_a] Extract run ID: 19874bc0-73c6-4f22-85ec-a7e0723b2e7f
2025-12-22 05:16:12,920 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 05:16:12,920 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 05:16:12,920 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 05:16:12,920 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 05:16:12,920 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 05:16:12,920 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 05:16:12,920 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 05:16:12,920 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 05:16:12,920 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 05:16:14,129 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 05:16:14,130 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-17...
2025-12-22 05:16:14,188 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240717 for 519 symbols
2025-12-22 05:17:19,928 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,667,955 trades
2025-12-22 05:17:19,928 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,667,955 rows
2025-12-22 05:17:55,228 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,383,784 trades
2025-12-22 05:17:55,229 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,383,784 rows
2025-12-22 05:18:29,073 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,452,837 trades
2025-12-22 05:18:29,073 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,452,837 rows
2025-12-22 05:18:56,374 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,924,297 trades
2025-12-22 05:18:56,375 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,924,297 rows
2025-12-22 05:19:40,443 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,060,603 trades
2025-12-22 05:19:40,443 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,060,603 rows
2025-12-22 05:20:18,602 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,696,912 trades
2025-12-22 05:20:18,602 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,696,912 rows
2025-12-22 05:21:59,859 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,813,135 trades
2025-12-22 05:21:59,859 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,813,135 rows
2025-12-22 05:22:44,697 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,104,880 trades
2025-12-22 05:22:44,700 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,104,880 rows
2025-12-22 05:23:25,875 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,797,132 trades
2025-12-22 05:23:25,875 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,797,132 rows
2025-12-22 05:24:21,682 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,948,020 trades
2025-12-22 05:24:21,682 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,948,020 rows
2025-12-22 05:24:22,176 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 33,849,555 total rows written
2025-12-22 05:24:39,335 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,269,878 trades
2025-12-22 05:24:39,343 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,269,878 rows
2025-12-22 05:24:39,754 INFO [src.stage_a.parquet_writer] ✓ Wrote 35,119,433 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-17
2025-12-22 05:24:39,757 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 05:24:39,757 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 05:24:39,757 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 05:24:39,757 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 05:24:39,757 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 05:24:39,757 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 05:24:39,757 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 05:24:40,895 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 05:24:40,895 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-17...
2025-12-22 05:24:40,942 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240717 for 519 symbols
2025-12-22 05:25:29,003 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,930,090 NBBO records
2025-12-22 05:25:29,003 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,930,090 rows
2025-12-22 05:25:59,727 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,114,012 NBBO records
2025-12-22 05:25:59,727 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,114,012 rows
2025-12-22 05:26:48,748 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,152,206 NBBO records
2025-12-22 05:26:48,748 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,152,206 rows
2025-12-22 05:27:16,350 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,717,812 NBBO records
2025-12-22 05:27:16,351 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,717,812 rows
2025-12-22 05:27:58,571 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,381,655 NBBO records
2025-12-22 05:27:58,571 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,381,655 rows
2025-12-22 05:28:42,531 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,631,947 NBBO records
2025-12-22 05:28:42,532 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,631,947 rows
2025-12-22 05:29:50,400 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,897,294 NBBO records
2025-12-22 05:29:50,401 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,897,294 rows
2025-12-22 05:30:51,361 INFO [src.stage_a.wrds_extractor]   Chunk 8: 6,188,156 NBBO records
2025-12-22 05:30:51,362 INFO [src.stage_a.parquet_writer]   Chunk 8: 6,188,156 rows
2025-12-22 05:31:37,191 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,600,816 NBBO records
2025-12-22 05:31:37,192 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,600,816 rows
2025-12-22 05:32:18,855 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,195,713 NBBO records
2025-12-22 05:32:18,855 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,195,713 rows
2025-12-22 05:32:19,201 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 46,809,701 total rows written
2025-12-22 05:33:23,850 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,872,389 NBBO records
2025-12-22 05:33:23,850 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,872,389 rows
2025-12-22 05:33:24,486 INFO [src.stage_a.parquet_writer] ✓ Wrote 53,682,090 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-17
2025-12-22 05:33:24,493 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 05:33:24,493 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 05:33:24,493 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 05:33:24,493 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 05:33:24,493 INFO [src.stage_a.stage_a] Trades: 35,119,433 rows
2025-12-22 05:33:24,493 INFO [src.stage_a.stage_a] Nbbo: 53,682,090 rows
2025-12-22 05:33:24,493 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 05:33:24,493 INFO [src.stage_a.stage_a] Processing date 25/140: 2024-07-18
2025-12-22 05:33:24,493 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 05:33:24,493 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 05:33:24,493 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-07-18 (519 symbols)
2025-12-22 05:33:24,493 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 05:33:24,493 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 05:33:24,493 INFO [src.stage_a.stage_a] Extract run ID: c72ced4e-afac-4324-94d8-252414cdf7b8
2025-12-22 05:33:24,501 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 05:33:24,501 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 05:33:24,501 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 05:33:24,501 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 05:33:24,501 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 05:33:24,501 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 05:33:24,501 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 05:33:24,501 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 05:33:24,501 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 05:33:25,694 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 05:33:25,694 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-18...
2025-12-22 05:33:25,777 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240718 for 519 symbols
2025-12-22 05:34:30,596 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,408,181 trades
2025-12-22 05:34:30,596 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,408,181 rows
2025-12-22 05:35:05,300 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,274,301 trades
2025-12-22 05:35:05,304 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,274,301 rows
2025-12-22 05:35:42,553 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,514,887 trades
2025-12-22 05:35:42,554 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,514,887 rows
2025-12-22 05:36:11,266 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,955,784 trades
2025-12-22 05:36:11,266 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,955,784 rows
2025-12-22 05:36:55,445 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,936,277 trades
2025-12-22 05:36:55,445 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,936,277 rows
2025-12-22 05:37:36,706 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,754,080 trades
2025-12-22 05:37:36,706 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,754,080 rows
2025-12-22 05:40:00,008 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,470,533 trades
2025-12-22 05:40:00,009 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,470,533 rows
2025-12-22 05:41:44,402 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,753,276 trades
2025-12-22 05:41:44,405 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,753,276 rows
2025-12-22 05:43:19,480 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,584,899 trades
2025-12-22 05:43:19,480 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,584,899 rows
2025-12-22 05:45:32,599 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,652,314 trades
2025-12-22 05:45:32,601 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,652,314 rows
2025-12-22 05:45:33,050 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 31,304,532 total rows written
2025-12-22 05:46:15,366 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,194,969 trades
2025-12-22 05:46:15,381 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,194,969 rows
2025-12-22 05:46:15,755 INFO [src.stage_a.parquet_writer] ✓ Wrote 32,499,501 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-18
2025-12-22 05:46:15,755 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 05:46:15,755 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 05:46:15,755 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 05:46:15,755 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 05:46:15,755 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 05:46:15,755 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 05:46:15,755 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 05:46:17,054 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 05:46:17,054 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-18...
2025-12-22 05:46:17,127 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240718 for 519 symbols
2025-12-22 05:48:20,326 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,345,301 NBBO records
2025-12-22 05:48:20,326 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,345,301 rows
2025-12-22 05:49:16,879 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,189,152 NBBO records
2025-12-22 05:49:16,880 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,189,152 rows
2025-12-22 05:50:13,815 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,567,006 NBBO records
2025-12-22 05:50:13,815 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,567,006 rows
2025-12-22 05:50:46,968 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,849,586 NBBO records
2025-12-22 05:50:46,968 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,849,586 rows
2025-12-22 05:51:36,305 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,587,015 NBBO records
2025-12-22 05:51:36,305 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,587,015 rows
2025-12-22 05:52:28,720 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,929,058 NBBO records
2025-12-22 05:52:28,720 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,929,058 rows
2025-12-22 05:53:35,454 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,390,297 NBBO records
2025-12-22 05:53:35,455 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,390,297 rows
2025-12-22 05:54:46,252 INFO [src.stage_a.wrds_extractor]   Chunk 8: 6,881,945 NBBO records
2025-12-22 05:54:46,254 INFO [src.stage_a.parquet_writer]   Chunk 8: 6,881,945 rows
2025-12-22 05:55:39,040 INFO [src.stage_a.wrds_extractor]   Chunk 9: 5,247,884 NBBO records
2025-12-22 05:55:39,041 INFO [src.stage_a.parquet_writer]   Chunk 9: 5,247,884 rows
2025-12-22 05:56:25,810 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,521,274 NBBO records
2025-12-22 05:56:25,810 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,521,274 rows
2025-12-22 05:56:26,158 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 49,508,518 total rows written
2025-12-22 05:57:34,877 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,998,117 NBBO records
2025-12-22 05:57:34,877 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,998,117 rows
2025-12-22 05:57:35,501 INFO [src.stage_a.parquet_writer] ✓ Wrote 56,506,635 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-18
2025-12-22 05:57:35,510 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 05:57:35,510 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 05:57:35,510 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 05:57:35,510 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 05:57:35,510 INFO [src.stage_a.stage_a] Trades: 32,499,501 rows
2025-12-22 05:57:35,510 INFO [src.stage_a.stage_a] Nbbo: 56,506,635 rows
2025-12-22 05:57:35,510 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 05:57:35,510 INFO [src.stage_a.stage_a] Processing date 26/140: 2024-07-19
2025-12-22 05:57:35,510 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 05:57:35,510 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 05:57:35,510 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-07-19 (519 symbols)
2025-12-22 05:57:35,510 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 05:57:35,510 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 05:57:35,510 INFO [src.stage_a.stage_a] Extract run ID: ebed9759-e608-488b-9226-57b8a187cc1f
2025-12-22 05:57:35,518 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 05:57:35,518 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 05:57:35,518 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 05:57:35,518 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 05:57:35,518 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 05:57:35,518 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 05:57:35,518 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 05:57:35,518 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 05:57:35,518 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 05:57:36,725 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 05:57:36,725 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-19...
2025-12-22 05:57:36,800 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240719 for 519 symbols
2025-12-22 05:58:26,849 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,313,217 trades
2025-12-22 05:58:26,849 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,313,217 rows
2025-12-22 05:58:54,776 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,840,814 trades
2025-12-22 05:58:54,777 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,840,814 rows
2025-12-22 05:59:22,295 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,890,903 trades
2025-12-22 05:59:22,295 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,890,903 rows
2025-12-22 05:59:47,102 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,705,883 trades
2025-12-22 05:59:47,102 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,705,883 rows
2025-12-22 06:00:22,319 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,446,957 trades
2025-12-22 06:00:22,319 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,446,957 rows
2025-12-22 06:00:51,903 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,059,729 trades
2025-12-22 06:00:51,904 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,059,729 rows
2025-12-22 06:02:01,824 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,242,327 trades
2025-12-22 06:02:01,824 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,242,327 rows
2025-12-22 06:02:38,331 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,311,743 trades
2025-12-22 06:02:38,337 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,311,743 rows
2025-12-22 06:03:14,400 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,370,076 trades
2025-12-22 06:03:14,403 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,370,076 rows
2025-12-22 06:04:03,891 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,103,291 trades
2025-12-22 06:04:03,892 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,103,291 rows
2025-12-22 06:04:04,308 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,284,940 total rows written
2025-12-22 06:04:18,084 INFO [src.stage_a.wrds_extractor]   Chunk 11: 981,278 trades
2025-12-22 06:04:18,084 INFO [src.stage_a.parquet_writer]   Chunk 11: 981,278 rows
2025-12-22 06:04:18,367 INFO [src.stage_a.parquet_writer] ✓ Wrote 26,266,218 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-19
2025-12-22 06:04:18,368 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 06:04:18,368 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 06:04:18,368 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 06:04:18,368 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 06:04:18,368 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 06:04:18,368 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 06:04:18,369 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 06:04:19,752 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 06:04:19,752 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-19...
2025-12-22 06:04:19,822 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240719 for 519 symbols
2025-12-22 06:05:05,859 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,534,985 NBBO records
2025-12-22 06:05:05,859 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,534,985 rows
2025-12-22 06:05:33,745 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,734,686 NBBO records
2025-12-22 06:05:33,746 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,734,686 rows
2025-12-22 06:06:26,175 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,282,171 NBBO records
2025-12-22 06:06:26,175 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,282,171 rows
2025-12-22 06:06:50,627 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,471,597 NBBO records
2025-12-22 06:06:50,627 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,471,597 rows
2025-12-22 06:07:32,480 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,757,482 NBBO records
2025-12-22 06:07:32,480 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,757,482 rows
2025-12-22 06:08:17,022 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,195,852 NBBO records
2025-12-22 06:08:17,022 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,195,852 rows
2025-12-22 06:09:08,452 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,357,290 NBBO records
2025-12-22 06:09:08,453 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,357,290 rows
2025-12-22 06:10:04,241 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,328,684 NBBO records
2025-12-22 06:10:04,242 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,328,684 rows
2025-12-22 06:11:00,438 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,501,972 NBBO records
2025-12-22 06:11:00,439 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,501,972 rows
2025-12-22 06:11:36,045 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,603,463 NBBO records
2025-12-22 06:11:36,046 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,603,463 rows
2025-12-22 06:11:36,358 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 40,768,182 total rows written
2025-12-22 06:12:39,457 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,106,965 NBBO records
2025-12-22 06:12:39,457 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,106,965 rows
2025-12-22 06:12:39,988 INFO [src.stage_a.parquet_writer] ✓ Wrote 46,875,147 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-19
2025-12-22 06:12:39,996 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 06:12:39,996 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 06:12:39,996 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 06:12:39,996 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 06:12:39,996 INFO [src.stage_a.stage_a] Trades: 26,266,218 rows
2025-12-22 06:12:39,996 INFO [src.stage_a.stage_a] Nbbo: 46,875,147 rows
2025-12-22 06:12:39,996 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 06:12:39,996 INFO [src.stage_a.stage_a] Processing date 27/140: 2024-07-22
2025-12-22 06:12:39,996 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 06:12:39,996 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 06:12:39,996 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-07-22 (519 symbols)
2025-12-22 06:12:39,996 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 06:12:39,996 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 06:12:39,996 INFO [src.stage_a.stage_a] Extract run ID: 547997d6-b6ac-457f-ae92-4a7fbdab0ace
2025-12-22 06:12:40,004 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 06:12:40,004 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 06:12:40,004 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 06:12:40,004 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 06:12:40,004 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 06:12:40,004 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 06:12:40,004 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 06:12:40,004 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 06:12:40,004 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 06:12:41,266 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 06:12:41,266 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-22...
2025-12-22 06:12:41,327 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240722 for 519 symbols
2025-12-22 06:13:27,934 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,254,928 trades
2025-12-22 06:13:27,934 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,254,928 rows
2025-12-22 06:13:55,036 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,766,786 trades
2025-12-22 06:13:55,036 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,766,786 rows
2025-12-22 06:14:33,626 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,042,057 trades
2025-12-22 06:14:33,627 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,042,057 rows
2025-12-22 06:14:58,839 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,490,896 trades
2025-12-22 06:14:58,839 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,490,896 rows
2025-12-22 06:15:33,941 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,321,682 trades
2025-12-22 06:15:33,941 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,321,682 rows
2025-12-22 06:16:08,968 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,024,847 trades
2025-12-22 06:16:08,968 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,024,847 rows
2025-12-22 06:17:15,180 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,235,987 trades
2025-12-22 06:17:15,180 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,235,987 rows
2025-12-22 06:17:47,657 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,200,626 trades
2025-12-22 06:17:47,669 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,200,626 rows
2025-12-22 06:18:20,993 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,266,105 trades
2025-12-22 06:18:20,993 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,266,105 rows
2025-12-22 06:19:09,108 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,212,448 trades
2025-12-22 06:19:09,113 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,212,448 rows
2025-12-22 06:19:09,542 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 24,816,362 total rows written
2025-12-22 06:19:21,566 INFO [src.stage_a.wrds_extractor]   Chunk 11: 860,419 trades
2025-12-22 06:19:21,569 INFO [src.stage_a.parquet_writer]   Chunk 11: 860,419 rows
2025-12-22 06:19:21,868 INFO [src.stage_a.parquet_writer] ✓ Wrote 25,676,781 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-22
2025-12-22 06:19:21,869 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 06:19:21,869 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 06:19:21,869 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 06:19:21,869 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 06:19:21,869 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 06:19:21,869 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 06:19:21,869 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 06:19:22,903 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 06:19:22,903 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-22...
2025-12-22 06:19:22,948 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240722 for 519 symbols
2025-12-22 06:20:03,369 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,808,995 NBBO records
2025-12-22 06:20:03,369 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,808,995 rows
2025-12-22 06:20:32,025 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,560,795 NBBO records
2025-12-22 06:20:32,025 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,560,795 rows
2025-12-22 06:21:12,747 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,444,422 NBBO records
2025-12-22 06:21:12,747 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,444,422 rows
2025-12-22 06:21:37,568 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,185,395 NBBO records
2025-12-22 06:21:37,568 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,185,395 rows
2025-12-22 06:22:16,556 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,732,904 NBBO records
2025-12-22 06:22:16,556 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,732,904 rows
2025-12-22 06:22:55,773 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,754,593 NBBO records
2025-12-22 06:22:55,773 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,754,593 rows
2025-12-22 06:23:38,680 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,591,714 NBBO records
2025-12-22 06:23:38,680 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,591,714 rows
2025-12-22 06:24:22,907 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,651,085 NBBO records
2025-12-22 06:24:22,908 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,651,085 rows
2025-12-22 06:25:01,148 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,136,009 NBBO records
2025-12-22 06:25:01,149 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,136,009 rows
2025-12-22 06:25:31,948 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,411,308 NBBO records
2025-12-22 06:25:31,949 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,411,308 rows
2025-12-22 06:25:32,259 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 37,277,220 total rows written
2025-12-22 06:26:26,643 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,910,665 NBBO records
2025-12-22 06:26:26,643 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,910,665 rows
2025-12-22 06:26:27,181 INFO [src.stage_a.parquet_writer] ✓ Wrote 43,187,885 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-22
2025-12-22 06:26:27,188 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 06:26:27,188 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 06:26:27,188 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 06:26:27,188 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 06:26:27,188 INFO [src.stage_a.stage_a] Trades: 25,676,781 rows
2025-12-22 06:26:27,188 INFO [src.stage_a.stage_a] Nbbo: 43,187,885 rows
2025-12-22 06:26:27,188 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 06:26:27,188 INFO [src.stage_a.stage_a] Processing date 28/140: 2024-07-23
2025-12-22 06:26:27,188 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 06:26:27,188 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 06:26:27,188 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-07-23 (519 symbols)
2025-12-22 06:26:27,188 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 06:26:27,188 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 06:26:27,188 INFO [src.stage_a.stage_a] Extract run ID: 69d47bf2-64d2-4839-bc14-4aa39fab8001
2025-12-22 06:26:27,196 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 06:26:27,196 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 06:26:27,196 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 06:26:27,196 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 06:26:27,196 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 06:26:27,196 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 06:26:27,196 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 06:26:27,196 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 06:26:27,196 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 06:26:28,318 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 06:26:28,319 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-23...
2025-12-22 06:26:28,383 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240723 for 519 symbols
2025-12-22 06:27:08,181 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,896,907 trades
2025-12-22 06:27:08,182 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,896,907 rows
2025-12-22 06:27:35,088 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,854,293 trades
2025-12-22 06:27:35,088 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,854,293 rows
2025-12-22 06:28:09,218 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,144,322 trades
2025-12-22 06:28:09,218 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,144,322 rows
2025-12-22 06:28:32,832 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,641,159 trades
2025-12-22 06:28:32,832 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,641,159 rows
2025-12-22 06:29:09,852 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,595,852 trades
2025-12-22 06:29:09,853 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,595,852 rows
2025-12-22 06:29:38,714 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,036,985 trades
2025-12-22 06:29:38,714 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,036,985 rows
2025-12-22 06:30:28,394 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,509,034 trades
2025-12-22 06:30:28,394 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,509,034 rows
2025-12-22 06:31:00,316 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,192,145 trades
2025-12-22 06:31:00,320 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,192,145 rows
2025-12-22 06:31:29,633 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,004,596 trades
2025-12-22 06:31:29,633 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,004,596 rows
2025-12-22 06:32:11,836 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,093,682 trades
2025-12-22 06:32:11,837 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,093,682 rows
2025-12-22 06:32:12,236 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,968,975 total rows written
2025-12-22 06:32:23,232 INFO [src.stage_a.wrds_extractor]   Chunk 11: 816,836 trades
2025-12-22 06:32:23,234 INFO [src.stage_a.parquet_writer]   Chunk 11: 816,836 rows
2025-12-22 06:32:23,511 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,785,811 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-23
2025-12-22 06:32:23,512 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 06:32:23,512 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 06:32:23,512 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 06:32:23,512 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 06:32:23,512 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 06:32:23,512 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 06:32:23,512 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 06:32:24,573 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 06:32:24,573 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-23...
2025-12-22 06:32:24,632 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240723 for 519 symbols
2025-12-22 06:32:54,659 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,347,269 NBBO records
2025-12-22 06:32:54,659 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,347,269 rows
2025-12-22 06:33:16,539 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,363,237 NBBO records
2025-12-22 06:33:16,539 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,363,237 rows
2025-12-22 06:33:48,905 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,745,121 NBBO records
2025-12-22 06:33:48,905 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,745,121 rows
2025-12-22 06:34:08,152 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,124,260 NBBO records
2025-12-22 06:34:08,152 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,124,260 rows
2025-12-22 06:34:38,424 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,368,197 NBBO records
2025-12-22 06:34:38,424 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,368,197 rows
2025-12-22 06:35:12,087 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,662,436 NBBO records
2025-12-22 06:35:12,087 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,662,436 rows
2025-12-22 06:35:50,079 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,112,846 NBBO records
2025-12-22 06:35:50,079 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,112,846 rows
2025-12-22 06:36:29,635 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,332,130 NBBO records
2025-12-22 06:36:29,635 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,332,130 rows
2025-12-22 06:37:02,140 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,516,509 NBBO records
2025-12-22 06:37:02,141 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,516,509 rows
2025-12-22 06:37:31,043 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,063,499 NBBO records
2025-12-22 06:37:31,044 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,063,499 rows
2025-12-22 06:37:31,322 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 33,635,504 total rows written
2025-12-22 06:38:18,880 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,156,910 NBBO records
2025-12-22 06:38:18,880 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,156,910 rows
2025-12-22 06:38:19,381 INFO [src.stage_a.parquet_writer] ✓ Wrote 38,792,414 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-23
2025-12-22 06:38:19,387 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 06:38:19,387 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 06:38:19,387 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 06:38:19,387 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 06:38:19,387 INFO [src.stage_a.stage_a] Trades: 24,785,811 rows
2025-12-22 06:38:19,387 INFO [src.stage_a.stage_a] Nbbo: 38,792,414 rows
2025-12-22 06:38:19,387 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 06:38:19,387 INFO [src.stage_a.stage_a] Processing date 29/140: 2024-07-24
2025-12-22 06:38:19,387 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 06:38:19,387 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 06:38:19,387 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-07-24 (519 symbols)
2025-12-22 06:38:19,387 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 06:38:19,387 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 06:38:19,387 INFO [src.stage_a.stage_a] Extract run ID: 7b72ee51-1351-47c4-b52b-d9b44c06688f
2025-12-22 06:38:19,395 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 06:38:19,395 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 06:38:19,395 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 06:38:19,395 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 06:38:19,395 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 06:38:19,395 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 06:38:19,395 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 06:38:19,395 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 06:38:19,395 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 06:38:20,518 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 06:38:20,518 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-24...
2025-12-22 06:38:20,577 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240724 for 519 symbols
2025-12-22 06:39:15,570 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,951,231 trades
2025-12-22 06:39:15,570 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,951,231 rows
2025-12-22 06:39:47,207 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,135,626 trades
2025-12-22 06:39:47,212 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,135,626 rows
2025-12-22 06:40:21,054 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,380,571 trades
2025-12-22 06:40:21,054 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,380,571 rows
2025-12-22 06:40:47,922 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,912,719 trades
2025-12-22 06:40:47,923 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,912,719 rows
2025-12-22 06:41:37,774 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,410,643 trades
2025-12-22 06:41:37,774 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,410,643 rows
2025-12-22 06:42:15,930 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,573,133 trades
2025-12-22 06:42:15,931 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,573,133 rows
2025-12-22 06:43:40,719 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,675,850 trades
2025-12-22 06:43:40,719 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,675,850 rows
2025-12-22 06:44:20,556 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,747,292 trades
2025-12-22 06:44:20,567 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,747,292 rows
2025-12-22 06:44:59,896 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,744,911 trades
2025-12-22 06:44:59,913 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,744,911 rows
2025-12-22 06:46:07,096 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,331,715 trades
2025-12-22 06:46:07,096 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,331,715 rows
2025-12-22 06:46:07,639 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 31,863,691 total rows written
2025-12-22 06:46:22,595 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,092,723 trades
2025-12-22 06:46:22,617 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,092,723 rows
2025-12-22 06:46:23,018 INFO [src.stage_a.parquet_writer] ✓ Wrote 32,956,414 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-24
2025-12-22 06:46:23,018 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 06:46:23,018 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 06:46:23,018 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 06:46:23,018 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 06:46:23,018 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 06:46:23,018 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 06:46:23,018 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 06:46:24,157 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 06:46:24,157 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-24...
2025-12-22 06:46:24,205 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240724 for 519 symbols
2025-12-22 06:47:07,320 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,183,337 NBBO records
2025-12-22 06:47:07,320 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,183,337 rows
2025-12-22 06:47:36,573 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,890,354 NBBO records
2025-12-22 06:47:36,573 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,890,354 rows
2025-12-22 06:48:20,403 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,329,489 NBBO records
2025-12-22 06:48:20,403 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,329,489 rows
2025-12-22 06:48:46,191 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,510,118 NBBO records
2025-12-22 06:48:46,192 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,510,118 rows
2025-12-22 06:49:25,500 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,894,667 NBBO records
2025-12-22 06:49:25,500 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,894,667 rows
2025-12-22 06:50:10,009 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,476,385 NBBO records
2025-12-22 06:50:10,009 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,476,385 rows
2025-12-22 06:51:11,649 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,752,706 NBBO records
2025-12-22 06:51:11,650 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,752,706 rows
2025-12-22 06:51:58,713 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,721,628 NBBO records
2025-12-22 06:51:58,714 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,721,628 rows
2025-12-22 06:52:45,798 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,361,026 NBBO records
2025-12-22 06:52:45,798 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,361,026 rows
2025-12-22 06:53:20,359 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,452,633 NBBO records
2025-12-22 06:53:20,359 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,452,633 rows
2025-12-22 06:53:20,648 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 40,572,343 total rows written
2025-12-22 06:54:21,139 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,104,359 NBBO records
2025-12-22 06:54:21,140 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,104,359 rows
2025-12-22 06:54:21,692 INFO [src.stage_a.parquet_writer] ✓ Wrote 46,676,702 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-24
2025-12-22 06:54:21,696 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 06:54:21,696 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 06:54:21,696 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 06:54:21,696 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 06:54:21,696 INFO [src.stage_a.stage_a] Trades: 32,956,414 rows
2025-12-22 06:54:21,696 INFO [src.stage_a.stage_a] Nbbo: 46,676,702 rows
2025-12-22 06:54:21,696 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 06:54:21,696 INFO [src.stage_a.stage_a] Processing date 30/140: 2024-07-25
2025-12-22 06:54:21,696 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 06:54:21,696 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 06:54:21,696 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-07-25 (519 symbols)
2025-12-22 06:54:21,696 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 06:54:21,696 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 06:54:21,697 INFO [src.stage_a.stage_a] Extract run ID: 0d94ff89-51ee-45a2-9b2d-d0aeb273edd1
2025-12-22 06:54:21,705 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 06:54:21,705 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 06:54:21,705 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 06:54:21,705 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 06:54:21,705 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 06:54:21,705 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 06:54:21,705 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 06:54:21,705 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 06:54:21,705 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 06:54:22,804 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 06:54:22,804 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-25...
2025-12-22 06:54:22,886 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240725 for 519 symbols
2025-12-22 06:55:27,260 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,352,964 trades
2025-12-22 06:55:27,260 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,352,964 rows
2025-12-22 06:56:07,559 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,318,692 trades
2025-12-22 06:56:07,562 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,318,692 rows
2025-12-22 06:56:47,522 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,584,912 trades
2025-12-22 06:56:47,522 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,584,912 rows
2025-12-22 06:57:27,126 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,442,672 trades
2025-12-22 06:57:27,126 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,442,672 rows
2025-12-22 06:58:24,882 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,573,216 trades
2025-12-22 06:58:24,882 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,573,216 rows
2025-12-22 06:59:10,175 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,966,037 trades
2025-12-22 06:59:10,177 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,966,037 rows
2025-12-22 07:01:04,996 INFO [src.stage_a.wrds_extractor]   Chunk 7: 7,146,311 trades
2025-12-22 07:01:04,997 INFO [src.stage_a.parquet_writer]   Chunk 7: 7,146,311 rows
2025-12-22 07:01:50,069 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,001,334 trades
2025-12-22 07:01:50,081 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,001,334 rows
2025-12-22 07:02:39,387 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,881,015 trades
2025-12-22 07:02:39,462 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,881,015 rows
2025-12-22 07:03:45,461 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,872,787 trades
2025-12-22 07:03:45,461 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,872,787 rows
2025-12-22 07:03:45,969 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 35,139,940 total rows written
2025-12-22 07:04:04,678 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,340,657 trades
2025-12-22 07:04:04,686 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,340,657 rows
2025-12-22 07:04:05,123 INFO [src.stage_a.parquet_writer] ✓ Wrote 36,480,597 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-25
2025-12-22 07:04:05,127 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 07:04:05,128 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 07:04:05,128 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 07:04:05,128 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 07:04:05,128 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 07:04:05,128 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 07:04:05,128 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 07:04:06,537 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 07:04:06,537 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-25...
2025-12-22 07:04:06,613 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240725 for 519 symbols
2025-12-22 07:05:05,655 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,547,369 NBBO records
2025-12-22 07:05:05,655 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,547,369 rows
2025-12-22 07:05:39,306 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,247,381 NBBO records
2025-12-22 07:05:39,307 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,247,381 rows
2025-12-22 07:06:34,170 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,403,694 NBBO records
2025-12-22 07:06:34,170 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,403,694 rows
2025-12-22 07:07:05,366 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,023,986 NBBO records
2025-12-22 07:07:05,368 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,023,986 rows
2025-12-22 07:07:56,962 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,165,702 NBBO records
2025-12-22 07:07:56,963 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,165,702 rows
2025-12-22 07:08:57,478 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,543,019 NBBO records
2025-12-22 07:08:57,479 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,543,019 rows
2025-12-22 07:10:09,526 INFO [src.stage_a.wrds_extractor]   Chunk 7: 7,239,352 NBBO records
2025-12-22 07:10:09,527 INFO [src.stage_a.parquet_writer]   Chunk 7: 7,239,352 rows
2025-12-22 07:11:14,550 INFO [src.stage_a.wrds_extractor]   Chunk 8: 6,535,846 NBBO records
2025-12-22 07:11:14,551 INFO [src.stage_a.parquet_writer]   Chunk 8: 6,535,846 rows
2025-12-22 07:12:12,316 INFO [src.stage_a.wrds_extractor]   Chunk 9: 5,703,027 NBBO records
2025-12-22 07:12:12,318 INFO [src.stage_a.parquet_writer]   Chunk 9: 5,703,027 rows
2025-12-22 07:12:55,742 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,494,847 NBBO records
2025-12-22 07:12:55,743 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,494,847 rows
2025-12-22 07:12:56,089 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 51,904,223 total rows written
2025-12-22 07:14:26,823 INFO [src.stage_a.wrds_extractor]   Chunk 11: 9,075,757 NBBO records
2025-12-22 07:14:26,823 INFO [src.stage_a.parquet_writer]   Chunk 11: 9,075,757 rows
2025-12-22 07:14:27,597 INFO [src.stage_a.parquet_writer] ✓ Wrote 60,979,980 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-25
2025-12-22 07:14:27,629 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 07:14:27,629 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 07:14:27,629 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 07:14:27,629 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 07:14:27,629 INFO [src.stage_a.stage_a] Trades: 36,480,597 rows
2025-12-22 07:14:27,629 INFO [src.stage_a.stage_a] Nbbo: 60,979,980 rows
2025-12-22 07:14:27,629 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 07:14:27,629 INFO [src.stage_a.stage_a] Processing date 31/140: 2024-07-26
2025-12-22 07:14:27,629 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 07:14:27,629 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 07:14:27,629 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-07-26 (519 symbols)
2025-12-22 07:14:27,629 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 07:14:27,629 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 07:14:27,629 INFO [src.stage_a.stage_a] Extract run ID: a5e3dd94-4a8a-4194-b08e-e0938f4dee5c
2025-12-22 07:14:27,637 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 07:14:27,637 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 07:14:27,637 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 07:14:27,637 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 07:14:27,637 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 07:14:27,637 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 07:14:27,637 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 07:14:27,637 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 07:14:27,637 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 07:14:28,754 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 07:14:28,754 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-26...
2025-12-22 07:14:28,848 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240726 for 519 symbols
2025-12-22 07:15:13,823 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,175,075 trades
2025-12-22 07:15:13,823 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,175,075 rows
2025-12-22 07:15:45,074 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,122,904 trades
2025-12-22 07:15:45,074 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,122,904 rows
2025-12-22 07:16:15,884 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,153,924 trades
2025-12-22 07:16:15,884 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,153,924 rows
2025-12-22 07:16:45,050 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,034,861 trades
2025-12-22 07:16:45,051 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,034,861 rows
2025-12-22 07:17:27,709 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,874,233 trades
2025-12-22 07:17:27,709 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,874,233 rows
2025-12-22 07:18:02,097 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,307,073 trades
2025-12-22 07:18:02,097 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,307,073 rows
2025-12-22 07:19:14,328 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,657,318 trades
2025-12-22 07:19:14,328 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,657,318 rows
2025-12-22 07:19:48,496 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,320,775 trades
2025-12-22 07:19:48,500 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,320,775 rows
2025-12-22 07:20:21,620 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,209,006 trades
2025-12-22 07:20:21,639 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,209,006 rows
2025-12-22 07:21:05,138 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,066,974 trades
2025-12-22 07:21:05,138 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,066,974 rows
2025-12-22 07:21:05,583 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,922,143 total rows written
2025-12-22 07:21:19,606 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,033,638 trades
2025-12-22 07:21:19,606 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,033,638 rows
2025-12-22 07:21:19,942 INFO [src.stage_a.parquet_writer] ✓ Wrote 27,955,781 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-26
2025-12-22 07:21:19,943 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 07:21:19,943 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 07:21:19,943 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 07:21:19,943 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 07:21:19,943 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 07:21:19,943 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 07:21:19,943 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 07:21:21,021 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 07:21:21,021 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-26...
2025-12-22 07:21:21,076 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240726 for 519 symbols
2025-12-22 07:22:04,917 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,260,795 NBBO records
2025-12-22 07:22:04,918 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,260,795 rows
2025-12-22 07:22:32,526 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,741,481 NBBO records
2025-12-22 07:22:32,527 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,741,481 rows
2025-12-22 07:23:16,934 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,528,598 NBBO records
2025-12-22 07:23:16,934 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,528,598 rows
2025-12-22 07:23:41,946 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,498,488 NBBO records
2025-12-22 07:23:41,946 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,498,488 rows
2025-12-22 07:24:25,123 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,360,335 NBBO records
2025-12-22 07:24:25,123 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,360,335 rows
2025-12-22 07:25:09,224 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,495,771 NBBO records
2025-12-22 07:25:09,225 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,495,771 rows
2025-12-22 07:26:06,358 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,825,871 NBBO records
2025-12-22 07:26:06,359 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,825,871 rows
2025-12-22 07:27:01,727 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,700,301 NBBO records
2025-12-22 07:27:01,728 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,700,301 rows
2025-12-22 07:28:03,766 INFO [src.stage_a.wrds_extractor]   Chunk 9: 5,053,084 NBBO records
2025-12-22 07:28:03,767 INFO [src.stage_a.parquet_writer]   Chunk 9: 5,053,084 rows
2025-12-22 07:28:42,064 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,432,366 NBBO records
2025-12-22 07:28:42,064 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,432,366 rows
2025-12-22 07:28:42,365 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 42,897,090 total rows written
2025-12-22 07:30:03,927 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,987,434 NBBO records
2025-12-22 07:30:03,927 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,987,434 rows
2025-12-22 07:30:04,516 INFO [src.stage_a.parquet_writer] ✓ Wrote 49,884,524 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-26
2025-12-22 07:30:04,522 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 07:30:04,522 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 07:30:04,522 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 07:30:04,522 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 07:30:04,522 INFO [src.stage_a.stage_a] Trades: 27,955,781 rows
2025-12-22 07:30:04,522 INFO [src.stage_a.stage_a] Nbbo: 49,884,524 rows
2025-12-22 07:30:04,522 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 07:30:04,522 INFO [src.stage_a.stage_a] Processing date 32/140: 2024-07-29
2025-12-22 07:30:04,522 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 07:30:04,522 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 07:30:04,522 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-07-29 (519 symbols)
2025-12-22 07:30:04,522 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 07:30:04,522 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 07:30:04,522 INFO [src.stage_a.stage_a] Extract run ID: ebab57bc-fa01-4ca6-94b1-a45538d6d085
2025-12-22 07:30:04,530 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 07:30:04,530 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 07:30:04,530 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 07:30:04,530 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 07:30:04,530 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 07:30:04,531 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 07:30:04,531 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 07:30:04,531 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 07:30:04,531 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 07:30:05,641 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 07:30:05,641 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-29...
2025-12-22 07:30:05,701 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240729 for 519 symbols
2025-12-22 07:30:49,854 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,000,874 trades
2025-12-22 07:30:49,854 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,000,874 rows
2025-12-22 07:31:18,570 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,824,153 trades
2025-12-22 07:31:18,570 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,824,153 rows
2025-12-22 07:31:51,543 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,976,387 trades
2025-12-22 07:31:51,543 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,976,387 rows
2025-12-22 07:32:22,491 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,783,936 trades
2025-12-22 07:32:22,491 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,783,936 rows
2025-12-22 07:32:59,002 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,246,318 trades
2025-12-22 07:32:59,002 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,246,318 rows
2025-12-22 07:33:33,635 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,075,302 trades
2025-12-22 07:33:33,635 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,075,302 rows
2025-12-22 07:34:40,809 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,173,296 trades
2025-12-22 07:34:40,809 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,173,296 rows
2025-12-22 07:35:15,268 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,319,629 trades
2025-12-22 07:35:15,284 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,319,629 rows
2025-12-22 07:35:46,995 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,018,257 trades
2025-12-22 07:35:46,995 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,018,257 rows
2025-12-22 07:36:33,037 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,112,822 trades
2025-12-22 07:36:33,038 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,112,822 rows
2025-12-22 07:36:33,475 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 24,530,974 total rows written
2025-12-22 07:36:47,484 INFO [src.stage_a.wrds_extractor]   Chunk 11: 949,798 trades
2025-12-22 07:36:47,486 INFO [src.stage_a.parquet_writer]   Chunk 11: 949,798 rows
2025-12-22 07:36:47,800 INFO [src.stage_a.parquet_writer] ✓ Wrote 25,480,772 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-29
2025-12-22 07:36:47,801 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 07:36:47,801 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 07:36:47,801 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 07:36:47,801 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 07:36:47,801 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 07:36:47,801 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 07:36:47,801 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 07:36:48,878 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 07:36:48,878 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-29...
2025-12-22 07:36:48,937 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240729 for 519 symbols
2025-12-22 07:37:24,535 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,597,125 NBBO records
2025-12-22 07:37:24,535 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,597,125 rows
2025-12-22 07:37:48,287 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,330,490 NBBO records
2025-12-22 07:37:48,287 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,330,490 rows
2025-12-22 07:38:35,558 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,854,576 NBBO records
2025-12-22 07:38:35,559 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,854,576 rows
2025-12-22 07:38:57,483 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,183,299 NBBO records
2025-12-22 07:38:57,483 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,183,299 rows
2025-12-22 07:39:34,549 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,757,066 NBBO records
2025-12-22 07:39:34,549 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,757,066 rows
2025-12-22 07:40:19,346 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,076,284 NBBO records
2025-12-22 07:40:19,346 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,076,284 rows
2025-12-22 07:41:08,656 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,902,877 NBBO records
2025-12-22 07:41:08,656 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,902,877 rows
2025-12-22 07:41:58,679 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,199,304 NBBO records
2025-12-22 07:41:58,680 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,199,304 rows
2025-12-22 07:42:41,257 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,296,342 NBBO records
2025-12-22 07:42:41,258 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,296,342 rows
2025-12-22 07:43:12,308 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,179,136 NBBO records
2025-12-22 07:43:12,308 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,179,136 rows
2025-12-22 07:43:12,581 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 38,376,499 total rows written
2025-12-22 07:44:19,759 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,669,263 NBBO records
2025-12-22 07:44:19,759 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,669,263 rows
2025-12-22 07:44:20,336 INFO [src.stage_a.parquet_writer] ✓ Wrote 45,045,762 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-29
2025-12-22 07:44:20,347 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 07:44:20,347 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 07:44:20,347 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 07:44:20,347 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 07:44:20,347 INFO [src.stage_a.stage_a] Trades: 25,480,772 rows
2025-12-22 07:44:20,347 INFO [src.stage_a.stage_a] Nbbo: 45,045,762 rows
2025-12-22 07:44:20,347 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 07:44:20,347 INFO [src.stage_a.stage_a] Processing date 33/140: 2024-07-30
2025-12-22 07:44:20,347 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 07:44:20,347 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 07:44:20,347 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-07-30 (519 symbols)
2025-12-22 07:44:20,347 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 07:44:20,347 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 07:44:20,347 INFO [src.stage_a.stage_a] Extract run ID: 3c50276d-2aac-4200-bc48-bf0c3f0befd3
2025-12-22 07:44:20,355 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 07:44:20,355 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 07:44:20,355 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 07:44:20,355 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 07:44:20,355 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 07:44:20,355 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 07:44:20,355 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 07:44:20,355 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 07:44:20,355 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 07:44:21,591 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 07:44:21,592 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-30...
2025-12-22 07:44:21,665 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240730 for 519 symbols
2025-12-22 07:45:14,104 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,484,709 trades
2025-12-22 07:45:14,104 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,484,709 rows
2025-12-22 07:45:44,719 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,999,720 trades
2025-12-22 07:45:44,721 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,999,720 rows
2025-12-22 07:46:17,221 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,199,747 trades
2025-12-22 07:46:17,221 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,199,747 rows
2025-12-22 07:46:45,613 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,938,036 trades
2025-12-22 07:46:45,614 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,938,036 rows
2025-12-22 07:47:23,810 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,648,676 trades
2025-12-22 07:47:23,810 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,648,676 rows
2025-12-22 07:47:58,803 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,319,769 trades
2025-12-22 07:47:58,803 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,319,769 rows
2025-12-22 07:49:37,199 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,329,813 trades
2025-12-22 07:49:37,199 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,329,813 rows
2025-12-22 07:50:26,462 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,991,227 trades
2025-12-22 07:50:26,468 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,991,227 rows
2025-12-22 07:51:01,256 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,299,209 trades
2025-12-22 07:51:01,256 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,299,209 rows
2025-12-22 07:51:49,260 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,152,970 trades
2025-12-22 07:51:49,260 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,152,970 rows
2025-12-22 07:51:49,691 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 29,363,876 total rows written
2025-12-22 07:52:04,290 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,055,550 trades
2025-12-22 07:52:04,290 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,055,550 rows
2025-12-22 07:52:04,629 INFO [src.stage_a.parquet_writer] ✓ Wrote 30,419,426 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-30
2025-12-22 07:52:04,630 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 07:52:04,630 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 07:52:04,630 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 07:52:04,630 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 07:52:04,630 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 07:52:04,630 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 07:52:04,630 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 07:52:05,775 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 07:52:05,775 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-30...
2025-12-22 07:52:05,823 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240730 for 519 symbols
2025-12-22 07:52:43,443 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,920,392 NBBO records
2025-12-22 07:52:43,444 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,920,392 rows
2025-12-22 07:53:09,304 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,564,256 NBBO records
2025-12-22 07:53:09,304 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,564,256 rows
2025-12-22 07:54:04,648 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,710,507 NBBO records
2025-12-22 07:54:04,648 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,710,507 rows
2025-12-22 07:54:26,627 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,261,912 NBBO records
2025-12-22 07:54:26,627 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,261,912 rows
2025-12-22 07:55:05,891 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,029,991 NBBO records
2025-12-22 07:55:05,891 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,029,991 rows
2025-12-22 07:55:47,633 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,056,326 NBBO records
2025-12-22 07:55:47,633 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,056,326 rows
2025-12-22 07:56:51,134 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,848,985 NBBO records
2025-12-22 07:56:51,134 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,848,985 rows
2025-12-22 07:57:47,651 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,619,084 NBBO records
2025-12-22 07:57:47,651 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,619,084 rows
2025-12-22 07:58:32,085 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,385,628 NBBO records
2025-12-22 07:58:32,085 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,385,628 rows
2025-12-22 07:59:06,091 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,362,282 NBBO records
2025-12-22 07:59:06,091 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,362,282 rows
2025-12-22 07:59:06,369 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 41,759,363 total rows written
2025-12-22 08:04:24,443 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,162,335 NBBO records
2025-12-22 08:04:24,443 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,162,335 rows
2025-12-22 08:04:25,049 INFO [src.stage_a.parquet_writer] ✓ Wrote 48,921,698 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-30
2025-12-22 08:04:25,057 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 08:04:25,057 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 08:04:25,057 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 08:04:25,057 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 08:04:25,057 INFO [src.stage_a.stage_a] Trades: 30,419,426 rows
2025-12-22 08:04:25,057 INFO [src.stage_a.stage_a] Nbbo: 48,921,698 rows
2025-12-22 08:04:25,057 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 08:04:25,057 INFO [src.stage_a.stage_a] Processing date 34/140: 2024-07-31
2025-12-22 08:04:25,057 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 08:04:25,057 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 08:04:25,057 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-07-31 (519 symbols)
2025-12-22 08:04:25,057 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 08:04:25,057 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 08:04:25,057 INFO [src.stage_a.stage_a] Extract run ID: cef54c2c-df33-4b0c-a90c-fd9e97a35ffc
2025-12-22 08:04:25,065 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 08:04:25,065 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 08:04:25,065 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 08:04:25,065 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 08:04:25,065 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 08:04:25,065 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 08:04:25,065 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 08:04:25,065 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 08:04:25,065 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 08:04:26,544 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 08:04:26,544 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-31...
2025-12-22 08:04:26,684 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240731 for 519 symbols
2025-12-22 08:05:36,471 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,226,542 trades
2025-12-22 08:05:36,471 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,226,542 rows
2025-12-22 08:06:16,314 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,349,363 trades
2025-12-22 08:06:16,314 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,349,363 rows
2025-12-22 08:06:57,297 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,393,234 trades
2025-12-22 08:06:57,297 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,393,234 rows
2025-12-22 08:07:26,908 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,032,288 trades
2025-12-22 08:07:26,908 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,032,288 rows
2025-12-22 08:08:13,689 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,728,807 trades
2025-12-22 08:08:13,689 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,728,807 rows
2025-12-22 08:09:04,469 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,657,022 trades
2025-12-22 08:09:04,469 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,657,022 rows
2025-12-22 08:10:59,311 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,391,698 trades
2025-12-22 08:10:59,311 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,391,698 rows
2025-12-22 08:11:47,306 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,821,915 trades
2025-12-22 08:11:47,308 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,821,915 rows
2025-12-22 08:12:35,705 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,445,267 trades
2025-12-22 08:12:35,706 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,445,267 rows
2025-12-22 08:13:22,182 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,220,819 trades
2025-12-22 08:13:22,182 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,220,819 rows
2025-12-22 08:13:22,589 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 31,266,955 total rows written
2025-12-22 08:13:41,899 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,190,204 trades
2025-12-22 08:13:41,899 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,190,204 rows
2025-12-22 08:13:42,253 INFO [src.stage_a.parquet_writer] ✓ Wrote 32,457,159 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-07-31
2025-12-22 08:13:42,274 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 08:13:42,274 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 08:13:42,274 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 08:13:42,274 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 08:13:42,274 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 08:13:42,274 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 08:13:42,274 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 08:13:43,339 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 08:13:43,339 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-31...
2025-12-22 08:13:43,388 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240731 for 519 symbols
2025-12-22 08:14:26,636 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,353,046 NBBO records
2025-12-22 08:14:26,636 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,353,046 rows
2025-12-22 08:15:07,540 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,028,872 NBBO records
2025-12-22 08:15:07,540 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,028,872 rows
2025-12-22 08:15:56,084 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,207,491 NBBO records
2025-12-22 08:15:56,085 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,207,491 rows
2025-12-22 08:16:31,057 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,736,761 NBBO records
2025-12-22 08:16:31,058 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,736,761 rows
2025-12-22 08:17:12,775 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,299,030 NBBO records
2025-12-22 08:17:12,775 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,299,030 rows
2025-12-22 08:18:30,702 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,711,896 NBBO records
2025-12-22 08:18:30,703 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,711,896 rows
2025-12-22 08:19:44,491 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,674,189 NBBO records
2025-12-22 08:19:44,492 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,674,189 rows
2025-12-22 08:20:54,855 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,875,545 NBBO records
2025-12-22 08:20:54,859 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,875,545 rows
2025-12-22 08:21:45,905 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,465,152 NBBO records
2025-12-22 08:21:45,906 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,465,152 rows
2025-12-22 08:22:38,049 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,986,645 NBBO records
2025-12-22 08:22:38,050 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,986,645 rows
2025-12-22 08:22:38,374 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 45,338,627 total rows written
2025-12-22 08:24:05,793 INFO [src.stage_a.wrds_extractor]   Chunk 11: 8,246,084 NBBO records
2025-12-22 08:24:05,793 INFO [src.stage_a.parquet_writer]   Chunk 11: 8,246,084 rows
2025-12-22 08:24:06,495 INFO [src.stage_a.parquet_writer] ✓ Wrote 53,584,711 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-07-31
2025-12-22 08:24:06,515 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 08:24:06,515 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 08:24:06,515 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 08:24:06,515 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 08:24:06,515 INFO [src.stage_a.stage_a] Trades: 32,457,159 rows
2025-12-22 08:24:06,515 INFO [src.stage_a.stage_a] Nbbo: 53,584,711 rows
2025-12-22 08:24:06,515 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 08:24:06,515 INFO [src.stage_a.stage_a] Processing date 35/140: 2024-08-01
2025-12-22 08:24:06,515 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 08:24:06,515 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 08:24:06,515 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-08-01 (519 symbols)
2025-12-22 08:24:06,515 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 08:24:06,515 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 08:24:06,515 INFO [src.stage_a.stage_a] Extract run ID: 0195b586-9399-43b2-9997-68f531e608bb
2025-12-22 08:24:06,523 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 08:24:06,524 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 08:24:06,524 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 08:24:06,524 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 08:24:06,524 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 08:24:06,524 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 08:24:06,524 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 08:24:06,524 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 08:24:06,524 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 08:24:07,739 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 08:24:07,739 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-01...
2025-12-22 08:24:07,808 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240801 for 519 symbols
2025-12-22 08:25:32,737 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,964,058 trades
2025-12-22 08:25:32,737 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,964,058 rows
2025-12-22 08:26:31,089 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,526,764 trades
2025-12-22 08:26:31,096 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,526,764 rows
2025-12-22 08:27:30,829 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,627,558 trades
2025-12-22 08:27:30,830 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,627,558 rows
2025-12-22 08:28:10,913 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,251,246 trades
2025-12-22 08:28:10,913 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,251,246 rows
2025-12-22 08:29:13,297 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,118,973 trades
2025-12-22 08:29:13,297 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,118,973 rows
2025-12-22 08:30:13,424 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,944,289 trades
2025-12-22 08:30:13,424 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,944,289 rows
2025-12-22 08:32:39,921 INFO [src.stage_a.wrds_extractor]   Chunk 7: 7,257,765 trades
2025-12-22 08:32:39,921 INFO [src.stage_a.parquet_writer]   Chunk 7: 7,257,765 rows
2025-12-22 08:33:41,078 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,313,442 trades
2025-12-22 08:33:41,081 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,313,442 rows
2025-12-22 08:34:37,759 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,800,185 trades
2025-12-22 08:34:37,759 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,800,185 rows
2025-12-22 08:35:55,464 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,633,237 trades
2025-12-22 08:35:55,489 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,633,237 rows
2025-12-22 08:35:55,957 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 35,437,517 total rows written
2025-12-22 08:36:24,364 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,526,349 trades
2025-12-22 08:36:24,375 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,526,349 rows
2025-12-22 08:36:24,806 INFO [src.stage_a.parquet_writer] ✓ Wrote 36,963,866 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-01
2025-12-22 08:36:24,811 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 08:36:24,811 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 08:36:24,811 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 08:36:24,811 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 08:36:24,811 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 08:36:24,811 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 08:36:24,811 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 08:36:25,898 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 08:36:25,899 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-01...
2025-12-22 08:36:25,941 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240801 for 519 symbols
2025-12-22 08:37:21,805 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,889,034 NBBO records
2025-12-22 08:37:21,805 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,889,034 rows
2025-12-22 08:37:53,239 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,074,043 NBBO records
2025-12-22 08:37:53,240 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,074,043 rows
2025-12-22 08:39:03,214 INFO [src.stage_a.wrds_extractor]   Chunk 3: 6,430,178 NBBO records
2025-12-22 08:39:03,214 INFO [src.stage_a.parquet_writer]   Chunk 3: 6,430,178 rows
2025-12-22 08:39:34,088 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,839,251 NBBO records
2025-12-22 08:39:34,093 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,839,251 rows
2025-12-22 08:40:30,627 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,038,508 NBBO records
2025-12-22 08:40:30,627 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,038,508 rows
2025-12-22 08:41:23,953 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,661,344 NBBO records
2025-12-22 08:41:23,954 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,661,344 rows
2025-12-22 08:42:57,990 INFO [src.stage_a.wrds_extractor]   Chunk 7: 8,075,046 NBBO records
2025-12-22 08:42:57,991 INFO [src.stage_a.parquet_writer]   Chunk 7: 8,075,046 rows
2025-12-22 08:44:13,439 INFO [src.stage_a.wrds_extractor]   Chunk 8: 6,996,181 NBBO records
2025-12-22 08:44:13,444 INFO [src.stage_a.parquet_writer]   Chunk 8: 6,996,181 rows
2025-12-22 08:45:07,794 INFO [src.stage_a.wrds_extractor]   Chunk 9: 5,366,427 NBBO records
2025-12-22 08:45:07,795 INFO [src.stage_a.parquet_writer]   Chunk 9: 5,366,427 rows
2025-12-22 08:45:56,604 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,160,235 NBBO records
2025-12-22 08:45:56,605 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,160,235 rows
2025-12-22 08:45:56,912 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 51,530,247 total rows written
2025-12-22 08:47:39,573 INFO [src.stage_a.wrds_extractor]   Chunk 11: 9,474,350 NBBO records
2025-12-22 08:47:39,574 INFO [src.stage_a.parquet_writer]   Chunk 11: 9,474,350 rows
2025-12-22 08:47:40,370 INFO [src.stage_a.parquet_writer] ✓ Wrote 61,004,597 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-01
2025-12-22 08:47:40,388 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 08:47:40,388 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 08:47:40,388 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 08:47:40,388 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 08:47:40,388 INFO [src.stage_a.stage_a] Trades: 36,963,866 rows
2025-12-22 08:47:40,388 INFO [src.stage_a.stage_a] Nbbo: 61,004,597 rows
2025-12-22 08:47:40,388 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 08:47:40,388 INFO [src.stage_a.stage_a] Processing date 36/140: 2024-08-02
2025-12-22 08:47:40,388 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 08:47:40,388 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 08:47:40,388 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-08-02 (519 symbols)
2025-12-22 08:47:40,388 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 08:47:40,388 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 08:47:40,388 INFO [src.stage_a.stage_a] Extract run ID: db15fb8d-a40a-4f26-9b61-de1bbbc07e4b
2025-12-22 08:47:40,396 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 08:47:40,396 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 08:47:40,396 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 08:47:40,396 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 08:47:40,396 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 08:47:40,396 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 08:47:40,396 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 08:47:40,396 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 08:47:40,396 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 08:47:42,012 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 08:47:42,012 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-02...
2025-12-22 08:47:42,077 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240802 for 519 symbols
2025-12-22 08:49:27,344 INFO [src.stage_a.wrds_extractor]   Chunk 1: 6,205,456 trades
2025-12-22 08:49:27,344 INFO [src.stage_a.parquet_writer]   Chunk 1: 6,205,456 rows
2025-12-22 08:50:18,075 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,875,457 trades
2025-12-22 08:50:18,077 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,875,457 rows
2025-12-22 08:51:05,670 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,866,964 trades
2025-12-22 08:51:05,670 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,866,964 rows
2025-12-22 08:51:42,005 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,346,103 trades
2025-12-22 08:51:42,005 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,346,103 rows
2025-12-22 08:52:50,424 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,088,374 trades
2025-12-22 08:52:50,424 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,088,374 rows
2025-12-22 08:53:46,559 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,304,191 trades
2025-12-22 08:53:46,562 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,304,191 rows
2025-12-22 08:55:55,399 INFO [src.stage_a.wrds_extractor]   Chunk 7: 7,639,492 trades
2025-12-22 08:55:55,399 INFO [src.stage_a.parquet_writer]   Chunk 7: 7,639,492 rows
2025-12-22 08:56:56,470 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,642,736 trades
2025-12-22 08:56:56,482 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,642,736 rows
2025-12-22 08:57:51,183 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,083,265 trades
2025-12-22 08:57:51,183 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,083,265 rows
2025-12-22 08:58:56,495 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,916,641 trades
2025-12-22 08:58:56,495 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,916,641 rows
2025-12-22 08:58:56,990 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 39,968,679 total rows written
2025-12-22 08:59:24,609 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,928,093 trades
2025-12-22 08:59:24,614 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,928,093 rows
2025-12-22 08:59:25,143 INFO [src.stage_a.parquet_writer] ✓ Wrote 41,896,772 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-02
2025-12-22 08:59:25,148 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 08:59:25,148 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 08:59:25,148 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 08:59:25,148 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 08:59:25,148 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 08:59:25,148 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 08:59:25,148 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 08:59:26,263 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 08:59:26,263 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-02...
2025-12-22 08:59:26,311 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240802 for 519 symbols
2025-12-22 09:00:32,008 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,675,919 NBBO records
2025-12-22 09:00:32,008 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,675,919 rows
2025-12-22 09:01:12,496 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,377,909 NBBO records
2025-12-22 09:01:12,496 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,377,909 rows
2025-12-22 09:02:29,203 INFO [src.stage_a.wrds_extractor]   Chunk 3: 6,790,219 NBBO records
2025-12-22 09:02:29,204 INFO [src.stage_a.parquet_writer]   Chunk 3: 6,790,219 rows
2025-12-22 09:03:08,589 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,063,684 NBBO records
2025-12-22 09:03:08,591 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,063,684 rows
2025-12-22 09:04:16,659 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,967,121 NBBO records
2025-12-22 09:04:16,659 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,967,121 rows
2025-12-22 09:05:22,547 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,419,381 NBBO records
2025-12-22 09:05:22,549 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,419,381 rows
2025-12-22 09:06:49,705 INFO [src.stage_a.wrds_extractor]   Chunk 7: 7,830,151 NBBO records
2025-12-22 09:06:49,706 INFO [src.stage_a.parquet_writer]   Chunk 7: 7,830,151 rows
2025-12-22 09:08:27,877 INFO [src.stage_a.wrds_extractor]   Chunk 8: 7,244,751 NBBO records
2025-12-22 09:08:27,879 INFO [src.stage_a.parquet_writer]   Chunk 8: 7,244,751 rows
2025-12-22 09:14:03,916 INFO [src.stage_a.wrds_extractor]   Chunk 9: 6,403,745 NBBO records
2025-12-22 09:14:03,917 INFO [src.stage_a.parquet_writer]   Chunk 9: 6,403,745 rows
2025-12-22 09:14:51,704 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,527,784 NBBO records
2025-12-22 09:14:51,705 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,527,784 rows
2025-12-22 09:14:52,049 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 56,300,664 total rows written
2025-12-22 09:22:27,638 INFO [src.stage_a.wrds_extractor]   Chunk 11: 10,888,306 NBBO records
2025-12-22 09:22:27,638 INFO [src.stage_a.parquet_writer]   Chunk 11: 10,888,306 rows
2025-12-22 09:22:28,541 INFO [src.stage_a.parquet_writer] ✓ Wrote 67,188,970 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-02
2025-12-22 09:22:28,552 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 09:22:28,552 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 09:22:28,552 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 09:22:28,552 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 09:22:28,552 INFO [src.stage_a.stage_a] Trades: 41,896,772 rows
2025-12-22 09:22:28,552 INFO [src.stage_a.stage_a] Nbbo: 67,188,970 rows
2025-12-22 09:22:28,552 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 09:22:28,552 INFO [src.stage_a.stage_a] Processing date 37/140: 2024-08-05
2025-12-22 09:22:28,552 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 09:22:28,552 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 09:22:28,552 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-08-05 (519 symbols)
2025-12-22 09:22:28,552 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 09:22:28,552 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 09:22:28,552 INFO [src.stage_a.stage_a] Extract run ID: 1a5f5342-0e3f-45e4-b512-149146cc6ec7
2025-12-22 09:22:28,560 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 09:22:28,560 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 09:22:28,560 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 09:22:28,560 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 09:22:28,560 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 09:22:28,560 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 09:22:28,560 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 09:22:28,560 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 09:22:28,560 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 09:22:32,153 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 09:22:32,154 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-05...
2025-12-22 09:22:32,470 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240805 for 519 symbols
2025-12-22 09:30:51,233 INFO [src.stage_a.wrds_extractor]   Chunk 1: 6,067,306 trades
2025-12-22 09:30:51,233 INFO [src.stage_a.parquet_writer]   Chunk 1: 6,067,306 rows
2025-12-22 09:32:03,684 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,035,887 trades
2025-12-22 09:32:03,702 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,035,887 rows
2025-12-22 09:33:09,711 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,068,331 trades
2025-12-22 09:33:09,711 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,068,331 rows
2025-12-22 09:34:00,022 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,610,024 trades
2025-12-22 09:34:00,022 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,610,024 rows
2025-12-22 09:35:35,049 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,399,615 trades
2025-12-22 09:35:35,049 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,399,615 rows
2025-12-22 09:36:41,449 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,588,708 trades
2025-12-22 09:36:41,460 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,588,708 rows
2025-12-22 09:39:30,307 INFO [src.stage_a.wrds_extractor]   Chunk 7: 8,619,917 trades
2025-12-22 09:39:30,307 INFO [src.stage_a.parquet_writer]   Chunk 7: 8,619,917 rows
2025-12-22 09:40:47,579 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,889,271 trades
2025-12-22 09:40:47,589 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,889,271 rows
2025-12-22 09:42:03,560 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,726,629 trades
2025-12-22 09:42:03,560 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,726,629 rows
2025-12-22 09:43:28,797 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,404,897 trades
2025-12-22 09:43:28,797 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,404,897 rows
2025-12-22 09:43:29,303 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 43,410,585 total rows written
2025-12-22 09:44:11,565 INFO [src.stage_a.wrds_extractor]   Chunk 11: 2,412,967 trades
2025-12-22 09:44:11,576 INFO [src.stage_a.parquet_writer]   Chunk 11: 2,412,967 rows
2025-12-22 09:44:12,161 INFO [src.stage_a.parquet_writer] ✓ Wrote 45,823,552 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-05
2025-12-22 09:44:12,171 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 09:44:12,171 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 09:44:12,171 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 09:44:12,171 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 09:44:12,171 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 09:44:12,171 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 09:44:12,172 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 09:44:13,195 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 09:44:13,195 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-05...
2025-12-22 09:44:13,252 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240805 for 519 symbols
2025-12-22 09:45:38,214 INFO [src.stage_a.wrds_extractor]   Chunk 1: 7,162,781 NBBO records
2025-12-22 09:45:38,214 INFO [src.stage_a.parquet_writer]   Chunk 1: 7,162,781 rows
2025-12-22 09:46:28,423 INFO [src.stage_a.wrds_extractor]   Chunk 2: 4,171,460 NBBO records
2025-12-22 09:46:28,425 INFO [src.stage_a.parquet_writer]   Chunk 2: 4,171,460 rows
2025-12-22 09:47:30,702 INFO [src.stage_a.wrds_extractor]   Chunk 3: 6,395,426 NBBO records
2025-12-22 09:47:30,702 INFO [src.stage_a.parquet_writer]   Chunk 3: 6,395,426 rows
2025-12-22 09:48:15,914 INFO [src.stage_a.wrds_extractor]   Chunk 4: 4,030,299 NBBO records
2025-12-22 09:48:15,915 INFO [src.stage_a.parquet_writer]   Chunk 4: 4,030,299 rows
2025-12-22 09:54:14,873 INFO [src.stage_a.wrds_extractor]   Chunk 5: 7,243,988 NBBO records
2025-12-22 09:54:14,873 INFO [src.stage_a.parquet_writer]   Chunk 5: 7,243,988 rows
2025-12-22 09:55:30,168 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,971,788 NBBO records
2025-12-22 09:55:30,168 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,971,788 rows
2025-12-22 09:57:29,305 INFO [src.stage_a.wrds_extractor]   Chunk 7: 9,314,753 NBBO records
2025-12-22 09:57:29,306 INFO [src.stage_a.parquet_writer]   Chunk 7: 9,314,753 rows
2025-12-22 10:00:36,594 INFO [src.stage_a.wrds_extractor]   Chunk 8: 7,522,310 NBBO records
2025-12-22 10:00:36,599 INFO [src.stage_a.parquet_writer]   Chunk 8: 7,522,310 rows
2025-12-22 10:04:16,091 INFO [src.stage_a.wrds_extractor]   Chunk 9: 6,824,581 NBBO records
2025-12-22 10:04:16,092 INFO [src.stage_a.parquet_writer]   Chunk 9: 6,824,581 rows
2025-12-22 10:07:44,536 INFO [src.stage_a.wrds_extractor]   Chunk 10: 5,931,951 NBBO records
2025-12-22 10:07:44,537 INFO [src.stage_a.parquet_writer]   Chunk 10: 5,931,951 rows
2025-12-22 10:07:44,925 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 64,569,337 total rows written
2025-12-22 10:16:25,384 INFO [src.stage_a.wrds_extractor]   Chunk 11: 12,835,431 NBBO records
2025-12-22 10:16:25,395 INFO [src.stage_a.parquet_writer]   Chunk 11: 12,835,431 rows
2025-12-22 10:16:26,559 INFO [src.stage_a.parquet_writer] ✓ Wrote 77,404,768 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-05
2025-12-22 10:16:26,645 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 10:16:26,645 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 10:16:26,645 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 10:16:26,645 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 10:16:26,645 INFO [src.stage_a.stage_a] Trades: 45,823,552 rows
2025-12-22 10:16:26,645 INFO [src.stage_a.stage_a] Nbbo: 77,404,768 rows
2025-12-22 10:16:26,645 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 10:16:26,645 INFO [src.stage_a.stage_a] Processing date 38/140: 2024-08-06
2025-12-22 10:16:26,645 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 10:16:26,645 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 10:16:26,645 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-08-06 (519 symbols)
2025-12-22 10:16:26,645 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 10:16:26,645 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 10:16:26,645 INFO [src.stage_a.stage_a] Extract run ID: 734ad6bc-829a-42d2-9bcc-d2a1d61a987c
2025-12-22 10:16:26,653 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 10:16:26,653 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 10:16:26,653 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 10:16:26,653 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 10:16:26,653 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 10:16:26,653 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 10:16:26,653 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 10:16:26,653 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 10:16:26,653 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 10:16:27,748 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 10:16:27,748 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-06...
2025-12-22 10:16:27,806 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240806 for 519 symbols
2025-12-22 10:17:40,518 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,161,792 trades
2025-12-22 10:17:40,518 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,161,792 rows
2025-12-22 10:18:25,291 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,326,459 trades
2025-12-22 10:18:25,297 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,326,459 rows
2025-12-22 10:19:17,251 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,575,350 trades
2025-12-22 10:19:17,251 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,575,350 rows
2025-12-22 10:19:53,550 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,123,271 trades
2025-12-22 10:19:53,550 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,123,271 rows
2025-12-22 10:20:50,443 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,242,584 trades
2025-12-22 10:20:50,443 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,242,584 rows
2025-12-22 10:21:37,239 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,562,902 trades
2025-12-22 10:21:37,239 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,562,902 rows
2025-12-22 10:23:18,315 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,751,360 trades
2025-12-22 10:23:18,315 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,751,360 rows
2025-12-22 10:24:05,359 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,925,913 trades
2025-12-22 10:24:05,364 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,925,913 rows
2025-12-22 10:24:46,576 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,690,893 trades
2025-12-22 10:24:46,603 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,690,893 rows
2025-12-22 10:25:43,422 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,632,442 trades
2025-12-22 10:25:43,422 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,632,442 rows
2025-12-22 10:25:43,873 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 31,992,966 total rows written
2025-12-22 10:26:05,598 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,580,144 trades
2025-12-22 10:26:05,601 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,580,144 rows
2025-12-22 10:26:06,075 INFO [src.stage_a.parquet_writer] ✓ Wrote 33,573,110 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-06
2025-12-22 10:26:06,081 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 10:26:06,081 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 10:26:06,081 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 10:26:06,081 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 10:26:06,081 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 10:26:06,081 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 10:26:06,081 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 10:26:07,163 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 10:26:07,164 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-06...
2025-12-22 10:26:07,239 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240806 for 519 symbols
2025-12-22 10:27:07,757 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,271,809 NBBO records
2025-12-22 10:27:07,757 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,271,809 rows
2025-12-22 10:29:28,088 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,346,362 NBBO records
2025-12-22 10:29:28,088 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,346,362 rows
2025-12-22 10:33:01,249 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,655,259 NBBO records
2025-12-22 10:33:01,249 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,655,259 rows
2025-12-22 10:33:37,820 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,201,229 NBBO records
2025-12-22 10:33:37,822 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,201,229 rows
2025-12-22 10:34:40,160 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,325,561 NBBO records
2025-12-22 10:34:40,160 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,325,561 rows
2025-12-22 10:35:41,792 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,536,021 NBBO records
2025-12-22 10:35:41,793 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,536,021 rows
2025-12-22 10:40:21,954 INFO [src.stage_a.wrds_extractor]   Chunk 7: 7,151,578 NBBO records
2025-12-22 10:40:21,955 INFO [src.stage_a.parquet_writer]   Chunk 7: 7,151,578 rows
2025-12-22 10:44:26,588 INFO [src.stage_a.wrds_extractor]   Chunk 8: 6,912,525 NBBO records
2025-12-22 10:44:26,590 INFO [src.stage_a.parquet_writer]   Chunk 8: 6,912,525 rows
2025-12-22 10:47:46,514 INFO [src.stage_a.wrds_extractor]   Chunk 9: 5,608,126 NBBO records
2025-12-22 10:47:46,515 INFO [src.stage_a.parquet_writer]   Chunk 9: 5,608,126 rows
2025-12-22 10:50:27,881 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,581,357 NBBO records
2025-12-22 10:50:27,883 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,581,357 rows
2025-12-22 10:50:28,248 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 52,589,827 total rows written
2025-12-22 10:55:05,966 INFO [src.stage_a.wrds_extractor]   Chunk 11: 10,207,866 NBBO records
2025-12-22 10:55:05,967 INFO [src.stage_a.parquet_writer]   Chunk 11: 10,207,866 rows
2025-12-22 10:55:06,845 INFO [src.stage_a.parquet_writer] ✓ Wrote 62,797,693 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-06
2025-12-22 10:55:06,856 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 10:55:06,856 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 10:55:06,856 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 10:55:06,856 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 10:55:06,856 INFO [src.stage_a.stage_a] Trades: 33,573,110 rows
2025-12-22 10:55:06,857 INFO [src.stage_a.stage_a] Nbbo: 62,797,693 rows
2025-12-22 10:55:06,857 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 10:55:06,857 INFO [src.stage_a.stage_a] Processing date 39/140: 2024-08-07
2025-12-22 10:55:06,857 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 10:55:06,857 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 10:55:06,857 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-08-07 (519 symbols)
2025-12-22 10:55:06,857 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 10:55:06,857 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 10:55:06,857 INFO [src.stage_a.stage_a] Extract run ID: 13205c41-e680-468a-b831-ff4e10b447f8
2025-12-22 10:55:06,865 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 10:55:06,865 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 10:55:06,865 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 10:55:06,865 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 10:55:06,865 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 10:55:06,865 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 10:55:06,865 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 10:55:06,865 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 10:55:06,865 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 10:55:08,112 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 10:55:08,112 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-07...
2025-12-22 10:55:08,180 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240807 for 519 symbols
2025-12-22 10:58:18,290 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,054,616 trades
2025-12-22 10:58:18,290 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,054,616 rows
2025-12-22 10:59:21,718 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,124,654 trades
2025-12-22 10:59:21,721 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,124,654 rows
2025-12-22 11:00:01,602 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,399,278 trades
2025-12-22 11:00:01,604 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,399,278 rows
2025-12-22 11:00:47,678 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,170,837 trades
2025-12-22 11:00:47,678 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,170,837 rows
2025-12-22 11:02:07,945 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,870,599 trades
2025-12-22 11:02:07,945 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,870,599 rows
2025-12-22 11:04:51,411 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,348,052 trades
2025-12-22 11:04:51,411 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,348,052 rows
2025-12-22 11:10:39,809 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,618,694 trades
2025-12-22 11:10:39,809 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,618,694 rows
2025-12-22 11:13:44,133 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,741,888 trades
2025-12-22 11:13:44,146 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,741,888 rows
2025-12-22 11:16:44,785 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,817,969 trades
2025-12-22 11:16:44,785 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,817,969 rows
2025-12-22 11:19:34,807 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,301,632 trades
2025-12-22 11:19:34,807 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,301,632 rows
2025-12-22 11:19:35,255 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 30,448,219 total rows written
2025-12-22 11:20:43,503 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,394,475 trades
2025-12-22 11:20:43,524 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,394,475 rows
2025-12-22 11:20:43,946 INFO [src.stage_a.parquet_writer] ✓ Wrote 31,842,694 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-07
2025-12-22 11:20:43,949 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 11:20:43,949 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 11:20:43,949 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 11:20:43,949 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 11:20:43,949 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 11:20:43,949 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 11:20:43,949 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 11:20:47,958 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 11:20:47,958 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-07...
2025-12-22 11:20:48,163 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240807 for 519 symbols
2025-12-22 11:24:01,873 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,638,614 NBBO records
2025-12-22 11:24:01,873 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,638,614 rows
2025-12-22 11:26:09,311 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,948,631 NBBO records
2025-12-22 11:26:09,312 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,948,631 rows
2025-12-22 11:29:11,865 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,607,652 NBBO records
2025-12-22 11:29:11,865 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,607,652 rows
2025-12-22 11:30:45,295 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,835,768 NBBO records
2025-12-22 11:30:45,296 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,835,768 rows
2025-12-22 11:34:29,880 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,688,351 NBBO records
2025-12-22 11:34:29,880 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,688,351 rows
2025-12-22 11:38:06,298 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,497,653 NBBO records
2025-12-22 11:38:06,299 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,497,653 rows
2025-12-22 11:42:40,070 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,688,936 NBBO records
2025-12-22 11:42:40,071 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,688,936 rows
2025-12-22 11:47:37,735 INFO [src.stage_a.wrds_extractor]   Chunk 8: 7,397,962 NBBO records
2025-12-22 11:47:37,737 INFO [src.stage_a.parquet_writer]   Chunk 8: 7,397,962 rows
2025-12-22 11:50:42,613 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,954,313 NBBO records
2025-12-22 11:50:42,615 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,954,313 rows
2025-12-22 11:55:26,111 INFO [src.stage_a.wrds_extractor]   Chunk 10: 5,039,497 NBBO records
2025-12-22 11:55:26,111 INFO [src.stage_a.parquet_writer]   Chunk 10: 5,039,497 rows
2025-12-22 11:55:26,480 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 50,297,377 total rows written
2025-12-22 12:01:43,060 INFO [src.stage_a.wrds_extractor]   Chunk 11: 8,789,427 NBBO records
2025-12-22 12:01:43,061 INFO [src.stage_a.parquet_writer]   Chunk 11: 8,789,427 rows
2025-12-22 12:01:43,848 INFO [src.stage_a.parquet_writer] ✓ Wrote 59,086,804 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-07
2025-12-22 12:01:43,864 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 12:01:43,864 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 12:01:43,864 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 12:01:43,864 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 12:01:43,864 INFO [src.stage_a.stage_a] Trades: 31,842,694 rows
2025-12-22 12:01:43,864 INFO [src.stage_a.stage_a] Nbbo: 59,086,804 rows
2025-12-22 12:01:43,864 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 12:01:43,864 INFO [src.stage_a.stage_a] Processing date 40/140: 2024-08-08
2025-12-22 12:01:43,864 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 12:01:43,864 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 12:01:43,864 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-08-08 (519 symbols)
2025-12-22 12:01:43,864 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 12:01:43,865 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 12:01:43,865 INFO [src.stage_a.stage_a] Extract run ID: 8cac3822-a003-4f00-8400-e3c408bf4689
2025-12-22 12:01:43,873 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 12:01:43,873 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 12:01:43,873 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 12:01:43,873 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 12:01:43,873 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 12:01:43,873 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 12:01:43,873 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 12:01:43,873 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 12:01:43,873 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 12:01:45,426 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 12:01:45,426 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-08...
2025-12-22 12:01:45,557 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240808 for 519 symbols
2025-12-22 12:05:26,105 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,446,816 trades
2025-12-22 12:05:26,105 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,446,816 rows
2025-12-22 12:07:25,478 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,833,771 trades
2025-12-22 12:07:25,478 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,833,771 rows
2025-12-22 12:09:48,166 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,153,115 trades
2025-12-22 12:09:48,166 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,153,115 rows
2025-12-22 12:10:20,678 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,876,184 trades
2025-12-22 12:10:20,678 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,876,184 rows
2025-12-22 12:11:15,657 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,504,160 trades
2025-12-22 12:11:15,657 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,504,160 rows
2025-12-22 12:11:46,629 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,118,724 trades
2025-12-22 12:11:46,630 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,118,724 rows
2025-12-22 12:13:41,022 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,296,645 trades
2025-12-22 12:13:41,022 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,296,645 rows
2025-12-22 12:14:30,444 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,578,143 trades
2025-12-22 12:14:30,461 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,578,143 rows
2025-12-22 12:15:14,962 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,348,243 trades
2025-12-22 12:15:14,962 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,348,243 rows
2025-12-22 12:16:19,428 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,996,101 trades
2025-12-22 12:16:19,434 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,996,101 rows
2025-12-22 12:16:19,877 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 27,151,902 total rows written
2025-12-22 12:16:37,133 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,176,886 trades
2025-12-22 12:16:37,134 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,176,886 rows
2025-12-22 12:16:37,520 INFO [src.stage_a.parquet_writer] ✓ Wrote 28,328,788 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-08
2025-12-22 12:16:37,521 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 12:16:37,521 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 12:16:37,521 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 12:16:37,521 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 12:16:37,521 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 12:16:37,521 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 12:16:37,521 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 12:16:38,839 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 12:16:38,839 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-08...
2025-12-22 12:16:38,943 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240808 for 519 symbols
2025-12-22 12:17:40,365 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,671,320 NBBO records
2025-12-22 12:17:40,365 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,671,320 rows
2025-12-22 12:18:16,097 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,550,754 NBBO records
2025-12-22 12:18:16,097 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,550,754 rows
2025-12-22 12:19:08,198 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,424,494 NBBO records
2025-12-22 12:19:08,198 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,424,494 rows
2025-12-22 12:19:46,916 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,525,960 NBBO records
2025-12-22 12:19:46,916 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,525,960 rows
2025-12-22 12:20:38,684 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,332,187 NBBO records
2025-12-22 12:20:38,684 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,332,187 rows
2025-12-22 12:21:25,214 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,957,217 NBBO records
2025-12-22 12:21:25,215 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,957,217 rows
2025-12-22 12:22:32,785 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,409,668 NBBO records
2025-12-22 12:22:32,785 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,409,668 rows
2025-12-22 12:23:53,210 INFO [src.stage_a.wrds_extractor]   Chunk 8: 6,138,188 NBBO records
2025-12-22 12:23:53,211 INFO [src.stage_a.parquet_writer]   Chunk 8: 6,138,188 rows
2025-12-22 12:24:51,931 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,424,577 NBBO records
2025-12-22 12:24:51,933 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,424,577 rows
2025-12-22 12:25:41,264 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,348,898 NBBO records
2025-12-22 12:25:41,264 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,348,898 rows
2025-12-22 12:25:41,588 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 43,783,263 total rows written
2025-12-22 12:27:01,844 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,236,872 NBBO records
2025-12-22 12:27:01,844 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,236,872 rows
2025-12-22 12:27:02,474 INFO [src.stage_a.parquet_writer] ✓ Wrote 51,020,135 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-08
2025-12-22 12:27:02,485 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 12:27:02,485 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 12:27:02,485 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 12:27:02,485 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 12:27:02,485 INFO [src.stage_a.stage_a] Trades: 28,328,788 rows
2025-12-22 12:27:02,485 INFO [src.stage_a.stage_a] Nbbo: 51,020,135 rows
2025-12-22 12:27:02,485 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 12:27:02,485 INFO [src.stage_a.stage_a] Processing date 41/140: 2024-08-09
2025-12-22 12:27:02,485 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 12:27:02,485 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 12:27:02,485 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-08-09 (519 symbols)
2025-12-22 12:27:02,485 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 12:27:02,485 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 12:27:02,485 INFO [src.stage_a.stage_a] Extract run ID: 4069b727-6147-4d98-b70a-fb362b531a93
2025-12-22 12:27:02,493 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 12:27:02,493 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 12:27:02,493 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 12:27:02,493 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 12:27:02,493 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 12:27:02,493 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 12:27:02,493 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 12:27:02,493 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 12:27:02,493 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 12:27:03,635 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 12:27:03,635 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-09...
2025-12-22 12:27:03,723 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240809 for 519 symbols
2025-12-22 12:27:51,273 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,909,201 trades
2025-12-22 12:27:51,273 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,909,201 rows
2025-12-22 12:28:20,518 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,499,633 trades
2025-12-22 12:28:20,519 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,499,633 rows
2025-12-22 12:29:05,041 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,865,592 trades
2025-12-22 12:29:05,041 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,865,592 rows
2025-12-22 12:29:28,022 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,607,261 trades
2025-12-22 12:29:28,022 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,607,261 rows
2025-12-22 12:30:31,119 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,318,420 trades
2025-12-22 12:30:31,119 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,318,420 rows
2025-12-22 12:30:58,923 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,883,257 trades
2025-12-22 12:30:58,924 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,883,257 rows
2025-12-22 12:32:27,396 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,152,011 trades
2025-12-22 12:32:27,396 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,152,011 rows
2025-12-22 12:33:04,435 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,127,303 trades
2025-12-22 12:33:04,441 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,127,303 rows
2025-12-22 12:33:31,387 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,902,238 trades
2025-12-22 12:33:31,387 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,902,238 rows
2025-12-22 12:34:10,783 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,550,569 trades
2025-12-22 12:34:10,783 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,550,569 rows
2025-12-22 12:34:11,162 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 22,815,485 total rows written
2025-12-22 12:34:25,409 INFO [src.stage_a.wrds_extractor]   Chunk 11: 924,241 trades
2025-12-22 12:34:25,410 INFO [src.stage_a.parquet_writer]   Chunk 11: 924,241 rows
2025-12-22 12:34:25,698 INFO [src.stage_a.parquet_writer] ✓ Wrote 23,739,726 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-09
2025-12-22 12:34:25,699 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 12:34:25,699 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 12:34:25,699 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 12:34:25,699 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 12:34:25,699 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 12:34:25,699 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 12:34:25,699 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 12:34:26,766 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 12:34:26,766 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-09...
2025-12-22 12:34:26,850 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240809 for 519 symbols
2025-12-22 12:35:08,173 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,068,884 NBBO records
2025-12-22 12:35:08,173 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,068,884 rows
2025-12-22 12:35:32,432 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,235,858 NBBO records
2025-12-22 12:35:32,432 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,235,858 rows
2025-12-22 12:36:12,016 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,210,454 NBBO records
2025-12-22 12:36:12,017 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,210,454 rows
2025-12-22 12:36:35,277 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,281,769 NBBO records
2025-12-22 12:36:35,278 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,281,769 rows
2025-12-22 12:37:16,517 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,747,383 NBBO records
2025-12-22 12:37:16,517 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,747,383 rows
2025-12-22 12:37:51,397 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,338,027 NBBO records
2025-12-22 12:37:51,397 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,338,027 rows
2025-12-22 12:38:45,965 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,222,103 NBBO records
2025-12-22 12:38:45,965 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,222,103 rows
2025-12-22 12:39:46,221 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,297,977 NBBO records
2025-12-22 12:39:46,222 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,297,977 rows
2025-12-22 12:40:28,096 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,098,563 NBBO records
2025-12-22 12:40:28,097 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,098,563 rows
2025-12-22 12:41:06,233 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,562,853 NBBO records
2025-12-22 12:41:06,233 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,562,853 rows
2025-12-22 12:41:06,524 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 38,063,871 total rows written
2025-12-22 12:42:13,535 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,777,432 NBBO records
2025-12-22 12:42:13,535 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,777,432 rows
2025-12-22 12:42:14,111 INFO [src.stage_a.parquet_writer] ✓ Wrote 44,841,303 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-09
2025-12-22 12:42:14,116 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 12:42:14,116 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 12:42:14,116 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 12:42:14,116 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 12:42:14,116 INFO [src.stage_a.stage_a] Trades: 23,739,726 rows
2025-12-22 12:42:14,116 INFO [src.stage_a.stage_a] Nbbo: 44,841,303 rows
2025-12-22 12:42:14,116 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 12:42:14,116 INFO [src.stage_a.stage_a] Processing date 42/140: 2024-08-12
2025-12-22 12:42:14,116 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 12:42:14,116 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 12:42:14,116 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-08-12 (519 symbols)
2025-12-22 12:42:14,116 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 12:42:14,116 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 12:42:14,116 INFO [src.stage_a.stage_a] Extract run ID: 2b8e1853-b138-49a8-9aa2-a3308a75807f
2025-12-22 12:42:14,124 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 12:42:14,124 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 12:42:14,124 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 12:42:14,124 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 12:42:14,124 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 12:42:14,124 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 12:42:14,124 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 12:42:14,124 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 12:42:14,124 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 12:42:15,194 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 12:42:15,195 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-12...
2025-12-22 12:42:15,256 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240812 for 519 symbols
2025-12-22 12:42:57,438 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,819,557 trades
2025-12-22 12:42:57,438 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,819,557 rows
2025-12-22 12:43:24,429 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,642,710 trades
2025-12-22 12:43:24,429 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,642,710 rows
2025-12-22 12:43:56,109 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,880,800 trades
2025-12-22 12:43:56,110 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,880,800 rows
2025-12-22 12:44:21,571 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,617,739 trades
2025-12-22 12:44:21,571 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,617,739 rows
2025-12-22 12:44:52,630 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,058,058 trades
2025-12-22 12:44:52,630 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,058,058 rows
2025-12-22 12:45:27,155 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,966,479 trades
2025-12-22 12:45:27,156 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,966,479 rows
2025-12-22 12:46:32,503 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,361,640 trades
2025-12-22 12:46:32,503 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,361,640 rows
2025-12-22 12:47:22,338 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,096,449 trades
2025-12-22 12:47:22,341 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,096,449 rows
2025-12-22 12:47:56,734 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,073,570 trades
2025-12-22 12:47:56,734 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,073,570 rows
2025-12-22 12:48:55,236 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,650,026 trades
2025-12-22 12:48:55,236 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,650,026 rows
2025-12-22 12:48:55,599 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,167,028 total rows written
2025-12-22 12:49:12,669 INFO [src.stage_a.wrds_extractor]   Chunk 11: 950,927 trades
2025-12-22 12:49:12,669 INFO [src.stage_a.parquet_writer]   Chunk 11: 950,927 rows
2025-12-22 12:49:12,974 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,117,955 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-12
2025-12-22 12:49:12,975 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 12:49:12,975 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 12:49:12,975 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 12:49:12,975 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 12:49:12,975 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 12:49:12,975 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 12:49:12,975 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 12:49:14,048 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 12:49:14,048 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-12...
2025-12-22 12:49:14,096 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240812 for 519 symbols
2025-12-22 12:49:59,030 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,832,325 NBBO records
2025-12-22 12:49:59,030 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,832,325 rows
2025-12-22 12:51:29,225 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,200,539 NBBO records
2025-12-22 12:51:29,225 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,200,539 rows
2025-12-22 12:55:01,300 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,355,973 NBBO records
2025-12-22 12:55:01,300 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,355,973 rows
2025-12-22 12:56:49,737 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,123,037 NBBO records
2025-12-22 12:56:49,737 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,123,037 rows
2025-12-22 12:58:16,080 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,451,088 NBBO records
2025-12-22 12:58:16,080 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,451,088 rows
2025-12-22 13:00:26,232 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,577,176 NBBO records
2025-12-22 13:00:26,232 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,577,176 rows
2025-12-22 13:03:25,200 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,221,884 NBBO records
2025-12-22 13:03:25,200 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,221,884 rows
2025-12-22 13:06:08,348 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,239,825 NBBO records
2025-12-22 13:06:08,348 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,239,825 rows
2025-12-22 13:08:26,331 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,786,437 NBBO records
2025-12-22 13:08:26,332 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,786,437 rows
2025-12-22 13:09:54,720 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,346,063 NBBO records
2025-12-22 13:09:54,720 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,346,063 rows
2025-12-22 13:09:55,006 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 37,134,347 total rows written
2025-12-22 13:14:12,124 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,717,094 NBBO records
2025-12-22 13:14:12,124 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,717,094 rows
2025-12-22 13:14:12,679 INFO [src.stage_a.parquet_writer] ✓ Wrote 43,851,441 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-12
2025-12-22 13:14:12,688 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 13:14:12,688 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 13:14:12,688 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 13:14:12,689 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 13:14:12,689 INFO [src.stage_a.stage_a] Trades: 24,117,955 rows
2025-12-22 13:14:12,689 INFO [src.stage_a.stage_a] Nbbo: 43,851,441 rows
2025-12-22 13:14:12,689 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 13:14:12,689 INFO [src.stage_a.stage_a] Processing date 43/140: 2024-08-13
2025-12-22 13:14:12,689 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 13:14:12,689 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 13:14:12,689 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-08-13 (519 symbols)
2025-12-22 13:14:12,689 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 13:14:12,689 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 13:14:12,689 INFO [src.stage_a.stage_a] Extract run ID: 6a63f664-8538-4ce2-87c5-079aeacc8e00
2025-12-22 13:14:12,697 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 13:14:12,697 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 13:14:12,697 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 13:14:12,697 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 13:14:12,697 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 13:14:12,697 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 13:14:12,697 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 13:14:12,697 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 13:14:12,697 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 13:14:14,638 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 13:14:14,639 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-13...
2025-12-22 13:14:14,793 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240813 for 519 symbols
2025-12-22 13:16:46,795 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,975,699 trades
2025-12-22 13:16:46,795 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,975,699 rows
2025-12-22 13:19:16,880 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,739,961 trades
2025-12-22 13:19:16,880 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,739,961 rows
2025-12-22 13:22:53,154 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,569,167 trades
2025-12-22 13:22:53,154 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,569,167 rows
2025-12-22 13:24:23,224 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,619,747 trades
2025-12-22 13:24:23,224 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,619,747 rows
2025-12-22 13:27:06,293 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,211,617 trades
2025-12-22 13:27:06,294 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,211,617 rows
2025-12-22 13:29:35,118 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,970,902 trades
2025-12-22 13:29:35,118 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,970,902 rows
2025-12-22 13:35:06,005 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,483,689 trades
2025-12-22 13:35:06,005 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,483,689 rows
2025-12-22 13:38:08,827 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,244,346 trades
2025-12-22 13:38:08,836 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,244,346 rows
2025-12-22 13:41:47,541 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,853,586 trades
2025-12-22 13:41:47,541 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,853,586 rows
2025-12-22 13:45:03,909 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,771,530 trades
2025-12-22 13:45:03,909 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,771,530 rows
2025-12-22 13:45:04,291 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,440,244 total rows written
2025-12-22 13:46:17,181 INFO [src.stage_a.wrds_extractor]   Chunk 11: 980,142 trades
2025-12-22 13:46:17,181 INFO [src.stage_a.parquet_writer]   Chunk 11: 980,142 rows
2025-12-22 13:46:17,497 INFO [src.stage_a.parquet_writer] ✓ Wrote 26,420,386 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-13
2025-12-22 13:46:17,498 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 13:46:17,498 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 13:46:17,498 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 13:46:17,498 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 13:46:17,498 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 13:46:17,498 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 13:46:17,498 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 13:46:20,434 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 13:46:20,434 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-13...
2025-12-22 13:46:20,643 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240813 for 519 symbols
2025-12-22 13:49:01,474 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,385,165 NBBO records
2025-12-22 13:49:01,474 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,385,165 rows
2025-12-22 13:50:47,075 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,900,493 NBBO records
2025-12-22 13:50:47,075 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,900,493 rows
2025-12-22 13:53:27,343 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,726,773 NBBO records
2025-12-22 13:53:27,344 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,726,773 rows
2025-12-22 13:55:07,098 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,922,995 NBBO records
2025-12-22 13:55:07,098 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,922,995 rows
2025-12-22 13:57:17,121 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,957,065 NBBO records
2025-12-22 13:57:17,121 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,957,065 rows
2025-12-22 13:59:31,749 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,898,835 NBBO records
2025-12-22 13:59:31,749 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,898,835 rows
2025-12-22 14:03:05,367 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,577,098 NBBO records
2025-12-22 14:03:05,367 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,577,098 rows
2025-12-22 14:05:39,896 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,671,937 NBBO records
2025-12-22 14:05:39,897 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,671,937 rows
2025-12-22 14:08:52,745 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,416,482 NBBO records
2025-12-22 14:08:52,745 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,416,482 rows
2025-12-22 14:11:16,685 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,905,615 NBBO records
2025-12-22 14:11:16,685 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,905,615 rows
2025-12-22 14:11:16,936 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 31,362,458 total rows written
2025-12-22 14:13:28,865 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,993,888 NBBO records
2025-12-22 14:13:28,865 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,993,888 rows
2025-12-22 14:13:29,320 INFO [src.stage_a.parquet_writer] ✓ Wrote 36,356,346 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-13
2025-12-22 14:13:29,325 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 14:13:29,325 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 14:13:29,325 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 14:13:29,325 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 14:13:29,325 INFO [src.stage_a.stage_a] Trades: 26,420,386 rows
2025-12-22 14:13:29,325 INFO [src.stage_a.stage_a] Nbbo: 36,356,346 rows
2025-12-22 14:13:29,325 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 14:13:29,325 INFO [src.stage_a.stage_a] Processing date 44/140: 2024-08-14
2025-12-22 14:13:29,325 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 14:13:29,325 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 14:13:29,325 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-08-14 (519 symbols)
2025-12-22 14:13:29,325 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 14:13:29,325 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 14:13:29,325 INFO [src.stage_a.stage_a] Extract run ID: 7fe5b99e-e00e-45b2-9967-96c17ed807a7
2025-12-22 14:13:29,333 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 14:13:29,333 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 14:13:29,333 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 14:13:29,333 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 14:13:29,333 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 14:13:29,333 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 14:13:29,333 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 14:13:29,333 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 14:13:29,333 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 14:13:30,613 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 14:13:30,613 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-14...
2025-12-22 14:13:30,688 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240814 for 519 symbols
2025-12-22 14:17:01,691 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,774,420 trades
2025-12-22 14:17:01,691 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,774,420 rows
2025-12-22 14:19:03,285 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,564,403 trades
2025-12-22 14:19:03,286 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,564,403 rows
2025-12-22 14:20:49,989 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,918,842 trades
2025-12-22 14:20:49,989 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,918,842 rows
2025-12-22 14:22:50,498 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,502,339 trades
2025-12-22 14:22:50,498 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,502,339 rows
2025-12-22 14:26:10,621 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,404,011 trades
2025-12-22 14:26:10,622 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,404,011 rows
2025-12-22 14:28:06,493 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,915,251 trades
2025-12-22 14:28:06,493 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,915,251 rows
2025-12-22 14:31:22,900 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,438,867 trades
2025-12-22 14:31:22,900 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,438,867 rows
2025-12-22 14:33:36,985 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,063,066 trades
2025-12-22 14:33:36,992 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,063,066 rows
2025-12-22 14:35:19,936 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,183,353 trades
2025-12-22 14:35:19,936 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,183,353 rows
2025-12-22 14:36:09,773 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,550,706 trades
2025-12-22 14:36:09,773 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,550,706 rows
2025-12-22 14:36:10,139 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,315,258 total rows written
2025-12-22 14:36:21,334 INFO [src.stage_a.wrds_extractor]   Chunk 11: 873,510 trades
2025-12-22 14:36:21,334 INFO [src.stage_a.parquet_writer]   Chunk 11: 873,510 rows
2025-12-22 14:36:21,618 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,188,768 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-14
2025-12-22 14:36:21,619 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 14:36:21,619 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 14:36:21,619 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 14:36:21,619 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 14:36:21,619 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 14:36:21,619 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 14:36:21,619 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 14:36:22,774 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 14:36:22,774 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-14...
2025-12-22 14:36:22,827 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240814 for 519 symbols
2025-12-22 14:36:59,772 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,445,097 NBBO records
2025-12-22 14:36:59,772 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,445,097 rows
2025-12-22 14:37:22,575 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,928,349 NBBO records
2025-12-22 14:37:22,575 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,928,349 rows
2025-12-22 14:38:07,042 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,013,916 NBBO records
2025-12-22 14:38:07,042 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,013,916 rows
2025-12-22 14:38:25,504 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,840,413 NBBO records
2025-12-22 14:38:25,504 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,840,413 rows
2025-12-22 14:39:01,169 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,071,982 NBBO records
2025-12-22 14:39:01,169 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,071,982 rows
2025-12-22 14:39:42,273 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,075,406 NBBO records
2025-12-22 14:39:42,273 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,075,406 rows
2025-12-22 14:41:00,554 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,015,131 NBBO records
2025-12-22 14:41:00,554 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,015,131 rows
2025-12-22 14:43:37,515 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,553,509 NBBO records
2025-12-22 14:43:37,516 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,553,509 rows
2025-12-22 14:45:47,004 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,568,087 NBBO records
2025-12-22 14:45:47,004 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,568,087 rows
2025-12-22 14:48:20,175 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,219,274 NBBO records
2025-12-22 14:48:20,175 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,219,274 rows
2025-12-22 14:48:20,454 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 33,731,164 total rows written
2025-12-22 14:52:07,622 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,340,155 NBBO records
2025-12-22 14:52:07,622 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,340,155 rows
2025-12-22 14:52:08,106 INFO [src.stage_a.parquet_writer] ✓ Wrote 39,071,319 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-14
2025-12-22 14:52:08,114 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 14:52:08,114 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 14:52:08,114 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 14:52:08,114 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 14:52:08,114 INFO [src.stage_a.stage_a] Trades: 24,188,768 rows
2025-12-22 14:52:08,114 INFO [src.stage_a.stage_a] Nbbo: 39,071,319 rows
2025-12-22 14:52:08,114 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 14:52:08,114 INFO [src.stage_a.stage_a] Processing date 45/140: 2024-08-15
2025-12-22 14:52:08,114 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 14:52:08,114 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 14:52:08,114 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-08-15 (519 symbols)
2025-12-22 14:52:08,114 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 14:52:08,114 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 14:52:08,114 INFO [src.stage_a.stage_a] Extract run ID: a2236edd-68b2-418e-88de-c23abde39d94
2025-12-22 14:52:08,122 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 14:52:08,122 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 14:52:08,122 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 14:52:08,122 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 14:52:08,122 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 14:52:08,122 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 14:52:08,122 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 14:52:08,122 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 14:52:08,122 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 14:52:09,242 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 14:52:09,242 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-15...
2025-12-22 14:52:09,313 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240815 for 519 symbols
2025-12-22 14:53:26,161 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,314,973 trades
2025-12-22 14:53:26,161 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,314,973 rows
2025-12-22 14:55:34,828 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,835,051 trades
2025-12-22 14:55:34,828 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,835,051 rows
2025-12-22 14:58:44,172 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,287,385 trades
2025-12-22 14:58:44,172 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,287,385 rows
2025-12-22 15:00:56,436 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,641,322 trades
2025-12-22 15:00:56,436 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,641,322 rows
2025-12-22 15:03:49,425 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,412,593 trades
2025-12-22 15:03:49,425 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,412,593 rows
2025-12-22 15:06:26,713 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,052,050 trades
2025-12-22 15:06:26,713 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,052,050 rows
2025-12-22 15:11:35,953 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,577,463 trades
2025-12-22 15:11:35,954 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,577,463 rows
2025-12-22 15:14:40,808 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,385,262 trades
2025-12-22 15:14:40,813 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,385,262 rows
2025-12-22 15:17:08,998 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,368,117 trades
2025-12-22 15:17:08,998 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,368,117 rows
2025-12-22 15:20:53,646 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,099,263 trades
2025-12-22 15:20:53,646 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,099,263 rows
2025-12-22 15:20:54,047 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,973,479 total rows written
2025-12-22 15:21:35,395 INFO [src.stage_a.wrds_extractor]   Chunk 11: 901,043 trades
2025-12-22 15:21:35,395 INFO [src.stage_a.parquet_writer]   Chunk 11: 901,043 rows
2025-12-22 15:21:35,682 INFO [src.stage_a.parquet_writer] ✓ Wrote 26,874,522 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-15
2025-12-22 15:21:35,683 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 15:21:35,683 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 15:21:35,683 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 15:21:35,683 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 15:21:35,683 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 15:21:35,683 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 15:21:35,683 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 15:21:36,809 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 15:21:36,810 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-15...
2025-12-22 15:21:37,053 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240815 for 519 symbols
2025-12-22 15:24:09,893 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,325,354 NBBO records
2025-12-22 15:24:09,893 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,325,354 rows
2025-12-22 15:25:32,901 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,924,496 NBBO records
2025-12-22 15:25:32,901 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,924,496 rows
2025-12-22 15:27:36,297 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,532,222 NBBO records
2025-12-22 15:27:36,297 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,532,222 rows
2025-12-22 15:28:59,798 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,899,891 NBBO records
2025-12-22 15:28:59,798 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,899,891 rows
2025-12-22 15:30:52,406 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,987,303 NBBO records
2025-12-22 15:30:52,406 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,987,303 rows
2025-12-22 15:32:50,169 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,002,161 NBBO records
2025-12-22 15:32:50,169 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,002,161 rows
2025-12-22 15:36:35,428 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,875,375 NBBO records
2025-12-22 15:36:35,428 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,875,375 rows
2025-12-22 15:38:44,034 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,885,643 NBBO records
2025-12-22 15:38:44,035 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,885,643 rows
2025-12-22 15:41:33,667 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,786,457 NBBO records
2025-12-22 15:41:33,667 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,786,457 rows
2025-12-22 15:43:25,483 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,204,929 NBBO records
2025-12-22 15:43:25,483 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,204,929 rows
2025-12-22 15:43:25,756 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 31,423,831 total rows written
2025-12-22 15:46:59,843 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,610,006 NBBO records
2025-12-22 15:46:59,843 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,610,006 rows
2025-12-22 15:47:00,250 INFO [src.stage_a.parquet_writer] ✓ Wrote 36,033,837 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-15
2025-12-22 15:47:00,255 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 15:47:00,255 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 15:47:00,255 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 15:47:00,255 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 15:47:00,255 INFO [src.stage_a.stage_a] Trades: 26,874,522 rows
2025-12-22 15:47:00,255 INFO [src.stage_a.stage_a] Nbbo: 36,033,837 rows
2025-12-22 15:47:00,255 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 15:47:00,255 INFO [src.stage_a.stage_a] Processing date 46/140: 2024-08-16
2025-12-22 15:47:00,255 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 15:47:00,255 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 15:47:00,255 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-08-16 (519 symbols)
2025-12-22 15:47:00,255 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 15:47:00,255 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 15:47:00,255 INFO [src.stage_a.stage_a] Extract run ID: 22c8c4c1-67bb-4f08-9c0d-bfb65185952f
2025-12-22 15:47:00,263 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 15:47:00,263 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 15:47:00,263 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 15:47:00,263 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 15:47:00,263 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 15:47:00,263 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 15:47:00,263 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 15:47:00,263 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 15:47:00,263 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 15:47:02,710 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 15:47:02,710 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-16...
2025-12-22 15:47:02,782 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240816 for 519 symbols
2025-12-22 15:49:47,465 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,785,403 trades
2025-12-22 15:49:47,465 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,785,403 rows
2025-12-22 15:51:52,943 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,570,539 trades
2025-12-22 15:51:52,943 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,570,539 rows
2025-12-22 15:54:01,475 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,813,374 trades
2025-12-22 15:54:01,475 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,813,374 rows
2025-12-22 15:55:40,246 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,447,691 trades
2025-12-22 15:55:40,246 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,447,691 rows
2025-12-22 15:57:26,512 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,055,544 trades
2025-12-22 15:57:26,512 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,055,544 rows
2025-12-22 15:59:54,844 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,732,297 trades
2025-12-22 15:59:54,844 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,732,297 rows
2025-12-22 16:04:11,097 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,012,760 trades
2025-12-22 16:04:11,097 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,012,760 rows
2025-12-22 16:06:30,688 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,092,295 trades
2025-12-22 16:06:30,691 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,092,295 rows
2025-12-22 16:08:07,552 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,895,591 trades
2025-12-22 16:08:07,552 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,895,591 rows
2025-12-22 16:11:22,418 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,609,373 trades
2025-12-22 16:11:22,418 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,609,373 rows
2025-12-22 16:11:22,776 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 22,014,867 total rows written
2025-12-22 16:12:11,306 INFO [src.stage_a.wrds_extractor]   Chunk 11: 770,351 trades
2025-12-22 16:12:11,306 INFO [src.stage_a.parquet_writer]   Chunk 11: 770,351 rows
2025-12-22 16:12:11,542 INFO [src.stage_a.parquet_writer] ✓ Wrote 22,785,218 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-16
2025-12-22 16:12:11,543 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 16:12:11,543 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 16:12:11,543 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 16:12:11,543 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 16:12:11,543 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 16:12:11,543 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 16:12:11,543 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 16:12:14,320 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 16:12:14,321 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-16...
2025-12-22 16:12:14,421 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240816 for 519 symbols
2025-12-22 16:13:49,441 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,180,925 NBBO records
2025-12-22 16:13:49,441 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,180,925 rows
2025-12-22 16:15:02,567 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,607,809 NBBO records
2025-12-22 16:15:02,567 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,607,809 rows
2025-12-22 16:17:34,155 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,416,563 NBBO records
2025-12-22 16:17:34,155 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,416,563 rows
2025-12-22 16:18:31,318 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,651,031 NBBO records
2025-12-22 16:18:31,319 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,651,031 rows
2025-12-22 16:20:15,470 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,929,570 NBBO records
2025-12-22 16:20:15,471 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,929,570 rows
2025-12-22 16:22:00,416 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,876,883 NBBO records
2025-12-22 16:22:00,416 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,876,883 rows
2025-12-22 16:24:20,295 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,321,437 NBBO records
2025-12-22 16:24:20,295 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,321,437 rows
2025-12-22 16:26:38,904 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,040,000 NBBO records
2025-12-22 16:26:38,904 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,040,000 rows
2025-12-22 16:27:57,955 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,650,667 NBBO records
2025-12-22 16:27:57,955 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,650,667 rows
2025-12-22 16:29:30,975 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,819,686 NBBO records
2025-12-22 16:29:30,975 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,819,686 rows
2025-12-22 16:29:31,223 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 29,494,571 total rows written
2025-12-22 16:31:42,449 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,426,903 NBBO records
2025-12-22 16:31:42,449 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,426,903 rows
2025-12-22 16:31:42,841 INFO [src.stage_a.parquet_writer] ✓ Wrote 33,921,474 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-16
2025-12-22 16:31:42,846 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 16:31:42,847 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 16:31:42,847 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 16:31:42,847 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 16:31:42,847 INFO [src.stage_a.stage_a] Trades: 22,785,218 rows
2025-12-22 16:31:42,847 INFO [src.stage_a.stage_a] Nbbo: 33,921,474 rows
2025-12-22 16:31:42,847 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 16:31:42,847 INFO [src.stage_a.stage_a] Processing date 47/140: 2024-08-19
2025-12-22 16:31:42,847 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 16:31:42,847 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 16:31:42,847 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-08-19 (519 symbols)
2025-12-22 16:31:42,847 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 16:31:42,847 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 16:31:42,847 INFO [src.stage_a.stage_a] Extract run ID: e7104163-05cd-4151-9da6-925e8e204435
2025-12-22 16:31:42,855 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 16:31:42,855 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 16:31:42,855 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 16:31:42,855 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 16:31:42,855 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 16:31:42,855 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 16:31:42,855 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 16:31:42,855 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 16:31:42,855 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 16:31:45,098 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 16:31:45,098 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-19...
2025-12-22 16:31:45,332 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240819 for 519 symbols
2025-12-22 16:34:28,217 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,926,946 trades
2025-12-22 16:34:28,217 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,926,946 rows
2025-12-22 16:35:28,432 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,433,622 trades
2025-12-22 16:35:28,432 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,433,622 rows
2025-12-22 16:36:48,857 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,688,108 trades
2025-12-22 16:36:48,858 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,688,108 rows
2025-12-22 16:38:13,492 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,447,825 trades
2025-12-22 16:38:13,493 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,447,825 rows
2025-12-22 16:39:42,703 INFO [src.stage_a.wrds_extractor]   Chunk 5: 1,996,661 trades
2025-12-22 16:39:42,704 INFO [src.stage_a.parquet_writer]   Chunk 5: 1,996,661 rows
2025-12-22 16:40:56,518 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,680,884 trades
2025-12-22 16:40:56,518 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,680,884 rows
2025-12-22 16:44:37,380 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,072,544 trades
2025-12-22 16:44:37,380 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,072,544 rows
2025-12-22 16:46:17,735 INFO [src.stage_a.wrds_extractor]   Chunk 8: 1,935,979 trades
2025-12-22 16:46:17,739 INFO [src.stage_a.parquet_writer]   Chunk 8: 1,935,979 rows
2025-12-22 16:47:48,586 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,849,781 trades
2025-12-22 16:47:48,587 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,849,781 rows
2025-12-22 16:50:26,310 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,556,681 trades
2025-12-22 16:50:26,310 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,556,681 rows
2025-12-22 16:50:26,664 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 21,589,031 total rows written
2025-12-22 16:50:53,640 INFO [src.stage_a.wrds_extractor]   Chunk 11: 764,369 trades
2025-12-22 16:50:53,640 INFO [src.stage_a.parquet_writer]   Chunk 11: 764,369 rows
2025-12-22 16:50:53,893 INFO [src.stage_a.parquet_writer] ✓ Wrote 22,353,400 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-19
2025-12-22 16:50:53,893 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 16:50:53,894 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 16:50:53,894 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 16:50:53,894 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 16:50:53,894 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 16:50:53,894 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 16:50:53,894 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 16:50:56,551 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 16:50:56,551 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-19...
2025-12-22 16:50:56,762 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240819 for 519 symbols
2025-12-22 16:53:12,253 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,951,327 NBBO records
2025-12-22 16:53:12,253 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,951,327 rows
2025-12-22 16:54:19,913 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,391,809 NBBO records
2025-12-22 16:54:19,913 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,391,809 rows
2025-12-22 16:56:05,230 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,042,904 NBBO records
2025-12-22 16:56:05,230 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,042,904 rows
2025-12-22 16:57:35,029 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,579,175 NBBO records
2025-12-22 16:57:35,030 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,579,175 rows
2025-12-22 16:59:46,544 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,548,336 NBBO records
2025-12-22 16:59:46,544 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,548,336 rows
2025-12-22 17:01:13,182 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,285,213 NBBO records
2025-12-22 17:01:13,183 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,285,213 rows
2025-12-22 17:04:41,525 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,311,203 NBBO records
2025-12-22 17:04:41,525 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,311,203 rows
2025-12-22 17:07:22,036 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,421,340 NBBO records
2025-12-22 17:07:22,036 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,421,340 rows
2025-12-22 17:09:31,516 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,360,544 NBBO records
2025-12-22 17:09:31,517 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,360,544 rows
2025-12-22 17:10:56,500 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,619,934 NBBO records
2025-12-22 17:10:56,501 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,619,934 rows
2025-12-22 17:10:56,747 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,511,785 total rows written
2025-12-22 17:14:31,091 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,017,479 NBBO records
2025-12-22 17:14:31,092 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,017,479 rows
2025-12-22 17:14:31,484 INFO [src.stage_a.parquet_writer] ✓ Wrote 30,529,264 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-19
2025-12-22 17:14:31,487 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 17:14:31,487 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 17:14:31,487 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 17:14:31,487 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 17:14:31,487 INFO [src.stage_a.stage_a] Trades: 22,353,400 rows
2025-12-22 17:14:31,487 INFO [src.stage_a.stage_a] Nbbo: 30,529,264 rows
2025-12-22 17:14:31,487 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 17:14:31,487 INFO [src.stage_a.stage_a] Processing date 48/140: 2024-08-20
2025-12-22 17:14:31,487 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 17:14:31,487 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 17:14:31,487 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-08-20 (519 symbols)
2025-12-22 17:14:31,487 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 17:14:31,487 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 17:14:31,487 INFO [src.stage_a.stage_a] Extract run ID: 858639cc-c9f4-4c60-9c5c-35455bca97ca
2025-12-22 17:14:31,495 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 17:14:31,495 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 17:14:31,495 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 17:14:31,495 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 17:14:31,495 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 17:14:31,495 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 17:14:31,495 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 17:14:31,495 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 17:14:31,495 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 17:14:34,060 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 17:14:34,060 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-20...
2025-12-22 17:14:34,170 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240820 for 519 symbols
2025-12-22 17:16:51,505 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,813,950 trades
2025-12-22 17:16:51,505 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,813,950 rows
2025-12-22 17:18:38,659 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,512,265 trades
2025-12-22 17:18:38,659 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,512,265 rows
2025-12-22 17:20:40,691 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,653,033 trades
2025-12-22 17:20:40,691 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,653,033 rows
2025-12-22 17:21:42,594 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,473,486 trades
2025-12-22 17:21:42,595 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,473,486 rows
2025-12-22 17:23:49,305 INFO [src.stage_a.wrds_extractor]   Chunk 5: 1,895,987 trades
2025-12-22 17:23:49,305 INFO [src.stage_a.parquet_writer]   Chunk 5: 1,895,987 rows
2025-12-22 17:25:48,689 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,759,002 trades
2025-12-22 17:25:48,690 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,759,002 rows
2025-12-22 17:29:20,452 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,982,312 trades
2025-12-22 17:29:20,452 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,982,312 rows
2025-12-22 17:32:16,451 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,253,255 trades
2025-12-22 17:32:16,456 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,253,255 rows
2025-12-22 17:34:13,179 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,799,343 trades
2025-12-22 17:34:13,179 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,799,343 rows
2025-12-22 17:36:49,190 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,478,749 trades
2025-12-22 17:36:49,190 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,478,749 rows
2025-12-22 17:36:49,537 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 21,621,382 total rows written
2025-12-22 17:37:42,139 INFO [src.stage_a.wrds_extractor]   Chunk 11: 847,997 trades
2025-12-22 17:37:42,139 INFO [src.stage_a.parquet_writer]   Chunk 11: 847,997 rows
2025-12-22 17:37:42,395 INFO [src.stage_a.parquet_writer] ✓ Wrote 22,469,379 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-20
2025-12-22 17:37:42,396 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 17:37:42,396 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 17:37:42,396 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 17:37:42,396 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 17:37:42,396 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 17:37:42,396 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 17:37:42,396 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 17:37:45,483 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 17:37:45,483 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-20...
2025-12-22 17:37:45,676 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240820 for 519 symbols
2025-12-22 17:40:00,439 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,117,486 NBBO records
2025-12-22 17:40:00,439 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,117,486 rows
2025-12-22 17:41:10,683 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,504,477 NBBO records
2025-12-22 17:41:10,683 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,504,477 rows
2025-12-22 17:43:08,332 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,086,020 NBBO records
2025-12-22 17:43:08,332 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,086,020 rows
2025-12-22 17:44:20,764 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,701,763 NBBO records
2025-12-22 17:44:20,764 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,701,763 rows
2025-12-22 17:46:14,536 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,646,733 NBBO records
2025-12-22 17:46:14,536 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,646,733 rows
2025-12-22 17:47:41,287 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,625,241 NBBO records
2025-12-22 17:47:41,288 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,625,241 rows
2025-12-22 17:50:51,757 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,690,756 NBBO records
2025-12-22 17:50:51,757 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,690,756 rows
2025-12-22 17:53:31,761 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,062,074 NBBO records
2025-12-22 17:53:31,761 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,062,074 rows
2025-12-22 17:55:36,609 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,605,371 NBBO records
2025-12-22 17:55:36,609 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,605,371 rows
2025-12-22 17:57:05,575 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,735,799 NBBO records
2025-12-22 17:57:05,575 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,735,799 rows
2025-12-22 17:57:05,820 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 28,775,720 total rows written
2025-12-22 17:59:48,322 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,718,245 NBBO records
2025-12-22 17:59:48,323 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,718,245 rows
2025-12-22 17:59:48,737 INFO [src.stage_a.parquet_writer] ✓ Wrote 33,493,965 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-20
2025-12-22 17:59:48,741 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 17:59:48,741 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 17:59:48,741 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 17:59:48,741 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 17:59:48,741 INFO [src.stage_a.stage_a] Trades: 22,469,379 rows
2025-12-22 17:59:48,741 INFO [src.stage_a.stage_a] Nbbo: 33,493,965 rows
2025-12-22 17:59:48,741 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 17:59:48,741 INFO [src.stage_a.stage_a] Processing date 49/140: 2024-08-21
2025-12-22 17:59:48,741 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 17:59:48,741 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 17:59:48,741 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-08-21 (519 symbols)
2025-12-22 17:59:48,741 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 17:59:48,741 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 17:59:48,741 INFO [src.stage_a.stage_a] Extract run ID: bcc0fc01-a890-489c-807d-75f92f0273ef
2025-12-22 17:59:48,749 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 17:59:48,749 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 17:59:48,749 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 17:59:48,749 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 17:59:48,749 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 17:59:48,749 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 17:59:48,749 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 17:59:48,749 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 17:59:48,749 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 17:59:51,185 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 17:59:51,185 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-21...
2025-12-22 17:59:51,313 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240821 for 519 symbols
2025-12-22 18:02:21,865 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,709,539 trades
2025-12-22 18:02:21,865 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,709,539 rows
2025-12-22 18:03:27,584 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,563,346 trades
2025-12-22 18:03:27,584 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,563,346 rows
2025-12-22 18:05:03,249 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,632,725 trades
2025-12-22 18:05:03,250 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,632,725 rows
2025-12-22 18:06:26,686 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,343,153 trades
2025-12-22 18:06:26,686 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,343,153 rows
2025-12-22 18:07:55,160 INFO [src.stage_a.wrds_extractor]   Chunk 5: 1,899,072 trades
2025-12-22 18:07:55,160 INFO [src.stage_a.parquet_writer]   Chunk 5: 1,899,072 rows
2025-12-22 18:09:24,036 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,680,213 trades
2025-12-22 18:09:24,037 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,680,213 rows
2025-12-22 18:12:43,491 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,681,430 trades
2025-12-22 18:12:43,491 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,681,430 rows
2025-12-22 18:14:10,663 INFO [src.stage_a.wrds_extractor]   Chunk 8: 1,925,030 trades
2025-12-22 18:14:10,667 INFO [src.stage_a.parquet_writer]   Chunk 8: 1,925,030 rows
2025-12-22 18:16:28,797 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,019,551 trades
2025-12-22 18:16:28,797 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,019,551 rows
2025-12-22 18:18:30,744 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,389,211 trades
2025-12-22 18:18:30,744 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,389,211 rows
2025-12-22 18:18:31,074 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 20,843,270 total rows written
2025-12-22 18:19:27,130 INFO [src.stage_a.wrds_extractor]   Chunk 11: 777,296 trades
2025-12-22 18:19:27,131 INFO [src.stage_a.parquet_writer]   Chunk 11: 777,296 rows
2025-12-22 18:19:27,376 INFO [src.stage_a.parquet_writer] ✓ Wrote 21,620,566 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-21
2025-12-22 18:19:27,377 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 18:19:27,377 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 18:19:27,377 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 18:19:27,377 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 18:19:27,377 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 18:19:27,377 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 18:19:27,377 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 18:19:29,842 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 18:19:29,842 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-21...
2025-12-22 18:19:30,054 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240821 for 519 symbols
2025-12-22 18:21:52,519 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,349,494 NBBO records
2025-12-22 18:21:52,519 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,349,494 rows
2025-12-22 18:22:37,510 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,763,302 NBBO records
2025-12-22 18:22:37,510 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,763,302 rows
2025-12-22 18:24:52,235 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,726,601 NBBO records
2025-12-22 18:24:52,235 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,726,601 rows
2025-12-22 18:26:23,893 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,849,663 NBBO records
2025-12-22 18:26:23,893 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,849,663 rows
2025-12-22 18:28:08,846 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,107,930 NBBO records
2025-12-22 18:28:08,846 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,107,930 rows
2025-12-22 18:30:05,611 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,003,459 NBBO records
2025-12-22 18:30:05,611 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,003,459 rows
2025-12-22 18:33:06,674 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,677,442 NBBO records
2025-12-22 18:33:06,675 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,677,442 rows
2025-12-22 18:35:24,548 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,463,974 NBBO records
2025-12-22 18:35:24,549 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,463,974 rows
2025-12-22 18:37:39,894 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,049,875 NBBO records
2025-12-22 18:37:39,894 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,049,875 rows
2025-12-22 18:39:51,492 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,344,545 NBBO records
2025-12-22 18:39:51,492 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,344,545 rows
2025-12-22 18:39:51,758 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 32,336,285 total rows written
2025-12-22 18:42:54,726 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,619,600 NBBO records
2025-12-22 18:42:54,726 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,619,600 rows
2025-12-22 18:42:55,204 INFO [src.stage_a.parquet_writer] ✓ Wrote 37,955,885 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-21
2025-12-22 18:42:55,209 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 18:42:55,209 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 18:42:55,209 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 18:42:55,209 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 18:42:55,209 INFO [src.stage_a.stage_a] Trades: 21,620,566 rows
2025-12-22 18:42:55,209 INFO [src.stage_a.stage_a] Nbbo: 37,955,885 rows
2025-12-22 18:42:55,209 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 18:42:55,209 INFO [src.stage_a.stage_a] Processing date 50/140: 2024-08-22
2025-12-22 18:42:55,209 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 18:42:55,209 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 18:42:55,209 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-08-22 (519 symbols)
2025-12-22 18:42:55,209 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 18:42:55,209 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 18:42:55,209 INFO [src.stage_a.stage_a] Extract run ID: 48c8c4d3-8bc4-4dc6-80ea-f49a341e5431
2025-12-22 18:42:55,217 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 18:42:55,217 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 18:42:55,217 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 18:42:55,217 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 18:42:55,217 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 18:42:55,217 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 18:42:55,217 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 18:42:55,217 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 18:42:55,217 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 18:42:58,081 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 18:42:58,081 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-22...
2025-12-22 18:42:58,175 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240822 for 519 symbols
2025-12-22 18:46:08,865 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,027,073 trades
2025-12-22 18:46:08,865 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,027,073 rows
2025-12-22 18:47:33,205 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,558,580 trades
2025-12-22 18:47:33,205 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,558,580 rows
2025-12-22 18:49:11,358 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,673,120 trades
2025-12-22 18:49:11,358 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,673,120 rows
2025-12-22 18:50:32,319 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,351,967 trades
2025-12-22 18:50:32,319 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,351,967 rows
2025-12-22 18:52:52,450 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,077,830 trades
2025-12-22 18:52:52,450 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,077,830 rows
2025-12-22 18:54:22,423 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,735,671 trades
2025-12-22 18:54:22,423 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,735,671 rows
2025-12-22 18:59:47,838 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,508,030 trades
2025-12-22 18:59:47,839 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,508,030 rows
2025-12-22 19:02:46,622 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,066,884 trades
2025-12-22 19:02:46,626 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,066,884 rows
2025-12-22 19:04:53,650 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,046,579 trades
2025-12-22 19:04:53,650 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,046,579 rows
2025-12-22 19:08:05,777 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,655,288 trades
2025-12-22 19:08:05,777 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,655,288 rows
2025-12-22 19:08:06,139 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 22,701,022 total rows written
2025-12-22 19:08:52,625 INFO [src.stage_a.wrds_extractor]   Chunk 11: 777,158 trades
2025-12-22 19:08:52,625 INFO [src.stage_a.parquet_writer]   Chunk 11: 777,158 rows
2025-12-22 19:08:52,875 INFO [src.stage_a.parquet_writer] ✓ Wrote 23,478,180 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-22
2025-12-22 19:08:52,876 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 19:08:52,876 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 19:08:52,876 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 19:08:52,876 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 19:08:52,876 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 19:08:52,876 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 19:08:52,876 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 19:08:55,194 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 19:08:55,194 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-22...
2025-12-22 19:08:55,275 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240822 for 519 symbols
2025-12-22 19:11:45,992 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,359,023 NBBO records
2025-12-22 19:11:45,992 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,359,023 rows
2025-12-22 19:13:14,366 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,975,557 NBBO records
2025-12-22 19:13:14,366 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,975,557 rows
2025-12-22 19:16:34,284 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,418,627 NBBO records
2025-12-22 19:16:34,284 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,418,627 rows
2025-12-22 19:18:15,906 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,977,099 NBBO records
2025-12-22 19:18:15,906 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,977,099 rows
2025-12-22 19:21:17,056 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,959,131 NBBO records
2025-12-22 19:21:17,056 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,959,131 rows
2025-12-22 19:24:08,950 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,601,119 NBBO records
2025-12-22 19:24:08,950 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,601,119 rows
2025-12-22 19:29:12,813 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,345,153 NBBO records
2025-12-22 19:29:12,813 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,345,153 rows
2025-12-22 19:34:00,706 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,654,682 NBBO records
2025-12-22 19:34:00,707 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,654,682 rows
2025-12-22 19:36:47,472 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,822,703 NBBO records
2025-12-22 19:36:47,473 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,822,703 rows
2025-12-22 19:39:04,969 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,527,842 NBBO records
2025-12-22 19:39:04,969 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,527,842 rows
2025-12-22 19:39:05,254 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 39,640,936 total rows written
2025-12-22 19:43:56,322 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,613,809 NBBO records
2025-12-22 19:43:56,322 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,613,809 rows
2025-12-22 19:43:56,872 INFO [src.stage_a.parquet_writer] ✓ Wrote 46,254,745 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-22
2025-12-22 19:43:56,880 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 19:43:56,880 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 19:43:56,880 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 19:43:56,880 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 19:43:56,880 INFO [src.stage_a.stage_a] Trades: 23,478,180 rows
2025-12-22 19:43:56,880 INFO [src.stage_a.stage_a] Nbbo: 46,254,745 rows
2025-12-22 19:43:56,881 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 19:43:56,881 INFO [src.stage_a.stage_a] Processing date 51/140: 2024-08-23
2025-12-22 19:43:56,881 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 19:43:56,881 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 19:43:56,881 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-08-23 (519 symbols)
2025-12-22 19:43:56,881 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 19:43:56,881 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 19:43:56,881 INFO [src.stage_a.stage_a] Extract run ID: 4782965b-2be0-47f8-b077-db30ccc095be
2025-12-22 19:43:56,889 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 19:43:56,889 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 19:43:56,889 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 19:43:56,889 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 19:43:56,889 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 19:43:56,889 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 19:43:56,889 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 19:43:56,889 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 19:43:56,889 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 19:43:59,982 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 19:43:59,983 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-23...
2025-12-22 19:44:00,182 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240823 for 519 symbols
2025-12-22 19:46:37,626 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,713,458 trades
2025-12-22 19:46:37,626 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,713,458 rows
2025-12-22 19:48:31,814 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,753,454 trades
2025-12-22 19:48:31,814 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,753,454 rows
2025-12-22 19:50:36,068 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,719,730 trades
2025-12-22 19:50:36,069 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,719,730 rows
2025-12-22 19:51:41,845 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,335,924 trades
2025-12-22 19:51:41,845 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,335,924 rows
2025-12-22 19:54:16,222 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,079,026 trades
2025-12-22 19:54:16,222 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,079,026 rows
2025-12-22 19:56:32,205 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,907,041 trades
2025-12-22 19:56:32,206 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,907,041 rows
2025-12-22 20:00:36,825 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,332,417 trades
2025-12-22 20:00:36,825 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,332,417 rows
2025-12-22 20:02:38,721 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,112,100 trades
2025-12-22 20:02:38,725 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,112,100 rows
2025-12-22 20:04:40,626 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,023,742 trades
2025-12-22 20:04:40,626 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,023,742 rows
2025-12-22 20:07:19,952 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,616,509 trades
2025-12-22 20:07:19,953 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,616,509 rows
2025-12-22 20:07:20,306 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 22,593,401 total rows written
2025-12-22 20:08:40,855 INFO [src.stage_a.wrds_extractor]   Chunk 11: 810,384 trades
2025-12-22 20:08:40,855 INFO [src.stage_a.parquet_writer]   Chunk 11: 810,384 rows
2025-12-22 20:08:41,110 INFO [src.stage_a.parquet_writer] ✓ Wrote 23,403,785 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-23
2025-12-22 20:08:41,112 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 20:08:41,112 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 20:08:41,112 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 20:08:41,112 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 20:08:41,112 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 20:08:41,112 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 20:08:41,112 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 20:08:45,974 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 20:08:45,974 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-23...
2025-12-22 20:08:46,402 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240823 for 519 symbols
2025-12-22 20:10:57,544 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,505,960 NBBO records
2025-12-22 20:10:57,544 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,505,960 rows
2025-12-22 20:12:29,458 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,257,038 NBBO records
2025-12-22 20:12:29,458 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,257,038 rows
2025-12-22 20:15:28,053 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,632,894 NBBO records
2025-12-22 20:15:28,053 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,632,894 rows
2025-12-22 20:17:02,103 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,301,723 NBBO records
2025-12-22 20:17:02,104 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,301,723 rows
2025-12-22 20:19:54,593 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,099,912 NBBO records
2025-12-22 20:19:54,593 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,099,912 rows
2025-12-22 20:22:22,916 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,892,588 NBBO records
2025-12-22 20:22:22,916 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,892,588 rows
2025-12-22 20:26:12,983 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,111,021 NBBO records
2025-12-22 20:26:12,983 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,111,021 rows
2025-12-22 20:29:15,082 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,438,562 NBBO records
2025-12-22 20:29:15,083 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,438,562 rows
2025-12-22 20:32:00,316 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,345,985 NBBO records
2025-12-22 20:32:00,317 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,345,985 rows
2025-12-22 20:34:42,745 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,996,582 NBBO records
2025-12-22 20:34:42,746 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,996,582 rows
2025-12-22 20:34:43,045 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 41,582,265 total rows written
2025-12-22 20:39:59,569 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,562,514 NBBO records
2025-12-22 20:39:59,570 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,562,514 rows
2025-12-22 20:40:00,190 INFO [src.stage_a.parquet_writer] ✓ Wrote 49,144,779 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-23
2025-12-22 20:40:00,195 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 20:40:00,195 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 20:40:00,195 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 20:40:00,195 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 20:40:00,195 INFO [src.stage_a.stage_a] Trades: 23,403,785 rows
2025-12-22 20:40:00,195 INFO [src.stage_a.stage_a] Nbbo: 49,144,779 rows
2025-12-22 20:40:00,195 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 20:40:00,195 INFO [src.stage_a.stage_a] Processing date 52/140: 2024-08-26
2025-12-22 20:40:00,195 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 20:40:00,195 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 20:40:00,195 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-08-26 (519 symbols)
2025-12-22 20:40:00,195 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 20:40:00,195 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 20:40:00,195 INFO [src.stage_a.stage_a] Extract run ID: 9452a847-c1ca-47bf-af76-f2caa2bbf986
2025-12-22 20:40:00,203 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 20:40:00,203 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 20:40:00,203 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 20:40:00,203 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 20:40:00,203 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 20:40:00,203 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 20:40:00,203 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 20:40:00,203 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 20:40:00,203 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 20:40:02,547 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 20:40:02,547 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-26...
2025-12-22 20:40:02,826 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240826 for 519 symbols
2025-12-22 20:43:25,701 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,737,695 trades
2025-12-22 20:43:25,701 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,737,695 rows
2025-12-22 20:45:14,300 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,547,285 trades
2025-12-22 20:45:14,300 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,547,285 rows
2025-12-22 20:47:45,944 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,682,583 trades
2025-12-22 20:47:45,944 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,682,583 rows
2025-12-22 20:49:31,606 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,364,097 trades
2025-12-22 20:49:31,607 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,364,097 rows
2025-12-22 20:51:41,942 INFO [src.stage_a.wrds_extractor]   Chunk 5: 1,821,769 trades
2025-12-22 20:51:41,942 INFO [src.stage_a.parquet_writer]   Chunk 5: 1,821,769 rows
2025-12-22 20:53:33,111 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,719,047 trades
2025-12-22 20:53:33,112 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,719,047 rows
2025-12-22 20:58:10,687 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,255,683 trades
2025-12-22 20:58:10,687 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,255,683 rows
2025-12-22 21:00:21,524 INFO [src.stage_a.wrds_extractor]   Chunk 8: 1,920,908 trades
2025-12-22 21:00:21,529 INFO [src.stage_a.parquet_writer]   Chunk 8: 1,920,908 rows
2025-12-22 21:02:26,406 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,957,720 trades
2025-12-22 21:02:26,406 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,957,720 rows
2025-12-22 21:05:22,099 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,429,128 trades
2025-12-22 21:05:22,100 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,429,128 rows
2025-12-22 21:05:22,454 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 21,435,915 total rows written
2025-12-22 21:06:00,125 INFO [src.stage_a.wrds_extractor]   Chunk 11: 770,221 trades
2025-12-22 21:06:00,125 INFO [src.stage_a.parquet_writer]   Chunk 11: 770,221 rows
2025-12-22 21:06:00,349 INFO [src.stage_a.parquet_writer] ✓ Wrote 22,206,136 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-26
2025-12-22 21:06:00,349 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 21:06:00,349 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 21:06:00,349 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 21:06:00,349 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 21:06:00,349 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 21:06:00,349 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 21:06:00,349 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 21:06:02,633 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 21:06:02,634 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-26...
2025-12-22 21:06:02,785 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240826 for 519 symbols
2025-12-22 21:08:57,082 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,548,215 NBBO records
2025-12-22 21:08:57,082 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,548,215 rows
2025-12-22 21:09:37,963 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,635,035 NBBO records
2025-12-22 21:09:37,963 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,635,035 rows
2025-12-22 21:11:19,153 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,311,627 NBBO records
2025-12-22 21:11:19,153 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,311,627 rows
2025-12-22 21:11:43,808 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,762,068 NBBO records
2025-12-22 21:11:43,808 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,762,068 rows
2025-12-22 21:12:39,027 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,186,277 NBBO records
2025-12-22 21:12:39,027 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,186,277 rows
2025-12-22 21:13:19,917 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,896,031 NBBO records
2025-12-22 21:13:19,917 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,896,031 rows
2025-12-22 21:14:22,572 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,071,124 NBBO records
2025-12-22 21:14:22,572 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,071,124 rows
2025-12-22 21:16:51,534 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,200,778 NBBO records
2025-12-22 21:16:51,535 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,200,778 rows
2025-12-22 21:18:20,643 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,790,680 NBBO records
2025-12-22 21:18:20,644 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,790,680 rows
2025-12-22 21:20:52,370 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,891,813 NBBO records
2025-12-22 21:20:52,370 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,891,813 rows
2025-12-22 21:20:52,621 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 31,293,648 total rows written
2025-12-22 21:23:28,036 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,761,118 NBBO records
2025-12-22 21:23:28,036 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,761,118 rows
2025-12-22 21:23:28,470 INFO [src.stage_a.parquet_writer] ✓ Wrote 36,054,766 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-26
2025-12-22 21:23:28,475 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 21:23:28,475 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 21:23:28,475 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 21:23:28,475 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 21:23:28,475 INFO [src.stage_a.stage_a] Trades: 22,206,136 rows
2025-12-22 21:23:28,475 INFO [src.stage_a.stage_a] Nbbo: 36,054,766 rows
2025-12-22 21:23:28,475 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 21:23:28,475 INFO [src.stage_a.stage_a] Processing date 53/140: 2024-08-27
2025-12-22 21:23:28,475 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 21:23:28,475 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 21:23:28,475 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-08-27 (519 symbols)
2025-12-22 21:23:28,475 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 21:23:28,475 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 21:23:28,475 INFO [src.stage_a.stage_a] Extract run ID: 66a2092d-5d09-4b76-9b30-63646ba4dc4f
2025-12-22 21:23:28,483 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 21:23:28,483 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 21:23:28,483 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 21:23:28,483 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 21:23:28,483 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 21:23:28,483 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 21:23:28,483 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 21:23:28,483 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 21:23:28,483 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 21:23:31,123 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 21:23:31,124 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-27...
2025-12-22 21:23:31,406 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240827 for 519 symbols
2025-12-22 21:26:32,420 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,540,574 trades
2025-12-22 21:26:32,420 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,540,574 rows
2025-12-22 21:27:27,036 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,442,191 trades
2025-12-22 21:27:27,036 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,442,191 rows
2025-12-22 21:29:23,829 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,610,594 trades
2025-12-22 21:29:23,829 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,610,594 rows
2025-12-22 21:30:47,587 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,199,717 trades
2025-12-22 21:30:47,588 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,199,717 rows
2025-12-22 21:32:14,392 INFO [src.stage_a.wrds_extractor]   Chunk 5: 1,759,565 trades
2025-12-22 21:32:14,393 INFO [src.stage_a.parquet_writer]   Chunk 5: 1,759,565 rows
2025-12-22 21:34:39,437 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,587,759 trades
2025-12-22 21:34:39,438 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,587,759 rows
2025-12-22 21:37:01,001 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,779,648 trades
2025-12-22 21:37:01,001 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,779,648 rows
2025-12-22 21:39:06,801 INFO [src.stage_a.wrds_extractor]   Chunk 8: 1,766,952 trades
2025-12-22 21:39:06,805 INFO [src.stage_a.parquet_writer]   Chunk 8: 1,766,952 rows
2025-12-22 21:40:58,230 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,942,257 trades
2025-12-22 21:40:58,230 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,942,257 rows
2025-12-22 21:42:01,504 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,301,114 trades
2025-12-22 21:42:01,504 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,301,114 rows
2025-12-22 21:42:01,850 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 19,930,371 total rows written
2025-12-22 21:42:19,913 INFO [src.stage_a.wrds_extractor]   Chunk 11: 708,355 trades
2025-12-22 21:42:19,913 INFO [src.stage_a.parquet_writer]   Chunk 11: 708,355 rows
2025-12-22 21:42:20,150 INFO [src.stage_a.parquet_writer] ✓ Wrote 20,638,726 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-27
2025-12-22 21:42:20,151 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 21:42:20,151 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 21:42:20,151 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 21:42:20,151 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 21:42:20,151 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 21:42:20,151 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 21:42:20,151 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 21:42:21,366 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 21:42:21,367 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-27...
2025-12-22 21:42:21,431 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240827 for 519 symbols
2025-12-22 21:42:58,595 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,792,136 NBBO records
2025-12-22 21:42:58,595 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,792,136 rows
2025-12-22 21:43:13,354 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,388,417 NBBO records
2025-12-22 21:43:13,354 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,388,417 rows
2025-12-22 21:45:12,890 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,076,236 NBBO records
2025-12-22 21:45:12,890 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,076,236 rows
2025-12-22 21:45:51,505 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,427,362 NBBO records
2025-12-22 21:45:51,505 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,427,362 rows
2025-12-22 21:47:41,208 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,519,696 NBBO records
2025-12-22 21:47:41,208 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,519,696 rows
2025-12-22 21:49:31,598 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,441,388 NBBO records
2025-12-22 21:49:31,598 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,441,388 rows
2025-12-22 21:52:19,232 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,223,133 NBBO records
2025-12-22 21:52:19,233 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,223,133 rows
2025-12-22 21:54:08,316 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,553,915 NBBO records
2025-12-22 21:54:08,316 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,553,915 rows
2025-12-22 21:54:47,202 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,879,471 NBBO records
2025-12-22 21:54:47,202 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,879,471 rows
2025-12-22 21:55:13,915 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,207,001 NBBO records
2025-12-22 21:55:13,915 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,207,001 rows
2025-12-22 21:55:14,143 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,508,755 total rows written
2025-12-22 21:56:04,598 INFO [src.stage_a.wrds_extractor]   Chunk 11: 3,934,017 NBBO records
2025-12-22 21:56:04,598 INFO [src.stage_a.parquet_writer]   Chunk 11: 3,934,017 rows
2025-12-22 21:56:04,967 INFO [src.stage_a.parquet_writer] ✓ Wrote 30,442,772 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-27
2025-12-22 21:56:04,971 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 21:56:04,971 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 21:56:04,971 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 21:56:04,971 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 21:56:04,971 INFO [src.stage_a.stage_a] Trades: 20,638,726 rows
2025-12-22 21:56:04,971 INFO [src.stage_a.stage_a] Nbbo: 30,442,772 rows
2025-12-22 21:56:04,971 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 21:56:04,971 INFO [src.stage_a.stage_a] Processing date 54/140: 2024-08-28
2025-12-22 21:56:04,971 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 21:56:04,971 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 21:56:04,971 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-08-28 (519 symbols)
2025-12-22 21:56:04,971 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 21:56:04,971 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 21:56:04,971 INFO [src.stage_a.stage_a] Extract run ID: d6a2ff57-979d-487b-ae19-024e6e0b9b02
2025-12-22 21:56:04,979 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 21:56:04,979 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 21:56:04,979 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 21:56:04,979 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 21:56:04,979 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 21:56:04,979 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 21:56:04,979 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 21:56:04,979 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 21:56:04,979 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 21:56:06,108 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 21:56:06,108 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-28...
2025-12-22 21:56:06,168 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240828 for 519 symbols
2025-12-22 21:57:15,420 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,637,429 trades
2025-12-22 21:57:15,420 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,637,429 rows
2025-12-22 21:58:00,461 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,641,695 trades
2025-12-22 21:58:00,461 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,641,695 rows
2025-12-22 21:59:24,252 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,851,525 trades
2025-12-22 21:59:24,252 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,851,525 rows
2025-12-22 22:00:52,715 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,255,799 trades
2025-12-22 22:00:52,715 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,255,799 rows
2025-12-22 22:02:48,792 INFO [src.stage_a.wrds_extractor]   Chunk 5: 1,968,316 trades
2025-12-22 22:02:48,792 INFO [src.stage_a.parquet_writer]   Chunk 5: 1,968,316 rows
2025-12-22 22:04:05,201 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,712,510 trades
2025-12-22 22:04:05,202 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,712,510 rows
2025-12-22 22:05:48,259 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,682,940 trades
2025-12-22 22:05:48,259 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,682,940 rows
2025-12-22 22:06:47,327 INFO [src.stage_a.wrds_extractor]   Chunk 8: 1,910,942 trades
2025-12-22 22:06:47,333 INFO [src.stage_a.parquet_writer]   Chunk 8: 1,910,942 rows
2025-12-22 22:07:29,471 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,711,404 trades
2025-12-22 22:07:29,471 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,711,404 rows
2025-12-22 22:09:26,346 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,386,245 trades
2025-12-22 22:09:26,346 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,386,245 rows
2025-12-22 22:09:26,683 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 22,758,805 total rows written
2025-12-22 22:10:31,869 INFO [src.stage_a.wrds_extractor]   Chunk 11: 764,727 trades
2025-12-22 22:10:31,869 INFO [src.stage_a.parquet_writer]   Chunk 11: 764,727 rows
2025-12-22 22:10:32,114 INFO [src.stage_a.parquet_writer] ✓ Wrote 23,523,532 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-28
2025-12-22 22:10:32,115 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 22:10:32,115 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 22:10:32,115 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 22:10:32,115 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 22:10:32,115 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 22:10:32,115 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 22:10:32,115 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 22:10:34,323 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 22:10:34,323 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-28...
2025-12-22 22:10:34,511 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240828 for 519 symbols
2025-12-22 22:12:35,646 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,322,247 NBBO records
2025-12-22 22:12:35,646 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,322,247 rows
2025-12-22 22:13:31,186 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,829,053 NBBO records
2025-12-22 22:13:31,186 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,829,053 rows
2025-12-22 22:15:55,088 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,622,208 NBBO records
2025-12-22 22:15:55,088 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,622,208 rows
2025-12-22 22:17:02,580 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,747,298 NBBO records
2025-12-22 22:17:02,581 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,747,298 rows
2025-12-22 22:18:49,184 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,309,294 NBBO records
2025-12-22 22:18:49,184 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,309,294 rows
2025-12-22 22:20:36,075 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,778,473 NBBO records
2025-12-22 22:20:36,075 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,778,473 rows
2025-12-22 22:23:37,925 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,460,788 NBBO records
2025-12-22 22:23:37,925 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,460,788 rows
2025-12-22 22:26:29,507 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,356,631 NBBO records
2025-12-22 22:26:29,508 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,356,631 rows
2025-12-22 22:28:20,261 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,596,993 NBBO records
2025-12-22 22:28:20,261 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,596,993 rows
2025-12-22 22:29:10,454 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,705,659 NBBO records
2025-12-22 22:29:10,454 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,705,659 rows
2025-12-22 22:29:10,708 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 32,728,644 total rows written
2025-12-22 22:30:17,595 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,239,408 NBBO records
2025-12-22 22:30:17,595 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,239,408 rows
2025-12-22 22:30:18,056 INFO [src.stage_a.parquet_writer] ✓ Wrote 37,968,052 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-28
2025-12-22 22:30:18,061 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 22:30:18,061 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 22:30:18,061 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 22:30:18,061 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 22:30:18,061 INFO [src.stage_a.stage_a] Trades: 23,523,532 rows
2025-12-22 22:30:18,061 INFO [src.stage_a.stage_a] Nbbo: 37,968,052 rows
2025-12-22 22:30:18,061 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 22:30:18,061 INFO [src.stage_a.stage_a] Processing date 55/140: 2024-08-29
2025-12-22 22:30:18,061 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 22:30:18,061 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 22:30:18,061 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-08-29 (519 symbols)
2025-12-22 22:30:18,061 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 22:30:18,061 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 22:30:18,061 INFO [src.stage_a.stage_a] Extract run ID: 5d2cb464-dbc3-4dc9-8b5b-a0329d7d6e73
2025-12-22 22:30:18,069 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 22:30:18,069 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 22:30:18,069 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 22:30:18,069 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 22:30:18,069 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 22:30:18,069 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 22:30:18,069 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 22:30:18,069 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 22:30:18,069 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 22:30:19,439 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 22:30:19,439 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-29...
2025-12-22 22:30:19,520 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240829 for 519 symbols
2025-12-22 22:31:06,997 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,956,587 trades
2025-12-22 22:31:06,997 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,956,587 rows
2025-12-22 22:31:38,322 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,756,647 trades
2025-12-22 22:31:38,322 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,756,647 rows
2025-12-22 22:33:11,916 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,343,130 trades
2025-12-22 22:33:11,916 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,343,130 rows
2025-12-22 22:34:30,067 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,360,667 trades
2025-12-22 22:34:30,068 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,360,667 rows
2025-12-22 22:36:27,106 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,267,376 trades
2025-12-22 22:36:27,106 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,267,376 rows
2025-12-22 22:38:01,574 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,823,938 trades
2025-12-22 22:38:01,574 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,823,938 rows
2025-12-22 22:42:52,155 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,478,315 trades
2025-12-22 22:42:52,155 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,478,315 rows
2025-12-22 22:43:29,429 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,267,839 trades
2025-12-22 22:43:29,444 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,267,839 rows
2025-12-22 22:44:06,109 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,115,415 trades
2025-12-22 22:44:06,109 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,115,415 rows
2025-12-22 22:46:21,844 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,549,818 trades
2025-12-22 22:46:21,844 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,549,818 rows
2025-12-22 22:46:22,196 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 24,919,732 total rows written
2025-12-22 22:47:14,020 INFO [src.stage_a.wrds_extractor]   Chunk 11: 898,976 trades
2025-12-22 22:47:14,020 INFO [src.stage_a.parquet_writer]   Chunk 11: 898,976 rows
2025-12-22 22:47:14,286 INFO [src.stage_a.parquet_writer] ✓ Wrote 25,818,708 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-29
2025-12-22 22:47:14,287 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 22:47:14,287 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 22:47:14,287 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 22:47:14,287 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 22:47:14,287 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 22:47:14,287 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 22:47:14,287 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 22:47:16,120 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 22:47:16,121 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-29...
2025-12-22 22:47:16,217 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240829 for 519 symbols
2025-12-22 22:49:50,289 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,374,202 NBBO records
2025-12-22 22:49:50,289 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,374,202 rows
2025-12-22 22:50:18,117 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,151,064 NBBO records
2025-12-22 22:50:18,118 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,151,064 rows
2025-12-22 22:51:23,845 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,256,932 NBBO records
2025-12-22 22:51:23,845 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,256,932 rows
2025-12-22 22:51:51,393 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,042,631 NBBO records
2025-12-22 22:51:51,393 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,042,631 rows
2025-12-22 22:52:52,707 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,918,091 NBBO records
2025-12-22 22:52:52,707 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,918,091 rows
2025-12-22 22:53:55,291 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,612,648 NBBO records
2025-12-22 22:53:55,292 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,612,648 rows
2025-12-22 22:55:37,900 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,743,422 NBBO records
2025-12-22 22:55:37,900 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,743,422 rows
2025-12-22 22:58:51,698 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,534,941 NBBO records
2025-12-22 22:58:51,699 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,534,941 rows
2025-12-22 23:01:31,019 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,518,909 NBBO records
2025-12-22 23:01:31,019 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,518,909 rows
2025-12-22 23:03:03,258 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,316,204 NBBO records
2025-12-22 23:03:03,258 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,316,204 rows
2025-12-22 23:03:03,540 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 39,469,044 total rows written
2025-12-22 23:07:11,624 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,386,246 NBBO records
2025-12-22 23:07:11,624 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,386,246 rows
2025-12-22 23:07:12,156 INFO [src.stage_a.parquet_writer] ✓ Wrote 45,855,290 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-29
2025-12-22 23:07:12,160 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 23:07:12,160 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 23:07:12,160 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 23:07:12,160 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 23:07:12,160 INFO [src.stage_a.stage_a] Trades: 25,818,708 rows
2025-12-22 23:07:12,160 INFO [src.stage_a.stage_a] Nbbo: 45,855,290 rows
2025-12-22 23:07:12,160 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 23:07:12,160 INFO [src.stage_a.stage_a] Processing date 56/140: 2024-08-30
2025-12-22 23:07:12,160 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 23:07:12,160 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 23:07:12,160 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-08-30 (519 symbols)
2025-12-22 23:07:12,160 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 23:07:12,160 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 23:07:12,160 INFO [src.stage_a.stage_a] Extract run ID: 12cc8805-9e45-4500-9ec6-aac9edbb6bbe
2025-12-22 23:07:12,169 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 23:07:12,169 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 23:07:12,169 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 23:07:12,169 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 23:07:12,169 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 23:07:12,169 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 23:07:12,169 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 23:07:12,169 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 23:07:12,169 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 23:07:14,156 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 23:07:14,156 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-30...
2025-12-22 23:07:14,277 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240830 for 519 symbols
2025-12-22 23:09:33,864 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,849,983 trades
2025-12-22 23:09:33,864 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,849,983 rows
2025-12-22 23:11:05,815 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,747,748 trades
2025-12-22 23:11:05,815 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,747,748 rows
2025-12-22 23:12:43,144 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,057,502 trades
2025-12-22 23:12:43,144 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,057,502 rows
2025-12-22 23:13:52,127 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,382,886 trades
2025-12-22 23:13:52,128 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,382,886 rows
2025-12-22 23:15:49,267 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,391,080 trades
2025-12-22 23:15:49,267 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,391,080 rows
2025-12-22 23:17:46,187 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,908,774 trades
2025-12-22 23:17:46,187 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,908,774 rows
2025-12-22 23:21:38,999 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,141,469 trades
2025-12-22 23:21:38,999 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,141,469 rows
2025-12-22 23:22:26,333 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,177,169 trades
2025-12-22 23:22:26,336 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,177,169 rows
2025-12-22 23:23:20,942 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,034,762 trades
2025-12-22 23:23:20,942 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,034,762 rows
2025-12-22 23:24:14,356 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,575,101 trades
2025-12-22 23:24:14,356 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,575,101 rows
2025-12-22 23:24:14,718 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,266,474 total rows written
2025-12-22 23:24:46,873 INFO [src.stage_a.wrds_extractor]   Chunk 11: 884,464 trades
2025-12-22 23:24:46,873 INFO [src.stage_a.parquet_writer]   Chunk 11: 884,464 rows
2025-12-22 23:24:47,157 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,150,938 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-08-30
2025-12-22 23:24:47,158 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 23:24:47,158 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 23:24:47,158 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 23:24:47,158 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 23:24:47,158 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 23:24:47,158 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 23:24:47,158 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 23:24:48,267 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 23:24:48,268 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-30...
2025-12-22 23:24:48,341 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240830 for 519 symbols
2025-12-22 23:25:27,502 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,522,529 NBBO records
2025-12-22 23:25:27,502 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,522,529 rows
2025-12-22 23:26:12,062 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,935,277 NBBO records
2025-12-22 23:26:12,062 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,935,277 rows
2025-12-22 23:28:24,276 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,629,842 NBBO records
2025-12-22 23:28:24,276 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,629,842 rows
2025-12-22 23:29:47,380 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,791,123 NBBO records
2025-12-22 23:29:47,381 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,791,123 rows
2025-12-22 23:31:20,326 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,440,197 NBBO records
2025-12-22 23:31:20,327 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,440,197 rows
2025-12-22 23:31:58,126 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,021,478 NBBO records
2025-12-22 23:31:58,127 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,021,478 rows
2025-12-22 23:33:27,383 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,037,567 NBBO records
2025-12-22 23:33:27,383 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,037,567 rows
2025-12-22 23:35:39,153 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,637,568 NBBO records
2025-12-22 23:35:39,154 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,637,568 rows
2025-12-22 23:38:22,841 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,377,349 NBBO records
2025-12-22 23:38:22,841 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,377,349 rows
2025-12-22 23:40:18,349 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,837,758 NBBO records
2025-12-22 23:40:18,349 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,837,758 rows
2025-12-22 23:40:18,596 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 33,230,688 total rows written
2025-12-22 23:44:07,216 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,795,013 NBBO records
2025-12-22 23:44:07,216 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,795,013 rows
2025-12-22 23:44:07,696 INFO [src.stage_a.parquet_writer] ✓ Wrote 39,025,701 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-08-30
2025-12-22 23:44:07,700 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 23:44:07,700 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 23:44:07,700 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 23:44:07,700 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 23:44:07,700 INFO [src.stage_a.stage_a] Trades: 24,150,938 rows
2025-12-22 23:44:07,700 INFO [src.stage_a.stage_a] Nbbo: 39,025,701 rows
2025-12-22 23:44:07,700 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 23:44:07,700 INFO [src.stage_a.stage_a] Processing date 57/140: 2024-09-03
2025-12-22 23:44:07,700 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 23:44:07,700 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 23:44:07,700 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-09-03 (519 symbols)
2025-12-22 23:44:07,700 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 23:44:07,700 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 23:44:07,700 INFO [src.stage_a.stage_a] Extract run ID: 641b7cb5-bc73-4245-9b81-257bd88dc971
2025-12-22 23:44:07,709 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 23:44:07,709 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 23:44:07,709 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 23:44:07,709 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 23:44:07,709 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 23:44:07,709 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 23:44:07,709 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 23:44:07,709 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 23:44:07,709 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 23:44:10,386 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 23:44:10,387 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-03...
2025-12-22 23:44:10,491 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240903 for 519 symbols
2025-12-22 23:48:10,010 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,964,749 trades
2025-12-22 23:48:10,010 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,964,749 rows
2025-12-22 23:50:30,536 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,425,392 trades
2025-12-22 23:50:30,539 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,425,392 rows
2025-12-22 23:52:41,573 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,468,052 trades
2025-12-22 23:52:41,573 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,468,052 rows
2025-12-22 23:54:56,161 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,900,601 trades
2025-12-22 23:54:56,161 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,900,601 rows
2025-12-22 23:57:19,949 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,085,385 trades
2025-12-22 23:57:19,949 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,085,385 rows
2025-12-23 00:00:11,830 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,400,308 trades
2025-12-23 00:00:11,830 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,400,308 rows
2025-12-23 00:06:53,952 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,519,767 trades
2025-12-23 00:06:53,952 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,519,767 rows
2025-12-23 00:10:49,997 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,989,808 trades
2025-12-23 00:10:50,019 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,989,808 rows
2025-12-23 00:13:21,480 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,750,365 trades
2025-12-23 00:13:21,480 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,750,365 rows
2025-12-23 00:16:41,022 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,498,953 trades
2025-12-23 00:16:41,022 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,498,953 rows
2025-12-23 00:16:41,469 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 32,003,380 total rows written
2025-12-23 00:18:09,871 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,313,362 trades
2025-12-23 00:18:09,874 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,313,362 rows
2025-12-23 00:18:10,231 INFO [src.stage_a.parquet_writer] ✓ Wrote 33,316,742 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-03
2025-12-23 00:18:10,234 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 00:18:10,234 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 00:18:10,234 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 00:18:10,234 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 00:18:10,234 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 00:18:10,234 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 00:18:10,234 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 00:18:12,181 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 00:18:12,181 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-03...
2025-12-23 00:18:12,313 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240903 for 519 symbols
2025-12-23 00:21:00,785 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,235,345 NBBO records
2025-12-23 00:21:00,785 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,235,345 rows
2025-12-23 00:22:47,510 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,470,883 NBBO records
2025-12-23 00:22:47,510 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,470,883 rows
2025-12-23 00:26:00,451 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,523,013 NBBO records
2025-12-23 00:26:00,451 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,523,013 rows
2025-12-23 00:27:24,419 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,299,482 NBBO records
2025-12-23 00:27:24,419 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,299,482 rows
2025-12-23 00:30:08,409 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,931,685 NBBO records
2025-12-23 00:30:08,410 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,931,685 rows
2025-12-23 00:32:49,538 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,587,424 NBBO records
2025-12-23 00:32:49,538 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,587,424 rows
2025-12-23 00:37:18,071 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,209,479 NBBO records
2025-12-23 00:37:18,071 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,209,479 rows
2025-12-23 00:40:50,817 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,906,535 NBBO records
2025-12-23 00:40:50,818 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,906,535 rows
2025-12-23 00:43:16,668 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,848,478 NBBO records
2025-12-23 00:43:16,669 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,848,478 rows
2025-12-23 00:45:38,153 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,384,608 NBBO records
2025-12-23 00:45:38,154 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,384,608 rows
2025-12-23 00:45:38,450 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 39,396,932 total rows written
2025-12-23 00:50:28,770 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,567,551 NBBO records
2025-12-23 00:50:28,771 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,567,551 rows
2025-12-23 00:50:29,306 INFO [src.stage_a.parquet_writer] ✓ Wrote 45,964,483 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-03
2025-12-23 00:50:29,311 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 00:50:29,311 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 00:50:29,311 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 00:50:29,311 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 00:50:29,311 INFO [src.stage_a.stage_a] Trades: 33,316,742 rows
2025-12-23 00:50:29,311 INFO [src.stage_a.stage_a] Nbbo: 45,964,483 rows
2025-12-23 00:50:29,311 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 00:50:29,311 INFO [src.stage_a.stage_a] Processing date 58/140: 2024-09-04
2025-12-23 00:50:29,311 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 00:50:29,311 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 00:50:29,311 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-09-04 (519 symbols)
2025-12-23 00:50:29,311 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 00:50:29,311 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 00:50:29,311 INFO [src.stage_a.stage_a] Extract run ID: 4b403758-6185-4855-95f1-cd94793ae79a
2025-12-23 00:50:29,319 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 00:50:29,319 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 00:50:29,319 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 00:50:29,319 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 00:50:29,319 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 00:50:29,319 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 00:50:29,319 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 00:50:29,319 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 00:50:29,319 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 00:50:31,455 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 00:50:31,455 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-04...
2025-12-23 00:50:31,580 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240904 for 519 symbols
2025-12-23 00:54:13,931 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,191,427 trades
2025-12-23 00:54:13,932 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,191,427 rows
2025-12-23 00:56:03,821 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,924,821 trades
2025-12-23 00:56:03,821 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,924,821 rows
2025-12-23 00:57:59,174 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,376,222 trades
2025-12-23 00:57:59,174 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,376,222 rows
2025-12-23 00:59:22,207 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,569,543 trades
2025-12-23 00:59:22,208 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,569,543 rows
2025-12-23 01:01:40,775 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,515,040 trades
2025-12-23 01:01:40,775 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,515,040 rows
2025-12-23 01:03:57,460 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,107,999 trades
2025-12-23 01:03:57,460 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,107,999 rows
2025-12-23 01:09:01,554 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,046,832 trades
2025-12-23 01:09:01,554 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,046,832 rows
2025-12-23 01:11:20,118 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,394,190 trades
2025-12-23 01:11:20,123 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,394,190 rows
2025-12-23 01:13:22,263 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,309,989 trades
2025-12-23 01:13:22,263 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,309,989 rows
2025-12-23 01:15:55,761 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,042,058 trades
2025-12-23 01:15:55,761 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,042,058 rows
2025-12-23 01:15:56,143 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,478,121 total rows written
2025-12-23 01:17:12,649 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,194,346 trades
2025-12-23 01:17:12,649 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,194,346 rows
2025-12-23 01:17:12,968 INFO [src.stage_a.parquet_writer] ✓ Wrote 27,672,467 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-04
2025-12-23 01:17:12,969 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 01:17:12,969 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 01:17:12,969 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 01:17:12,969 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 01:17:12,969 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 01:17:12,969 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 01:17:12,969 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 01:17:14,328 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 01:17:14,328 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-04...
2025-12-23 01:17:14,399 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240904 for 519 symbols
2025-12-23 01:20:04,345 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,043,755 NBBO records
2025-12-23 01:20:04,345 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,043,755 rows
2025-12-23 01:21:15,974 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,388,011 NBBO records
2025-12-23 01:21:15,974 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,388,011 rows
2025-12-23 01:23:56,808 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,407,366 NBBO records
2025-12-23 01:23:56,808 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,407,366 rows
2025-12-23 01:25:42,770 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,303,165 NBBO records
2025-12-23 01:25:42,770 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,303,165 rows
2025-12-23 01:27:48,159 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,835,369 NBBO records
2025-12-23 01:27:48,160 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,835,369 rows
2025-12-23 01:30:06,084 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,611,044 NBBO records
2025-12-23 01:30:06,084 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,611,044 rows
2025-12-23 01:33:41,553 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,297,523 NBBO records
2025-12-23 01:33:41,553 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,297,523 rows
2025-12-23 01:37:08,632 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,638,381 NBBO records
2025-12-23 01:37:08,633 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,638,381 rows
2025-12-23 01:40:17,940 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,151,771 NBBO records
2025-12-23 01:40:17,941 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,151,771 rows
2025-12-23 01:42:45,624 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,681,703 NBBO records
2025-12-23 01:42:45,624 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,681,703 rows
2025-12-23 01:42:45,920 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 39,358,088 total rows written
2025-12-23 01:47:24,882 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,310,097 NBBO records
2025-12-23 01:47:24,882 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,310,097 rows
2025-12-23 01:47:25,412 INFO [src.stage_a.parquet_writer] ✓ Wrote 45,668,185 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-04
2025-12-23 01:47:25,416 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 01:47:25,416 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 01:47:25,416 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 01:47:25,416 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 01:47:25,416 INFO [src.stage_a.stage_a] Trades: 27,672,467 rows
2025-12-23 01:47:25,416 INFO [src.stage_a.stage_a] Nbbo: 45,668,185 rows
2025-12-23 01:47:25,416 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 01:47:25,416 INFO [src.stage_a.stage_a] Processing date 59/140: 2024-09-05
2025-12-23 01:47:25,416 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 01:47:25,416 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 01:47:25,416 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-09-05 (519 symbols)
2025-12-23 01:47:25,416 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 01:47:25,416 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 01:47:25,416 INFO [src.stage_a.stage_a] Extract run ID: 01d4c338-a2f7-4a8b-810f-c178f9b7970a
2025-12-23 01:47:25,424 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 01:47:25,424 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 01:47:25,424 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 01:47:25,424 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 01:47:25,424 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 01:47:25,424 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 01:47:25,424 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 01:47:25,424 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 01:47:25,424 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 01:47:28,426 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 01:47:28,426 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-05...
2025-12-23 01:47:28,559 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240905 for 519 symbols
2025-12-23 01:50:55,323 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,137,916 trades
2025-12-23 01:50:55,323 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,137,916 rows
2025-12-23 01:53:37,587 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,002,486 trades
2025-12-23 01:53:37,587 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,002,486 rows
2025-12-23 01:56:18,525 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,410,305 trades
2025-12-23 01:56:18,526 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,410,305 rows
2025-12-23 01:58:21,607 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,731,046 trades
2025-12-23 01:58:21,607 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,731,046 rows
2025-12-23 02:01:01,799 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,529,610 trades
2025-12-23 02:01:01,799 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,529,610 rows
2025-12-23 02:03:00,205 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,128,953 trades
2025-12-23 02:03:00,205 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,128,953 rows
2025-12-23 02:07:56,386 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,465,531 trades
2025-12-23 02:07:56,386 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,465,531 rows
2025-12-23 02:10:22,577 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,473,924 trades
2025-12-23 02:10:22,585 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,473,924 rows
2025-12-23 02:12:55,006 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,230,134 trades
2025-12-23 02:12:55,007 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,230,134 rows
2025-12-23 02:16:40,219 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,372,631 trades
2025-12-23 02:16:40,219 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,372,631 rows
2025-12-23 02:16:40,638 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,482,536 total rows written
2025-12-23 02:18:06,273 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,081,812 trades
2025-12-23 02:18:06,275 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,081,812 rows
2025-12-23 02:18:06,588 INFO [src.stage_a.parquet_writer] ✓ Wrote 27,564,348 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-05
2025-12-23 02:18:06,589 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 02:18:06,589 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 02:18:06,589 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 02:18:06,589 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 02:18:06,589 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 02:18:06,589 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 02:18:06,589 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 02:18:07,805 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 02:18:07,805 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-05...
2025-12-23 02:18:07,867 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240905 for 519 symbols
2025-12-23 02:20:35,619 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,041,773 NBBO records
2025-12-23 02:20:35,619 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,041,773 rows
2025-12-23 02:22:17,013 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,222,538 NBBO records
2025-12-23 02:22:17,013 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,222,538 rows
2025-12-23 02:24:39,837 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,974,060 NBBO records
2025-12-23 02:24:39,837 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,974,060 rows
2025-12-23 02:26:09,270 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,161,688 NBBO records
2025-12-23 02:26:09,271 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,161,688 rows
2025-12-23 02:28:26,576 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,930,228 NBBO records
2025-12-23 02:28:26,576 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,930,228 rows
2025-12-23 02:30:38,579 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,596,241 NBBO records
2025-12-23 02:30:38,579 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,596,241 rows
2025-12-23 02:33:30,862 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,038,137 NBBO records
2025-12-23 02:33:30,862 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,038,137 rows
2025-12-23 02:36:31,427 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,280,973 NBBO records
2025-12-23 02:36:31,427 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,280,973 rows
2025-12-23 02:38:53,333 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,851,869 NBBO records
2025-12-23 02:38:53,334 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,851,869 rows
2025-12-23 02:41:07,981 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,465,066 NBBO records
2025-12-23 02:41:07,981 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,465,066 rows
2025-12-23 02:41:08,263 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 37,562,573 total rows written
2025-12-23 02:44:42,902 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,513,949 NBBO records
2025-12-23 02:44:42,902 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,513,949 rows
2025-12-23 02:44:43,464 INFO [src.stage_a.parquet_writer] ✓ Wrote 44,076,522 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-05
2025-12-23 02:44:43,472 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 02:44:43,472 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 02:44:43,472 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 02:44:43,472 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 02:44:43,473 INFO [src.stage_a.stage_a] Trades: 27,564,348 rows
2025-12-23 02:44:43,473 INFO [src.stage_a.stage_a] Nbbo: 44,076,522 rows
2025-12-23 02:44:43,473 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 02:44:43,473 INFO [src.stage_a.stage_a] Processing date 60/140: 2024-09-06
2025-12-23 02:44:43,473 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 02:44:43,473 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 02:44:43,473 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-09-06 (519 symbols)
2025-12-23 02:44:43,473 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 02:44:43,473 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 02:44:43,473 INFO [src.stage_a.stage_a] Extract run ID: 43874fec-a8b3-4ba0-998d-6b62510079b3
2025-12-23 02:44:43,490 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 02:44:43,490 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 02:44:43,490 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 02:44:43,490 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 02:44:43,490 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 02:44:43,490 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 02:44:43,490 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 02:44:43,490 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 02:44:43,490 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 02:44:45,526 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 02:44:45,526 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-06...
2025-12-23 02:44:45,685 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240906 for 519 symbols
2025-12-23 02:48:51,331 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,905,060 trades
2025-12-23 02:48:51,331 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,905,060 rows
2025-12-23 02:51:17,834 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,045,102 trades
2025-12-23 02:51:17,836 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,045,102 rows
2025-12-23 02:53:36,872 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,234,854 trades
2025-12-23 02:53:36,872 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,234,854 rows
2025-12-23 02:55:05,535 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,655,393 trades
2025-12-23 02:55:05,535 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,655,393 rows
2025-12-23 02:57:47,632 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,856,021 trades
2025-12-23 02:57:47,632 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,856,021 rows
2025-12-23 02:59:41,388 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,154,354 trades
2025-12-23 02:59:41,388 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,154,354 rows
2025-12-23 03:05:36,253 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,634,907 trades
2025-12-23 03:05:36,263 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,634,907 rows
2025-12-23 03:08:29,097 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,817,504 trades
2025-12-23 03:08:29,120 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,817,504 rows
2025-12-23 03:11:05,842 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,482,174 trades
2025-12-23 03:11:05,842 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,482,174 rows
2025-12-23 03:14:44,261 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,453,381 trades
2025-12-23 03:14:44,261 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,453,381 rows
2025-12-23 03:14:44,725 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 29,238,750 total rows written
2025-12-23 03:16:00,938 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,213,329 trades
2025-12-23 03:16:00,941 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,213,329 rows
2025-12-23 03:16:01,315 INFO [src.stage_a.parquet_writer] ✓ Wrote 30,452,079 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-06
2025-12-23 03:16:01,316 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 03:16:01,316 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 03:16:01,316 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 03:16:01,316 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 03:16:01,316 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 03:16:01,316 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 03:16:01,316 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 03:16:03,216 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 03:16:03,216 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-06...
2025-12-23 03:16:03,293 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240906 for 519 symbols
2025-12-23 03:18:52,638 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,711,043 NBBO records
2025-12-23 03:18:52,638 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,711,043 rows
2025-12-23 03:20:30,329 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,683,669 NBBO records
2025-12-23 03:20:30,329 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,683,669 rows
2025-12-23 03:23:21,428 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,335,998 NBBO records
2025-12-23 03:23:21,428 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,335,998 rows
2025-12-23 03:24:39,511 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,470,228 NBBO records
2025-12-23 03:24:39,512 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,470,228 rows
2025-12-23 03:27:41,122 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,613,548 NBBO records
2025-12-23 03:27:41,122 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,613,548 rows
2025-12-23 03:29:43,230 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,244,654 NBBO records
2025-12-23 03:29:43,230 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,244,654 rows
2025-12-23 03:33:26,897 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,562,296 NBBO records
2025-12-23 03:33:26,898 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,562,296 rows
2025-12-23 03:37:28,544 INFO [src.stage_a.wrds_extractor]   Chunk 8: 6,634,462 NBBO records
2025-12-23 03:37:28,545 INFO [src.stage_a.parquet_writer]   Chunk 8: 6,634,462 rows
2025-12-23 03:40:10,010 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,858,347 NBBO records
2025-12-23 03:40:10,011 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,858,347 rows
2025-12-23 03:42:10,372 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,988,296 NBBO records
2025-12-23 03:42:10,372 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,988,296 rows
2025-12-23 03:42:10,699 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 46,102,541 total rows written
2025-12-23 03:46:20,289 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,859,305 NBBO records
2025-12-23 03:46:20,289 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,859,305 rows
2025-12-23 03:46:20,942 INFO [src.stage_a.parquet_writer] ✓ Wrote 53,961,846 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-06
2025-12-23 03:46:20,950 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 03:46:20,950 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 03:46:20,950 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 03:46:20,950 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 03:46:20,950 INFO [src.stage_a.stage_a] Trades: 30,452,079 rows
2025-12-23 03:46:20,950 INFO [src.stage_a.stage_a] Nbbo: 53,961,846 rows
2025-12-23 03:46:20,950 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 03:46:20,950 INFO [src.stage_a.stage_a] Processing date 61/140: 2024-09-09
2025-12-23 03:46:20,950 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 03:46:20,950 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 03:46:20,950 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-09-09 (519 symbols)
2025-12-23 03:46:20,950 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 03:46:20,950 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 03:46:20,950 INFO [src.stage_a.stage_a] Extract run ID: 55206faa-f43a-454e-bb26-33def4c4c921
2025-12-23 03:46:20,958 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 03:46:20,958 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 03:46:20,958 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 03:46:20,958 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 03:46:20,958 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 03:46:20,958 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 03:46:20,958 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 03:46:20,958 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 03:46:20,958 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 03:46:23,134 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 03:46:23,134 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-09...
2025-12-23 03:46:23,290 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240909 for 519 symbols
2025-12-23 03:50:17,395 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,587,899 trades
2025-12-23 03:50:17,395 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,587,899 rows
2025-12-23 03:52:54,327 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,078,058 trades
2025-12-23 03:52:54,328 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,078,058 rows
2025-12-23 03:55:19,683 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,229,694 trades
2025-12-23 03:55:19,683 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,229,694 rows
2025-12-23 03:57:21,213 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,795,468 trades
2025-12-23 03:57:21,213 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,795,468 rows
2025-12-23 04:00:49,756 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,818,330 trades
2025-12-23 04:00:49,756 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,818,330 rows
2025-12-23 04:03:08,037 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,219,213 trades
2025-12-23 04:03:08,038 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,219,213 rows
2025-12-23 04:07:05,047 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,326,901 trades
2025-12-23 04:07:05,047 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,326,901 rows
2025-12-23 04:09:51,458 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,635,426 trades
2025-12-23 04:09:51,485 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,635,426 rows
2025-12-23 04:12:00,015 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,335,143 trades
2025-12-23 04:12:00,015 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,335,143 rows
2025-12-23 04:14:50,092 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,123,403 trades
2025-12-23 04:14:50,092 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,123,403 rows
2025-12-23 04:14:50,531 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 27,149,535 total rows written
2025-12-23 04:15:23,957 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,127,645 trades
2025-12-23 04:15:23,957 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,127,645 rows
2025-12-23 04:15:24,287 INFO [src.stage_a.parquet_writer] ✓ Wrote 28,277,180 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-09
2025-12-23 04:15:24,288 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 04:15:24,288 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 04:15:24,288 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 04:15:24,288 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 04:15:24,288 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 04:15:24,288 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 04:15:24,288 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 04:15:27,038 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 04:15:27,038 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-09...
2025-12-23 04:15:27,207 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240909 for 519 symbols
2025-12-23 04:17:37,016 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,543,697 NBBO records
2025-12-23 04:17:37,016 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,543,697 rows
2025-12-23 04:18:54,327 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,116,623 NBBO records
2025-12-23 04:18:54,327 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,116,623 rows
2025-12-23 04:21:02,425 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,641,372 NBBO records
2025-12-23 04:21:02,425 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,641,372 rows
2025-12-23 04:22:26,533 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,007,214 NBBO records
2025-12-23 04:22:26,533 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,007,214 rows
2025-12-23 04:24:33,254 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,568,488 NBBO records
2025-12-23 04:24:33,254 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,568,488 rows
2025-12-23 04:26:43,910 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,147,499 NBBO records
2025-12-23 04:26:43,910 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,147,499 rows
2025-12-23 04:30:51,278 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,082,013 NBBO records
2025-12-23 04:30:51,279 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,082,013 rows
2025-12-23 04:33:51,345 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,705,504 NBBO records
2025-12-23 04:33:51,346 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,705,504 rows
2025-12-23 04:36:30,904 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,448,130 NBBO records
2025-12-23 04:36:30,904 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,448,130 rows
2025-12-23 04:38:19,121 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,997,431 NBBO records
2025-12-23 04:38:19,121 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,997,431 rows
2025-12-23 04:38:19,401 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 34,257,971 total rows written
2025-12-23 04:42:16,032 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,557,913 NBBO records
2025-12-23 04:42:16,033 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,557,913 rows
2025-12-23 04:42:16,519 INFO [src.stage_a.parquet_writer] ✓ Wrote 39,815,884 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-09
2025-12-23 04:42:16,523 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 04:42:16,523 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 04:42:16,523 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 04:42:16,523 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 04:42:16,523 INFO [src.stage_a.stage_a] Trades: 28,277,180 rows
2025-12-23 04:42:16,523 INFO [src.stage_a.stage_a] Nbbo: 39,815,884 rows
2025-12-23 04:42:16,523 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 04:42:16,523 INFO [src.stage_a.stage_a] Processing date 62/140: 2024-09-10
2025-12-23 04:42:16,523 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 04:42:16,523 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 04:42:16,523 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-09-10 (519 symbols)
2025-12-23 04:42:16,523 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 04:42:16,523 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 04:42:16,523 INFO [src.stage_a.stage_a] Extract run ID: 20dd7ddf-ec7b-4c18-8506-e16e67545fca
2025-12-23 04:42:16,531 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 04:42:16,531 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 04:42:16,531 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 04:42:16,531 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 04:42:16,531 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 04:42:16,531 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 04:42:16,531 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 04:42:16,531 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 04:42:16,531 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 04:42:17,616 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 04:42:17,616 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-10...
2025-12-23 04:42:17,680 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240910 for 519 symbols
2025-12-23 04:45:06,362 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,273,475 trades
2025-12-23 04:45:06,362 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,273,475 rows
2025-12-23 04:47:05,967 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,125,738 trades
2025-12-23 04:47:05,967 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,125,738 rows
2025-12-23 04:49:11,655 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,048,354 trades
2025-12-23 04:49:11,655 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,048,354 rows
2025-12-23 04:50:17,346 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,758,760 trades
2025-12-23 04:50:17,347 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,758,760 rows
2025-12-23 04:53:08,495 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,663,125 trades
2025-12-23 04:53:08,495 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,663,125 rows
2025-12-23 04:55:08,920 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,197,273 trades
2025-12-23 04:55:08,920 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,197,273 rows
2025-12-23 04:58:33,775 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,150,627 trades
2025-12-23 04:58:33,775 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,150,627 rows
2025-12-23 05:01:18,062 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,596,594 trades
2025-12-23 05:01:18,069 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,596,594 rows
2025-12-23 05:03:12,919 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,156,819 trades
2025-12-23 05:03:12,921 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,156,819 rows
2025-12-23 05:05:35,513 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,066,441 trades
2025-12-23 05:05:35,513 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,066,441 rows
2025-12-23 05:05:35,921 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,037,206 total rows written
2025-12-23 05:06:39,283 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,190,915 trades
2025-12-23 05:06:39,283 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,190,915 rows
2025-12-23 05:06:39,609 INFO [src.stage_a.parquet_writer] ✓ Wrote 27,228,121 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-10
2025-12-23 05:06:39,610 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 05:06:39,610 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 05:06:39,610 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 05:06:39,610 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 05:06:39,610 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 05:06:39,610 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 05:06:39,610 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 05:06:41,436 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 05:06:41,436 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-10...
2025-12-23 05:06:41,638 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240910 for 519 symbols
2025-12-23 05:09:00,238 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,891,166 NBBO records
2025-12-23 05:09:00,239 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,891,166 rows
2025-12-23 05:10:33,499 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,597,315 NBBO records
2025-12-23 05:10:33,499 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,597,315 rows
2025-12-23 05:12:27,149 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,056,591 NBBO records
2025-12-23 05:12:27,149 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,056,591 rows
2025-12-23 05:13:48,056 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,096,004 NBBO records
2025-12-23 05:13:48,056 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,096,004 rows
2025-12-23 05:15:59,001 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,800,898 NBBO records
2025-12-23 05:15:59,001 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,800,898 rows
2025-12-23 05:17:40,026 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,367,810 NBBO records
2025-12-23 05:17:40,026 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,367,810 rows
2025-12-23 05:20:37,710 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,261,820 NBBO records
2025-12-23 05:20:37,710 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,261,820 rows
2025-12-23 05:23:41,365 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,549,015 NBBO records
2025-12-23 05:23:41,366 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,549,015 rows
2025-12-23 05:26:14,034 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,518,394 NBBO records
2025-12-23 05:26:14,035 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,518,394 rows
2025-12-23 05:28:10,456 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,321,840 NBBO records
2025-12-23 05:28:10,457 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,321,840 rows
2025-12-23 05:28:10,740 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 37,460,853 total rows written
2025-12-23 05:31:42,871 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,922,043 NBBO records
2025-12-23 05:31:42,871 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,922,043 rows
2025-12-23 05:31:43,404 INFO [src.stage_a.parquet_writer] ✓ Wrote 43,382,896 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-10
2025-12-23 05:31:43,412 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 05:31:43,412 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 05:31:43,412 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 05:31:43,412 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 05:31:43,412 INFO [src.stage_a.stage_a] Trades: 27,228,121 rows
2025-12-23 05:31:43,412 INFO [src.stage_a.stage_a] Nbbo: 43,382,896 rows
2025-12-23 05:31:43,412 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 05:31:43,412 INFO [src.stage_a.stage_a] Processing date 63/140: 2024-09-11
2025-12-23 05:31:43,412 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 05:31:43,412 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 05:31:43,412 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-09-11 (519 symbols)
2025-12-23 05:31:43,412 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 05:31:43,412 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 05:31:43,412 INFO [src.stage_a.stage_a] Extract run ID: fc7475ba-b5e3-4321-8df5-0d62f6a05b2c
2025-12-23 05:31:43,420 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 05:31:43,420 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 05:31:43,420 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 05:31:43,420 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 05:31:43,420 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 05:31:43,420 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 05:31:43,420 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 05:31:43,420 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 05:31:43,420 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 05:31:48,372 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 05:31:48,383 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-11...
2025-12-23 05:31:48,674 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240911 for 519 symbols
2025-12-23 05:35:19,421 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,598,648 trades
2025-12-23 05:35:19,421 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,598,648 rows
2025-12-23 05:37:40,843 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,161,679 trades
2025-12-23 05:37:40,843 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,161,679 rows
2025-12-23 05:39:49,078 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,213,064 trades
2025-12-23 05:39:49,079 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,213,064 rows
2025-12-23 05:42:30,332 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,870,755 trades
2025-12-23 05:42:30,332 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,870,755 rows
2025-12-23 05:46:37,375 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,739,005 trades
2025-12-23 05:46:37,375 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,739,005 rows
2025-12-23 05:49:13,352 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,150,462 trades
2025-12-23 05:49:13,352 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,150,462 rows
2025-12-23 05:55:16,326 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,241,887 trades
2025-12-23 05:55:16,326 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,241,887 rows
2025-12-23 05:58:03,639 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,673,971 trades
2025-12-23 05:58:03,667 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,673,971 rows
2025-12-23 06:00:51,102 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,610,353 trades
2025-12-23 06:00:51,102 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,610,353 rows
2025-12-23 06:04:34,876 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,110,941 trades
2025-12-23 06:04:34,876 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,110,941 rows
2025-12-23 06:04:35,309 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 28,370,765 total rows written
2025-12-23 06:05:26,137 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,216,001 trades
2025-12-23 06:05:26,139 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,216,001 rows
2025-12-23 06:05:26,491 INFO [src.stage_a.parquet_writer] ✓ Wrote 29,586,766 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-11
2025-12-23 06:05:26,492 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 06:05:26,492 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 06:05:26,492 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 06:05:26,492 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 06:05:26,492 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 06:05:26,492 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 06:05:26,492 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 06:05:27,931 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 06:05:27,931 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-11...
2025-12-23 06:05:28,023 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240911 for 519 symbols
2025-12-23 06:07:15,285 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,928,844 NBBO records
2025-12-23 06:07:15,285 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,928,844 rows
2025-12-23 06:09:00,791 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,842,544 NBBO records
2025-12-23 06:09:00,791 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,842,544 rows
2025-12-23 06:11:51,321 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,277,063 NBBO records
2025-12-23 06:11:51,321 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,277,063 rows
2025-12-23 06:12:47,489 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,702,588 NBBO records
2025-12-23 06:12:47,490 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,702,588 rows
2025-12-23 06:15:31,743 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,969,781 NBBO records
2025-12-23 06:15:31,743 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,969,781 rows
2025-12-23 06:18:15,819 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,296,914 NBBO records
2025-12-23 06:18:15,820 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,296,914 rows
2025-12-23 06:22:19,202 INFO [src.stage_a.wrds_extractor]   Chunk 7: 7,327,886 NBBO records
2025-12-23 06:22:19,202 INFO [src.stage_a.parquet_writer]   Chunk 7: 7,327,886 rows
2025-12-23 06:26:54,854 INFO [src.stage_a.wrds_extractor]   Chunk 8: 6,759,938 NBBO records
2025-12-23 06:26:54,855 INFO [src.stage_a.parquet_writer]   Chunk 8: 6,759,938 rows
2025-12-23 06:29:03,755 INFO [src.stage_a.wrds_extractor]   Chunk 9: 5,171,234 NBBO records
2025-12-23 06:29:03,756 INFO [src.stage_a.parquet_writer]   Chunk 9: 5,171,234 rows
2025-12-23 06:31:41,692 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,248,972 NBBO records
2025-12-23 06:31:41,695 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,248,972 rows
2025-12-23 06:31:42,049 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 48,525,764 total rows written
2025-12-23 06:36:27,150 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,752,418 NBBO records
2025-12-23 06:36:27,150 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,752,418 rows
2025-12-23 06:36:27,795 INFO [src.stage_a.parquet_writer] ✓ Wrote 56,278,182 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-11
2025-12-23 06:36:27,806 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 06:36:27,806 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 06:36:27,806 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 06:36:27,806 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 06:36:27,806 INFO [src.stage_a.stage_a] Trades: 29,586,766 rows
2025-12-23 06:36:27,806 INFO [src.stage_a.stage_a] Nbbo: 56,278,182 rows
2025-12-23 06:36:27,806 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 06:36:27,806 INFO [src.stage_a.stage_a] Processing date 64/140: 2024-09-12
2025-12-23 06:36:27,806 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 06:36:27,806 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 06:36:27,806 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-09-12 (519 symbols)
2025-12-23 06:36:27,806 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 06:36:27,806 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 06:36:27,806 INFO [src.stage_a.stage_a] Extract run ID: adc1c06e-5b69-4bce-b21c-20d9bdfb19b8
2025-12-23 06:36:27,814 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 06:36:27,814 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 06:36:27,814 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 06:36:27,814 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 06:36:27,814 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 06:36:27,814 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 06:36:27,814 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 06:36:27,814 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 06:36:27,814 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 06:36:30,814 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 06:36:30,815 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-12...
2025-12-23 06:36:30,974 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240912 for 519 symbols
2025-12-23 06:39:08,298 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,263,029 trades
2025-12-23 06:39:08,298 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,263,029 rows
2025-12-23 06:40:07,350 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,870,303 trades
2025-12-23 06:40:07,350 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,870,303 rows
2025-12-23 06:40:38,663 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,052,626 trades
2025-12-23 06:40:38,663 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,052,626 rows
2025-12-23 06:42:39,972 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,749,062 trades
2025-12-23 06:42:39,973 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,749,062 rows
2025-12-23 06:45:30,622 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,604,860 trades
2025-12-23 06:45:30,622 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,604,860 rows
2025-12-23 06:46:39,468 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,985,932 trades
2025-12-23 06:46:39,468 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,985,932 rows
2025-12-23 06:48:25,179 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,079,966 trades
2025-12-23 06:48:25,179 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,079,966 rows
2025-12-23 06:50:50,415 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,340,787 trades
2025-12-23 06:50:50,430 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,340,787 rows
2025-12-23 06:53:21,579 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,139,595 trades
2025-12-23 06:53:21,579 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,139,595 rows
2025-12-23 06:56:32,794 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,226,042 trades
2025-12-23 06:56:32,794 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,226,042 rows
2025-12-23 06:56:33,230 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,312,202 total rows written
2025-12-23 06:57:17,999 INFO [src.stage_a.wrds_extractor]   Chunk 11: 990,041 trades
2025-12-23 06:57:18,001 INFO [src.stage_a.parquet_writer]   Chunk 11: 990,041 rows
2025-12-23 06:57:18,318 INFO [src.stage_a.parquet_writer] ✓ Wrote 27,302,243 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-12
2025-12-23 06:57:18,319 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 06:57:18,319 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 06:57:18,319 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 06:57:18,319 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 06:57:18,319 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 06:57:18,319 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 06:57:18,319 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 06:57:19,621 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 06:57:19,622 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-12...
2025-12-23 06:57:19,695 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240912 for 519 symbols
2025-12-23 06:59:42,871 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,379,022 NBBO records
2025-12-23 06:59:42,871 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,379,022 rows
2025-12-23 07:01:05,132 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,427,172 NBBO records
2025-12-23 07:01:05,132 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,427,172 rows
2025-12-23 07:03:23,930 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,358,867 NBBO records
2025-12-23 07:03:23,931 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,358,867 rows
2025-12-23 07:04:55,032 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,493,702 NBBO records
2025-12-23 07:04:55,032 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,493,702 rows
2025-12-23 07:06:55,900 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,466,633 NBBO records
2025-12-23 07:06:55,900 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,466,633 rows
2025-12-23 07:09:00,245 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,622,405 NBBO records
2025-12-23 07:09:00,245 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,622,405 rows
2025-12-23 07:12:08,376 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,456,914 NBBO records
2025-12-23 07:12:08,376 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,456,914 rows
2025-12-23 07:15:07,108 INFO [src.stage_a.wrds_extractor]   Chunk 8: 6,157,718 NBBO records
2025-12-23 07:15:07,109 INFO [src.stage_a.parquet_writer]   Chunk 8: 6,157,718 rows
2025-12-23 07:17:31,651 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,139,708 NBBO records
2025-12-23 07:17:31,652 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,139,708 rows
2025-12-23 07:19:29,154 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,796,016 NBBO records
2025-12-23 07:19:29,154 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,796,016 rows
2025-12-23 07:19:29,459 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 42,298,157 total rows written
2025-12-23 07:23:07,365 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,417,742 NBBO records
2025-12-23 07:23:07,365 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,417,742 rows
2025-12-23 07:23:07,954 INFO [src.stage_a.parquet_writer] ✓ Wrote 48,715,899 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-12
2025-12-23 07:23:07,962 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 07:23:07,962 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 07:23:07,962 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 07:23:07,962 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 07:23:07,962 INFO [src.stage_a.stage_a] Trades: 27,302,243 rows
2025-12-23 07:23:07,962 INFO [src.stage_a.stage_a] Nbbo: 48,715,899 rows
2025-12-23 07:23:07,962 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 07:23:07,962 INFO [src.stage_a.stage_a] Processing date 65/140: 2024-09-13
2025-12-23 07:23:07,962 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 07:23:07,962 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 07:23:07,962 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-09-13 (519 symbols)
2025-12-23 07:23:07,962 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 07:23:07,962 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 07:23:07,962 INFO [src.stage_a.stage_a] Extract run ID: 843c5e80-71dd-4ecd-9159-6fa0039c6099
2025-12-23 07:23:07,971 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 07:23:07,971 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 07:23:07,971 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 07:23:07,971 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 07:23:07,971 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 07:23:07,971 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 07:23:07,971 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 07:23:07,971 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 07:23:07,971 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 07:23:09,269 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 07:23:09,269 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-13...
2025-12-23 07:23:09,355 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240913 for 519 symbols
2025-12-23 07:25:49,292 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,889,401 trades
2025-12-23 07:25:49,292 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,889,401 rows
2025-12-23 07:27:35,503 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,902,961 trades
2025-12-23 07:27:35,503 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,902,961 rows
2025-12-23 07:29:30,287 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,875,983 trades
2025-12-23 07:29:30,287 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,875,983 rows
2025-12-23 07:31:28,563 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,674,773 trades
2025-12-23 07:31:28,564 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,674,773 rows
2025-12-23 07:33:04,388 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,499,764 trades
2025-12-23 07:33:04,388 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,499,764 rows
2025-12-23 07:35:08,670 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,987,000 trades
2025-12-23 07:35:08,670 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,987,000 rows
2025-12-23 07:38:40,266 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,890,829 trades
2025-12-23 07:38:40,266 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,890,829 rows
2025-12-23 07:40:26,353 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,256,728 trades
2025-12-23 07:40:26,367 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,256,728 rows
2025-12-23 07:42:36,063 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,021,684 trades
2025-12-23 07:42:36,063 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,021,684 rows
2025-12-23 07:44:58,689 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,925,830 trades
2025-12-23 07:44:58,690 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,925,830 rows
2025-12-23 07:44:59,085 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,924,953 total rows written
2025-12-23 07:46:00,709 INFO [src.stage_a.wrds_extractor]   Chunk 11: 906,804 trades
2025-12-23 07:46:00,710 INFO [src.stage_a.parquet_writer]   Chunk 11: 906,804 rows
2025-12-23 07:46:00,978 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,831,757 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-13
2025-12-23 07:46:00,978 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 07:46:00,978 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 07:46:00,978 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 07:46:00,978 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 07:46:00,978 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 07:46:00,978 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 07:46:00,978 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 07:46:02,958 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 07:46:02,958 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-13...
2025-12-23 07:46:03,078 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240913 for 519 symbols
2025-12-23 07:48:14,036 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,515,436 NBBO records
2025-12-23 07:48:14,036 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,515,436 rows
2025-12-23 07:49:38,920 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,168,906 NBBO records
2025-12-23 07:49:38,920 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,168,906 rows
2025-12-23 07:51:36,300 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,947,179 NBBO records
2025-12-23 07:51:36,300 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,947,179 rows
2025-12-23 07:52:58,155 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,267,078 NBBO records
2025-12-23 07:52:58,156 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,267,078 rows
2025-12-23 07:55:18,581 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,733,624 NBBO records
2025-12-23 07:55:18,581 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,733,624 rows
2025-12-23 07:57:03,500 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,026,188 NBBO records
2025-12-23 07:57:03,500 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,026,188 rows
2025-12-23 08:00:36,311 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,403,303 NBBO records
2025-12-23 08:00:36,311 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,403,303 rows
2025-12-23 08:03:49,024 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,941,782 NBBO records
2025-12-23 08:03:49,025 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,941,782 rows
2025-12-23 08:05:44,285 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,127,527 NBBO records
2025-12-23 08:05:44,286 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,127,527 rows
2025-12-23 08:07:50,840 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,335,122 NBBO records
2025-12-23 08:07:50,840 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,335,122 rows
2025-12-23 08:07:51,118 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 35,466,145 total rows written
2025-12-23 08:11:51,716 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,769,162 NBBO records
2025-12-23 08:11:51,716 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,769,162 rows
2025-12-23 08:11:52,240 INFO [src.stage_a.parquet_writer] ✓ Wrote 41,235,307 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-13
2025-12-23 08:11:52,248 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 08:11:52,248 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 08:11:52,248 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 08:11:52,248 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 08:11:52,248 INFO [src.stage_a.stage_a] Trades: 24,831,757 rows
2025-12-23 08:11:52,248 INFO [src.stage_a.stage_a] Nbbo: 41,235,307 rows
2025-12-23 08:11:52,248 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 08:11:52,248 INFO [src.stage_a.stage_a] Processing date 66/140: 2024-09-16
2025-12-23 08:11:52,248 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 08:11:52,248 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 08:11:52,248 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-09-16 (519 symbols)
2025-12-23 08:11:52,248 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 08:11:52,248 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 08:11:52,248 INFO [src.stage_a.stage_a] Extract run ID: ac841dbb-cd0c-45e3-855d-42d981c5f584
2025-12-23 08:11:52,256 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 08:11:52,256 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 08:11:52,256 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 08:11:52,256 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 08:11:52,256 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 08:11:52,256 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 08:11:52,256 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 08:11:52,256 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 08:11:52,256 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 08:11:54,143 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 08:11:54,143 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-16...
2025-12-23 08:11:54,220 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240916 for 519 symbols
2025-12-23 08:14:47,995 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,146,558 trades
2025-12-23 08:14:47,995 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,146,558 rows
2025-12-23 08:16:49,481 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,877,115 trades
2025-12-23 08:16:49,481 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,877,115 rows
2025-12-23 08:19:18,308 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,990,470 trades
2025-12-23 08:19:18,308 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,990,470 rows
2025-12-23 08:20:52,407 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,653,859 trades
2025-12-23 08:20:52,407 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,653,859 rows
2025-12-23 08:23:08,721 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,549,414 trades
2025-12-23 08:23:08,721 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,549,414 rows
2025-12-23 08:24:54,850 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,812,979 trades
2025-12-23 08:24:54,850 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,812,979 rows
2025-12-23 08:28:27,938 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,027,619 trades
2025-12-23 08:28:27,939 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,027,619 rows
2025-12-23 08:30:22,127 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,350,148 trades
2025-12-23 08:30:22,129 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,350,148 rows
2025-12-23 08:32:29,511 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,124,907 trades
2025-12-23 08:32:29,511 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,124,907 rows
2025-12-23 08:34:29,723 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,727,923 trades
2025-12-23 08:34:29,724 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,727,923 rows
2025-12-23 08:34:30,100 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 24,260,992 total rows written
2025-12-23 08:35:15,599 INFO [src.stage_a.wrds_extractor]   Chunk 11: 897,009 trades
2025-12-23 08:35:15,599 INFO [src.stage_a.parquet_writer]   Chunk 11: 897,009 rows
2025-12-23 08:35:15,894 INFO [src.stage_a.parquet_writer] ✓ Wrote 25,158,001 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-16
2025-12-23 08:35:15,895 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 08:35:15,895 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 08:35:15,895 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 08:35:15,895 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 08:35:15,895 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 08:35:15,895 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 08:35:15,895 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 08:35:18,154 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 08:35:18,154 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-16...
2025-12-23 08:35:18,348 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240916 for 519 symbols
2025-12-23 08:37:06,372 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,371,632 NBBO records
2025-12-23 08:37:06,372 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,371,632 rows
2025-12-23 08:38:07,114 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,008,689 NBBO records
2025-12-23 08:38:07,114 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,008,689 rows
2025-12-23 08:39:47,141 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,466,688 NBBO records
2025-12-23 08:39:47,141 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,466,688 rows
2025-12-23 08:40:44,235 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,054,486 NBBO records
2025-12-23 08:40:44,235 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,054,486 rows
2025-12-23 08:42:43,541 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,766,562 NBBO records
2025-12-23 08:42:43,541 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,766,562 rows
2025-12-23 08:44:02,960 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,727,821 NBBO records
2025-12-23 08:44:02,960 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,727,821 rows
2025-12-23 08:46:30,392 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,759,017 NBBO records
2025-12-23 08:46:30,392 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,759,017 rows
2025-12-23 08:49:11,738 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,404,900 NBBO records
2025-12-23 08:49:11,739 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,404,900 rows
2025-12-23 08:51:05,519 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,187,633 NBBO records
2025-12-23 08:51:05,520 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,187,633 rows
2025-12-23 08:52:57,559 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,972,573 NBBO records
2025-12-23 08:52:57,559 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,972,573 rows
2025-12-23 08:52:57,821 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 32,720,001 total rows written
2025-12-23 08:55:28,704 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,048,386 NBBO records
2025-12-23 08:55:28,704 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,048,386 rows
2025-12-23 08:55:29,172 INFO [src.stage_a.parquet_writer] ✓ Wrote 37,768,387 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-16
2025-12-23 08:55:29,180 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 08:55:29,180 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 08:55:29,180 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 08:55:29,180 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 08:55:29,180 INFO [src.stage_a.stage_a] Trades: 25,158,001 rows
2025-12-23 08:55:29,180 INFO [src.stage_a.stage_a] Nbbo: 37,768,387 rows
2025-12-23 08:55:29,180 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 08:55:29,180 INFO [src.stage_a.stage_a] Processing date 67/140: 2024-09-17
2025-12-23 08:55:29,180 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 08:55:29,180 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 08:55:29,180 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-09-17 (519 symbols)
2025-12-23 08:55:29,180 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 08:55:29,180 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 08:55:29,180 INFO [src.stage_a.stage_a] Extract run ID: 377514e1-fb12-4601-9c78-6ca4a6f54952
2025-12-23 08:55:29,188 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 08:55:29,188 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 08:55:29,188 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 08:55:29,188 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 08:55:29,188 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 08:55:29,188 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 08:55:29,188 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 08:55:29,188 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 08:55:29,188 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 08:55:30,394 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 08:55:30,394 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-17...
2025-12-23 08:55:30,457 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240917 for 519 symbols
2025-12-23 08:58:06,898 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,059,078 trades
2025-12-23 08:58:06,898 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,059,078 rows
2025-12-23 08:59:35,163 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,838,788 trades
2025-12-23 08:59:35,163 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,838,788 rows
2025-12-23 09:00:55,880 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,043,806 trades
2025-12-23 09:00:55,880 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,043,806 rows
2025-12-23 09:02:24,581 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,753,709 trades
2025-12-23 09:02:24,581 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,753,709 rows
2025-12-23 09:04:21,388 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,782,897 trades
2025-12-23 09:04:21,388 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,782,897 rows
2025-12-23 09:05:29,932 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,942,078 trades
2025-12-23 09:05:29,933 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,942,078 rows
2025-12-23 09:08:18,980 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,001,585 trades
2025-12-23 09:08:18,980 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,001,585 rows
2025-12-23 09:09:51,638 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,222,758 trades
2025-12-23 09:09:51,642 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,222,758 rows
2025-12-23 09:11:04,114 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,066,503 trades
2025-12-23 09:11:04,114 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,066,503 rows
2025-12-23 09:13:28,444 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,925,077 trades
2025-12-23 09:13:28,444 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,925,077 rows
2025-12-23 09:13:28,851 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 24,636,279 total rows written
2025-12-23 09:14:12,303 INFO [src.stage_a.wrds_extractor]   Chunk 11: 965,410 trades
2025-12-23 09:14:12,303 INFO [src.stage_a.parquet_writer]   Chunk 11: 965,410 rows
2025-12-23 09:14:12,575 INFO [src.stage_a.parquet_writer] ✓ Wrote 25,601,689 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-17
2025-12-23 09:14:12,576 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 09:14:12,576 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 09:14:12,576 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 09:14:12,576 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 09:14:12,576 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 09:14:12,576 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 09:14:12,576 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 09:14:14,270 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 09:14:14,270 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-17...
2025-12-23 09:14:14,354 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240917 for 519 symbols
2025-12-23 09:16:16,794 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,115,986 NBBO records
2025-12-23 09:16:16,794 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,115,986 rows
2025-12-23 09:17:45,710 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,517,492 NBBO records
2025-12-23 09:17:45,710 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,517,492 rows
2025-12-23 09:20:23,984 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,997,264 NBBO records
2025-12-23 09:20:23,984 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,997,264 rows
2025-12-23 09:21:41,437 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,182,171 NBBO records
2025-12-23 09:21:41,438 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,182,171 rows
2025-12-23 09:24:34,696 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,000,332 NBBO records
2025-12-23 09:24:34,697 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,000,332 rows
2025-12-23 09:26:34,163 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,653,287 NBBO records
2025-12-23 09:26:34,163 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,653,287 rows
2025-12-23 09:29:48,527 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,602,854 NBBO records
2025-12-23 09:29:48,527 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,602,854 rows
2025-12-23 09:32:55,978 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,836,898 NBBO records
2025-12-23 09:32:55,979 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,836,898 rows
2025-12-23 09:34:56,381 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,533,569 NBBO records
2025-12-23 09:34:56,382 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,533,569 rows
2025-12-23 09:36:30,383 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,253,267 NBBO records
2025-12-23 09:36:30,383 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,253,267 rows
2025-12-23 09:36:30,660 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 40,693,120 total rows written
2025-12-23 09:40:09,876 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,327,905 NBBO records
2025-12-23 09:40:09,876 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,327,905 rows
2025-12-23 09:40:10,395 INFO [src.stage_a.parquet_writer] ✓ Wrote 47,021,025 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-17
2025-12-23 09:40:10,400 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 09:40:10,400 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 09:40:10,400 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 09:40:10,400 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 09:40:10,400 INFO [src.stage_a.stage_a] Trades: 25,601,689 rows
2025-12-23 09:40:10,400 INFO [src.stage_a.stage_a] Nbbo: 47,021,025 rows
2025-12-23 09:40:10,400 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 09:40:10,400 INFO [src.stage_a.stage_a] Processing date 68/140: 2024-09-18
2025-12-23 09:40:10,400 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 09:40:10,400 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 09:40:10,400 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-09-18 (519 symbols)
2025-12-23 09:40:10,400 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 09:40:10,400 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 09:40:10,400 INFO [src.stage_a.stage_a] Extract run ID: 6c6cf0ac-d5e4-48d9-9952-26c1f130d4cb
2025-12-23 09:40:10,408 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 09:40:10,408 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 09:40:10,408 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 09:40:10,408 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 09:40:10,408 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 09:40:10,408 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 09:40:10,408 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 09:40:10,408 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 09:40:10,408 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 09:40:12,793 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 09:40:12,794 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-18...
2025-12-23 09:40:12,924 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240918 for 519 symbols
2025-12-23 09:43:03,281 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,258,727 trades
2025-12-23 09:43:03,281 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,258,727 rows
2025-12-23 09:45:27,909 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,078,027 trades
2025-12-23 09:45:27,909 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,078,027 rows
2025-12-23 09:47:13,131 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,126,441 trades
2025-12-23 09:47:13,132 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,126,441 rows
2025-12-23 09:49:10,254 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,836,819 trades
2025-12-23 09:49:10,254 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,836,819 rows
2025-12-23 09:51:35,293 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,809,128 trades
2025-12-23 09:51:35,293 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,809,128 rows
2025-12-23 09:53:44,220 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,272,414 trades
2025-12-23 09:53:44,220 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,272,414 rows
2025-12-23 09:57:41,690 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,464,937 trades
2025-12-23 09:57:41,690 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,464,937 rows
2025-12-23 10:00:22,493 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,584,631 trades
2025-12-23 10:00:22,513 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,584,631 rows
2025-12-23 10:02:26,175 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,464,856 trades
2025-12-23 10:02:26,176 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,464,856 rows
2025-12-23 10:05:49,220 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,044,633 trades
2025-12-23 10:05:49,221 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,044,633 rows
2025-12-23 10:05:49,642 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,940,613 total rows written
2025-12-23 10:07:09,790 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,269,682 trades
2025-12-23 10:07:09,790 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,269,682 rows
2025-12-23 10:07:10,163 INFO [src.stage_a.parquet_writer] ✓ Wrote 28,210,295 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-18
2025-12-23 10:07:10,168 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 10:07:10,168 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 10:07:10,168 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 10:07:10,168 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 10:07:10,168 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 10:07:10,168 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 10:07:10,168 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 10:07:12,896 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 10:07:12,897 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-18...
2025-12-23 10:07:13,070 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240918 for 519 symbols
2025-12-23 10:10:55,485 INFO [src.stage_a.wrds_extractor]   Chunk 1: 6,072,141 NBBO records
2025-12-23 10:10:55,485 INFO [src.stage_a.parquet_writer]   Chunk 1: 6,072,141 rows
2025-12-23 10:13:21,743 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,788,131 NBBO records
2025-12-23 10:13:21,744 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,788,131 rows
2025-12-23 10:17:06,544 INFO [src.stage_a.wrds_extractor]   Chunk 3: 6,105,271 NBBO records
2025-12-23 10:17:06,544 INFO [src.stage_a.parquet_writer]   Chunk 3: 6,105,271 rows
2025-12-23 10:18:49,378 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,186,589 NBBO records
2025-12-23 10:18:49,382 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,186,589 rows
2025-12-23 10:22:29,217 INFO [src.stage_a.wrds_extractor]   Chunk 5: 6,141,066 NBBO records
2025-12-23 10:22:29,217 INFO [src.stage_a.parquet_writer]   Chunk 5: 6,141,066 rows
2025-12-23 10:25:17,026 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,251,443 NBBO records
2025-12-23 10:25:17,027 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,251,443 rows
2025-12-23 10:29:52,937 INFO [src.stage_a.wrds_extractor]   Chunk 7: 7,576,362 NBBO records
2025-12-23 10:29:52,938 INFO [src.stage_a.parquet_writer]   Chunk 7: 7,576,362 rows
2025-12-23 10:34:09,642 INFO [src.stage_a.wrds_extractor]   Chunk 8: 6,717,921 NBBO records
2025-12-23 10:34:09,645 INFO [src.stage_a.parquet_writer]   Chunk 8: 6,717,921 rows
2025-12-23 10:37:12,727 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,716,530 NBBO records
2025-12-23 10:37:12,728 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,716,530 rows
2025-12-23 10:40:18,589 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,493,710 NBBO records
2025-12-23 10:40:18,590 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,493,710 rows
2025-12-23 10:40:18,949 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 54,049,164 total rows written
2025-12-23 10:46:04,768 INFO [src.stage_a.wrds_extractor]   Chunk 11: 8,505,537 NBBO records
2025-12-23 10:46:04,769 INFO [src.stage_a.parquet_writer]   Chunk 11: 8,505,537 rows
2025-12-23 10:46:05,482 INFO [src.stage_a.parquet_writer] ✓ Wrote 62,554,701 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-18
2025-12-23 10:46:05,504 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 10:46:05,504 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 10:46:05,504 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 10:46:05,504 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 10:46:05,504 INFO [src.stage_a.stage_a] Trades: 28,210,295 rows
2025-12-23 10:46:05,504 INFO [src.stage_a.stage_a] Nbbo: 62,554,701 rows
2025-12-23 10:46:05,504 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 10:46:05,504 INFO [src.stage_a.stage_a] Processing date 69/140: 2024-09-19
2025-12-23 10:46:05,504 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 10:46:05,504 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 10:46:05,504 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-09-19 (519 symbols)
2025-12-23 10:46:05,504 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 10:46:05,504 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 10:46:05,504 INFO [src.stage_a.stage_a] Extract run ID: 40dad49c-1f12-416c-b6de-5c225353f509
2025-12-23 10:46:05,512 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 10:46:05,512 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 10:46:05,512 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 10:46:05,512 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 10:46:05,512 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 10:46:05,512 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 10:46:05,512 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 10:46:05,512 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 10:46:05,512 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 10:46:08,666 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 10:46:08,666 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-19...
2025-12-23 10:46:08,795 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240919 for 519 symbols
2025-12-23 10:50:12,372 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,703,270 trades
2025-12-23 10:50:12,373 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,703,270 rows
2025-12-23 10:51:16,087 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,284,944 trades
2025-12-23 10:51:16,088 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,284,944 rows
2025-12-23 10:53:38,616 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,316,354 trades
2025-12-23 10:53:38,616 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,316,354 rows
2025-12-23 10:55:23,095 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,833,252 trades
2025-12-23 10:55:23,095 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,833,252 rows
2025-12-23 10:58:12,308 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,714,259 trades
2025-12-23 10:58:12,308 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,714,259 rows
2025-12-23 11:00:26,201 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,287,043 trades
2025-12-23 11:00:26,201 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,287,043 rows
2025-12-23 11:05:15,513 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,773,075 trades
2025-12-23 11:05:15,513 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,773,075 rows
2025-12-23 11:08:09,998 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,790,925 trades
2025-12-23 11:08:10,008 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,790,925 rows
2025-12-23 11:10:25,876 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,461,602 trades
2025-12-23 11:10:25,876 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,461,602 rows
2025-12-23 11:13:53,469 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,543,832 trades
2025-12-23 11:13:53,469 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,543,832 rows
2025-12-23 11:13:53,921 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 28,708,556 total rows written
2025-12-23 11:14:51,936 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,196,790 trades
2025-12-23 11:14:51,939 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,196,790 rows
2025-12-23 11:14:52,295 INFO [src.stage_a.parquet_writer] ✓ Wrote 29,905,346 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-19
2025-12-23 11:14:52,296 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 11:14:52,296 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 11:14:52,296 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 11:14:52,296 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 11:14:52,296 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 11:14:52,296 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 11:14:52,296 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 11:14:54,631 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 11:14:54,632 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-19...
2025-12-23 11:14:54,766 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240919 for 519 symbols
2025-12-23 11:17:56,302 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,236,198 NBBO records
2025-12-23 11:17:56,302 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,236,198 rows
2025-12-23 11:19:25,307 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,705,468 NBBO records
2025-12-23 11:19:25,307 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,705,468 rows
2025-12-23 11:22:19,683 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,964,521 NBBO records
2025-12-23 11:22:19,684 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,964,521 rows
2025-12-23 11:23:59,853 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,435,238 NBBO records
2025-12-23 11:23:59,854 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,435,238 rows
2025-12-23 11:26:34,419 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,052,512 NBBO records
2025-12-23 11:26:34,419 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,052,512 rows
2025-12-23 11:28:40,626 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,653,669 NBBO records
2025-12-23 11:28:40,626 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,653,669 rows
2025-12-23 11:31:52,707 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,764,349 NBBO records
2025-12-23 11:31:52,707 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,764,349 rows
2025-12-23 11:33:36,314 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,783,030 NBBO records
2025-12-23 11:33:36,315 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,783,030 rows
2025-12-23 11:34:13,465 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,648,300 NBBO records
2025-12-23 11:34:13,466 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,648,300 rows
2025-12-23 11:34:55,383 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,849,162 NBBO records
2025-12-23 11:34:55,383 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,849,162 rows
2025-12-23 11:34:55,703 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 40,092,447 total rows written
2025-12-23 11:37:43,900 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,398,683 NBBO records
2025-12-23 11:37:43,900 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,398,683 rows
2025-12-23 11:37:44,456 INFO [src.stage_a.parquet_writer] ✓ Wrote 46,491,130 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-19
2025-12-23 11:37:44,463 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 11:37:44,464 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 11:37:44,464 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 11:37:44,464 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 11:37:44,464 INFO [src.stage_a.stage_a] Trades: 29,905,346 rows
2025-12-23 11:37:44,464 INFO [src.stage_a.stage_a] Nbbo: 46,491,130 rows
2025-12-23 11:37:44,464 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 11:37:44,464 INFO [src.stage_a.stage_a] Processing date 70/140: 2024-09-20
2025-12-23 11:37:44,464 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 11:37:44,464 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 11:37:44,464 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-09-20 (519 symbols)
2025-12-23 11:37:44,464 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 11:37:44,464 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 11:37:44,464 INFO [src.stage_a.stage_a] Extract run ID: e85836f7-b59c-4a84-a6eb-8328ab38a3c9
2025-12-23 11:37:44,472 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 11:37:44,472 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 11:37:44,472 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 11:37:44,472 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 11:37:44,472 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 11:37:44,472 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 11:37:44,472 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 11:37:44,472 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 11:37:44,472 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 11:37:46,372 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 11:37:46,372 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-20...
2025-12-23 11:37:46,493 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240920 for 519 symbols
2025-12-23 11:40:50,030 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,759,111 trades
2025-12-23 11:40:50,030 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,759,111 rows
2025-12-23 11:42:25,584 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,310,457 trades
2025-12-23 11:42:25,586 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,310,457 rows
2025-12-23 11:44:12,703 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,353,829 trades
2025-12-23 11:44:12,703 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,353,829 rows
2025-12-23 11:45:48,160 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,191,924 trades
2025-12-23 11:45:48,161 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,191,924 rows
2025-12-23 11:48:03,787 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,976,094 trades
2025-12-23 11:48:03,787 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,976,094 rows
2025-12-23 11:49:51,496 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,333,559 trades
2025-12-23 11:49:51,497 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,333,559 rows
2025-12-23 11:53:38,543 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,613,770 trades
2025-12-23 11:53:38,543 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,613,770 rows
2025-12-23 11:56:08,536 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,706,387 trades
2025-12-23 11:56:08,551 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,706,387 rows
2025-12-23 11:58:08,445 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,427,325 trades
2025-12-23 11:58:08,445 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,427,325 rows
2025-12-23 12:00:23,152 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,380,204 trades
2025-12-23 12:00:23,152 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,380,204 rows
2025-12-23 12:00:23,593 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 29,052,660 total rows written
2025-12-23 12:01:03,959 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,192,658 trades
2025-12-23 12:01:03,961 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,192,658 rows
2025-12-23 12:01:04,312 INFO [src.stage_a.parquet_writer] ✓ Wrote 30,245,318 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-20
2025-12-23 12:01:04,313 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 12:01:04,313 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 12:01:04,313 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 12:01:04,313 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 12:01:04,313 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 12:01:04,313 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 12:01:04,313 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 12:01:05,447 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 12:01:05,447 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-20...
2025-12-23 12:01:05,510 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240920 for 519 symbols
2025-12-23 12:02:30,747 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,502,903 NBBO records
2025-12-23 12:02:30,747 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,502,903 rows
2025-12-23 12:03:42,361 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,732,594 NBBO records
2025-12-23 12:03:42,361 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,732,594 rows
2025-12-23 12:05:45,549 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,627,222 NBBO records
2025-12-23 12:05:45,549 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,627,222 rows
2025-12-23 12:07:05,149 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,544,601 NBBO records
2025-12-23 12:07:05,149 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,544,601 rows
2025-12-23 12:09:07,364 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,476,928 NBBO records
2025-12-23 12:09:07,364 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,476,928 rows
2025-12-23 12:10:29,767 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,458,042 NBBO records
2025-12-23 12:10:29,767 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,458,042 rows
2025-12-23 12:13:09,049 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,676,517 NBBO records
2025-12-23 12:13:09,049 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,676,517 rows
2025-12-23 12:15:34,460 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,100,381 NBBO records
2025-12-23 12:15:34,461 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,100,381 rows
2025-12-23 12:17:08,467 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,479,932 NBBO records
2025-12-23 12:17:08,470 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,479,932 rows
2025-12-23 12:19:00,313 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,732,264 NBBO records
2025-12-23 12:19:00,314 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,732,264 rows
2025-12-23 12:19:00,629 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 40,331,384 total rows written
2025-12-23 12:21:31,295 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,826,793 NBBO records
2025-12-23 12:21:31,296 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,826,793 rows
2025-12-23 12:21:31,791 INFO [src.stage_a.parquet_writer] ✓ Wrote 46,158,177 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-20
2025-12-23 12:21:31,795 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 12:21:31,795 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 12:21:31,795 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 12:21:31,795 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 12:21:31,795 INFO [src.stage_a.stage_a] Trades: 30,245,318 rows
2025-12-23 12:21:31,795 INFO [src.stage_a.stage_a] Nbbo: 46,158,177 rows
2025-12-23 12:21:31,795 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 12:21:31,795 INFO [src.stage_a.stage_a] Processing date 71/140: 2024-09-23
2025-12-23 12:21:31,795 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 12:21:31,795 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 12:21:31,795 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-09-23 (519 symbols)
2025-12-23 12:21:31,795 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 12:21:31,795 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 12:21:31,796 INFO [src.stage_a.stage_a] Extract run ID: 356219f5-2286-4a88-a9da-fc318272ccfe
2025-12-23 12:21:31,804 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 12:21:31,804 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 12:21:31,804 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 12:21:31,804 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 12:21:31,804 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 12:21:31,804 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 12:21:31,804 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 12:21:31,804 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 12:21:31,804 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 12:21:34,109 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 12:21:34,119 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-23...
2025-12-23 12:21:34,204 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240923 for 519 symbols
2025-12-23 12:23:02,323 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,899,232 trades
2025-12-23 12:23:02,324 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,899,232 rows
2025-12-23 12:24:52,628 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,950,371 trades
2025-12-23 12:24:52,628 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,950,371 rows
2025-12-23 12:26:16,627 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,909,761 trades
2025-12-23 12:26:16,627 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,909,761 rows
2025-12-23 12:28:32,961 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,634,798 trades
2025-12-23 12:28:32,961 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,634,798 rows
2025-12-23 12:29:16,004 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,520,175 trades
2025-12-23 12:29:16,004 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,520,175 rows
2025-12-23 12:30:04,717 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,911,664 trades
2025-12-23 12:30:04,717 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,911,664 rows
2025-12-23 12:33:25,727 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,804,027 trades
2025-12-23 12:33:25,727 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,804,027 rows
2025-12-23 12:35:25,549 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,189,678 trades
2025-12-23 12:35:25,567 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,189,678 rows
2025-12-23 12:36:18,850 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,974,111 trades
2025-12-23 12:36:18,850 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,974,111 rows
2025-12-23 12:37:08,345 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,942,759 trades
2025-12-23 12:37:08,345 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,942,759 rows
2025-12-23 12:37:08,735 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,736,576 total rows written
2025-12-23 12:37:24,856 INFO [src.stage_a.wrds_extractor]   Chunk 11: 925,068 trades
2025-12-23 12:37:24,856 INFO [src.stage_a.parquet_writer]   Chunk 11: 925,068 rows
2025-12-23 12:37:25,143 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,661,644 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-23
2025-12-23 12:37:25,144 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 12:37:25,144 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 12:37:25,144 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 12:37:25,144 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 12:37:25,144 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 12:37:25,145 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 12:37:25,145 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 12:37:26,391 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 12:37:26,391 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-23...
2025-12-23 12:37:26,452 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240923 for 519 symbols
2025-12-23 12:38:16,667 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,815,479 NBBO records
2025-12-23 12:38:16,667 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,815,479 rows
2025-12-23 12:38:51,138 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,347,514 NBBO records
2025-12-23 12:38:51,138 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,347,514 rows
2025-12-23 12:39:27,300 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,339,003 NBBO records
2025-12-23 12:39:27,300 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,339,003 rows
2025-12-23 12:40:04,566 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,018,013 NBBO records
2025-12-23 12:40:04,566 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,018,013 rows
2025-12-23 12:42:03,687 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,854,146 NBBO records
2025-12-23 12:42:03,687 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,854,146 rows
2025-12-23 12:43:49,307 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,897,118 NBBO records
2025-12-23 12:43:49,307 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,897,118 rows
2025-12-23 12:46:14,476 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,550,681 NBBO records
2025-12-23 12:46:14,476 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,550,681 rows
2025-12-23 12:49:30,204 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,295,190 NBBO records
2025-12-23 12:49:30,204 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,295,190 rows
2025-12-23 12:51:20,159 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,957,474 NBBO records
2025-12-23 12:51:20,159 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,957,474 rows
2025-12-23 12:53:12,591 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,855,929 NBBO records
2025-12-23 12:53:12,591 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,855,929 rows
2025-12-23 12:53:12,847 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 32,930,547 total rows written
2025-12-23 12:56:39,189 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,324,188 NBBO records
2025-12-23 12:56:39,189 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,324,188 rows
2025-12-23 12:56:39,667 INFO [src.stage_a.parquet_writer] ✓ Wrote 38,254,735 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-23
2025-12-23 12:56:39,674 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 12:56:39,674 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 12:56:39,674 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 12:56:39,674 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 12:56:39,674 INFO [src.stage_a.stage_a] Trades: 24,661,644 rows
2025-12-23 12:56:39,674 INFO [src.stage_a.stage_a] Nbbo: 38,254,735 rows
2025-12-23 12:56:39,674 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 12:56:39,674 INFO [src.stage_a.stage_a] Processing date 72/140: 2024-09-24
2025-12-23 12:56:39,674 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 12:56:39,674 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 12:56:39,674 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-09-24 (519 symbols)
2025-12-23 12:56:39,674 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 12:56:39,674 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 12:56:39,674 INFO [src.stage_a.stage_a] Extract run ID: 0ef49f50-9e2d-43e2-8684-61b446c3dd96
2025-12-23 12:56:39,685 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 12:56:39,685 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 12:56:39,685 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 12:56:39,685 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 12:56:39,685 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 12:56:39,685 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 12:56:39,685 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 12:56:39,685 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 12:56:39,685 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 12:56:41,300 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 12:56:41,301 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-24...
2025-12-23 12:56:41,362 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240924 for 519 symbols
2025-12-23 12:59:28,069 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,769,296 trades
2025-12-23 12:59:28,069 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,769,296 rows
2025-12-23 13:01:16,151 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,878,000 trades
2025-12-23 13:01:16,151 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,878,000 rows
2025-12-23 13:02:41,960 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,035,067 trades
2025-12-23 13:02:41,960 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,035,067 rows
2025-12-23 13:03:56,853 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,757,339 trades
2025-12-23 13:03:56,854 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,757,339 rows
2025-12-23 13:06:14,562 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,327,228 trades
2025-12-23 13:06:14,562 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,327,228 rows
2025-12-23 13:07:54,343 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,962,806 trades
2025-12-23 13:07:54,343 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,962,806 rows
2025-12-23 13:12:43,337 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,503,433 trades
2025-12-23 13:12:43,337 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,503,433 rows
2025-12-23 13:14:01,858 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,154,613 trades
2025-12-23 13:14:01,874 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,154,613 rows
2025-12-23 13:14:36,947 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,936,558 trades
2025-12-23 13:14:36,947 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,936,558 rows
2025-12-23 13:15:51,065 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,034,925 trades
2025-12-23 13:15:51,065 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,034,925 rows
2025-12-23 13:15:51,482 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 24,359,265 total rows written
2025-12-23 13:16:09,998 INFO [src.stage_a.wrds_extractor]   Chunk 11: 968,538 trades
2025-12-23 13:16:09,998 INFO [src.stage_a.parquet_writer]   Chunk 11: 968,538 rows
2025-12-23 13:16:10,309 INFO [src.stage_a.parquet_writer] ✓ Wrote 25,327,803 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-24
2025-12-23 13:16:10,309 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 13:16:10,310 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 13:16:10,310 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 13:16:10,310 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 13:16:10,310 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 13:16:10,310 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 13:16:10,310 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 13:16:11,512 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 13:16:11,512 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-24...
2025-12-23 13:16:11,600 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240924 for 519 symbols
2025-12-23 13:16:53,592 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,631,017 NBBO records
2025-12-23 13:16:53,592 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,631,017 rows
2025-12-23 13:18:04,954 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,102,463 NBBO records
2025-12-23 13:18:04,955 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,102,463 rows
2025-12-23 13:19:46,955 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,421,952 NBBO records
2025-12-23 13:19:46,955 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,421,952 rows
2025-12-23 13:21:01,030 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,133,622 NBBO records
2025-12-23 13:21:01,030 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,133,622 rows
2025-12-23 13:22:19,862 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,536,913 NBBO records
2025-12-23 13:22:19,863 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,536,913 rows
2025-12-23 13:24:13,521 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,055,878 NBBO records
2025-12-23 13:24:13,521 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,055,878 rows
2025-12-23 13:27:18,307 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,278,483 NBBO records
2025-12-23 13:27:18,307 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,278,483 rows
2025-12-23 13:30:05,059 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,310,720 NBBO records
2025-12-23 13:30:05,060 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,310,720 rows
2025-12-23 13:31:45,217 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,021,611 NBBO records
2025-12-23 13:31:45,218 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,021,611 rows
2025-12-23 13:33:41,505 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,291,401 NBBO records
2025-12-23 13:33:41,506 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,291,401 rows
2025-12-23 13:33:41,780 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 33,784,060 total rows written
2025-12-23 13:36:57,055 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,152,757 NBBO records
2025-12-23 13:36:57,055 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,152,757 rows
2025-12-23 13:36:57,532 INFO [src.stage_a.parquet_writer] ✓ Wrote 38,936,817 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-24
2025-12-23 13:36:57,538 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 13:36:57,538 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 13:36:57,538 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 13:36:57,538 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 13:36:57,538 INFO [src.stage_a.stage_a] Trades: 25,327,803 rows
2025-12-23 13:36:57,538 INFO [src.stage_a.stage_a] Nbbo: 38,936,817 rows
2025-12-23 13:36:57,538 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 13:36:57,538 INFO [src.stage_a.stage_a] Processing date 73/140: 2024-09-25
2025-12-23 13:36:57,538 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 13:36:57,538 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 13:36:57,538 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-09-25 (519 symbols)
2025-12-23 13:36:57,538 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 13:36:57,538 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 13:36:57,538 INFO [src.stage_a.stage_a] Extract run ID: 8b385fc6-bf12-46c4-967a-85c2e47d4421
2025-12-23 13:36:57,546 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 13:36:57,546 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 13:36:57,546 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 13:36:57,546 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 13:36:57,546 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 13:36:57,546 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 13:36:57,546 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 13:36:57,546 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 13:36:57,546 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 13:37:00,882 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 13:37:00,882 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-25...
2025-12-23 13:37:01,047 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240925 for 519 symbols
2025-12-23 13:39:55,013 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,798,122 trades
2025-12-23 13:39:55,013 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,798,122 rows
2025-12-23 13:41:25,926 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,895,232 trades
2025-12-23 13:41:25,926 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,895,232 rows
2025-12-23 13:42:57,089 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,938,476 trades
2025-12-23 13:42:57,089 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,938,476 rows
2025-12-23 13:44:47,101 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,650,378 trades
2025-12-23 13:44:47,101 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,650,378 rows
2025-12-23 13:46:45,086 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,455,324 trades
2025-12-23 13:46:45,086 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,455,324 rows
2025-12-23 13:48:18,291 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,923,335 trades
2025-12-23 13:48:18,291 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,923,335 rows
2025-12-23 13:51:27,595 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,148,528 trades
2025-12-23 13:51:27,595 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,148,528 rows
2025-12-23 13:53:00,293 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,035,723 trades
2025-12-23 13:53:00,310 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,035,723 rows
2025-12-23 13:54:34,814 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,819,237 trades
2025-12-23 13:54:34,814 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,819,237 rows
2025-12-23 13:56:39,522 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,832,275 trades
2025-12-23 13:56:39,522 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,832,275 rows
2025-12-23 13:56:39,904 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,496,630 total rows written
2025-12-23 13:57:32,125 INFO [src.stage_a.wrds_extractor]   Chunk 11: 866,850 trades
2025-12-23 13:57:32,125 INFO [src.stage_a.parquet_writer]   Chunk 11: 866,850 rows
2025-12-23 13:57:32,410 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,363,480 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-25
2025-12-23 13:57:32,411 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 13:57:32,411 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 13:57:32,411 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 13:57:32,411 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 13:57:32,411 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 13:57:32,411 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 13:57:32,411 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 13:57:34,642 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 13:57:34,642 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-25...
2025-12-23 13:57:34,738 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240925 for 519 symbols
2025-12-23 13:59:15,943 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,730,887 NBBO records
2025-12-23 13:59:15,943 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,730,887 rows
2025-12-23 14:00:06,202 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,118,918 NBBO records
2025-12-23 14:00:06,203 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,118,918 rows
2025-12-23 14:01:50,487 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,392,582 NBBO records
2025-12-23 14:01:50,487 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,392,582 rows
2025-12-23 14:03:05,492 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,148,392 NBBO records
2025-12-23 14:03:05,493 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,148,392 rows
2025-12-23 14:05:08,010 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,707,857 NBBO records
2025-12-23 14:05:08,010 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,707,857 rows
2025-12-23 14:06:37,807 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,870,117 NBBO records
2025-12-23 14:06:37,807 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,870,117 rows
2025-12-23 14:08:35,622 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,460,021 NBBO records
2025-12-23 14:08:35,622 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,460,021 rows
2025-12-23 14:10:19,116 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,267,892 NBBO records
2025-12-23 14:10:19,116 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,267,892 rows
2025-12-23 14:10:48,530 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,744,821 NBBO records
2025-12-23 14:10:48,530 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,744,821 rows
2025-12-23 14:11:24,765 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,074,431 NBBO records
2025-12-23 14:11:24,766 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,074,431 rows
2025-12-23 14:11:25,037 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 32,515,918 total rows written
2025-12-23 14:13:18,272 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,048,473 NBBO records
2025-12-23 14:13:18,272 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,048,473 rows
2025-12-23 14:13:18,744 INFO [src.stage_a.parquet_writer] ✓ Wrote 37,564,391 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-25
2025-12-23 14:13:18,750 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 14:13:18,750 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 14:13:18,750 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 14:13:18,750 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 14:13:18,750 INFO [src.stage_a.stage_a] Trades: 24,363,480 rows
2025-12-23 14:13:18,750 INFO [src.stage_a.stage_a] Nbbo: 37,564,391 rows
2025-12-23 14:13:18,750 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 14:13:18,750 INFO [src.stage_a.stage_a] Processing date 74/140: 2024-09-26
2025-12-23 14:13:18,750 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 14:13:18,750 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 14:13:18,750 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-09-26 (519 symbols)
2025-12-23 14:13:18,750 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 14:13:18,750 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 14:13:18,750 INFO [src.stage_a.stage_a] Extract run ID: 7d64c9ec-9bab-4645-9717-b417fe4ebcf5
2025-12-23 14:13:18,758 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 14:13:18,758 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 14:13:18,758 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 14:13:18,758 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 14:13:18,758 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 14:13:18,758 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 14:13:18,758 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 14:13:18,758 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 14:13:18,758 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 14:13:20,018 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 14:13:20,018 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-26...
2025-12-23 14:13:20,096 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240926 for 519 symbols
2025-12-23 14:15:44,408 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,261,642 trades
2025-12-23 14:15:44,408 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,261,642 rows
2025-12-23 14:17:22,525 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,040,266 trades
2025-12-23 14:17:22,525 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,040,266 rows
2025-12-23 14:19:07,437 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,195,199 trades
2025-12-23 14:19:07,437 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,195,199 rows
2025-12-23 14:20:54,175 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,071,799 trades
2025-12-23 14:20:54,175 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,071,799 rows
2025-12-23 14:22:29,008 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,579,820 trades
2025-12-23 14:22:29,008 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,579,820 rows
2025-12-23 14:23:08,347 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,323,647 trades
2025-12-23 14:23:08,347 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,323,647 rows
2025-12-23 14:25:06,916 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,072,677 trades
2025-12-23 14:25:06,916 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,072,677 rows
2025-12-23 14:27:10,887 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,506,287 trades
2025-12-23 14:27:10,906 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,506,287 rows
2025-12-23 14:29:14,996 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,656,851 trades
2025-12-23 14:29:15,010 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,656,851 rows
2025-12-23 14:31:56,860 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,292,491 trades
2025-12-23 14:31:56,860 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,292,491 rows
2025-12-23 14:31:57,278 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 28,000,679 total rows written
2025-12-23 14:32:54,383 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,117,513 trades
2025-12-23 14:32:54,385 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,117,513 rows
2025-12-23 14:32:54,708 INFO [src.stage_a.parquet_writer] ✓ Wrote 29,118,192 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-26
2025-12-23 14:32:54,709 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 14:32:54,709 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 14:32:54,709 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 14:32:54,709 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 14:32:54,709 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 14:32:54,709 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 14:32:54,709 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 14:32:57,247 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 14:32:57,247 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-26...
2025-12-23 14:32:57,351 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240926 for 519 symbols
2025-12-23 14:35:04,287 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,489,929 NBBO records
2025-12-23 14:35:04,287 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,489,929 rows
2025-12-23 14:35:36,225 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,389,126 NBBO records
2025-12-23 14:35:36,226 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,389,126 rows
2025-12-23 14:36:16,141 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,640,295 NBBO records
2025-12-23 14:36:16,141 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,640,295 rows
2025-12-23 14:36:54,655 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,508,500 NBBO records
2025-12-23 14:36:54,655 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,508,500 rows
2025-12-23 14:39:01,841 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,451,188 NBBO records
2025-12-23 14:39:01,842 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,451,188 rows
2025-12-23 14:41:04,842 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,650,615 NBBO records
2025-12-23 14:41:04,842 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,650,615 rows
2025-12-23 14:44:31,581 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,193,673 NBBO records
2025-12-23 14:44:31,582 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,193,673 rows
2025-12-23 14:48:10,070 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,344,937 NBBO records
2025-12-23 14:48:10,071 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,344,937 rows
2025-12-23 14:50:26,677 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,447,647 NBBO records
2025-12-23 14:50:26,681 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,447,647 rows
2025-12-23 14:53:21,461 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,814,257 NBBO records
2025-12-23 14:53:21,461 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,814,257 rows
2025-12-23 14:53:21,762 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 39,930,167 total rows written
2025-12-23 14:57:49,143 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,970,214 NBBO records
2025-12-23 14:57:49,143 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,970,214 rows
2025-12-23 14:57:49,668 INFO [src.stage_a.parquet_writer] ✓ Wrote 45,900,381 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-26
2025-12-23 14:57:49,672 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 14:57:49,672 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 14:57:49,672 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 14:57:49,672 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 14:57:49,672 INFO [src.stage_a.stage_a] Trades: 29,118,192 rows
2025-12-23 14:57:49,672 INFO [src.stage_a.stage_a] Nbbo: 45,900,381 rows
2025-12-23 14:57:49,672 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 14:57:49,672 INFO [src.stage_a.stage_a] Processing date 75/140: 2024-09-27
2025-12-23 14:57:49,672 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 14:57:49,672 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 14:57:49,672 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-09-27 (519 symbols)
2025-12-23 14:57:49,672 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 14:57:49,672 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 14:57:49,672 INFO [src.stage_a.stage_a] Extract run ID: 20aee2f2-843a-43f5-bcea-15554242c7ba
2025-12-23 14:57:49,680 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 14:57:49,680 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 14:57:49,680 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 14:57:49,680 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 14:57:49,680 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 14:57:49,680 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 14:57:49,680 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 14:57:49,680 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 14:57:49,680 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 14:57:51,670 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 14:57:51,670 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-27...
2025-12-23 14:57:51,865 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240927 for 519 symbols
2025-12-23 14:58:34,179 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,873,952 trades
2025-12-23 14:58:34,179 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,873,952 rows
2025-12-23 14:59:16,107 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,855,508 trades
2025-12-23 14:59:16,108 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,855,508 rows
2025-12-23 15:00:56,028 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,059,486 trades
2025-12-23 15:00:56,028 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,059,486 rows
2025-12-23 15:02:30,558 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,632,319 trades
2025-12-23 15:02:30,558 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,632,319 rows
2025-12-23 15:04:37,471 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,314,029 trades
2025-12-23 15:04:37,471 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,314,029 rows
2025-12-23 15:06:10,556 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,110,102 trades
2025-12-23 15:06:10,556 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,110,102 rows
2025-12-23 15:09:30,216 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,265,902 trades
2025-12-23 15:09:30,217 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,265,902 rows
2025-12-23 15:11:38,109 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,193,643 trades
2025-12-23 15:11:38,119 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,193,643 rows
2025-12-23 15:13:38,713 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,013,805 trades
2025-12-23 15:13:38,714 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,013,805 rows
2025-12-23 15:15:49,208 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,806,843 trades
2025-12-23 15:15:49,208 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,806,843 rows
2025-12-23 15:15:49,591 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 24,125,589 total rows written
2025-12-23 15:16:24,731 INFO [src.stage_a.wrds_extractor]   Chunk 11: 979,035 trades
2025-12-23 15:16:24,731 INFO [src.stage_a.parquet_writer]   Chunk 11: 979,035 rows
2025-12-23 15:16:25,042 INFO [src.stage_a.parquet_writer] ✓ Wrote 25,104,624 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-27
2025-12-23 15:16:25,043 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 15:16:25,043 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 15:16:25,043 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 15:16:25,043 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 15:16:25,043 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 15:16:25,043 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 15:16:25,043 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 15:16:27,084 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 15:16:27,084 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-27...
2025-12-23 15:16:28,183 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240927 for 519 symbols
2025-12-23 15:19:03,187 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,958,655 NBBO records
2025-12-23 15:19:03,187 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,958,655 rows
2025-12-23 15:20:27,264 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,258,934 NBBO records
2025-12-23 15:20:27,264 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,258,934 rows
2025-12-23 15:21:31,178 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,254,129 NBBO records
2025-12-23 15:21:31,178 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,254,129 rows
2025-12-23 15:21:59,851 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,075,466 NBBO records
2025-12-23 15:21:59,851 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,075,466 rows
2025-12-23 15:22:53,766 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,606,837 NBBO records
2025-12-23 15:22:53,767 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,606,837 rows
2025-12-23 15:24:50,871 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,211,020 NBBO records
2025-12-23 15:24:50,871 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,211,020 rows
2025-12-23 15:27:13,647 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,839,444 NBBO records
2025-12-23 15:27:13,647 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,839,444 rows
2025-12-23 15:29:35,025 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,584,139 NBBO records
2025-12-23 15:29:35,026 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,584,139 rows
2025-12-23 15:31:07,257 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,174,404 NBBO records
2025-12-23 15:31:07,257 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,174,404 rows
2025-12-23 15:32:39,256 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,016,683 NBBO records
2025-12-23 15:32:39,256 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,016,683 rows
2025-12-23 15:32:39,519 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 33,979,711 total rows written
2025-12-23 15:33:41,860 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,657,829 NBBO records
2025-12-23 15:33:41,860 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,657,829 rows
2025-12-23 15:33:42,354 INFO [src.stage_a.parquet_writer] ✓ Wrote 39,637,540 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-27
2025-12-23 15:33:42,361 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 15:33:42,361 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 15:33:42,361 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 15:33:42,361 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 15:33:42,361 INFO [src.stage_a.stage_a] Trades: 25,104,624 rows
2025-12-23 15:33:42,361 INFO [src.stage_a.stage_a] Nbbo: 39,637,540 rows
2025-12-23 15:33:42,361 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 15:33:42,361 INFO [src.stage_a.stage_a] Processing date 76/140: 2024-09-30
2025-12-23 15:33:42,361 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 15:33:42,361 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 15:33:42,361 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-09-30 (519 symbols)
2025-12-23 15:33:42,361 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 15:33:42,361 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 15:33:42,361 INFO [src.stage_a.stage_a] Extract run ID: 66b20831-27a1-4d24-bd04-c9e88677371f
2025-12-23 15:33:42,369 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 15:33:42,369 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 15:33:42,369 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 15:33:42,369 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 15:33:42,369 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 15:33:42,369 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 15:33:42,369 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 15:33:42,369 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 15:33:42,369 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 15:33:43,444 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 15:33:43,444 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-30...
2025-12-23 15:33:43,507 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240930 for 519 symbols
2025-12-23 15:35:15,447 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,983,309 trades
2025-12-23 15:35:15,447 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,983,309 rows
2025-12-23 15:36:40,129 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,002,434 trades
2025-12-23 15:36:40,130 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,002,434 rows
2025-12-23 15:38:27,789 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,043,849 trades
2025-12-23 15:38:27,789 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,043,849 rows
2025-12-23 15:39:33,260 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,668,994 trades
2025-12-23 15:39:33,260 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,668,994 rows
2025-12-23 15:40:09,203 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,277,426 trades
2025-12-23 15:40:09,203 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,277,426 rows
2025-12-23 15:41:44,768 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,030,889 trades
2025-12-23 15:41:44,768 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,030,889 rows
2025-12-23 15:44:35,855 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,926,311 trades
2025-12-23 15:44:35,856 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,926,311 rows
2025-12-23 15:46:27,423 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,232,019 trades
2025-12-23 15:46:27,429 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,232,019 rows
2025-12-23 15:48:08,815 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,031,510 trades
2025-12-23 15:48:08,815 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,031,510 rows
2025-12-23 15:50:16,792 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,971,749 trades
2025-12-23 15:50:16,792 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,971,749 rows
2025-12-23 15:50:17,200 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 24,168,490 total rows written
2025-12-23 15:51:21,651 INFO [src.stage_a.wrds_extractor]   Chunk 11: 945,001 trades
2025-12-23 15:51:21,651 INFO [src.stage_a.parquet_writer]   Chunk 11: 945,001 rows
2025-12-23 15:51:21,949 INFO [src.stage_a.parquet_writer] ✓ Wrote 25,113,491 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-09-30
2025-12-23 15:51:21,950 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 15:51:21,950 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 15:51:21,950 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 15:51:21,950 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 15:51:21,950 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 15:51:21,950 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 15:51:21,950 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 15:51:23,940 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 15:51:23,940 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-30...
2025-12-23 15:51:24,085 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240930 for 519 symbols
2025-12-23 15:53:22,702 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,207,064 NBBO records
2025-12-23 15:53:22,702 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,207,064 rows
2025-12-23 15:55:05,142 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,548,253 NBBO records
2025-12-23 15:55:05,142 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,548,253 rows
2025-12-23 15:56:08,319 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,585,473 NBBO records
2025-12-23 15:56:08,319 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,585,473 rows
2025-12-23 15:57:17,190 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,301,083 NBBO records
2025-12-23 15:57:17,190 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,301,083 rows
2025-12-23 15:59:22,182 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,724,366 NBBO records
2025-12-23 15:59:22,182 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,724,366 rows
2025-12-23 16:00:41,873 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,185,072 NBBO records
2025-12-23 16:00:41,873 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,185,072 rows
2025-12-23 16:03:37,383 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,033,694 NBBO records
2025-12-23 16:03:37,383 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,033,694 rows
2025-12-23 16:05:53,946 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,950,355 NBBO records
2025-12-23 16:05:53,947 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,950,355 rows
2025-12-23 16:07:10,625 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,142,101 NBBO records
2025-12-23 16:07:10,630 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,142,101 rows
2025-12-23 16:07:39,097 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,043,866 NBBO records
2025-12-23 16:07:39,097 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,043,866 rows
2025-12-23 16:07:39,367 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 35,721,327 total rows written
2025-12-23 16:10:39,846 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,644,337 NBBO records
2025-12-23 16:10:39,846 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,644,337 rows
2025-12-23 16:10:40,336 INFO [src.stage_a.parquet_writer] ✓ Wrote 41,365,664 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-09-30
2025-12-23 16:10:40,343 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 16:10:40,343 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 16:10:40,343 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 16:10:40,343 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 16:10:40,343 INFO [src.stage_a.stage_a] Trades: 25,113,491 rows
2025-12-23 16:10:40,343 INFO [src.stage_a.stage_a] Nbbo: 41,365,664 rows
2025-12-23 16:10:40,343 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 16:10:40,343 INFO [src.stage_a.stage_a] Processing date 77/140: 2024-10-01
2025-12-23 16:10:40,343 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 16:10:40,343 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 16:10:40,343 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-10-01 (519 symbols)
2025-12-23 16:10:40,343 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 16:10:40,343 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 16:10:40,344 INFO [src.stage_a.stage_a] Extract run ID: c56092d9-f05d-43c9-b115-71261ddc9a5d
2025-12-23 16:10:40,352 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 16:10:40,352 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 16:10:40,352 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 16:10:40,352 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 16:10:40,352 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 16:10:40,352 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 16:10:40,352 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 16:10:40,352 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 16:10:40,352 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 16:10:43,183 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 16:10:43,184 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-01...
2025-12-23 16:10:43,288 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241001 for 519 symbols
2025-12-23 16:13:24,291 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,457,332 trades
2025-12-23 16:13:24,291 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,457,332 rows
2025-12-23 16:14:02,669 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,196,494 trades
2025-12-23 16:14:02,670 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,196,494 rows
2025-12-23 16:14:49,013 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,275,703 trades
2025-12-23 16:14:49,013 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,275,703 rows
2025-12-23 16:16:39,719 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,839,691 trades
2025-12-23 16:16:39,720 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,839,691 rows
2025-12-23 16:19:23,521 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,781,820 trades
2025-12-23 16:19:23,522 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,781,820 rows
2025-12-23 16:21:15,026 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,314,729 trades
2025-12-23 16:21:15,026 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,314,729 rows
2025-12-23 16:26:00,595 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,959,121 trades
2025-12-23 16:26:00,595 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,959,121 rows
2025-12-23 16:27:23,807 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,692,576 trades
2025-12-23 16:27:23,814 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,692,576 rows
2025-12-23 16:29:32,781 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,568,268 trades
2025-12-23 16:29:32,800 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,568,268 rows
2025-12-23 16:32:17,205 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,217,824 trades
2025-12-23 16:32:17,205 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,217,824 rows
2025-12-23 16:32:17,657 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 28,303,558 total rows written
2025-12-23 16:33:41,980 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,343,292 trades
2025-12-23 16:33:41,983 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,343,292 rows
2025-12-23 16:33:42,353 INFO [src.stage_a.parquet_writer] ✓ Wrote 29,646,850 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-01
2025-12-23 16:33:42,356 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 16:33:42,356 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 16:33:42,356 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 16:33:42,356 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 16:33:42,356 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 16:33:42,356 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 16:33:42,356 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 16:33:44,186 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 16:33:44,187 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-01...
2025-12-23 16:33:44,262 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241001 for 519 symbols
2025-12-23 16:36:26,994 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,697,399 NBBO records
2025-12-23 16:36:26,994 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,697,399 rows
2025-12-23 16:38:29,071 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,566,928 NBBO records
2025-12-23 16:38:29,072 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,566,928 rows
2025-12-23 16:41:17,847 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,478,539 NBBO records
2025-12-23 16:41:17,847 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,478,539 rows
2025-12-23 16:42:58,193 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,090,584 NBBO records
2025-12-23 16:42:58,194 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,090,584 rows
2025-12-23 16:46:03,422 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,130,288 NBBO records
2025-12-23 16:46:03,422 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,130,288 rows
2025-12-23 16:49:04,558 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,513,736 NBBO records
2025-12-23 16:49:04,559 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,513,736 rows
2025-12-23 16:53:43,502 INFO [src.stage_a.wrds_extractor]   Chunk 7: 7,365,552 NBBO records
2025-12-23 16:53:43,502 INFO [src.stage_a.parquet_writer]   Chunk 7: 7,365,552 rows
2025-12-23 16:57:01,920 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,827,382 NBBO records
2025-12-23 16:57:01,924 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,827,382 rows
2025-12-23 17:00:26,038 INFO [src.stage_a.wrds_extractor]   Chunk 9: 5,045,528 NBBO records
2025-12-23 17:00:26,044 INFO [src.stage_a.parquet_writer]   Chunk 9: 5,045,528 rows
2025-12-23 17:02:53,024 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,100,028 NBBO records
2025-12-23 17:02:53,025 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,100,028 rows
2025-12-23 17:02:53,352 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 49,815,964 total rows written
2025-12-23 17:05:07,736 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,925,396 NBBO records
2025-12-23 17:05:07,736 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,925,396 rows
2025-12-23 17:05:08,431 INFO [src.stage_a.parquet_writer] ✓ Wrote 57,741,360 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-01
2025-12-23 17:05:08,439 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 17:05:08,439 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 17:05:08,439 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 17:05:08,439 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 17:05:08,439 INFO [src.stage_a.stage_a] Trades: 29,646,850 rows
2025-12-23 17:05:08,439 INFO [src.stage_a.stage_a] Nbbo: 57,741,360 rows
2025-12-23 17:05:08,439 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 17:05:08,439 INFO [src.stage_a.stage_a] Processing date 78/140: 2024-10-02
2025-12-23 17:05:08,439 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 17:05:08,439 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 17:05:08,439 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-10-02 (519 symbols)
2025-12-23 17:05:08,439 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 17:05:08,439 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 17:05:08,439 INFO [src.stage_a.stage_a] Extract run ID: 38cf916d-ecbb-47c5-a2cb-22acedee7436
2025-12-23 17:05:08,447 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 17:05:08,447 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 17:05:08,447 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 17:05:08,447 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 17:05:08,447 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 17:05:08,447 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 17:05:08,447 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 17:05:08,447 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 17:05:08,447 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 17:05:09,635 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 17:05:09,636 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-02...
2025-12-23 17:05:09,820 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241002 for 519 symbols
2025-12-23 17:07:46,626 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,640,599 trades
2025-12-23 17:07:46,627 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,640,599 rows
2025-12-23 17:10:04,660 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,860,490 trades
2025-12-23 17:10:04,660 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,860,490 rows
2025-12-23 17:11:17,667 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,067,154 trades
2025-12-23 17:11:17,667 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,067,154 rows
2025-12-23 17:13:01,172 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,602,871 trades
2025-12-23 17:13:01,172 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,602,871 rows
2025-12-23 17:14:52,819 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,454,981 trades
2025-12-23 17:14:52,819 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,454,981 rows
2025-12-23 17:16:48,332 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,959,848 trades
2025-12-23 17:16:48,332 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,959,848 rows
2025-12-23 17:17:49,207 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,769,579 trades
2025-12-23 17:17:49,208 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,769,579 rows
2025-12-23 17:18:22,673 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,128,877 trades
2025-12-23 17:18:22,678 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,128,877 rows
2025-12-23 17:18:53,682 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,950,389 trades
2025-12-23 17:18:53,682 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,950,389 rows
2025-12-23 17:21:11,368 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,971,875 trades
2025-12-23 17:21:11,368 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,971,875 rows
2025-12-23 17:21:11,769 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,406,663 total rows written
2025-12-23 17:21:55,107 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,040,091 trades
2025-12-23 17:21:55,107 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,040,091 rows
2025-12-23 17:21:55,425 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,446,754 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-02
2025-12-23 17:21:55,426 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 17:21:55,426 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 17:21:55,426 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 17:21:55,426 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 17:21:55,426 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 17:21:55,426 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 17:21:55,426 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 17:21:57,668 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 17:21:57,668 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-02...
2025-12-23 17:21:57,886 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241002 for 519 symbols
2025-12-23 17:24:17,862 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,296,536 NBBO records
2025-12-23 17:24:17,862 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,296,536 rows
2025-12-23 17:24:46,681 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,251,441 NBBO records
2025-12-23 17:24:46,681 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,251,441 rows
2025-12-23 17:25:37,157 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,407,340 NBBO records
2025-12-23 17:25:37,157 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,407,340 rows
2025-12-23 17:26:06,632 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,072,387 NBBO records
2025-12-23 17:26:06,632 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,072,387 rows
2025-12-23 17:28:33,677 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,687,991 NBBO records
2025-12-23 17:28:33,677 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,687,991 rows
2025-12-23 17:30:10,023 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,006,432 NBBO records
2025-12-23 17:30:10,024 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,006,432 rows
2025-12-23 17:32:00,662 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,703,377 NBBO records
2025-12-23 17:32:00,662 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,703,377 rows
2025-12-23 17:33:07,180 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,806,129 NBBO records
2025-12-23 17:33:07,180 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,806,129 rows
2025-12-23 17:34:46,206 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,323,790 NBBO records
2025-12-23 17:34:46,212 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,323,790 rows
2025-12-23 17:36:19,909 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,032,733 NBBO records
2025-12-23 17:36:19,909 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,032,733 rows
2025-12-23 17:36:20,185 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 33,588,156 total rows written
2025-12-23 17:38:57,094 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,273,693 NBBO records
2025-12-23 17:38:57,094 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,273,693 rows
2025-12-23 17:38:57,545 INFO [src.stage_a.parquet_writer] ✓ Wrote 38,861,849 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-02
2025-12-23 17:38:57,551 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 17:38:57,551 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 17:38:57,551 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 17:38:57,551 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 17:38:57,551 INFO [src.stage_a.stage_a] Trades: 24,446,754 rows
2025-12-23 17:38:57,551 INFO [src.stage_a.stage_a] Nbbo: 38,861,849 rows
2025-12-23 17:38:57,551 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 17:38:57,551 INFO [src.stage_a.stage_a] Processing date 79/140: 2024-10-03
2025-12-23 17:38:57,551 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 17:38:57,551 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 17:38:57,551 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-10-03 (519 symbols)
2025-12-23 17:38:57,551 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 17:38:57,551 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 17:38:57,551 INFO [src.stage_a.stage_a] Extract run ID: 0407aa5d-627f-48c6-9d49-3457bce1da00
2025-12-23 17:38:57,559 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 17:38:57,559 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 17:38:57,559 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 17:38:57,559 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 17:38:57,559 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 17:38:57,559 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 17:38:57,559 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 17:38:57,559 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 17:38:57,559 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 17:38:58,699 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 17:38:58,699 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-03...
2025-12-23 17:38:58,753 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241003 for 519 symbols
2025-12-23 17:40:55,128 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,741,899 trades
2025-12-23 17:40:55,128 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,741,899 rows
2025-12-23 17:42:20,939 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,803,308 trades
2025-12-23 17:42:20,939 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,803,308 rows
2025-12-23 17:43:30,579 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,827,208 trades
2025-12-23 17:43:30,579 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,827,208 rows
2025-12-23 17:44:34,050 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,562,274 trades
2025-12-23 17:44:34,050 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,562,274 rows
2025-12-23 17:45:33,815 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,133,953 trades
2025-12-23 17:45:33,815 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,133,953 rows
2025-12-23 17:46:52,524 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,935,487 trades
2025-12-23 17:46:52,525 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,935,487 rows
2025-12-23 17:50:15,511 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,079,916 trades
2025-12-23 17:50:15,511 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,079,916 rows
2025-12-23 17:51:56,113 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,136,560 trades
2025-12-23 17:51:56,117 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,136,560 rows
2025-12-23 17:53:35,058 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,059,324 trades
2025-12-23 17:53:35,058 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,059,324 rows
2025-12-23 17:55:45,331 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,865,415 trades
2025-12-23 17:55:45,331 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,865,415 rows
2025-12-23 17:55:45,730 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,145,344 total rows written
2025-12-23 17:56:15,261 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,062,891 trades
2025-12-23 17:56:15,261 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,062,891 rows
2025-12-23 17:56:15,558 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,208,235 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-03
2025-12-23 17:56:15,559 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 17:56:15,559 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 17:56:15,559 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 17:56:15,559 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 17:56:15,559 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 17:56:15,559 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 17:56:15,559 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 17:56:16,687 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 17:56:16,687 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-03...
2025-12-23 17:56:16,750 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241003 for 519 symbols
2025-12-23 17:57:08,939 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,858,974 NBBO records
2025-12-23 17:57:08,939 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,858,974 rows
2025-12-23 17:58:20,138 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,398,707 NBBO records
2025-12-23 17:58:20,139 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,398,707 rows
2025-12-23 18:00:11,882 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,818,450 NBBO records
2025-12-23 18:00:11,882 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,818,450 rows
2025-12-23 18:01:32,536 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,347,713 NBBO records
2025-12-23 18:01:32,536 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,347,713 rows
2025-12-23 18:03:30,874 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,947,034 NBBO records
2025-12-23 18:03:30,875 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,947,034 rows
2025-12-23 18:05:14,263 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,835,007 NBBO records
2025-12-23 18:05:14,263 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,835,007 rows
2025-12-23 18:07:39,397 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,804,766 NBBO records
2025-12-23 18:07:39,397 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,804,766 rows
2025-12-23 18:10:12,650 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,818,357 NBBO records
2025-12-23 18:10:12,651 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,818,357 rows
2025-12-23 18:11:55,389 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,474,626 NBBO records
2025-12-23 18:11:55,389 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,474,626 rows
2025-12-23 18:13:12,630 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,959,307 NBBO records
2025-12-23 18:13:12,630 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,959,307 rows
2025-12-23 18:13:12,922 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 37,262,941 total rows written
2025-12-23 18:14:14,626 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,742,142 NBBO records
2025-12-23 18:14:14,626 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,742,142 rows
2025-12-23 18:14:15,162 INFO [src.stage_a.parquet_writer] ✓ Wrote 43,005,083 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-03
2025-12-23 18:14:15,171 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 18:14:15,171 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 18:14:15,171 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 18:14:15,171 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 18:14:15,171 INFO [src.stage_a.stage_a] Trades: 24,208,235 rows
2025-12-23 18:14:15,171 INFO [src.stage_a.stage_a] Nbbo: 43,005,083 rows
2025-12-23 18:14:15,171 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 18:14:15,171 INFO [src.stage_a.stage_a] Processing date 80/140: 2024-10-04
2025-12-23 18:14:15,171 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 18:14:15,171 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 18:14:15,171 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-10-04 (519 symbols)
2025-12-23 18:14:15,171 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 18:14:15,171 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 18:14:15,171 INFO [src.stage_a.stage_a] Extract run ID: 73db1434-8235-48c8-a13f-52d3acbfc3fe
2025-12-23 18:14:15,179 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 18:14:15,179 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 18:14:15,179 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 18:14:15,179 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 18:14:15,179 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 18:14:15,179 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 18:14:15,179 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 18:14:15,179 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 18:14:15,179 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 18:14:16,302 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 18:14:16,302 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-04...
2025-12-23 18:14:16,386 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241004 for 519 symbols
2025-12-23 18:15:06,062 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,083,057 trades
2025-12-23 18:15:06,062 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,083,057 rows
2025-12-23 18:15:44,907 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,865,649 trades
2025-12-23 18:15:44,908 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,865,649 rows
2025-12-23 18:16:21,527 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,002,625 trades
2025-12-23 18:16:21,527 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,002,625 rows
2025-12-23 18:16:50,203 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,614,927 trades
2025-12-23 18:16:50,203 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,614,927 rows
2025-12-23 18:17:28,611 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,177,119 trades
2025-12-23 18:17:28,611 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,177,119 rows
2025-12-23 18:18:07,698 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,100,311 trades
2025-12-23 18:18:07,698 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,100,311 rows
2025-12-23 18:19:08,378 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,992,775 trades
2025-12-23 18:19:08,378 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,992,775 rows
2025-12-23 18:20:16,223 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,241,458 trades
2025-12-23 18:20:16,235 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,241,458 rows
2025-12-23 18:21:39,985 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,039,579 trades
2025-12-23 18:21:39,985 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,039,579 rows
2025-12-23 18:23:32,983 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,995,058 trades
2025-12-23 18:23:32,983 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,995,058 rows
2025-12-23 18:23:33,375 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 24,112,558 total rows written
2025-12-23 18:24:21,946 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,112,799 trades
2025-12-23 18:24:21,946 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,112,799 rows
2025-12-23 18:24:22,265 INFO [src.stage_a.parquet_writer] ✓ Wrote 25,225,357 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-04
2025-12-23 18:24:22,266 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 18:24:22,266 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 18:24:22,266 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 18:24:22,266 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 18:24:22,266 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 18:24:22,266 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 18:24:22,266 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 18:24:23,526 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 18:24:23,526 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-04...
2025-12-23 18:24:23,590 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241004 for 519 symbols
2025-12-23 18:25:48,832 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,384,679 NBBO records
2025-12-23 18:25:48,832 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,384,679 rows
2025-12-23 18:27:46,947 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,464,934 NBBO records
2025-12-23 18:27:46,947 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,464,934 rows
2025-12-23 18:29:49,033 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,723,768 NBBO records
2025-12-23 18:29:49,034 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,723,768 rows
2025-12-23 18:31:09,026 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,273,245 NBBO records
2025-12-23 18:31:09,027 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,273,245 rows
2025-12-23 18:31:49,766 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,610,342 NBBO records
2025-12-23 18:31:49,766 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,610,342 rows
2025-12-23 18:32:32,341 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,574,480 NBBO records
2025-12-23 18:32:32,342 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,574,480 rows
2025-12-23 18:36:21,857 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,769,307 NBBO records
2025-12-23 18:36:21,858 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,769,307 rows
2025-12-23 18:38:28,783 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,067,551 NBBO records
2025-12-23 18:38:28,784 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,067,551 rows
2025-12-23 18:40:27,064 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,695,237 NBBO records
2025-12-23 18:40:27,065 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,695,237 rows
2025-12-23 18:42:09,443 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,310,178 NBBO records
2025-12-23 18:42:09,443 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,310,178 rows
2025-12-23 18:42:09,747 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 37,873,721 total rows written
2025-12-23 18:46:22,912 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,967,475 NBBO records
2025-12-23 18:46:22,912 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,967,475 rows
2025-12-23 18:46:23,454 INFO [src.stage_a.parquet_writer] ✓ Wrote 43,841,196 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-04
2025-12-23 18:46:23,459 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 18:46:23,459 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 18:46:23,459 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 18:46:23,459 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 18:46:23,459 INFO [src.stage_a.stage_a] Trades: 25,225,357 rows
2025-12-23 18:46:23,459 INFO [src.stage_a.stage_a] Nbbo: 43,841,196 rows
2025-12-23 18:46:23,459 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 18:46:23,459 INFO [src.stage_a.stage_a] Processing date 81/140: 2024-10-07
2025-12-23 18:46:23,459 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 18:46:23,459 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 18:46:23,459 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-10-07 (519 symbols)
2025-12-23 18:46:23,459 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 18:46:23,459 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 18:46:23,459 INFO [src.stage_a.stage_a] Extract run ID: 9add5d72-5c1f-492c-96ce-da640ffda782
2025-12-23 18:46:23,467 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 18:46:23,467 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 18:46:23,467 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 18:46:23,467 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 18:46:23,467 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 18:46:23,467 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 18:46:23,467 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 18:46:23,467 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 18:46:23,467 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 18:46:24,913 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 18:46:24,913 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-07...
2025-12-23 18:46:24,986 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241007 for 519 symbols
2025-12-23 18:49:57,519 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,297,138 trades
2025-12-23 18:49:57,520 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,297,138 rows
2025-12-23 18:51:51,246 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,787,095 trades
2025-12-23 18:51:51,246 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,787,095 rows
2025-12-23 18:53:43,663 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,059,445 trades
2025-12-23 18:53:43,663 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,059,445 rows
2025-12-23 18:54:51,945 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,584,950 trades
2025-12-23 18:54:51,945 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,584,950 rows
2025-12-23 18:56:47,509 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,255,045 trades
2025-12-23 18:56:47,509 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,255,045 rows
2025-12-23 18:58:11,006 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,916,328 trades
2025-12-23 18:58:11,006 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,916,328 rows
2025-12-23 19:02:42,960 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,919,823 trades
2025-12-23 19:02:42,960 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,919,823 rows
2025-12-23 19:04:51,726 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,172,992 trades
2025-12-23 19:04:51,732 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,172,992 rows
2025-12-23 19:06:56,240 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,524,169 trades
2025-12-23 19:06:56,241 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,524,169 rows
2025-12-23 19:09:33,453 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,891,332 trades
2025-12-23 19:09:33,453 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,891,332 rows
2025-12-23 19:09:33,839 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,408,317 total rows written
2025-12-23 19:10:29,217 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,046,422 trades
2025-12-23 19:10:29,217 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,046,422 rows
2025-12-23 19:10:29,512 INFO [src.stage_a.parquet_writer] ✓ Wrote 26,454,739 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-07
2025-12-23 19:10:29,513 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 19:10:29,513 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 19:10:29,513 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 19:10:29,513 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 19:10:29,513 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 19:10:29,513 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 19:10:29,513 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 19:10:31,780 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 19:10:31,780 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-07...
2025-12-23 19:10:31,988 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241007 for 519 symbols
2025-12-23 19:12:19,895 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,462,313 NBBO records
2025-12-23 19:12:19,895 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,462,313 rows
2025-12-23 19:13:33,115 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,392,663 NBBO records
2025-12-23 19:13:33,115 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,392,663 rows
2025-12-23 19:14:53,704 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,625,583 NBBO records
2025-12-23 19:14:53,704 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,625,583 rows
2025-12-23 19:15:24,189 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,389,036 NBBO records
2025-12-23 19:15:24,189 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,389,036 rows
2025-12-23 19:16:09,309 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,892,936 NBBO records
2025-12-23 19:16:09,309 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,892,936 rows
2025-12-23 19:16:49,493 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,418,318 NBBO records
2025-12-23 19:16:49,493 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,418,318 rows
2025-12-23 19:19:20,562 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,812,038 NBBO records
2025-12-23 19:19:20,562 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,812,038 rows
2025-12-23 19:21:41,502 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,668,396 NBBO records
2025-12-23 19:21:41,503 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,668,396 rows
2025-12-23 19:22:49,497 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,775,437 NBBO records
2025-12-23 19:22:49,498 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,775,437 rows
2025-12-23 19:24:19,974 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,085,313 NBBO records
2025-12-23 19:24:19,974 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,085,313 rows
2025-12-23 19:24:20,248 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 37,522,033 total rows written
2025-12-23 19:26:40,300 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,468,595 NBBO records
2025-12-23 19:26:40,300 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,468,595 rows
2025-12-23 19:26:40,790 INFO [src.stage_a.parquet_writer] ✓ Wrote 42,990,628 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-07
2025-12-23 19:26:40,794 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 19:26:40,794 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 19:26:40,794 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 19:26:40,794 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 19:26:40,794 INFO [src.stage_a.stage_a] Trades: 26,454,739 rows
2025-12-23 19:26:40,794 INFO [src.stage_a.stage_a] Nbbo: 42,990,628 rows
2025-12-23 19:26:40,795 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 19:26:40,795 INFO [src.stage_a.stage_a] Processing date 82/140: 2024-10-08
2025-12-23 19:26:40,795 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 19:26:40,795 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 19:26:40,795 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-10-08 (519 symbols)
2025-12-23 19:26:40,795 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 19:26:40,795 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 19:26:40,795 INFO [src.stage_a.stage_a] Extract run ID: 5704bb31-72c3-4d01-9faa-9acfdf02f337
2025-12-23 19:26:40,803 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 19:26:40,803 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 19:26:40,803 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 19:26:40,803 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 19:26:40,803 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 19:26:40,803 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 19:26:40,803 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 19:26:40,803 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 19:26:40,803 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 19:26:42,182 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 19:26:42,183 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-08...
2025-12-23 19:26:42,246 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241008 for 519 symbols
2025-12-23 19:28:47,623 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,863,268 trades
2025-12-23 19:28:47,623 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,863,268 rows
2025-12-23 19:30:05,235 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,688,933 trades
2025-12-23 19:30:05,235 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,688,933 rows
2025-12-23 19:31:12,874 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,872,407 trades
2025-12-23 19:31:12,874 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,872,407 rows
2025-12-23 19:32:14,843 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,629,980 trades
2025-12-23 19:32:14,843 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,629,980 rows
2025-12-23 19:34:07,000 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,208,978 trades
2025-12-23 19:34:07,000 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,208,978 rows
2025-12-23 19:35:25,265 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,776,349 trades
2025-12-23 19:35:25,265 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,776,349 rows
2025-12-23 19:38:04,490 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,104,071 trades
2025-12-23 19:38:04,490 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,104,071 rows
2025-12-23 19:39:48,489 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,039,936 trades
2025-12-23 19:39:48,503 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,039,936 rows
2025-12-23 19:41:16,603 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,348,556 trades
2025-12-23 19:41:16,603 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,348,556 rows
2025-12-23 19:43:20,295 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,548,304 trades
2025-12-23 19:43:20,295 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,548,304 rows
2025-12-23 19:43:20,654 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,080,782 total rows written
2025-12-23 19:44:07,347 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,005,061 trades
2025-12-23 19:44:07,347 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,005,061 rows
2025-12-23 19:44:07,644 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,085,843 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-08
2025-12-23 19:44:07,645 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 19:44:07,645 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 19:44:07,645 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 19:44:07,645 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 19:44:07,645 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 19:44:07,645 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 19:44:07,645 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 19:44:09,110 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 19:44:09,111 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-08...
2025-12-23 19:44:09,203 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241008 for 519 symbols
2025-12-23 19:46:39,077 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,908,022 NBBO records
2025-12-23 19:46:39,077 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,908,022 rows
2025-12-23 19:47:59,503 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,753,722 NBBO records
2025-12-23 19:47:59,503 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,753,722 rows
2025-12-23 19:49:44,425 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,122,594 NBBO records
2025-12-23 19:49:44,425 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,122,594 rows
2025-12-23 19:51:45,476 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,903,452 NBBO records
2025-12-23 19:51:45,476 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,903,452 rows
2025-12-23 19:53:55,317 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,262,340 NBBO records
2025-12-23 19:53:55,317 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,262,340 rows
2025-12-23 19:54:44,435 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,586,506 NBBO records
2025-12-23 19:54:44,435 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,586,506 rows
2025-12-23 19:58:13,842 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,961,943 NBBO records
2025-12-23 19:58:13,842 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,961,943 rows
2025-12-23 20:00:21,268 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,691,901 NBBO records
2025-12-23 20:00:21,269 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,691,901 rows
2025-12-23 20:01:07,528 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,914,717 NBBO records
2025-12-23 20:01:07,528 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,914,717 rows
2025-12-23 20:13:13,319 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,936,536 NBBO records
2025-12-23 20:13:13,319 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,936,536 rows
2025-12-23 20:13:13,652 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 41,041,733 total rows written
2025-12-23 20:16:28,499 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,403,616 NBBO records
2025-12-23 20:16:28,499 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,403,616 rows
2025-12-23 20:16:28,994 INFO [src.stage_a.parquet_writer] ✓ Wrote 46,445,349 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-08
2025-12-23 20:16:29,002 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 20:16:29,002 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 20:16:29,002 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 20:16:29,002 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 20:16:29,002 INFO [src.stage_a.stage_a] Trades: 24,085,843 rows
2025-12-23 20:16:29,002 INFO [src.stage_a.stage_a] Nbbo: 46,445,349 rows
2025-12-23 20:16:29,002 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 20:16:29,002 INFO [src.stage_a.stage_a] Processing date 83/140: 2024-10-09
2025-12-23 20:16:29,002 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 20:16:29,002 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 20:16:29,002 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-10-09 (519 symbols)
2025-12-23 20:16:29,002 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 20:16:29,002 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 20:16:29,002 INFO [src.stage_a.stage_a] Extract run ID: 48a914cb-8729-4bf6-b63e-de5187050512
2025-12-23 20:16:29,011 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 20:16:29,011 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 20:16:29,011 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 20:16:29,011 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 20:16:29,011 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 20:16:29,011 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 20:16:29,011 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 20:16:29,011 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 20:16:29,011 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 20:16:31,393 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 20:16:31,394 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-09...
2025-12-23 20:16:31,528 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241009 for 519 symbols
2025-12-23 20:18:56,623 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,949,390 trades
2025-12-23 20:18:56,623 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,949,390 rows
2025-12-23 20:20:36,411 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,934,934 trades
2025-12-23 20:20:36,411 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,934,934 rows
2025-12-23 20:22:04,732 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,863,906 trades
2025-12-23 20:22:04,732 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,863,906 rows
2025-12-23 20:23:06,641 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,462,274 trades
2025-12-23 20:23:06,641 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,462,274 rows
2025-12-23 20:24:54,691 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,506,637 trades
2025-12-23 20:24:54,691 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,506,637 rows
2025-12-23 20:25:27,207 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,790,125 trades
2025-12-23 20:25:27,207 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,790,125 rows
2025-12-23 20:27:09,063 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,001,139 trades
2025-12-23 20:27:09,063 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,001,139 rows
2025-12-23 20:28:38,663 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,121,849 trades
2025-12-23 20:28:38,665 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,121,849 rows
2025-12-23 20:30:18,365 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,150,229 trades
2025-12-23 20:30:18,365 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,150,229 rows
2025-12-23 20:31:51,252 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,692,730 trades
2025-12-23 20:31:51,252 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,692,730 rows
2025-12-23 20:31:51,617 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,473,213 total rows written
2025-12-23 20:32:27,612 INFO [src.stage_a.wrds_extractor]   Chunk 11: 886,646 trades
2025-12-23 20:32:27,613 INFO [src.stage_a.parquet_writer]   Chunk 11: 886,646 rows
2025-12-23 20:32:27,871 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,359,859 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-09
2025-12-23 20:32:27,872 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 20:32:27,872 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 20:32:27,872 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 20:32:27,872 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 20:32:27,872 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 20:32:27,872 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 20:32:27,872 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 20:32:29,483 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 20:32:29,483 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-09...
2025-12-23 20:32:29,586 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241009 for 519 symbols
2025-12-23 20:34:47,334 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,209,064 NBBO records
2025-12-23 20:34:47,334 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,209,064 rows
2025-12-23 20:36:31,824 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,355,851 NBBO records
2025-12-23 20:36:31,824 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,355,851 rows
2025-12-23 20:39:02,572 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,743,730 NBBO records
2025-12-23 20:39:02,573 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,743,730 rows
2025-12-23 20:40:44,396 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,132,093 NBBO records
2025-12-23 20:40:44,396 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,132,093 rows
2025-12-23 20:43:06,296 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,945,166 NBBO records
2025-12-23 20:43:06,296 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,945,166 rows
2025-12-23 20:45:00,703 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,098,371 NBBO records
2025-12-23 20:45:00,704 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,098,371 rows
2025-12-23 20:48:14,229 INFO [src.stage_a.wrds_extractor]   Chunk 7: 7,466,190 NBBO records
2025-12-23 20:48:14,229 INFO [src.stage_a.parquet_writer]   Chunk 7: 7,466,190 rows
2025-12-23 20:49:20,190 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,612,250 NBBO records
2025-12-23 20:49:20,194 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,612,250 rows
2025-12-23 20:50:06,606 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,169,213 NBBO records
2025-12-23 20:50:06,606 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,169,213 rows
2025-12-23 20:50:58,576 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,517,447 NBBO records
2025-12-23 20:50:58,576 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,517,447 rows
2025-12-23 20:50:58,944 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 47,249,375 total rows written
2025-12-23 20:52:52,918 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,797,987 NBBO records
2025-12-23 20:52:52,918 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,797,987 rows
2025-12-23 20:52:53,445 INFO [src.stage_a.parquet_writer] ✓ Wrote 53,047,362 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-09
2025-12-23 20:52:53,453 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 20:52:53,454 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 20:52:53,454 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 20:52:53,454 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 20:52:53,454 INFO [src.stage_a.stage_a] Trades: 24,359,859 rows
2025-12-23 20:52:53,454 INFO [src.stage_a.stage_a] Nbbo: 53,047,362 rows
2025-12-23 20:52:53,454 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 20:52:53,454 INFO [src.stage_a.stage_a] Processing date 84/140: 2024-10-10
2025-12-23 20:52:53,454 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 20:52:53,454 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 20:52:53,454 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-10-10 (519 symbols)
2025-12-23 20:52:53,454 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 20:52:53,454 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 20:52:53,454 INFO [src.stage_a.stage_a] Extract run ID: 0c05592d-36bb-4215-8b66-49e58226f38c
2025-12-23 20:52:53,462 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 20:52:53,462 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 20:52:53,462 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 20:52:53,462 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 20:52:53,462 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 20:52:53,462 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 20:52:53,462 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 20:52:53,462 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 20:52:53,462 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 20:52:55,751 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 20:52:55,751 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-10...
2025-12-23 20:52:55,937 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241010 for 519 symbols
2025-12-23 20:55:15,287 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,984,095 trades
2025-12-23 20:55:15,287 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,984,095 rows
2025-12-23 20:56:42,579 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,758,840 trades
2025-12-23 20:56:42,579 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,758,840 rows
2025-12-23 20:58:11,502 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,864,565 trades
2025-12-23 20:58:11,502 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,864,565 rows
2025-12-23 20:59:23,078 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,529,334 trades
2025-12-23 20:59:23,078 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,529,334 rows
2025-12-23 21:01:20,256 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,023,360 trades
2025-12-23 21:01:20,256 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,023,360 rows
2025-12-23 21:02:46,519 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,792,576 trades
2025-12-23 21:02:46,519 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,792,576 rows
2025-12-23 21:05:47,810 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,796,996 trades
2025-12-23 21:05:47,810 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,796,996 rows
2025-12-23 21:07:15,108 INFO [src.stage_a.wrds_extractor]   Chunk 8: 1,996,666 trades
2025-12-23 21:07:15,112 INFO [src.stage_a.parquet_writer]   Chunk 8: 1,996,666 rows
2025-12-23 21:08:21,351 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,982,230 trades
2025-12-23 21:08:21,351 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,982,230 rows
2025-12-23 21:10:25,750 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,763,518 trades
2025-12-23 21:10:25,750 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,763,518 rows
2025-12-23 21:10:26,129 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 22,492,180 total rows written
2025-12-23 21:11:09,154 INFO [src.stage_a.wrds_extractor]   Chunk 11: 832,883 trades
2025-12-23 21:11:09,154 INFO [src.stage_a.parquet_writer]   Chunk 11: 832,883 rows
2025-12-23 21:11:09,410 INFO [src.stage_a.parquet_writer] ✓ Wrote 23,325,063 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-10
2025-12-23 21:11:09,411 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 21:11:09,411 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 21:11:09,411 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 21:11:09,411 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 21:11:09,411 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 21:11:09,411 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 21:11:09,411 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 21:11:11,224 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 21:11:11,224 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-10...
2025-12-23 21:11:11,385 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241010 for 519 symbols
2025-12-23 21:14:41,739 INFO [src.stage_a.wrds_extractor]   Chunk 1: 6,919,604 NBBO records
2025-12-23 21:14:41,739 INFO [src.stage_a.parquet_writer]   Chunk 1: 6,919,604 rows
2025-12-23 21:16:29,546 INFO [src.stage_a.wrds_extractor]   Chunk 2: 4,069,663 NBBO records
2025-12-23 21:16:29,547 INFO [src.stage_a.parquet_writer]   Chunk 2: 4,069,663 rows
2025-12-23 21:19:09,950 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,155,794 NBBO records
2025-12-23 21:19:09,950 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,155,794 rows
2025-12-23 21:20:52,838 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,627,097 NBBO records
2025-12-23 21:20:52,839 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,627,097 rows
2025-12-23 21:24:08,248 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,855,946 NBBO records
2025-12-23 21:24:08,248 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,855,946 rows
2025-12-23 21:26:27,819 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,704,794 NBBO records
2025-12-23 21:26:27,820 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,704,794 rows
2025-12-23 21:30:40,264 INFO [src.stage_a.wrds_extractor]   Chunk 7: 7,936,628 NBBO records
2025-12-23 21:30:40,265 INFO [src.stage_a.parquet_writer]   Chunk 7: 7,936,628 rows
2025-12-23 21:33:58,223 INFO [src.stage_a.wrds_extractor]   Chunk 8: 6,917,176 NBBO records
2025-12-23 21:33:58,226 INFO [src.stage_a.parquet_writer]   Chunk 8: 6,917,176 rows
2025-12-23 21:36:44,642 INFO [src.stage_a.wrds_extractor]   Chunk 9: 5,109,527 NBBO records
2025-12-23 21:36:44,653 INFO [src.stage_a.parquet_writer]   Chunk 9: 5,109,527 rows
2025-12-23 21:39:34,428 INFO [src.stage_a.wrds_extractor]   Chunk 10: 5,514,437 NBBO records
2025-12-23 21:39:34,429 INFO [src.stage_a.parquet_writer]   Chunk 10: 5,514,437 rows
2025-12-23 21:39:34,812 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 55,810,666 total rows written
2025-12-23 21:42:02,324 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,557,168 NBBO records
2025-12-23 21:42:02,325 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,557,168 rows
2025-12-23 21:42:02,854 INFO [src.stage_a.parquet_writer] ✓ Wrote 61,367,834 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-10
2025-12-23 21:42:02,860 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 21:42:02,860 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 21:42:02,860 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 21:42:02,861 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 21:42:02,861 INFO [src.stage_a.stage_a] Trades: 23,325,063 rows
2025-12-23 21:42:02,861 INFO [src.stage_a.stage_a] Nbbo: 61,367,834 rows
2025-12-23 21:42:02,861 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 21:42:02,861 INFO [src.stage_a.stage_a] Processing date 85/140: 2024-10-11
2025-12-23 21:42:02,861 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 21:42:02,861 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 21:42:02,861 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-10-11 (519 symbols)
2025-12-23 21:42:02,861 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 21:42:02,861 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 21:42:02,861 INFO [src.stage_a.stage_a] Extract run ID: ec5656a2-b605-4190-95d3-1f0f0417a2da
2025-12-23 21:42:02,869 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 21:42:02,869 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 21:42:02,869 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 21:42:02,869 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 21:42:02,869 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 21:42:02,869 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 21:42:02,869 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 21:42:02,869 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 21:42:02,869 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 21:42:05,778 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 21:42:05,778 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-11...
2025-12-23 21:42:05,928 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241011 for 519 symbols
2025-12-23 21:44:25,020 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,794,918 trades
2025-12-23 21:44:25,020 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,794,918 rows
2025-12-23 21:45:48,235 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,878,405 trades
2025-12-23 21:45:48,235 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,878,405 rows
2025-12-23 21:47:05,186 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,767,027 trades
2025-12-23 21:47:05,186 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,767,027 rows
2025-12-23 21:48:13,787 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,408,053 trades
2025-12-23 21:48:13,787 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,408,053 rows
2025-12-23 21:49:40,887 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,035,874 trades
2025-12-23 21:49:40,887 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,035,874 rows
2025-12-23 21:51:21,988 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,902,382 trades
2025-12-23 21:51:21,988 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,902,382 rows
2025-12-23 21:53:58,620 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,446,477 trades
2025-12-23 21:53:58,620 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,446,477 rows
2025-12-23 21:55:22,178 INFO [src.stage_a.wrds_extractor]   Chunk 8: 1,924,271 trades
2025-12-23 21:55:22,180 INFO [src.stage_a.parquet_writer]   Chunk 8: 1,924,271 rows
2025-12-23 21:57:02,214 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,891,260 trades
2025-12-23 21:57:02,214 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,891,260 rows
2025-12-23 22:00:04,020 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,984,509 trades
2025-12-23 22:00:04,020 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,984,509 rows
2025-12-23 22:00:04,470 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,033,176 total rows written
2025-12-23 22:00:46,874 INFO [src.stage_a.wrds_extractor]   Chunk 11: 908,101 trades
2025-12-23 22:00:46,880 INFO [src.stage_a.parquet_writer]   Chunk 11: 908,101 rows
2025-12-23 22:00:47,158 INFO [src.stage_a.parquet_writer] ✓ Wrote 23,941,277 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-11
2025-12-23 22:00:47,158 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 22:00:47,158 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 22:00:47,158 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 22:00:47,158 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 22:00:47,158 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 22:00:47,158 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 22:00:47,158 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 22:00:48,411 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 22:00:48,412 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-11...
2025-12-23 22:00:48,483 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241011 for 519 symbols
2025-12-23 22:01:56,448 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,312,014 NBBO records
2025-12-23 22:01:56,448 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,312,014 rows
2025-12-23 22:02:32,547 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,367,185 NBBO records
2025-12-23 22:02:32,548 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,367,185 rows
2025-12-23 22:04:43,341 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,577,659 NBBO records
2025-12-23 22:04:43,341 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,577,659 rows
2025-12-23 22:06:27,337 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,127,899 NBBO records
2025-12-23 22:06:27,337 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,127,899 rows
2025-12-23 22:08:46,124 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,598,347 NBBO records
2025-12-23 22:08:46,124 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,598,347 rows
2025-12-23 22:11:10,518 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,716,945 NBBO records
2025-12-23 22:11:10,519 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,716,945 rows
2025-12-23 22:14:46,808 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,575,859 NBBO records
2025-12-23 22:14:46,808 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,575,859 rows
2025-12-23 22:17:45,754 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,839,613 NBBO records
2025-12-23 22:17:45,759 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,839,613 rows
2025-12-23 22:20:54,745 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,064,482 NBBO records
2025-12-23 22:20:54,748 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,064,482 rows
2025-12-23 22:24:22,888 INFO [src.stage_a.wrds_extractor]   Chunk 10: 5,034,628 NBBO records
2025-12-23 22:24:22,888 INFO [src.stage_a.parquet_writer]   Chunk 10: 5,034,628 rows
2025-12-23 22:24:23,245 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 46,214,631 total rows written
2025-12-23 22:28:02,782 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,927,183 NBBO records
2025-12-23 22:28:02,783 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,927,183 rows
2025-12-23 22:28:03,255 INFO [src.stage_a.parquet_writer] ✓ Wrote 51,141,814 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-11
2025-12-23 22:28:03,261 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 22:28:03,261 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 22:28:03,261 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 22:28:03,261 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 22:28:03,261 INFO [src.stage_a.stage_a] Trades: 23,941,277 rows
2025-12-23 22:28:03,261 INFO [src.stage_a.stage_a] Nbbo: 51,141,814 rows
2025-12-23 22:28:03,261 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 22:28:03,261 INFO [src.stage_a.stage_a] Processing date 86/140: 2024-10-14
2025-12-23 22:28:03,261 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 22:28:03,261 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 22:28:03,261 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-10-14 (519 symbols)
2025-12-23 22:28:03,261 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 22:28:03,261 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 22:28:03,261 INFO [src.stage_a.stage_a] Extract run ID: 3e1e0e51-b508-4d8b-85de-279a01c1a523
2025-12-23 22:28:03,269 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 22:28:03,269 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 22:28:03,269 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 22:28:03,269 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 22:28:03,269 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 22:28:03,269 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 22:28:03,269 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 22:28:03,269 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 22:28:03,269 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 22:28:06,986 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 22:28:06,986 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-14...
2025-12-23 22:28:07,233 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241014 for 519 symbols
2025-12-23 22:30:37,131 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,813,409 trades
2025-12-23 22:30:37,132 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,813,409 rows
2025-12-23 22:32:46,358 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,721,891 trades
2025-12-23 22:32:46,358 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,721,891 rows
2025-12-23 22:34:12,883 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,757,394 trades
2025-12-23 22:34:12,883 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,757,394 rows
2025-12-23 22:35:31,980 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,402,956 trades
2025-12-23 22:35:31,980 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,402,956 rows
2025-12-23 22:37:26,210 INFO [src.stage_a.wrds_extractor]   Chunk 5: 1,882,548 trades
2025-12-23 22:37:26,211 INFO [src.stage_a.parquet_writer]   Chunk 5: 1,882,548 rows
2025-12-23 22:39:16,281 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,841,162 trades
2025-12-23 22:39:16,282 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,841,162 rows
2025-12-23 22:41:54,155 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,774,591 trades
2025-12-23 22:41:54,156 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,774,591 rows
2025-12-23 22:43:56,458 INFO [src.stage_a.wrds_extractor]   Chunk 8: 1,997,450 trades
2025-12-23 22:43:56,484 INFO [src.stage_a.parquet_writer]   Chunk 8: 1,997,450 rows
2025-12-23 22:45:53,491 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,954,147 trades
2025-12-23 22:45:53,492 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,954,147 rows
2025-12-23 22:48:47,831 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,162,440 trades
2025-12-23 22:48:47,831 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,162,440 rows
2025-12-23 22:48:48,224 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 22,307,988 total rows written
2025-12-23 22:49:50,325 INFO [src.stage_a.wrds_extractor]   Chunk 11: 819,579 trades
2025-12-23 22:49:50,325 INFO [src.stage_a.parquet_writer]   Chunk 11: 819,579 rows
2025-12-23 22:49:50,574 INFO [src.stage_a.parquet_writer] ✓ Wrote 23,127,567 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-14
2025-12-23 22:49:50,575 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 22:49:50,575 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 22:49:50,575 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 22:49:50,575 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 22:49:50,575 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 22:49:50,575 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 22:49:50,575 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 22:49:52,464 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 22:49:52,465 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-14...
2025-12-23 22:49:52,560 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241014 for 519 symbols
2025-12-23 22:53:06,481 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,574,292 NBBO records
2025-12-23 22:53:06,481 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,574,292 rows
2025-12-23 22:53:45,849 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,237,626 NBBO records
2025-12-23 22:53:45,849 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,237,626 rows
2025-12-23 22:55:00,693 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,238,792 NBBO records
2025-12-23 22:55:00,693 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,238,792 rows
2025-12-23 22:56:26,783 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,120,617 NBBO records
2025-12-23 22:56:26,783 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,120,617 rows
2025-12-23 22:58:42,452 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,720,555 NBBO records
2025-12-23 22:58:42,452 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,720,555 rows
2025-12-23 22:59:53,139 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,929,043 NBBO records
2025-12-23 22:59:53,139 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,929,043 rows
2025-12-23 23:03:11,525 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,571,561 NBBO records
2025-12-23 23:03:11,525 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,571,561 rows
2025-12-23 23:05:49,485 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,741,986 NBBO records
2025-12-23 23:05:49,489 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,741,986 rows
2025-12-23 23:06:35,106 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,005,009 NBBO records
2025-12-23 23:06:35,115 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,005,009 rows
2025-12-23 23:08:52,630 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,557,668 NBBO records
2025-12-23 23:08:52,630 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,557,668 rows
2025-12-23 23:08:52,965 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 45,697,149 total rows written
2025-12-23 23:11:47,458 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,878,378 NBBO records
2025-12-23 23:11:47,458 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,878,378 rows
2025-12-23 23:11:47,929 INFO [src.stage_a.parquet_writer] ✓ Wrote 50,575,527 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-14
2025-12-23 23:11:47,933 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 23:11:47,933 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 23:11:47,933 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 23:11:47,933 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 23:11:47,933 INFO [src.stage_a.stage_a] Trades: 23,127,567 rows
2025-12-23 23:11:47,933 INFO [src.stage_a.stage_a] Nbbo: 50,575,527 rows
2025-12-23 23:11:47,933 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 23:11:47,933 INFO [src.stage_a.stage_a] Processing date 87/140: 2024-10-15
2025-12-23 23:11:47,933 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 23:11:47,933 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 23:11:47,933 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-10-15 (519 symbols)
2025-12-23 23:11:47,933 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 23:11:47,933 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 23:11:47,933 INFO [src.stage_a.stage_a] Extract run ID: fcf4b1d6-78f3-4c04-adbc-7ea3b24d83ae
2025-12-23 23:11:47,941 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 23:11:47,941 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 23:11:47,941 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 23:11:47,941 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 23:11:47,941 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 23:11:47,941 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 23:11:47,941 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 23:11:47,941 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 23:11:47,941 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 23:11:49,600 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 23:11:49,601 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-15...
2025-12-23 23:11:49,708 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241015 for 519 symbols
2025-12-23 23:15:25,779 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,189,782 trades
2025-12-23 23:15:25,780 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,189,782 rows
2025-12-23 23:17:18,244 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,447,576 trades
2025-12-23 23:17:18,246 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,447,576 rows
2025-12-23 23:17:55,074 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,247,745 trades
2025-12-23 23:17:55,074 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,247,745 rows
2025-12-23 23:19:27,742 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,985,574 trades
2025-12-23 23:19:27,742 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,985,574 rows
2025-12-23 23:21:29,236 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,551,356 trades
2025-12-23 23:21:29,236 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,551,356 rows
2025-12-23 23:23:53,830 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,524,475 trades
2025-12-23 23:23:53,830 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,524,475 rows
2025-12-23 23:28:06,330 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,350,515 trades
2025-12-23 23:28:06,330 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,350,515 rows
2025-12-23 23:30:32,551 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,687,422 trades
2025-12-23 23:30:32,556 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,687,422 rows
2025-12-23 23:32:48,351 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,610,791 trades
2025-12-23 23:32:48,361 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,610,791 rows
2025-12-23 23:34:31,979 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,509,745 trades
2025-12-23 23:34:31,979 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,509,745 rows
2025-12-23 23:34:32,432 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 30,104,981 total rows written
2025-12-23 23:34:52,577 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,201,229 trades
2025-12-23 23:34:52,580 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,201,229 rows
2025-12-23 23:34:52,958 INFO [src.stage_a.parquet_writer] ✓ Wrote 31,306,210 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-15
2025-12-23 23:34:52,959 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 23:34:52,959 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 23:34:52,959 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 23:34:52,959 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 23:34:52,959 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 23:34:52,959 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 23:34:52,959 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 23:34:54,318 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 23:34:54,318 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-15...
2025-12-23 23:34:54,377 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241015 for 519 symbols
2025-12-23 23:36:38,543 INFO [src.stage_a.wrds_extractor]   Chunk 1: 8,300,576 NBBO records
2025-12-23 23:36:38,543 INFO [src.stage_a.parquet_writer]   Chunk 1: 8,300,576 rows
2025-12-23 23:37:48,655 INFO [src.stage_a.wrds_extractor]   Chunk 2: 4,168,926 NBBO records
2025-12-23 23:37:48,658 INFO [src.stage_a.parquet_writer]   Chunk 2: 4,168,926 rows
2025-12-23 23:40:53,355 INFO [src.stage_a.wrds_extractor]   Chunk 3: 6,288,124 NBBO records
2025-12-23 23:40:53,356 INFO [src.stage_a.parquet_writer]   Chunk 3: 6,288,124 rows
2025-12-23 23:43:49,853 INFO [src.stage_a.wrds_extractor]   Chunk 4: 4,465,778 NBBO records
2025-12-23 23:43:49,854 INFO [src.stage_a.parquet_writer]   Chunk 4: 4,465,778 rows
2025-12-23 23:47:57,453 INFO [src.stage_a.wrds_extractor]   Chunk 5: 6,974,993 NBBO records
2025-12-23 23:47:57,453 INFO [src.stage_a.parquet_writer]   Chunk 5: 6,974,993 rows
2025-12-23 23:51:32,376 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,421,585 NBBO records
2025-12-23 23:51:32,377 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,421,585 rows
2025-12-23 23:55:39,399 INFO [src.stage_a.wrds_extractor]   Chunk 7: 9,262,640 NBBO records
2025-12-23 23:55:39,400 INFO [src.stage_a.parquet_writer]   Chunk 7: 9,262,640 rows
2025-12-23 23:57:41,077 INFO [src.stage_a.wrds_extractor]   Chunk 8: 8,074,821 NBBO records
2025-12-23 23:57:41,084 INFO [src.stage_a.parquet_writer]   Chunk 8: 8,074,821 rows
2025-12-24 00:02:08,749 INFO [src.stage_a.wrds_extractor]   Chunk 9: 5,692,851 NBBO records
2025-12-24 00:02:08,750 INFO [src.stage_a.parquet_writer]   Chunk 9: 5,692,851 rows
2025-12-24 00:04:11,595 INFO [src.stage_a.wrds_extractor]   Chunk 10: 6,090,863 NBBO records
2025-12-24 00:04:11,596 INFO [src.stage_a.parquet_writer]   Chunk 10: 6,090,863 rows
2025-12-24 00:04:12,007 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 64,741,157 total rows written
2025-12-24 00:05:54,018 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,366,033 NBBO records
2025-12-24 00:05:54,019 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,366,033 rows
2025-12-24 00:05:54,676 INFO [src.stage_a.parquet_writer] ✓ Wrote 72,107,190 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-15
2025-12-24 00:05:54,688 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 00:05:54,688 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 00:05:54,688 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 00:05:54,688 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 00:05:54,688 INFO [src.stage_a.stage_a] Trades: 31,306,210 rows
2025-12-24 00:05:54,688 INFO [src.stage_a.stage_a] Nbbo: 72,107,190 rows
2025-12-24 00:05:54,688 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 00:05:54,688 INFO [src.stage_a.stage_a] Processing date 88/140: 2024-10-16
2025-12-24 00:05:54,688 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 00:05:54,688 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 00:05:54,688 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-10-16 (519 symbols)
2025-12-24 00:05:54,688 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 00:05:54,688 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 00:05:54,688 INFO [src.stage_a.stage_a] Extract run ID: 937743b3-e401-4164-a092-8b6b83c63eb9
2025-12-24 00:05:54,696 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 00:05:54,696 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 00:05:54,696 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 00:05:54,696 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 00:05:54,696 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 00:05:54,696 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 00:05:54,696 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 00:05:54,696 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 00:05:54,696 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 00:05:56,132 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 00:05:56,133 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-16...
2025-12-24 00:05:56,221 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241016 for 519 symbols
2025-12-24 00:09:29,344 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,984,702 trades
2025-12-24 00:09:29,344 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,984,702 rows
2025-12-24 00:11:34,707 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,896,064 trades
2025-12-24 00:11:34,707 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,896,064 rows
2025-12-24 00:13:16,842 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,089,608 trades
2025-12-24 00:13:16,842 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,089,608 rows
2025-12-24 00:15:05,433 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,502,325 trades
2025-12-24 00:15:05,433 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,502,325 rows
2025-12-24 00:17:05,798 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,057,003 trades
2025-12-24 00:17:05,798 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,057,003 rows
2025-12-24 00:19:20,893 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,114,905 trades
2025-12-24 00:19:20,893 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,114,905 rows
2025-12-24 00:22:54,910 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,122,354 trades
2025-12-24 00:22:54,910 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,122,354 rows
2025-12-24 00:24:02,974 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,069,983 trades
2025-12-24 00:24:02,978 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,069,983 rows
2025-12-24 00:26:10,251 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,205,766 trades
2025-12-24 00:26:10,251 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,205,766 rows
2025-12-24 00:29:08,256 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,036,480 trades
2025-12-24 00:29:08,256 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,036,480 rows
2025-12-24 00:29:08,674 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 24,079,190 total rows written
2025-12-24 00:29:21,025 INFO [src.stage_a.wrds_extractor]   Chunk 11: 813,399 trades
2025-12-24 00:29:21,025 INFO [src.stage_a.parquet_writer]   Chunk 11: 813,399 rows
2025-12-24 00:29:21,297 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,892,589 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-16
2025-12-24 00:29:21,298 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 00:29:21,298 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 00:29:21,298 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 00:29:21,298 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 00:29:21,298 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 00:29:21,298 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 00:29:21,298 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 00:29:22,586 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 00:29:22,586 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-16...
2025-12-24 00:29:22,660 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241016 for 519 symbols
2025-12-24 00:30:46,145 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,439,360 NBBO records
2025-12-24 00:30:46,145 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,439,360 rows
2025-12-24 00:32:29,252 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,100,693 NBBO records
2025-12-24 00:32:29,253 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,100,693 rows
2025-12-24 00:35:53,449 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,668,080 NBBO records
2025-12-24 00:35:53,450 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,668,080 rows
2025-12-24 00:37:05,526 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,081,688 NBBO records
2025-12-24 00:37:05,526 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,081,688 rows
2025-12-24 00:37:58,673 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,986,644 NBBO records
2025-12-24 00:37:58,673 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,986,644 rows
2025-12-24 00:38:51,855 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,172,525 NBBO records
2025-12-24 00:38:51,856 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,172,525 rows
2025-12-24 00:43:52,022 INFO [src.stage_a.wrds_extractor]   Chunk 7: 7,225,974 NBBO records
2025-12-24 00:43:52,023 INFO [src.stage_a.parquet_writer]   Chunk 7: 7,225,974 rows
2025-12-24 00:47:28,134 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,380,454 NBBO records
2025-12-24 00:47:28,138 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,380,454 rows
2025-12-24 00:50:17,366 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,097,860 NBBO records
2025-12-24 00:50:17,367 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,097,860 rows
2025-12-24 00:53:10,099 INFO [src.stage_a.wrds_extractor]   Chunk 10: 5,005,449 NBBO records
2025-12-24 00:53:10,099 INFO [src.stage_a.parquet_writer]   Chunk 10: 5,005,449 rows
2025-12-24 00:53:10,453 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 47,158,727 total rows written
2025-12-24 00:56:10,672 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,216,705 NBBO records
2025-12-24 00:56:10,673 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,216,705 rows
2025-12-24 00:56:11,164 INFO [src.stage_a.parquet_writer] ✓ Wrote 52,375,432 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-16
2025-12-24 00:56:11,175 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 00:56:11,175 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 00:56:11,175 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 00:56:11,175 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 00:56:11,175 INFO [src.stage_a.stage_a] Trades: 24,892,589 rows
2025-12-24 00:56:11,175 INFO [src.stage_a.stage_a] Nbbo: 52,375,432 rows
2025-12-24 00:56:11,176 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 00:56:11,176 INFO [src.stage_a.stage_a] Processing date 89/140: 2024-10-17
2025-12-24 00:56:11,176 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 00:56:11,176 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 00:56:11,176 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-10-17 (519 symbols)
2025-12-24 00:56:11,176 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 00:56:11,176 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 00:56:11,176 INFO [src.stage_a.stage_a] Extract run ID: c3404ffa-acce-4a3e-8f70-456175688f56
2025-12-24 00:56:11,184 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 00:56:11,184 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 00:56:11,184 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 00:56:11,184 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 00:56:11,184 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 00:56:11,184 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 00:56:11,184 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 00:56:11,184 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 00:56:11,184 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 00:56:14,021 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 00:56:14,021 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-17...
2025-12-24 00:56:14,148 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241017 for 519 symbols
2025-12-24 00:59:00,132 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,959,430 trades
2025-12-24 00:59:00,132 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,959,430 rows
2025-12-24 01:00:49,784 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,839,699 trades
2025-12-24 01:00:49,784 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,839,699 rows
2025-12-24 01:03:04,505 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,117,948 trades
2025-12-24 01:03:04,505 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,117,948 rows
2025-12-24 01:04:32,408 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,740,914 trades
2025-12-24 01:04:32,408 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,740,914 rows
2025-12-24 01:07:14,454 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,274,581 trades
2025-12-24 01:07:14,455 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,274,581 rows
2025-12-24 01:08:46,870 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,073,326 trades
2025-12-24 01:08:46,870 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,073,326 rows
2025-12-24 01:13:25,165 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,383,117 trades
2025-12-24 01:13:25,165 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,383,117 rows
2025-12-24 01:15:15,989 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,060,729 trades
2025-12-24 01:15:16,001 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,060,729 rows
2025-12-24 01:17:27,132 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,225,300 trades
2025-12-24 01:17:27,132 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,225,300 rows
2025-12-24 01:20:32,659 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,919,002 trades
2025-12-24 01:20:32,659 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,919,002 rows
2025-12-24 01:20:33,056 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 24,594,046 total rows written
2025-12-24 01:21:44,811 INFO [src.stage_a.wrds_extractor]   Chunk 11: 871,934 trades
2025-12-24 01:21:44,812 INFO [src.stage_a.parquet_writer]   Chunk 11: 871,934 rows
2025-12-24 01:21:45,061 INFO [src.stage_a.parquet_writer] ✓ Wrote 25,465,980 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-17
2025-12-24 01:21:45,062 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 01:21:45,062 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 01:21:45,062 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 01:21:45,062 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 01:21:45,062 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 01:21:45,062 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 01:21:45,062 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 01:21:47,690 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 01:21:47,690 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-17...
2025-12-24 01:21:47,832 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241017 for 519 symbols
2025-12-24 01:25:25,424 INFO [src.stage_a.wrds_extractor]   Chunk 1: 6,039,485 NBBO records
2025-12-24 01:25:25,424 INFO [src.stage_a.parquet_writer]   Chunk 1: 6,039,485 rows
2025-12-24 01:26:46,204 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,323,059 NBBO records
2025-12-24 01:26:46,205 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,323,059 rows
2025-12-24 01:29:52,446 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,186,923 NBBO records
2025-12-24 01:29:52,446 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,186,923 rows
2025-12-24 01:31:38,624 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,302,836 NBBO records
2025-12-24 01:31:38,625 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,302,836 rows
2025-12-24 01:34:56,441 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,276,514 NBBO records
2025-12-24 01:34:56,441 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,276,514 rows
2025-12-24 01:37:33,173 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,124,226 NBBO records
2025-12-24 01:37:33,174 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,124,226 rows
2025-12-24 01:42:08,756 INFO [src.stage_a.wrds_extractor]   Chunk 7: 7,728,721 NBBO records
2025-12-24 01:42:08,756 INFO [src.stage_a.parquet_writer]   Chunk 7: 7,728,721 rows
2025-12-24 01:45:04,860 INFO [src.stage_a.wrds_extractor]   Chunk 8: 6,322,488 NBBO records
2025-12-24 01:45:04,864 INFO [src.stage_a.parquet_writer]   Chunk 8: 6,322,488 rows
2025-12-24 01:47:31,724 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,417,062 NBBO records
2025-12-24 01:47:31,727 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,417,062 rows
2025-12-24 01:50:38,015 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,983,083 NBBO records
2025-12-24 01:50:38,016 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,983,083 rows
2025-12-24 01:50:38,391 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 50,704,397 total rows written
2025-12-24 01:53:53,244 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,228,955 NBBO records
2025-12-24 01:53:53,244 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,228,955 rows
2025-12-24 01:53:53,730 INFO [src.stage_a.parquet_writer] ✓ Wrote 55,933,352 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-17
2025-12-24 01:53:53,737 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 01:53:53,737 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 01:53:53,737 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 01:53:53,737 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 01:53:53,737 INFO [src.stage_a.stage_a] Trades: 25,465,980 rows
2025-12-24 01:53:53,737 INFO [src.stage_a.stage_a] Nbbo: 55,933,352 rows
2025-12-24 01:53:53,737 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 01:53:53,737 INFO [src.stage_a.stage_a] Processing date 90/140: 2024-10-18
2025-12-24 01:53:53,737 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 01:53:53,737 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 01:53:53,737 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-10-18 (519 symbols)
2025-12-24 01:53:53,737 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 01:53:53,737 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 01:53:53,737 INFO [src.stage_a.stage_a] Extract run ID: 9659317c-3a96-4339-b725-728f71e0133f
2025-12-24 01:53:53,745 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 01:53:53,745 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 01:53:53,745 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 01:53:53,745 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 01:53:53,746 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 01:53:53,746 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 01:53:53,746 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 01:53:53,746 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 01:53:53,746 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 01:53:56,465 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 01:53:56,465 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-18...
2025-12-24 01:53:56,610 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241018 for 519 symbols
2025-12-24 01:56:18,888 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,808,988 trades
2025-12-24 01:56:18,888 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,808,988 rows
2025-12-24 01:58:24,224 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,828,247 trades
2025-12-24 01:58:24,224 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,828,247 rows
2025-12-24 02:00:04,876 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,976,854 trades
2025-12-24 02:00:04,876 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,976,854 rows
2025-12-24 02:01:12,510 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,519,205 trades
2025-12-24 02:01:12,510 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,519,205 rows
2025-12-24 02:03:13,363 INFO [src.stage_a.wrds_extractor]   Chunk 5: 1,970,820 trades
2025-12-24 02:03:13,363 INFO [src.stage_a.parquet_writer]   Chunk 5: 1,970,820 rows
2025-12-24 02:05:03,340 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,987,253 trades
2025-12-24 02:05:03,340 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,987,253 rows
2025-12-24 02:08:17,562 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,504,902 trades
2025-12-24 02:08:17,562 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,504,902 rows
2025-12-24 02:09:47,372 INFO [src.stage_a.wrds_extractor]   Chunk 8: 1,899,036 trades
2025-12-24 02:09:47,374 INFO [src.stage_a.parquet_writer]   Chunk 8: 1,899,036 rows
2025-12-24 02:11:33,108 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,036,888 trades
2025-12-24 02:11:33,108 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,036,888 rows
2025-12-24 02:13:54,059 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,454,793 trades
2025-12-24 02:13:54,059 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,454,793 rows
2025-12-24 02:13:54,415 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 21,986,986 total rows written
2025-12-24 02:14:45,823 INFO [src.stage_a.wrds_extractor]   Chunk 11: 793,930 trades
2025-12-24 02:14:45,823 INFO [src.stage_a.parquet_writer]   Chunk 11: 793,930 rows
2025-12-24 02:14:46,064 INFO [src.stage_a.parquet_writer] ✓ Wrote 22,780,916 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-18
2025-12-24 02:14:46,065 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 02:14:46,065 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 02:14:46,065 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 02:14:46,065 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 02:14:46,065 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 02:14:46,065 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 02:14:46,065 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 02:14:47,236 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 02:14:47,236 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-18...
2025-12-24 02:14:47,298 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241018 for 519 symbols
2025-12-24 02:17:50,916 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,962,167 NBBO records
2025-12-24 02:17:50,916 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,962,167 rows
2025-12-24 02:19:23,234 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,962,803 NBBO records
2025-12-24 02:19:23,235 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,962,803 rows
2025-12-24 02:21:41,050 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,150,532 NBBO records
2025-12-24 02:21:41,050 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,150,532 rows
2025-12-24 02:23:08,916 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,853,013 NBBO records
2025-12-24 02:23:08,917 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,853,013 rows
2025-12-24 02:26:00,393 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,420,914 NBBO records
2025-12-24 02:26:00,393 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,420,914 rows
2025-12-24 02:28:19,503 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,944,300 NBBO records
2025-12-24 02:28:19,503 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,944,300 rows
2025-12-24 02:32:18,567 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,312,989 NBBO records
2025-12-24 02:32:18,567 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,312,989 rows
2025-12-24 02:35:17,864 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,654,924 NBBO records
2025-12-24 02:35:17,865 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,654,924 rows
2025-12-24 02:37:24,176 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,509,938 NBBO records
2025-12-24 02:37:24,177 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,509,938 rows
2025-12-24 02:39:52,840 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,201,823 NBBO records
2025-12-24 02:39:52,840 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,201,823 rows
2025-12-24 02:39:53,165 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 41,973,403 total rows written
2025-12-24 02:42:53,345 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,519,695 NBBO records
2025-12-24 02:42:53,345 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,519,695 rows
2025-12-24 02:42:53,788 INFO [src.stage_a.parquet_writer] ✓ Wrote 46,493,098 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-18
2025-12-24 02:42:53,796 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 02:42:53,796 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 02:42:53,796 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 02:42:53,796 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 02:42:53,796 INFO [src.stage_a.stage_a] Trades: 22,780,916 rows
2025-12-24 02:42:53,796 INFO [src.stage_a.stage_a] Nbbo: 46,493,098 rows
2025-12-24 02:42:53,797 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 02:42:53,797 INFO [src.stage_a.stage_a] Processing date 91/140: 2024-10-21
2025-12-24 02:42:53,797 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 02:42:53,797 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 02:42:53,797 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-10-21 (519 symbols)
2025-12-24 02:42:53,797 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 02:42:53,797 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 02:42:53,797 INFO [src.stage_a.stage_a] Extract run ID: acd25557-c4f8-46bb-a7ae-d364149a052b
2025-12-24 02:42:53,805 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 02:42:53,805 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 02:42:53,805 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 02:42:53,805 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 02:42:53,805 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 02:42:53,805 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 02:42:53,805 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 02:42:53,805 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 02:42:53,805 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 02:42:56,390 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 02:42:56,390 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-21...
2025-12-24 02:42:56,538 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241021 for 519 symbols
2025-12-24 02:45:58,913 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,645,880 trades
2025-12-24 02:45:58,914 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,645,880 rows
2025-12-24 02:48:15,429 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,788,562 trades
2025-12-24 02:48:15,429 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,788,562 rows
2025-12-24 02:49:51,347 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,794,569 trades
2025-12-24 02:49:51,347 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,794,569 rows
2025-12-24 02:51:22,911 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,459,349 trades
2025-12-24 02:51:22,911 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,459,349 rows
2025-12-24 02:53:03,663 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,071,155 trades
2025-12-24 02:53:03,663 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,071,155 rows
2025-12-24 02:54:56,786 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,047,265 trades
2025-12-24 02:54:56,786 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,047,265 rows
2025-12-24 02:59:33,557 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,079,470 trades
2025-12-24 02:59:33,557 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,079,470 rows
2025-12-24 03:01:48,648 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,062,927 trades
2025-12-24 03:01:48,657 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,062,927 rows
2025-12-24 03:03:48,000 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,065,608 trades
2025-12-24 03:03:48,000 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,065,608 rows
2025-12-24 03:06:43,665 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,644,794 trades
2025-12-24 03:06:43,665 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,644,794 rows
2025-12-24 03:06:44,036 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 22,659,579 total rows written
2025-12-24 03:07:47,931 INFO [src.stage_a.wrds_extractor]   Chunk 11: 749,248 trades
2025-12-24 03:07:47,932 INFO [src.stage_a.parquet_writer]   Chunk 11: 749,248 rows
2025-12-24 03:07:48,178 INFO [src.stage_a.parquet_writer] ✓ Wrote 23,408,827 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-21
2025-12-24 03:07:48,179 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 03:07:48,179 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 03:07:48,179 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 03:07:48,179 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 03:07:48,179 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 03:07:48,179 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 03:07:48,179 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 03:07:52,028 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 03:07:52,037 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-21...
2025-12-24 03:07:52,341 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241021 for 519 symbols
2025-12-24 03:11:03,799 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,026,844 NBBO records
2025-12-24 03:11:03,799 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,026,844 rows
2025-12-24 03:12:54,114 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,941,329 NBBO records
2025-12-24 03:12:54,115 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,941,329 rows
2025-12-24 03:15:23,062 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,522,273 NBBO records
2025-12-24 03:15:23,062 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,522,273 rows
2025-12-24 03:17:21,957 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,007,325 NBBO records
2025-12-24 03:17:21,958 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,007,325 rows
2025-12-24 03:20:32,314 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,015,956 NBBO records
2025-12-24 03:20:32,314 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,015,956 rows
2025-12-24 03:22:56,087 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,059,691 NBBO records
2025-12-24 03:22:56,088 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,059,691 rows
2025-12-24 03:27:21,902 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,821,150 NBBO records
2025-12-24 03:27:21,903 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,821,150 rows
2025-12-24 03:30:16,562 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,111,031 NBBO records
2025-12-24 03:30:16,563 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,111,031 rows
2025-12-24 03:32:38,912 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,050,888 NBBO records
2025-12-24 03:32:38,913 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,050,888 rows
2025-12-24 03:35:25,005 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,277,482 NBBO records
2025-12-24 03:35:25,005 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,277,482 rows
2025-12-24 03:35:25,344 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 44,833,969 total rows written
2025-12-24 03:38:11,993 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,879,847 NBBO records
2025-12-24 03:38:11,993 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,879,847 rows
2025-12-24 03:38:12,471 INFO [src.stage_a.parquet_writer] ✓ Wrote 49,713,816 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-21
2025-12-24 03:38:12,478 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 03:38:12,478 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 03:38:12,478 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 03:38:12,478 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 03:38:12,478 INFO [src.stage_a.stage_a] Trades: 23,408,827 rows
2025-12-24 03:38:12,478 INFO [src.stage_a.stage_a] Nbbo: 49,713,816 rows
2025-12-24 03:38:12,478 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 03:38:12,478 INFO [src.stage_a.stage_a] Processing date 92/140: 2024-10-22
2025-12-24 03:38:12,478 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 03:38:12,478 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 03:38:12,478 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-10-22 (519 symbols)
2025-12-24 03:38:12,478 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 03:38:12,478 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 03:38:12,478 INFO [src.stage_a.stage_a] Extract run ID: 1a5097b5-511b-415c-bd1e-ec1d14a4fbc8
2025-12-24 03:38:12,486 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 03:38:12,486 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 03:38:12,486 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 03:38:12,486 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 03:38:12,486 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 03:38:12,486 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 03:38:12,486 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 03:38:12,486 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 03:38:12,486 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 03:38:15,449 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 03:38:15,449 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-22...
2025-12-24 03:38:15,676 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241022 for 519 symbols
2025-12-24 03:41:05,849 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,704,249 trades
2025-12-24 03:41:05,849 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,704,249 rows
2025-12-24 03:42:48,522 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,732,560 trades
2025-12-24 03:42:48,522 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,732,560 rows
2025-12-24 03:44:50,771 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,865,533 trades
2025-12-24 03:44:50,771 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,865,533 rows
2025-12-24 03:46:42,876 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,511,394 trades
2025-12-24 03:46:42,876 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,511,394 rows
2025-12-24 03:49:05,925 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,467,377 trades
2025-12-24 03:49:05,925 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,467,377 rows
2025-12-24 03:51:18,271 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,032,311 trades
2025-12-24 03:51:18,271 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,032,311 rows
2025-12-24 03:55:06,534 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,926,704 trades
2025-12-24 03:55:06,534 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,926,704 rows
2025-12-24 03:57:27,105 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,192,967 trades
2025-12-24 03:57:27,118 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,192,967 rows
2025-12-24 03:59:06,922 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,121,205 trades
2025-12-24 03:59:06,922 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,121,205 rows
2025-12-24 04:01:46,073 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,724,738 trades
2025-12-24 04:01:46,073 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,724,738 rows
2025-12-24 04:01:46,449 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,279,038 total rows written
2025-12-24 04:02:44,444 INFO [src.stage_a.wrds_extractor]   Chunk 11: 770,459 trades
2025-12-24 04:02:44,444 INFO [src.stage_a.parquet_writer]   Chunk 11: 770,459 rows
2025-12-24 04:02:44,685 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,049,497 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-22
2025-12-24 04:02:44,686 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 04:02:44,686 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 04:02:44,686 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 04:02:44,686 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 04:02:44,686 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 04:02:44,686 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 04:02:44,686 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 04:02:47,456 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 04:02:47,456 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-22...
2025-12-24 04:02:47,709 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241022 for 519 symbols
2025-12-24 04:05:20,471 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,935,811 NBBO records
2025-12-24 04:05:20,471 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,935,811 rows
2025-12-24 04:06:45,740 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,791,701 NBBO records
2025-12-24 04:06:45,740 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,791,701 rows
2025-12-24 04:09:38,578 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,415,267 NBBO records
2025-12-24 04:09:38,578 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,415,267 rows
2025-12-24 04:11:23,412 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,967,880 NBBO records
2025-12-24 04:11:23,412 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,967,880 rows
2025-12-24 04:14:02,516 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,601,192 NBBO records
2025-12-24 04:14:02,516 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,601,192 rows
2025-12-24 04:16:49,762 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,731,312 NBBO records
2025-12-24 04:16:49,762 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,731,312 rows
2025-12-24 04:21:56,686 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,760,754 NBBO records
2025-12-24 04:21:56,686 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,760,754 rows
2025-12-24 04:25:11,970 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,169,497 NBBO records
2025-12-24 04:25:11,972 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,169,497 rows
2025-12-24 04:28:04,738 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,853,476 NBBO records
2025-12-24 04:28:04,746 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,853,476 rows
2025-12-24 04:30:33,590 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,172,788 NBBO records
2025-12-24 04:30:33,590 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,172,788 rows
2025-12-24 04:30:33,908 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 43,399,678 total rows written
2025-12-24 04:33:44,222 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,585,202 NBBO records
2025-12-24 04:33:44,222 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,585,202 rows
2025-12-24 04:33:44,659 INFO [src.stage_a.parquet_writer] ✓ Wrote 47,984,880 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-22
2025-12-24 04:33:44,663 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 04:33:44,663 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 04:33:44,663 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 04:33:44,663 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 04:33:44,663 INFO [src.stage_a.stage_a] Trades: 24,049,497 rows
2025-12-24 04:33:44,663 INFO [src.stage_a.stage_a] Nbbo: 47,984,880 rows
2025-12-24 04:33:44,663 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 04:33:44,663 INFO [src.stage_a.stage_a] Processing date 93/140: 2024-10-23
2025-12-24 04:33:44,663 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 04:33:44,663 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 04:33:44,663 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-10-23 (519 symbols)
2025-12-24 04:33:44,663 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 04:33:44,663 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 04:33:44,663 INFO [src.stage_a.stage_a] Extract run ID: 7b7e3ba5-570f-462b-b53a-4f70b09e172a
2025-12-24 04:33:44,671 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 04:33:44,671 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 04:33:44,671 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 04:33:44,671 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 04:33:44,672 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 04:33:44,672 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 04:33:44,672 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 04:33:44,672 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 04:33:44,672 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 04:33:47,316 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 04:33:47,316 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-23...
2025-12-24 04:33:47,480 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241023 for 519 symbols
2025-12-24 04:36:49,660 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,164,956 trades
2025-12-24 04:36:49,660 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,164,956 rows
2025-12-24 04:39:27,358 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,976,593 trades
2025-12-24 04:39:27,359 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,976,593 rows
2025-12-24 04:41:17,240 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,083,080 trades
2025-12-24 04:41:17,241 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,083,080 rows
2025-12-24 04:43:29,034 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,756,390 trades
2025-12-24 04:43:29,034 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,756,390 rows
2025-12-24 04:46:15,854 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,387,478 trades
2025-12-24 04:46:15,854 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,387,478 rows
2025-12-24 04:48:02,212 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,243,758 trades
2025-12-24 04:48:02,212 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,243,758 rows
2025-12-24 04:53:15,352 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,859,314 trades
2025-12-24 04:53:15,352 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,859,314 rows
2025-12-24 04:55:45,698 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,344,519 trades
2025-12-24 04:55:45,705 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,344,519 rows
2025-12-24 04:58:47,627 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,511,884 trades
2025-12-24 04:58:47,627 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,511,884 rows
2025-12-24 05:01:29,911 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,968,882 trades
2025-12-24 05:01:29,911 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,968,882 rows
2025-12-24 05:01:30,342 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,296,854 total rows written
2025-12-24 05:02:09,182 INFO [src.stage_a.wrds_extractor]   Chunk 11: 805,802 trades
2025-12-24 05:02:09,183 INFO [src.stage_a.parquet_writer]   Chunk 11: 805,802 rows
2025-12-24 05:02:09,435 INFO [src.stage_a.parquet_writer] ✓ Wrote 27,102,656 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-23
2025-12-24 05:02:09,436 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 05:02:09,436 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 05:02:09,436 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 05:02:09,436 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 05:02:09,436 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 05:02:09,436 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 05:02:09,436 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 05:02:11,750 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 05:02:11,750 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-23...
2025-12-24 05:02:11,941 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241023 for 519 symbols
2025-12-24 05:06:44,327 INFO [src.stage_a.wrds_extractor]   Chunk 1: 6,137,778 NBBO records
2025-12-24 05:06:44,327 INFO [src.stage_a.parquet_writer]   Chunk 1: 6,137,778 rows
2025-12-24 05:09:05,003 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,193,344 NBBO records
2025-12-24 05:09:05,004 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,193,344 rows
2025-12-24 05:12:46,929 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,249,913 NBBO records
2025-12-24 05:12:46,929 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,249,913 rows
2025-12-24 05:14:53,664 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,353,697 NBBO records
2025-12-24 05:14:53,665 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,353,697 rows
2025-12-24 05:18:12,811 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,449,352 NBBO records
2025-12-24 05:18:12,811 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,449,352 rows
2025-12-24 05:21:04,243 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,407,715 NBBO records
2025-12-24 05:21:04,244 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,407,715 rows
2025-12-24 05:26:43,918 INFO [src.stage_a.wrds_extractor]   Chunk 7: 8,377,053 NBBO records
2025-12-24 05:26:43,918 INFO [src.stage_a.parquet_writer]   Chunk 7: 8,377,053 rows
2025-12-24 05:30:44,951 INFO [src.stage_a.wrds_extractor]   Chunk 8: 6,365,480 NBBO records
2025-12-24 05:30:44,959 INFO [src.stage_a.parquet_writer]   Chunk 8: 6,365,480 rows
2025-12-24 05:33:54,627 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,539,170 NBBO records
2025-12-24 05:33:54,632 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,539,170 rows
2025-12-24 05:37:29,208 INFO [src.stage_a.wrds_extractor]   Chunk 10: 5,001,015 NBBO records
2025-12-24 05:37:29,209 INFO [src.stage_a.parquet_writer]   Chunk 10: 5,001,015 rows
2025-12-24 05:37:29,586 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 52,074,517 total rows written
2025-12-24 05:41:36,940 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,608,039 NBBO records
2025-12-24 05:41:36,941 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,608,039 rows
2025-12-24 05:41:37,470 INFO [src.stage_a.parquet_writer] ✓ Wrote 57,682,556 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-23
2025-12-24 05:41:37,479 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 05:41:37,479 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 05:41:37,479 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 05:41:37,479 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 05:41:37,479 INFO [src.stage_a.stage_a] Trades: 27,102,656 rows
2025-12-24 05:41:37,479 INFO [src.stage_a.stage_a] Nbbo: 57,682,556 rows
2025-12-24 05:41:37,479 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 05:41:37,479 INFO [src.stage_a.stage_a] Processing date 94/140: 2024-10-24
2025-12-24 05:41:37,479 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 05:41:37,479 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 05:41:37,479 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-10-24 (519 symbols)
2025-12-24 05:41:37,479 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 05:41:37,479 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 05:41:37,479 INFO [src.stage_a.stage_a] Extract run ID: 1f5723fc-24f9-45dc-83d3-52c2573b0b51
2025-12-24 05:41:37,487 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 05:41:37,487 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 05:41:37,487 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 05:41:37,487 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 05:41:37,487 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 05:41:37,487 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 05:41:37,487 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 05:41:37,487 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 05:41:37,487 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 05:41:38,698 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 05:41:38,698 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-24...
2025-12-24 05:41:38,764 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241024 for 519 symbols
2025-12-24 05:44:50,597 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,813,817 trades
2025-12-24 05:44:50,597 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,813,817 rows
2025-12-24 05:46:57,598 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,773,162 trades
2025-12-24 05:46:57,598 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,773,162 rows
2025-12-24 05:48:45,974 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,004,433 trades
2025-12-24 05:48:45,974 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,004,433 rows
2025-12-24 05:50:03,845 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,534,694 trades
2025-12-24 05:50:03,845 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,534,694 rows
2025-12-24 05:52:05,706 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,316,263 trades
2025-12-24 05:52:05,706 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,316,263 rows
2025-12-24 05:53:43,144 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,199,132 trades
2025-12-24 05:53:43,145 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,199,132 rows
2025-12-24 05:56:34,032 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,798,131 trades
2025-12-24 05:56:34,032 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,798,131 rows
2025-12-24 05:58:00,340 INFO [src.stage_a.wrds_extractor]   Chunk 8: 1,927,750 trades
2025-12-24 05:58:00,355 INFO [src.stage_a.parquet_writer]   Chunk 8: 1,927,750 rows
2025-12-24 05:59:54,126 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,207,868 trades
2025-12-24 05:59:54,126 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,207,868 rows
2025-12-24 06:03:32,652 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,539,192 trades
2025-12-24 06:03:32,653 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,539,192 rows
2025-12-24 06:03:33,152 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,114,442 total rows written
2025-12-24 06:04:16,939 INFO [src.stage_a.wrds_extractor]   Chunk 11: 796,351 trades
2025-12-24 06:04:16,942 INFO [src.stage_a.parquet_writer]   Chunk 11: 796,351 rows
2025-12-24 06:04:17,212 INFO [src.stage_a.parquet_writer] ✓ Wrote 25,910,793 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-24
2025-12-24 06:04:17,215 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 06:04:17,215 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 06:04:17,215 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 06:04:17,215 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 06:04:17,215 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 06:04:17,215 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 06:04:17,215 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 06:04:19,039 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 06:04:19,039 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-24...
2025-12-24 06:04:19,189 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241024 for 519 symbols
2025-12-24 06:06:40,748 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,806,918 NBBO records
2025-12-24 06:06:40,748 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,806,918 rows
2025-12-24 06:08:15,981 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,937,281 NBBO records
2025-12-24 06:08:15,981 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,937,281 rows
2025-12-24 06:10:36,270 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,596,256 NBBO records
2025-12-24 06:10:36,270 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,596,256 rows
2025-12-24 06:12:17,010 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,784,456 NBBO records
2025-12-24 06:12:17,010 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,784,456 rows
2025-12-24 06:14:38,981 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,626,240 NBBO records
2025-12-24 06:14:38,981 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,626,240 rows
2025-12-24 06:16:42,524 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,823,890 NBBO records
2025-12-24 06:16:42,524 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,823,890 rows
2025-12-24 06:20:07,467 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,620,444 NBBO records
2025-12-24 06:20:07,467 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,620,444 rows
2025-12-24 06:23:42,673 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,994,195 NBBO records
2025-12-24 06:23:42,674 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,994,195 rows
2025-12-24 06:25:55,394 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,772,353 NBBO records
2025-12-24 06:25:55,395 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,772,353 rows
2025-12-24 06:29:02,128 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,190,318 NBBO records
2025-12-24 06:29:02,129 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,190,318 rows
2025-12-24 06:29:02,471 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 43,152,351 total rows written
2025-12-24 06:32:33,247 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,856,515 NBBO records
2025-12-24 06:32:33,247 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,856,515 rows
2025-12-24 06:32:33,717 INFO [src.stage_a.parquet_writer] ✓ Wrote 48,008,866 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-24
2025-12-24 06:32:33,724 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 06:32:33,724 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 06:32:33,724 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 06:32:33,724 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 06:32:33,724 INFO [src.stage_a.stage_a] Trades: 25,910,793 rows
2025-12-24 06:32:33,724 INFO [src.stage_a.stage_a] Nbbo: 48,008,866 rows
2025-12-24 06:32:33,724 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 06:32:33,724 INFO [src.stage_a.stage_a] Processing date 95/140: 2024-10-25
2025-12-24 06:32:33,724 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 06:32:33,724 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 06:32:33,724 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-10-25 (519 symbols)
2025-12-24 06:32:33,724 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 06:32:33,724 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 06:32:33,724 INFO [src.stage_a.stage_a] Extract run ID: 3709bfd9-3d53-4809-8987-99209cadaa13
2025-12-24 06:32:33,732 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 06:32:33,732 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 06:32:33,732 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 06:32:33,732 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 06:32:33,732 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 06:32:33,732 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 06:32:33,732 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 06:32:33,732 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 06:32:33,732 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 06:32:35,592 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 06:32:35,592 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-25...
2025-12-24 06:32:35,711 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241025 for 519 symbols
2025-12-24 06:36:23,191 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,939,551 trades
2025-12-24 06:36:23,191 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,939,551 rows
2025-12-24 06:38:21,993 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,817,538 trades
2025-12-24 06:38:21,993 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,817,538 rows
2025-12-24 06:40:19,334 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,217,187 trades
2025-12-24 06:40:19,334 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,217,187 rows
2025-12-24 06:42:25,843 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,693,586 trades
2025-12-24 06:42:25,843 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,693,586 rows
2025-12-24 06:44:28,270 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,306,749 trades
2025-12-24 06:44:28,271 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,306,749 rows
2025-12-24 06:47:14,918 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,107,888 trades
2025-12-24 06:47:14,918 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,107,888 rows
2025-12-24 06:51:34,634 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,080,470 trades
2025-12-24 06:51:34,634 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,080,470 rows
2025-12-24 06:54:16,617 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,260,253 trades
2025-12-24 06:54:16,622 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,260,253 rows
2025-12-24 06:56:16,690 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,308,969 trades
2025-12-24 06:56:16,690 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,308,969 rows
2025-12-24 07:00:12,028 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,808,542 trades
2025-12-24 07:00:12,029 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,808,542 rows
2025-12-24 07:00:12,484 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,540,733 total rows written
2025-12-24 07:01:17,712 INFO [src.stage_a.wrds_extractor]   Chunk 11: 913,015 trades
2025-12-24 07:01:17,716 INFO [src.stage_a.parquet_writer]   Chunk 11: 913,015 rows
2025-12-24 07:01:18,032 INFO [src.stage_a.parquet_writer] ✓ Wrote 26,453,748 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-25
2025-12-24 07:01:18,033 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 07:01:18,033 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 07:01:18,033 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 07:01:18,033 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 07:01:18,033 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 07:01:18,033 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 07:01:18,033 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 07:01:20,222 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 07:01:20,222 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-25...
2025-12-24 07:01:20,330 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241025 for 519 symbols
2025-12-24 07:04:31,816 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,503,059 NBBO records
2025-12-24 07:04:31,816 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,503,059 rows
2025-12-24 07:06:01,090 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,947,970 NBBO records
2025-12-24 07:06:01,091 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,947,970 rows
2025-12-24 07:08:48,220 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,148,777 NBBO records
2025-12-24 07:08:48,220 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,148,777 rows
2025-12-24 07:10:25,612 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,296,970 NBBO records
2025-12-24 07:10:25,612 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,296,970 rows
2025-12-24 07:13:23,693 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,138,318 NBBO records
2025-12-24 07:13:23,693 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,138,318 rows
2025-12-24 07:15:25,239 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,071,903 NBBO records
2025-12-24 07:15:25,240 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,071,903 rows
2025-12-24 07:19:01,375 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,340,964 NBBO records
2025-12-24 07:19:01,375 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,340,964 rows
2025-12-24 07:22:34,348 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,914,136 NBBO records
2025-12-24 07:22:34,349 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,914,136 rows
2025-12-24 07:24:49,650 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,469,795 NBBO records
2025-12-24 07:24:49,651 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,469,795 rows
2025-12-24 07:27:19,872 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,550,106 NBBO records
2025-12-24 07:27:19,872 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,550,106 rows
2025-12-24 07:27:20,216 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 47,381,998 total rows written
2025-12-24 07:30:29,367 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,212,660 NBBO records
2025-12-24 07:30:29,367 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,212,660 rows
2025-12-24 07:30:29,962 INFO [src.stage_a.parquet_writer] ✓ Wrote 53,594,658 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-25
2025-12-24 07:30:29,972 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 07:30:29,972 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 07:30:29,972 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 07:30:29,972 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 07:30:29,972 INFO [src.stage_a.stage_a] Trades: 26,453,748 rows
2025-12-24 07:30:29,972 INFO [src.stage_a.stage_a] Nbbo: 53,594,658 rows
2025-12-24 07:30:29,972 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 07:30:29,972 INFO [src.stage_a.stage_a] Processing date 96/140: 2024-10-28
2025-12-24 07:30:29,972 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 07:30:29,972 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 07:30:29,972 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-10-28 (519 symbols)
2025-12-24 07:30:29,972 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 07:30:29,972 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 07:30:29,972 INFO [src.stage_a.stage_a] Extract run ID: 6951b1fb-01ce-4eb1-8559-97b94bcc01c1
2025-12-24 07:30:29,980 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 07:30:29,980 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 07:30:29,980 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 07:30:29,980 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 07:30:29,980 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 07:30:29,980 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 07:30:29,980 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 07:30:29,980 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 07:30:29,980 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 07:30:31,073 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 07:30:31,073 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-28...
2025-12-24 07:30:31,150 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241028 for 519 symbols
2025-12-24 07:32:38,661 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,849,656 trades
2025-12-24 07:32:38,661 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,849,656 rows
2025-12-24 07:34:06,680 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,874,932 trades
2025-12-24 07:34:06,680 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,874,932 rows
2025-12-24 07:35:33,067 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,018,285 trades
2025-12-24 07:35:33,068 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,018,285 rows
2025-12-24 07:36:51,623 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,670,615 trades
2025-12-24 07:36:51,623 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,670,615 rows
2025-12-24 07:38:32,232 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,504,416 trades
2025-12-24 07:38:32,232 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,504,416 rows
2025-12-24 07:40:08,682 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,992,096 trades
2025-12-24 07:40:08,682 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,992,096 rows
2025-12-24 07:43:00,732 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,663,904 trades
2025-12-24 07:43:00,732 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,663,904 rows
2025-12-24 07:45:05,624 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,198,336 trades
2025-12-24 07:45:05,627 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,198,336 rows
2025-12-24 07:46:37,780 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,051,095 trades
2025-12-24 07:46:37,780 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,051,095 rows
2025-12-24 07:49:33,172 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,112,800 trades
2025-12-24 07:49:33,172 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,112,800 rows
2025-12-24 07:49:33,594 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,936,135 total rows written
2025-12-24 07:50:21,141 INFO [src.stage_a.wrds_extractor]   Chunk 11: 854,734 trades
2025-12-24 07:50:21,142 INFO [src.stage_a.parquet_writer]   Chunk 11: 854,734 rows
2025-12-24 07:50:21,409 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,790,869 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-28
2025-12-24 07:50:21,410 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 07:50:21,410 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 07:50:21,410 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 07:50:21,410 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 07:50:21,410 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 07:50:21,410 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 07:50:21,410 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 07:50:23,382 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 07:50:23,382 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-28...
2025-12-24 07:50:23,491 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241028 for 519 symbols
2025-12-24 07:52:37,022 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,466,739 NBBO records
2025-12-24 07:52:37,022 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,466,739 rows
2025-12-24 07:53:47,673 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,735,395 NBBO records
2025-12-24 07:53:47,673 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,735,395 rows
2025-12-24 07:55:50,950 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,465,410 NBBO records
2025-12-24 07:55:50,950 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,465,410 rows
2025-12-24 07:57:18,609 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,846,626 NBBO records
2025-12-24 07:57:18,609 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,846,626 rows
2025-12-24 07:59:17,566 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,256,216 NBBO records
2025-12-24 07:59:17,566 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,256,216 rows
2025-12-24 08:01:10,551 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,741,650 NBBO records
2025-12-24 08:01:10,551 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,741,650 rows
2025-12-24 08:04:07,169 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,234,273 NBBO records
2025-12-24 08:04:07,169 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,234,273 rows
2025-12-24 08:06:43,610 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,230,194 NBBO records
2025-12-24 08:06:43,611 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,230,194 rows
2025-12-24 08:08:44,041 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,879,333 NBBO records
2025-12-24 08:08:44,046 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,879,333 rows
2025-12-24 08:10:46,982 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,047,141 NBBO records
2025-12-24 08:10:46,982 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,047,141 rows
2025-12-24 08:10:47,301 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 41,902,977 total rows written
2025-12-24 08:13:25,532 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,216,366 NBBO records
2025-12-24 08:13:25,532 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,216,366 rows
2025-12-24 08:13:26,036 INFO [src.stage_a.parquet_writer] ✓ Wrote 47,119,343 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-28
2025-12-24 08:13:26,045 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 08:13:26,045 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 08:13:26,045 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 08:13:26,045 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 08:13:26,045 INFO [src.stage_a.stage_a] Trades: 24,790,869 rows
2025-12-24 08:13:26,045 INFO [src.stage_a.stage_a] Nbbo: 47,119,343 rows
2025-12-24 08:13:26,045 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 08:13:26,045 INFO [src.stage_a.stage_a] Processing date 97/140: 2024-10-29
2025-12-24 08:13:26,045 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 08:13:26,045 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 08:13:26,045 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-10-29 (519 symbols)
2025-12-24 08:13:26,045 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 08:13:26,045 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 08:13:26,045 INFO [src.stage_a.stage_a] Extract run ID: 0e079173-47cc-4d5b-903c-6d1d8b53e55d
2025-12-24 08:13:26,054 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 08:13:26,054 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 08:13:26,054 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 08:13:26,054 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 08:13:26,054 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 08:13:26,054 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 08:13:26,054 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 08:13:26,054 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 08:13:26,054 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 08:13:27,403 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 08:13:27,404 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-29...
2025-12-24 08:13:27,503 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241029 for 519 symbols
2025-12-24 08:16:38,883 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,127,158 trades
2025-12-24 08:16:38,883 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,127,158 rows
2025-12-24 08:19:14,013 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,359,288 trades
2025-12-24 08:19:14,014 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,359,288 rows
2025-12-24 08:21:08,633 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,192,786 trades
2025-12-24 08:21:08,633 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,192,786 rows
2025-12-24 08:23:05,492 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,988,576 trades
2025-12-24 08:23:05,492 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,988,576 rows
2025-12-24 08:25:57,108 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,734,488 trades
2025-12-24 08:25:57,108 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,734,488 rows
2025-12-24 08:27:56,920 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,305,728 trades
2025-12-24 08:27:56,921 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,305,728 rows
2025-12-24 08:31:52,522 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,839,546 trades
2025-12-24 08:31:52,522 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,839,546 rows
2025-12-24 08:34:40,344 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,567,315 trades
2025-12-24 08:34:40,351 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,567,315 rows
2025-12-24 08:37:11,981 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,311,720 trades
2025-12-24 08:37:11,981 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,311,720 rows
2025-12-24 08:39:48,989 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,044,322 trades
2025-12-24 08:39:48,989 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,044,322 rows
2025-12-24 08:39:49,392 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,470,927 total rows written
2025-12-24 08:40:57,467 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,022,058 trades
2025-12-24 08:40:57,467 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,022,058 rows
2025-12-24 08:40:57,788 INFO [src.stage_a.parquet_writer] ✓ Wrote 27,492,985 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-29
2025-12-24 08:40:57,789 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 08:40:57,789 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 08:40:57,789 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 08:40:57,789 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 08:40:57,789 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 08:40:57,789 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 08:40:57,789 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 08:40:59,452 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 08:40:59,452 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-29...
2025-12-24 08:40:59,523 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241029 for 519 symbols
2025-12-24 08:44:04,775 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,410,825 NBBO records
2025-12-24 08:44:04,776 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,410,825 rows
2025-12-24 08:46:13,970 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,997,666 NBBO records
2025-12-24 08:46:13,971 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,997,666 rows
2025-12-24 08:48:56,170 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,566,550 NBBO records
2025-12-24 08:48:56,170 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,566,550 rows
2025-12-24 08:50:45,419 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,741,250 NBBO records
2025-12-24 08:50:45,419 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,741,250 rows
2025-12-24 08:53:06,819 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,604,992 NBBO records
2025-12-24 08:53:06,819 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,604,992 rows
2025-12-24 08:55:32,397 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,988,206 NBBO records
2025-12-24 08:55:32,397 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,988,206 rows
2025-12-24 08:58:51,317 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,737,666 NBBO records
2025-12-24 08:58:51,317 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,737,666 rows
2025-12-24 09:01:43,095 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,924,537 NBBO records
2025-12-24 09:01:43,096 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,924,537 rows
2025-12-24 09:04:25,806 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,828,202 NBBO records
2025-12-24 09:04:25,807 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,828,202 rows
2025-12-24 09:06:46,064 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,485,265 NBBO records
2025-12-24 09:06:46,064 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,485,265 rows
2025-12-24 09:06:46,402 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 43,285,159 total rows written
2025-12-24 09:09:52,195 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,491,885 NBBO records
2025-12-24 09:09:52,197 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,491,885 rows
2025-12-24 09:09:52,690 INFO [src.stage_a.parquet_writer] ✓ Wrote 48,777,044 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-29
2025-12-24 09:09:52,694 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 09:09:52,694 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 09:09:52,694 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 09:09:52,694 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 09:09:52,694 INFO [src.stage_a.stage_a] Trades: 27,492,985 rows
2025-12-24 09:09:52,694 INFO [src.stage_a.stage_a] Nbbo: 48,777,044 rows
2025-12-24 09:09:52,694 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 09:09:52,694 INFO [src.stage_a.stage_a] Processing date 98/140: 2024-10-30
2025-12-24 09:09:52,694 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 09:09:52,695 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 09:09:52,695 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-10-30 (519 symbols)
2025-12-24 09:09:52,695 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 09:09:52,695 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 09:09:52,695 INFO [src.stage_a.stage_a] Extract run ID: 3edfb314-c98b-47ea-8d00-f8aef6b3e63c
2025-12-24 09:09:52,703 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 09:09:52,703 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 09:09:52,703 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 09:09:52,703 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 09:09:52,703 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 09:09:52,703 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 09:09:52,703 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 09:09:52,703 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 09:09:52,703 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 09:09:54,618 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 09:09:54,618 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-30...
2025-12-24 09:09:54,800 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241030 for 519 symbols
2025-12-24 09:12:47,454 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,725,476 trades
2025-12-24 09:12:47,454 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,725,476 rows
2025-12-24 09:14:32,227 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,304,929 trades
2025-12-24 09:14:32,229 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,304,929 rows
2025-12-24 09:16:22,447 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,299,359 trades
2025-12-24 09:16:22,448 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,299,359 rows
2025-12-24 09:17:46,379 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,021,593 trades
2025-12-24 09:17:46,380 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,021,593 rows
2025-12-24 09:20:25,489 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,482,072 trades
2025-12-24 09:20:25,489 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,482,072 rows
2025-12-24 09:22:17,083 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,671,393 trades
2025-12-24 09:22:17,085 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,671,393 rows
2025-12-24 09:25:34,284 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,406,662 trades
2025-12-24 09:25:34,285 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,406,662 rows
2025-12-24 09:27:24,529 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,485,106 trades
2025-12-24 09:27:24,546 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,485,106 rows
2025-12-24 09:29:44,102 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,373,436 trades
2025-12-24 09:29:44,102 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,373,436 rows
2025-12-24 09:32:40,184 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,826,897 trades
2025-12-24 09:32:40,187 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,826,897 rows
2025-12-24 09:32:40,585 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 29,596,923 total rows written
2025-12-24 09:33:47,056 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,009,413 trades
2025-12-24 09:33:47,057 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,009,413 rows
2025-12-24 09:33:47,382 INFO [src.stage_a.parquet_writer] ✓ Wrote 30,606,336 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-30
2025-12-24 09:33:47,383 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 09:33:47,383 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 09:33:47,383 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 09:33:47,383 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 09:33:47,383 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 09:33:47,383 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 09:33:47,383 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 09:33:49,075 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 09:33:49,076 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-30...
2025-12-24 09:33:49,162 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241030 for 519 symbols
2025-12-24 09:36:02,354 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,697,395 NBBO records
2025-12-24 09:36:02,354 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,697,395 rows
2025-12-24 09:37:25,289 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,136,274 NBBO records
2025-12-24 09:37:25,290 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,136,274 rows
2025-12-24 09:40:01,081 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,402,589 NBBO records
2025-12-24 09:40:01,082 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,402,589 rows
2025-12-24 09:41:44,344 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,847,327 NBBO records
2025-12-24 09:41:44,345 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,847,327 rows
2025-12-24 09:44:22,076 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,274,446 NBBO records
2025-12-24 09:44:22,077 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,274,446 rows
2025-12-24 09:46:27,549 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,435,622 NBBO records
2025-12-24 09:46:27,550 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,435,622 rows
2025-12-24 09:49:14,175 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,055,312 NBBO records
2025-12-24 09:49:14,176 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,055,312 rows
2025-12-24 09:52:17,636 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,637,585 NBBO records
2025-12-24 09:52:17,637 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,637,585 rows
2025-12-24 09:53:58,663 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,876,566 NBBO records
2025-12-24 09:53:58,667 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,876,566 rows
2025-12-24 09:56:16,841 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,434,816 NBBO records
2025-12-24 09:56:16,841 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,434,816 rows
2025-12-24 09:56:17,183 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 45,797,932 total rows written
2025-12-24 09:59:30,224 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,417,790 NBBO records
2025-12-24 09:59:30,224 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,417,790 rows
2025-12-24 09:59:30,789 INFO [src.stage_a.parquet_writer] ✓ Wrote 52,215,722 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-30
2025-12-24 09:59:30,800 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 09:59:30,800 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 09:59:30,800 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 09:59:30,800 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 09:59:30,800 INFO [src.stage_a.stage_a] Trades: 30,606,336 rows
2025-12-24 09:59:30,800 INFO [src.stage_a.stage_a] Nbbo: 52,215,722 rows
2025-12-24 09:59:30,800 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 09:59:30,800 INFO [src.stage_a.stage_a] Processing date 99/140: 2024-10-31
2025-12-24 09:59:30,800 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 09:59:30,800 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 09:59:30,800 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-10-31 (519 symbols)
2025-12-24 09:59:30,800 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 09:59:30,800 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 09:59:30,800 INFO [src.stage_a.stage_a] Extract run ID: 02782cfd-8065-4fc9-adb1-aeb08ed401be
2025-12-24 09:59:30,817 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 09:59:30,817 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 09:59:30,817 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 09:59:30,817 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 09:59:30,817 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 09:59:30,817 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 09:59:30,817 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 09:59:30,817 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 09:59:30,817 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 09:59:32,206 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 09:59:32,206 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-31...
2025-12-24 09:59:32,308 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241031 for 519 symbols
2025-12-24 10:02:49,181 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,158,407 trades
2025-12-24 10:02:49,181 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,158,407 rows
2025-12-24 10:04:34,151 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,425,986 trades
2025-12-24 10:04:34,155 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,425,986 rows
2025-12-24 10:06:38,472 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,443,422 trades
2025-12-24 10:06:38,473 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,443,422 rows
2025-12-24 10:08:40,911 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,380,172 trades
2025-12-24 10:08:40,911 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,380,172 rows
2025-12-24 10:11:31,518 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,314,422 trades
2025-12-24 10:11:31,518 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,314,422 rows
2025-12-24 10:13:52,835 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,567,867 trades
2025-12-24 10:13:52,836 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,567,867 rows
2025-12-24 10:19:29,050 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,161,004 trades
2025-12-24 10:19:29,051 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,161,004 rows
2025-12-24 10:21:59,653 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,907,804 trades
2025-12-24 10:21:59,667 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,907,804 rows
2025-12-24 10:23:35,964 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,127,097 trades
2025-12-24 10:23:35,971 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,127,097 rows
2025-12-24 10:24:34,587 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,405,284 trades
2025-12-24 10:24:34,598 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,405,284 rows
2025-12-24 10:24:35,035 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 32,891,465 total rows written
2025-12-24 10:24:53,282 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,282,204 trades
2025-12-24 10:24:53,294 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,282,204 rows
2025-12-24 10:24:53,673 INFO [src.stage_a.parquet_writer] ✓ Wrote 34,173,669 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-10-31
2025-12-24 10:24:53,677 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 10:24:53,677 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 10:24:53,677 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 10:24:53,677 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 10:24:53,677 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 10:24:53,677 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 10:24:53,677 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 10:24:54,910 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 10:24:54,910 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-31...
2025-12-24 10:24:54,978 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241031 for 519 symbols
2025-12-24 10:29:27,860 INFO [src.stage_a.wrds_extractor]   Chunk 1: 7,273,407 NBBO records
2025-12-24 10:29:27,860 INFO [src.stage_a.parquet_writer]   Chunk 1: 7,273,407 rows
2025-12-24 10:30:56,454 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,757,865 NBBO records
2025-12-24 10:30:56,455 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,757,865 rows
2025-12-24 10:34:25,164 INFO [src.stage_a.wrds_extractor]   Chunk 3: 6,454,348 NBBO records
2025-12-24 10:34:25,164 INFO [src.stage_a.parquet_writer]   Chunk 3: 6,454,348 rows
2025-12-24 10:36:02,466 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,692,906 NBBO records
2025-12-24 10:36:02,468 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,692,906 rows
2025-12-24 10:37:33,186 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,928,304 NBBO records
2025-12-24 10:37:33,186 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,928,304 rows
2025-12-24 10:40:04,216 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,108,130 NBBO records
2025-12-24 10:40:04,217 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,108,130 rows
2025-12-24 10:43:08,786 INFO [src.stage_a.wrds_extractor]   Chunk 7: 8,486,849 NBBO records
2025-12-24 10:43:08,786 INFO [src.stage_a.parquet_writer]   Chunk 7: 8,486,849 rows
2025-12-24 10:44:29,754 INFO [src.stage_a.wrds_extractor]   Chunk 8: 6,753,442 NBBO records
2025-12-24 10:44:29,762 INFO [src.stage_a.parquet_writer]   Chunk 8: 6,753,442 rows
2025-12-24 10:46:33,697 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,800,098 NBBO records
2025-12-24 10:46:33,704 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,800,098 rows
2025-12-24 10:48:56,870 INFO [src.stage_a.wrds_extractor]   Chunk 10: 5,340,992 NBBO records
2025-12-24 10:48:56,872 INFO [src.stage_a.parquet_writer]   Chunk 10: 5,340,992 rows
2025-12-24 10:48:57,262 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 57,596,341 total rows written
2025-12-24 10:51:13,598 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,636,717 NBBO records
2025-12-24 10:51:13,600 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,636,717 rows
2025-12-24 10:51:14,284 INFO [src.stage_a.parquet_writer] ✓ Wrote 65,233,058 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-10-31
2025-12-24 10:51:14,297 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 10:51:14,297 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 10:51:14,297 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 10:51:14,297 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 10:51:14,297 INFO [src.stage_a.stage_a] Trades: 34,173,669 rows
2025-12-24 10:51:14,297 INFO [src.stage_a.stage_a] Nbbo: 65,233,058 rows
2025-12-24 10:51:14,297 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 10:51:14,297 INFO [src.stage_a.stage_a] Processing date 100/140: 2024-11-01
2025-12-24 10:51:14,297 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 10:51:14,297 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 10:51:14,297 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-11-01 (519 symbols)
2025-12-24 10:51:14,297 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 10:51:14,297 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 10:51:14,297 INFO [src.stage_a.stage_a] Extract run ID: e1d5740f-71a4-462f-9f6d-e4a5450ff5c6
2025-12-24 10:51:14,306 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 10:51:14,306 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 10:51:14,306 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 10:51:14,306 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 10:51:14,306 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 10:51:14,306 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 10:51:14,306 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 10:51:14,306 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 10:51:14,306 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 10:51:15,565 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 10:51:15,565 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-01...
2025-12-24 10:51:15,664 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241101 for 519 symbols
2025-12-24 10:52:54,506 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,237,330 trades
2025-12-24 10:52:54,506 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,237,330 rows
2025-12-24 10:54:45,358 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,208,033 trades
2025-12-24 10:54:45,362 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,208,033 rows
2025-12-24 10:56:32,032 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,456,140 trades
2025-12-24 10:56:32,032 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,456,140 rows
2025-12-24 10:58:29,005 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,037,560 trades
2025-12-24 10:58:29,006 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,037,560 rows
2025-12-24 11:00:46,984 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,040,688 trades
2025-12-24 11:00:46,984 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,040,688 rows
2025-12-24 11:02:43,263 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,290,209 trades
2025-12-24 11:02:43,264 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,290,209 rows
2025-12-24 11:06:04,582 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,131,813 trades
2025-12-24 11:06:04,583 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,131,813 rows
2025-12-24 11:08:45,413 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,433,560 trades
2025-12-24 11:08:45,418 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,433,560 rows
2025-12-24 11:11:18,001 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,756,824 trades
2025-12-24 11:11:18,001 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,756,824 rows
2025-12-24 11:14:16,480 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,955,708 trades
2025-12-24 11:14:16,480 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,955,708 rows
2025-12-24 11:14:16,889 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 28,547,865 total rows written
2025-12-24 11:15:32,773 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,164,792 trades
2025-12-24 11:15:32,773 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,164,792 rows
2025-12-24 11:15:33,110 INFO [src.stage_a.parquet_writer] ✓ Wrote 29,712,657 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-01
2025-12-24 11:15:33,111 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 11:15:33,111 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 11:15:33,111 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 11:15:33,111 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 11:15:33,111 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 11:15:33,111 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 11:15:33,111 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 11:15:34,904 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 11:15:34,904 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-01...
2025-12-24 11:15:35,026 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241101 for 519 symbols
2025-12-24 11:19:52,839 INFO [src.stage_a.wrds_extractor]   Chunk 1: 6,915,335 NBBO records
2025-12-24 11:19:52,839 INFO [src.stage_a.parquet_writer]   Chunk 1: 6,915,335 rows
2025-12-24 11:22:12,447 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,517,445 NBBO records
2025-12-24 11:22:12,448 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,517,445 rows
2025-12-24 11:26:22,733 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,956,881 NBBO records
2025-12-24 11:26:22,733 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,956,881 rows
2025-12-24 11:28:40,159 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,480,075 NBBO records
2025-12-24 11:28:40,163 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,480,075 rows
2025-12-24 11:33:04,534 INFO [src.stage_a.wrds_extractor]   Chunk 5: 6,314,349 NBBO records
2025-12-24 11:33:04,534 INFO [src.stage_a.parquet_writer]   Chunk 5: 6,314,349 rows
2025-12-24 11:36:02,198 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,838,691 NBBO records
2025-12-24 11:36:02,200 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,838,691 rows
2025-12-24 11:40:57,204 INFO [src.stage_a.wrds_extractor]   Chunk 7: 8,221,598 NBBO records
2025-12-24 11:40:57,204 INFO [src.stage_a.parquet_writer]   Chunk 7: 8,221,598 rows
2025-12-24 11:45:00,281 INFO [src.stage_a.wrds_extractor]   Chunk 8: 6,660,233 NBBO records
2025-12-24 11:45:00,290 INFO [src.stage_a.parquet_writer]   Chunk 8: 6,660,233 rows
2025-12-24 11:47:31,139 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,717,022 NBBO records
2025-12-24 11:47:31,140 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,717,022 rows
2025-12-24 11:50:29,619 INFO [src.stage_a.wrds_extractor]   Chunk 10: 5,067,789 NBBO records
2025-12-24 11:50:29,619 INFO [src.stage_a.parquet_writer]   Chunk 10: 5,067,789 rows
2025-12-24 11:50:29,979 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 55,689,418 total rows written
2025-12-24 11:54:19,228 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,675,905 NBBO records
2025-12-24 11:54:19,230 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,675,905 rows
2025-12-24 11:54:19,880 INFO [src.stage_a.parquet_writer] ✓ Wrote 63,365,323 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-01
2025-12-24 11:54:19,886 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 11:54:19,886 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 11:54:19,886 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 11:54:19,886 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 11:54:19,886 INFO [src.stage_a.stage_a] Trades: 29,712,657 rows
2025-12-24 11:54:19,886 INFO [src.stage_a.stage_a] Nbbo: 63,365,323 rows
2025-12-24 11:54:19,887 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 11:54:19,887 INFO [src.stage_a.stage_a] Processing date 101/140: 2024-11-04
2025-12-24 11:54:19,887 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 11:54:19,887 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 11:54:19,887 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-11-04 (519 symbols)
2025-12-24 11:54:19,887 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 11:54:19,887 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 11:54:19,887 INFO [src.stage_a.stage_a] Extract run ID: dcaf1bb4-3db6-436d-ab68-4460423460cd
2025-12-24 11:54:19,895 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 11:54:19,895 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 11:54:19,895 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 11:54:19,895 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 11:54:19,895 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 11:54:19,895 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 11:54:19,895 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 11:54:19,895 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 11:54:19,895 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 11:54:21,551 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 11:54:21,551 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-04...
2025-12-24 11:54:21,639 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241104 for 519 symbols
2025-12-24 11:56:52,620 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,141,256 trades
2025-12-24 11:56:52,620 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,141,256 rows
2025-12-24 11:58:47,574 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,300,314 trades
2025-12-24 11:58:47,574 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,300,314 rows
2025-12-24 12:00:46,844 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,257,157 trades
2025-12-24 12:00:46,844 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,257,157 rows
2025-12-24 12:02:29,003 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,985,157 trades
2025-12-24 12:02:29,003 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,985,157 rows
2025-12-24 12:04:55,925 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,576,048 trades
2025-12-24 12:04:55,925 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,576,048 rows
2025-12-24 12:06:57,488 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,185,890 trades
2025-12-24 12:06:57,488 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,185,890 rows
2025-12-24 12:10:20,094 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,936,846 trades
2025-12-24 12:10:20,094 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,936,846 rows
2025-12-24 12:12:05,545 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,260,596 trades
2025-12-24 12:12:05,563 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,260,596 rows
2025-12-24 12:14:16,407 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,481,592 trades
2025-12-24 12:14:16,407 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,481,592 rows
2025-12-24 12:16:42,146 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,923,112 trades
2025-12-24 12:16:42,147 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,923,112 rows
2025-12-24 12:16:42,553 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,047,968 total rows written
2025-12-24 12:17:41,173 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,154,737 trades
2025-12-24 12:17:41,173 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,154,737 rows
2025-12-24 12:17:41,498 INFO [src.stage_a.parquet_writer] ✓ Wrote 27,202,705 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-04
2025-12-24 12:17:41,499 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 12:17:41,499 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 12:17:41,499 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 12:17:41,499 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 12:17:41,499 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 12:17:41,499 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 12:17:41,499 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 12:17:43,301 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 12:17:43,301 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-04...
2025-12-24 12:17:43,424 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241104 for 519 symbols
2025-12-24 12:20:54,486 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,421,494 NBBO records
2025-12-24 12:20:54,486 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,421,494 rows
2025-12-24 12:23:07,784 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,749,161 NBBO records
2025-12-24 12:23:07,784 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,749,161 rows
2025-12-24 12:26:30,226 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,621,759 NBBO records
2025-12-24 12:26:30,226 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,621,759 rows
2025-12-24 12:28:24,796 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,395,711 NBBO records
2025-12-24 12:28:24,797 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,395,711 rows
2025-12-24 12:31:30,160 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,521,482 NBBO records
2025-12-24 12:31:30,160 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,521,482 rows
2025-12-24 12:34:09,980 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,013,540 NBBO records
2025-12-24 12:34:09,981 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,013,540 rows
2025-12-24 12:38:33,472 INFO [src.stage_a.wrds_extractor]   Chunk 7: 8,538,280 NBBO records
2025-12-24 12:38:33,472 INFO [src.stage_a.parquet_writer]   Chunk 7: 8,538,280 rows
2025-12-24 12:41:41,710 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,657,898 NBBO records
2025-12-24 12:41:41,721 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,657,898 rows
2025-12-24 12:44:06,701 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,580,514 NBBO records
2025-12-24 12:44:06,702 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,580,514 rows
2025-12-24 12:46:50,468 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,259,938 NBBO records
2025-12-24 12:46:50,469 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,259,938 rows
2025-12-24 12:46:50,809 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 51,759,777 total rows written
2025-12-24 12:50:49,018 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,461,415 NBBO records
2025-12-24 12:50:49,019 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,461,415 rows
2025-12-24 12:50:49,603 INFO [src.stage_a.parquet_writer] ✓ Wrote 58,221,192 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-04
2025-12-24 12:50:49,611 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 12:50:49,611 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 12:50:49,611 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 12:50:49,611 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 12:50:49,611 INFO [src.stage_a.stage_a] Trades: 27,202,705 rows
2025-12-24 12:50:49,611 INFO [src.stage_a.stage_a] Nbbo: 58,221,192 rows
2025-12-24 12:50:49,611 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 12:50:49,611 INFO [src.stage_a.stage_a] Processing date 102/140: 2024-11-05
2025-12-24 12:50:49,611 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 12:50:49,611 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 12:50:49,611 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-11-05 (519 symbols)
2025-12-24 12:50:49,611 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 12:50:49,611 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 12:50:49,611 INFO [src.stage_a.stage_a] Extract run ID: 9dc775bb-286e-4b9a-a967-ac25985921c8
2025-12-24 12:50:49,620 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 12:50:49,620 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 12:50:49,620 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 12:50:49,620 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 12:50:49,620 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 12:50:49,620 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 12:50:49,620 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 12:50:49,620 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 12:50:49,620 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 12:50:51,029 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 12:50:51,029 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-05...
2025-12-24 12:50:51,118 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241105 for 519 symbols
2025-12-24 12:53:33,206 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,900,618 trades
2025-12-24 12:53:33,206 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,900,618 rows
2025-12-24 12:56:04,909 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,167,146 trades
2025-12-24 12:56:04,909 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,167,146 rows
2025-12-24 12:58:00,977 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,093,507 trades
2025-12-24 12:58:00,978 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,093,507 rows
2025-12-24 12:59:58,264 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,926,089 trades
2025-12-24 12:59:58,264 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,926,089 rows
2025-12-24 13:02:25,613 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,313,105 trades
2025-12-24 13:02:25,613 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,313,105 rows
2025-12-24 13:04:54,312 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,004,085 trades
2025-12-24 13:04:54,312 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,004,085 rows
2025-12-24 13:08:20,124 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,469,319 trades
2025-12-24 13:08:20,124 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,469,319 rows
2025-12-24 13:10:38,549 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,051,721 trades
2025-12-24 13:10:38,554 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,051,721 rows
2025-12-24 13:13:20,479 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,248,213 trades
2025-12-24 13:13:20,479 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,248,213 rows
2025-12-24 13:16:51,999 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,720,530 trades
2025-12-24 13:16:51,999 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,720,530 rows
2025-12-24 13:16:52,389 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,894,333 total rows written
2025-12-24 13:17:39,932 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,061,654 trades
2025-12-24 13:17:39,932 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,061,654 rows
2025-12-24 13:17:40,255 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,955,987 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-05
2025-12-24 13:17:40,255 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 13:17:40,256 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 13:17:40,256 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 13:17:40,256 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 13:17:40,256 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 13:17:40,256 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 13:17:40,256 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 13:17:41,568 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 13:17:41,568 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-05...
2025-12-24 13:17:41,664 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241105 for 519 symbols
2025-12-24 13:21:52,106 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,494,398 NBBO records
2025-12-24 13:21:52,106 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,494,398 rows
2025-12-24 13:24:09,645 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,450,660 NBBO records
2025-12-24 13:24:09,645 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,450,660 rows
2025-12-24 13:27:55,931 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,504,401 NBBO records
2025-12-24 13:27:55,932 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,504,401 rows
2025-12-24 13:30:17,850 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,969,434 NBBO records
2025-12-24 13:30:17,851 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,969,434 rows
2025-12-24 13:34:19,924 INFO [src.stage_a.wrds_extractor]   Chunk 5: 6,104,334 NBBO records
2025-12-24 13:34:19,924 INFO [src.stage_a.parquet_writer]   Chunk 5: 6,104,334 rows
2025-12-24 13:37:23,384 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,855,588 NBBO records
2025-12-24 13:37:23,385 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,855,588 rows
2025-12-24 13:40:55,701 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,836,172 NBBO records
2025-12-24 13:40:55,702 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,836,172 rows
2025-12-24 13:44:06,189 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,975,426 NBBO records
2025-12-24 13:44:06,193 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,975,426 rows
2025-12-24 13:46:11,555 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,132,088 NBBO records
2025-12-24 13:46:11,568 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,132,088 rows
2025-12-24 13:48:40,541 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,759,493 NBBO records
2025-12-24 13:48:40,541 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,759,493 rows
2025-12-24 13:48:40,883 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 50,081,994 total rows written
2025-12-24 13:51:30,203 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,357,205 NBBO records
2025-12-24 13:51:30,205 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,357,205 rows
2025-12-24 13:51:30,747 INFO [src.stage_a.parquet_writer] ✓ Wrote 56,439,199 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-05
2025-12-24 13:51:30,756 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 13:51:30,756 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 13:51:30,756 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 13:51:30,756 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 13:51:30,756 INFO [src.stage_a.stage_a] Trades: 24,955,987 rows
2025-12-24 13:51:30,756 INFO [src.stage_a.stage_a] Nbbo: 56,439,199 rows
2025-12-24 13:51:30,756 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 13:51:30,756 INFO [src.stage_a.stage_a] Processing date 103/140: 2024-11-06
2025-12-24 13:51:30,756 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 13:51:30,756 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 13:51:30,756 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-11-06 (519 symbols)
2025-12-24 13:51:30,756 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 13:51:30,756 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 13:51:30,756 INFO [src.stage_a.stage_a] Extract run ID: 39fb0b55-4a4c-4fa8-9533-27768fcdb342
2025-12-24 13:51:30,765 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 13:51:30,765 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 13:51:30,765 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 13:51:30,765 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 13:51:30,765 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 13:51:30,765 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 13:51:30,765 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 13:51:30,765 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 13:51:30,765 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 13:51:33,019 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 13:51:33,020 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-06...
2025-12-24 13:51:33,199 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241106 for 519 symbols
2025-12-24 13:55:31,226 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,647,757 trades
2025-12-24 13:55:31,226 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,647,757 rows
2025-12-24 13:59:09,632 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,852,747 trades
2025-12-24 13:59:09,633 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,852,747 rows
2025-12-24 14:01:55,002 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,626,735 trades
2025-12-24 14:01:55,012 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,626,735 rows
2025-12-24 14:04:17,728 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,101,852 trades
2025-12-24 14:04:17,728 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,101,852 rows
2025-12-24 14:07:29,584 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,260,679 trades
2025-12-24 14:07:29,585 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,260,679 rows
2025-12-24 14:10:58,875 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,981,335 trades
2025-12-24 14:10:58,875 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,981,335 rows
2025-12-24 14:16:18,254 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,091,331 trades
2025-12-24 14:16:18,254 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,091,331 rows
2025-12-24 14:19:19,170 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,746,851 trades
2025-12-24 14:19:19,179 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,746,851 rows
2025-12-24 14:22:50,463 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,969,419 trades
2025-12-24 14:22:50,479 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,969,419 rows
2025-12-24 14:27:43,700 INFO [src.stage_a.wrds_extractor]   Chunk 10: 5,686,215 trades
2025-12-24 14:27:43,700 INFO [src.stage_a.parquet_writer]   Chunk 10: 5,686,215 rows
2025-12-24 14:27:44,326 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 42,964,921 total rows written
2025-12-24 14:29:31,495 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,913,791 trades
2025-12-24 14:29:31,504 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,913,791 rows
2025-12-24 14:29:32,051 INFO [src.stage_a.parquet_writer] ✓ Wrote 44,878,712 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-06
2025-12-24 14:29:32,057 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 14:29:32,057 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 14:29:32,057 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 14:29:32,057 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 14:29:32,057 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 14:29:32,057 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 14:29:32,057 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 14:29:33,277 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 14:29:33,277 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-06...
2025-12-24 14:29:33,342 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241106 for 519 symbols
2025-12-24 14:32:58,945 INFO [src.stage_a.wrds_extractor]   Chunk 1: 6,748,255 NBBO records
2025-12-24 14:32:58,945 INFO [src.stage_a.parquet_writer]   Chunk 1: 6,748,255 rows
2025-12-24 14:36:39,100 INFO [src.stage_a.wrds_extractor]   Chunk 2: 5,755,220 NBBO records
2025-12-24 14:36:39,101 INFO [src.stage_a.parquet_writer]   Chunk 2: 5,755,220 rows
2025-12-24 14:42:19,608 INFO [src.stage_a.wrds_extractor]   Chunk 3: 7,894,394 NBBO records
2025-12-24 14:42:19,610 INFO [src.stage_a.parquet_writer]   Chunk 3: 7,894,394 rows
2025-12-24 14:46:02,772 INFO [src.stage_a.wrds_extractor]   Chunk 4: 5,016,135 NBBO records
2025-12-24 14:46:02,773 INFO [src.stage_a.parquet_writer]   Chunk 4: 5,016,135 rows
2025-12-24 14:51:52,873 INFO [src.stage_a.wrds_extractor]   Chunk 5: 8,539,198 NBBO records
2025-12-24 14:51:52,874 INFO [src.stage_a.parquet_writer]   Chunk 5: 8,539,198 rows
2025-12-24 14:58:18,684 INFO [src.stage_a.wrds_extractor]   Chunk 6: 7,464,992 NBBO records
2025-12-24 14:58:18,690 INFO [src.stage_a.parquet_writer]   Chunk 6: 7,464,992 rows
2025-12-24 15:06:12,281 INFO [src.stage_a.wrds_extractor]   Chunk 7: 9,820,108 NBBO records
2025-12-24 15:06:12,285 INFO [src.stage_a.parquet_writer]   Chunk 7: 9,820,108 rows
2025-12-24 15:11:53,611 INFO [src.stage_a.wrds_extractor]   Chunk 8: 8,133,594 NBBO records
2025-12-24 15:11:53,618 INFO [src.stage_a.parquet_writer]   Chunk 8: 8,133,594 rows
2025-12-24 15:16:17,889 INFO [src.stage_a.wrds_extractor]   Chunk 9: 6,195,811 NBBO records
2025-12-24 15:16:17,895 INFO [src.stage_a.parquet_writer]   Chunk 9: 6,195,811 rows
2025-12-24 15:20:42,871 INFO [src.stage_a.wrds_extractor]   Chunk 10: 7,027,091 NBBO records
2025-12-24 15:20:42,873 INFO [src.stage_a.parquet_writer]   Chunk 10: 7,027,091 rows
2025-12-24 15:20:43,295 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 72,594,798 total rows written
2025-12-24 15:27:10,406 INFO [src.stage_a.wrds_extractor]   Chunk 11: 9,162,267 NBBO records
2025-12-24 15:27:10,407 INFO [src.stage_a.parquet_writer]   Chunk 11: 9,162,267 rows
2025-12-24 15:27:11,226 INFO [src.stage_a.parquet_writer] ✓ Wrote 81,757,065 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-06
2025-12-24 15:27:11,236 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 15:27:11,236 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 15:27:11,236 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 15:27:11,236 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 15:27:11,236 INFO [src.stage_a.stage_a] Trades: 44,878,712 rows
2025-12-24 15:27:11,236 INFO [src.stage_a.stage_a] Nbbo: 81,757,065 rows
2025-12-24 15:27:11,236 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 15:27:11,236 INFO [src.stage_a.stage_a] Processing date 104/140: 2024-11-07
2025-12-24 15:27:11,236 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 15:27:11,236 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 15:27:11,236 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-11-07 (519 symbols)
2025-12-24 15:27:11,236 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 15:27:11,236 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 15:27:11,236 INFO [src.stage_a.stage_a] Extract run ID: f92d8ae1-d052-4f15-b420-cc857256a6dc
2025-12-24 15:27:11,245 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 15:27:11,245 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 15:27:11,245 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 15:27:11,245 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 15:27:11,245 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 15:27:11,245 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 15:27:11,245 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 15:27:11,245 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 15:27:11,245 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 15:27:12,547 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 15:27:12,547 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-07...
2025-12-24 15:27:12,622 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241107 for 519 symbols
2025-12-24 15:31:29,446 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,875,976 trades
2025-12-24 15:31:29,446 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,875,976 rows
2025-12-24 15:33:57,196 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,478,369 trades
2025-12-24 15:33:57,198 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,478,369 rows
2025-12-24 15:36:46,396 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,606,424 trades
2025-12-24 15:36:46,396 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,606,424 rows
2025-12-24 15:38:34,865 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,230,362 trades
2025-12-24 15:38:34,865 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,230,362 rows
2025-12-24 15:41:35,518 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,169,558 trades
2025-12-24 15:41:35,518 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,169,558 rows
2025-12-24 15:43:58,517 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,651,083 trades
2025-12-24 15:43:58,518 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,651,083 rows
2025-12-24 15:48:34,088 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,761,873 trades
2025-12-24 15:48:34,088 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,761,873 rows
2025-12-24 15:51:07,461 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,869,577 trades
2025-12-24 15:51:07,470 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,869,577 rows
2025-12-24 15:54:10,047 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,906,029 trades
2025-12-24 15:54:10,047 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,906,029 rows
2025-12-24 15:58:24,859 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,367,700 trades
2025-12-24 15:58:24,859 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,367,700 rows
2025-12-24 15:58:25,394 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 31,916,951 total rows written
2025-12-24 15:59:46,693 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,323,569 trades
2025-12-24 15:59:46,708 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,323,569 rows
2025-12-24 15:59:47,131 INFO [src.stage_a.parquet_writer] ✓ Wrote 33,240,520 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-07
2025-12-24 15:59:47,136 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 15:59:47,136 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 15:59:47,136 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 15:59:47,136 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 15:59:47,136 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 15:59:47,136 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 15:59:47,136 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 15:59:49,060 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 15:59:49,060 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-07...
2025-12-24 15:59:49,225 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241107 for 519 symbols
2025-12-24 16:03:44,044 INFO [src.stage_a.wrds_extractor]   Chunk 1: 6,381,764 NBBO records
2025-12-24 16:03:44,044 INFO [src.stage_a.parquet_writer]   Chunk 1: 6,381,764 rows
2025-12-24 16:06:32,171 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,908,366 NBBO records
2025-12-24 16:06:32,173 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,908,366 rows
2025-12-24 16:10:11,268 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,877,877 NBBO records
2025-12-24 16:10:11,268 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,877,877 rows
2025-12-24 16:12:15,819 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,303,162 NBBO records
2025-12-24 16:12:15,820 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,303,162 rows
2025-12-24 16:16:02,604 INFO [src.stage_a.wrds_extractor]   Chunk 5: 6,073,798 NBBO records
2025-12-24 16:16:02,604 INFO [src.stage_a.parquet_writer]   Chunk 5: 6,073,798 rows
2025-12-24 16:19:33,841 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,508,674 NBBO records
2025-12-24 16:19:33,842 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,508,674 rows
2025-12-24 16:24:46,910 INFO [src.stage_a.wrds_extractor]   Chunk 7: 7,540,679 NBBO records
2025-12-24 16:24:46,911 INFO [src.stage_a.parquet_writer]   Chunk 7: 7,540,679 rows
2025-12-24 16:28:26,128 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,401,363 NBBO records
2025-12-24 16:28:26,131 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,401,363 rows
2025-12-24 16:31:36,089 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,679,688 NBBO records
2025-12-24 16:31:36,090 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,679,688 rows
2025-12-24 16:34:44,219 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,861,705 NBBO records
2025-12-24 16:34:44,219 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,861,705 rows
2025-12-24 16:34:44,553 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 53,537,076 total rows written
2025-12-24 16:39:49,060 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,432,129 NBBO records
2025-12-24 16:39:49,061 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,432,129 rows
2025-12-24 16:39:49,653 INFO [src.stage_a.parquet_writer] ✓ Wrote 60,969,205 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-07
2025-12-24 16:39:49,660 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 16:39:49,660 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 16:39:49,660 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 16:39:49,660 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 16:39:49,660 INFO [src.stage_a.stage_a] Trades: 33,240,520 rows
2025-12-24 16:39:49,660 INFO [src.stage_a.stage_a] Nbbo: 60,969,205 rows
2025-12-24 16:39:49,660 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 16:39:49,660 INFO [src.stage_a.stage_a] Processing date 105/140: 2024-11-08
2025-12-24 16:39:49,660 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 16:39:49,660 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 16:39:49,660 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-11-08 (519 symbols)
2025-12-24 16:39:49,660 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 16:39:49,660 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 16:39:49,660 INFO [src.stage_a.stage_a] Extract run ID: 14c6509b-955a-4acb-8eae-14043df6beb9
2025-12-24 16:39:49,668 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 16:39:49,668 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 16:39:49,668 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 16:39:49,668 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 16:39:49,668 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 16:39:49,668 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 16:39:49,668 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 16:39:49,668 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 16:39:49,668 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 16:39:51,863 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 16:39:51,863 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-08...
2025-12-24 16:39:51,961 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241108 for 519 symbols
2025-12-24 16:42:58,960 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,577,135 trades
2025-12-24 16:42:58,960 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,577,135 rows
2025-12-24 16:45:03,438 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,279,276 trades
2025-12-24 16:45:03,439 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,279,276 rows
2025-12-24 16:47:21,310 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,541,584 trades
2025-12-24 16:47:21,310 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,541,584 rows
2025-12-24 16:49:27,826 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,153,595 trades
2025-12-24 16:49:27,827 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,153,595 rows
2025-12-24 16:52:06,593 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,736,715 trades
2025-12-24 16:52:06,593 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,736,715 rows
2025-12-24 16:54:33,859 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,396,661 trades
2025-12-24 16:54:33,860 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,396,661 rows
2025-12-24 16:58:11,189 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,170,509 trades
2025-12-24 16:58:11,189 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,170,509 rows
2025-12-24 17:00:40,671 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,595,615 trades
2025-12-24 17:00:40,692 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,595,615 rows
2025-12-24 17:02:55,635 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,545,498 trades
2025-12-24 17:02:55,635 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,545,498 rows
2025-12-24 17:08:08,432 INFO [src.stage_a.wrds_extractor]   Chunk 10: 5,060,779 trades
2025-12-24 17:08:08,432 INFO [src.stage_a.parquet_writer]   Chunk 10: 5,060,779 rows
2025-12-24 17:08:08,972 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 30,057,367 total rows written
2025-12-24 17:09:31,030 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,072,337 trades
2025-12-24 17:09:31,052 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,072,337 rows
2025-12-24 17:09:31,424 INFO [src.stage_a.parquet_writer] ✓ Wrote 31,129,704 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-08
2025-12-24 17:09:31,425 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 17:09:31,425 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 17:09:31,425 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 17:09:31,425 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 17:09:31,425 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 17:09:31,425 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 17:09:31,425 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 17:09:32,847 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 17:09:32,847 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-08...
2025-12-24 17:09:32,922 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241108 for 519 symbols
2025-12-24 17:13:22,350 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,440,896 NBBO records
2025-12-24 17:13:22,350 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,440,896 rows
2025-12-24 17:16:13,604 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,613,523 NBBO records
2025-12-24 17:16:13,604 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,613,523 rows
2025-12-24 17:19:48,769 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,441,992 NBBO records
2025-12-24 17:19:48,769 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,441,992 rows
2025-12-24 17:21:55,014 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,023,758 NBBO records
2025-12-24 17:21:55,015 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,023,758 rows
2025-12-24 17:24:54,274 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,970,149 NBBO records
2025-12-24 17:24:54,274 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,970,149 rows
2025-12-24 17:27:17,775 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,644,397 NBBO records
2025-12-24 17:27:17,775 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,644,397 rows
2025-12-24 17:31:22,512 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,956,995 NBBO records
2025-12-24 17:31:22,512 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,956,995 rows
2025-12-24 17:34:13,524 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,151,096 NBBO records
2025-12-24 17:34:13,525 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,151,096 rows
2025-12-24 17:36:25,095 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,999,069 NBBO records
2025-12-24 17:36:25,096 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,999,069 rows
2025-12-24 17:39:20,697 INFO [src.stage_a.wrds_extractor]   Chunk 10: 5,051,416 NBBO records
2025-12-24 17:39:20,698 INFO [src.stage_a.parquet_writer]   Chunk 10: 5,051,416 rows
2025-12-24 17:39:21,041 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 47,293,291 total rows written
2025-12-24 17:42:39,875 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,171,369 NBBO records
2025-12-24 17:42:39,876 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,171,369 rows
2025-12-24 17:42:40,416 INFO [src.stage_a.parquet_writer] ✓ Wrote 53,464,660 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-08
2025-12-24 17:42:40,420 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 17:42:40,421 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 17:42:40,421 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 17:42:40,421 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 17:42:40,421 INFO [src.stage_a.stage_a] Trades: 31,129,704 rows
2025-12-24 17:42:40,421 INFO [src.stage_a.stage_a] Nbbo: 53,464,660 rows
2025-12-24 17:42:40,421 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 17:42:40,421 INFO [src.stage_a.stage_a] Processing date 106/140: 2024-11-11
2025-12-24 17:42:40,421 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 17:42:40,421 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 17:42:40,421 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-11-11 (519 symbols)
2025-12-24 17:42:40,421 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 17:42:40,421 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 17:42:40,421 INFO [src.stage_a.stage_a] Extract run ID: 50154e93-c362-4b56-bf98-3c39105b6b99
2025-12-24 17:42:40,429 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 17:42:40,429 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 17:42:40,429 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 17:42:40,429 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 17:42:40,429 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 17:42:40,429 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 17:42:40,429 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 17:42:40,429 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 17:42:40,429 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 17:42:42,633 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 17:42:42,633 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-11...
2025-12-24 17:42:42,699 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241111 for 519 symbols
2025-12-24 17:45:38,613 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,461,614 trades
2025-12-24 17:45:38,613 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,461,614 rows
2025-12-24 17:47:31,369 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,299,756 trades
2025-12-24 17:47:31,369 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,299,756 rows
2025-12-24 17:49:09,509 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,268,171 trades
2025-12-24 17:49:09,509 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,268,171 rows
2025-12-24 17:50:48,324 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,951,033 trades
2025-12-24 17:50:48,324 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,951,033 rows
2025-12-24 17:52:57,779 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,485,642 trades
2025-12-24 17:52:57,779 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,485,642 rows
2025-12-24 17:54:28,279 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,260,437 trades
2025-12-24 17:54:28,279 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,260,437 rows
2025-12-24 17:57:47,148 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,303,899 trades
2025-12-24 17:57:47,148 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,303,899 rows
2025-12-24 17:59:41,865 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,418,425 trades
2025-12-24 17:59:41,878 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,418,425 rows
2025-12-24 18:01:38,927 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,419,786 trades
2025-12-24 18:01:38,927 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,419,786 rows
2025-12-24 18:05:11,372 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,860,834 trades
2025-12-24 18:05:11,372 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,860,834 rows
2025-12-24 18:05:11,892 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 28,729,597 total rows written
2025-12-24 18:06:08,396 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,041,273 trades
2025-12-24 18:06:08,401 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,041,273 rows
2025-12-24 18:06:08,726 INFO [src.stage_a.parquet_writer] ✓ Wrote 29,770,870 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-11
2025-12-24 18:06:08,727 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 18:06:08,727 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 18:06:08,727 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 18:06:08,727 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 18:06:08,727 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 18:06:08,727 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 18:06:08,727 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 18:06:10,606 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 18:06:10,606 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-11...
2025-12-24 18:06:10,744 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241111 for 519 symbols
2025-12-24 18:08:56,210 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,497,925 NBBO records
2025-12-24 18:08:56,211 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,497,925 rows
2025-12-24 18:10:27,299 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,167,444 NBBO records
2025-12-24 18:10:27,299 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,167,444 rows
2025-12-24 18:12:35,111 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,345,967 NBBO records
2025-12-24 18:12:35,111 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,345,967 rows
2025-12-24 18:13:50,959 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,988,523 NBBO records
2025-12-24 18:13:50,959 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,988,523 rows
2025-12-24 18:16:02,021 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,478,655 NBBO records
2025-12-24 18:16:02,021 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,478,655 rows
2025-12-24 18:18:12,168 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,910,565 NBBO records
2025-12-24 18:18:12,168 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,910,565 rows
2025-12-24 18:21:20,226 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,538,157 NBBO records
2025-12-24 18:21:20,227 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,538,157 rows
2025-12-24 18:23:00,692 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,193,644 NBBO records
2025-12-24 18:23:00,693 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,193,644 rows
2025-12-24 18:24:55,663 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,911,438 NBBO records
2025-12-24 18:24:55,664 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,911,438 rows
2025-12-24 18:27:11,345 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,569,585 NBBO records
2025-12-24 18:27:11,345 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,569,585 rows
2025-12-24 18:27:11,665 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 45,601,903 total rows written
2025-12-24 18:30:37,726 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,578,762 NBBO records
2025-12-24 18:30:37,727 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,578,762 rows
2025-12-24 18:30:38,296 INFO [src.stage_a.parquet_writer] ✓ Wrote 52,180,665 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-11
2025-12-24 18:30:38,303 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 18:30:38,303 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 18:30:38,303 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 18:30:38,303 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 18:30:38,303 INFO [src.stage_a.stage_a] Trades: 29,770,870 rows
2025-12-24 18:30:38,303 INFO [src.stage_a.stage_a] Nbbo: 52,180,665 rows
2025-12-24 18:30:38,303 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 18:30:38,303 INFO [src.stage_a.stage_a] Processing date 107/140: 2024-11-12
2025-12-24 18:30:38,303 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 18:30:38,303 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 18:30:38,303 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-11-12 (519 symbols)
2025-12-24 18:30:38,303 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 18:30:38,303 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 18:30:38,303 INFO [src.stage_a.stage_a] Extract run ID: d2944aa0-f443-48dc-940f-defaa8b73016
2025-12-24 18:30:38,311 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 18:30:38,311 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 18:30:38,311 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 18:30:38,311 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 18:30:38,311 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 18:30:38,311 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 18:30:38,311 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 18:30:38,311 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 18:30:38,311 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 18:30:40,110 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 18:30:40,110 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-12...
2025-12-24 18:30:40,277 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241112 for 519 symbols
2025-12-24 18:32:49,807 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,386,498 trades
2025-12-24 18:32:49,807 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,386,498 rows
2025-12-24 18:33:33,826 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,198,108 trades
2025-12-24 18:33:33,826 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,198,108 rows
2025-12-24 18:34:12,755 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,335,168 trades
2025-12-24 18:34:12,755 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,335,168 rows
2025-12-24 18:34:49,161 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,001,049 trades
2025-12-24 18:34:49,162 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,001,049 rows
2025-12-24 18:35:33,562 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,645,281 trades
2025-12-24 18:35:33,562 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,645,281 rows
2025-12-24 18:36:29,971 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,252,978 trades
2025-12-24 18:36:29,971 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,252,978 rows
2025-12-24 18:40:38,612 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,380,261 trades
2025-12-24 18:40:38,612 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,380,261 rows
2025-12-24 18:41:40,695 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,293,729 trades
2025-12-24 18:41:40,705 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,293,729 rows
2025-12-24 18:42:22,513 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,321,854 trades
2025-12-24 18:42:22,513 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,321,854 rows
2025-12-24 18:43:39,933 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,000,852 trades
2025-12-24 18:43:39,933 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,000,852 rows
2025-12-24 18:43:40,435 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 27,815,778 total rows written
2025-12-24 18:45:04,918 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,038,966 trades
2025-12-24 18:45:04,923 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,038,966 rows
2025-12-24 18:45:05,248 INFO [src.stage_a.parquet_writer] ✓ Wrote 28,854,744 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-12
2025-12-24 18:45:05,249 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 18:45:05,249 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 18:45:05,249 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 18:45:05,249 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 18:45:05,249 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 18:45:05,249 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 18:45:05,249 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 18:45:06,518 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 18:45:06,518 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-12...
2025-12-24 18:45:06,578 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241112 for 519 symbols
2025-12-24 18:48:47,334 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,748,571 NBBO records
2025-12-24 18:48:47,334 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,748,571 rows
2025-12-24 18:49:29,409 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,236,678 NBBO records
2025-12-24 18:49:29,410 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,236,678 rows
2025-12-24 18:50:49,095 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,248,537 NBBO records
2025-12-24 18:50:49,095 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,248,537 rows
2025-12-24 18:52:39,636 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,053,707 NBBO records
2025-12-24 18:52:39,637 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,053,707 rows
2025-12-24 18:56:26,494 INFO [src.stage_a.wrds_extractor]   Chunk 5: 6,898,820 NBBO records
2025-12-24 18:56:26,494 INFO [src.stage_a.parquet_writer]   Chunk 5: 6,898,820 rows
2025-12-24 18:59:05,359 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,817,076 NBBO records
2025-12-24 18:59:05,361 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,817,076 rows
2025-12-24 19:01:44,375 INFO [src.stage_a.wrds_extractor]   Chunk 7: 7,537,318 NBBO records
2025-12-24 19:01:44,375 INFO [src.stage_a.parquet_writer]   Chunk 7: 7,537,318 rows
2025-12-24 19:02:48,235 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,227,017 NBBO records
2025-12-24 19:02:48,236 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,227,017 rows
2025-12-24 19:03:39,319 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,155,644 NBBO records
2025-12-24 19:03:39,320 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,155,644 rows
2025-12-24 19:06:56,538 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,757,715 NBBO records
2025-12-24 19:06:56,538 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,757,715 rows
2025-12-24 19:06:56,885 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 50,681,083 total rows written
2025-12-24 19:09:42,897 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,564,895 NBBO records
2025-12-24 19:09:42,897 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,564,895 rows
2025-12-24 19:09:43,481 INFO [src.stage_a.parquet_writer] ✓ Wrote 57,245,978 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-12
2025-12-24 19:09:43,491 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 19:09:43,491 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 19:09:43,491 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 19:09:43,491 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 19:09:43,491 INFO [src.stage_a.stage_a] Trades: 28,854,744 rows
2025-12-24 19:09:43,491 INFO [src.stage_a.stage_a] Nbbo: 57,245,978 rows
2025-12-24 19:09:43,491 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 19:09:43,491 INFO [src.stage_a.stage_a] Processing date 108/140: 2024-11-13
2025-12-24 19:09:43,491 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 19:09:43,491 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 19:09:43,491 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-11-13 (519 symbols)
2025-12-24 19:09:43,491 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 19:09:43,491 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 19:09:43,491 INFO [src.stage_a.stage_a] Extract run ID: 713615d9-c8cd-41c0-aafc-a12d0a67ff62
2025-12-24 19:09:43,499 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 19:09:43,499 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 19:09:43,499 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 19:09:43,499 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 19:09:43,499 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 19:09:43,499 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 19:09:43,499 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 19:09:43,499 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 19:09:43,499 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 19:09:44,568 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 19:09:44,569 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-13...
2025-12-24 19:09:44,638 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241113 for 519 symbols
2025-12-24 19:11:13,316 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,336,102 trades
2025-12-24 19:11:13,316 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,336,102 rows
2025-12-24 19:13:07,247 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,127,334 trades
2025-12-24 19:13:07,247 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,127,334 rows
2025-12-24 19:15:21,463 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,361,596 trades
2025-12-24 19:15:21,463 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,361,596 rows
2025-12-24 19:15:55,076 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,762,512 trades
2025-12-24 19:15:55,076 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,762,512 rows
2025-12-24 19:16:43,214 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,450,447 trades
2025-12-24 19:16:43,214 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,450,447 rows
2025-12-24 19:17:19,515 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,192,414 trades
2025-12-24 19:17:19,515 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,192,414 rows
2025-12-24 19:18:22,070 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,904,691 trades
2025-12-24 19:18:22,070 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,904,691 rows
2025-12-24 19:20:24,995 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,331,441 trades
2025-12-24 19:20:25,001 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,331,441 rows
2025-12-24 19:22:35,421 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,301,804 trades
2025-12-24 19:22:35,421 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,301,804 rows
2025-12-24 19:25:57,155 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,584,553 trades
2025-12-24 19:25:57,155 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,584,553 rows
2025-12-24 19:25:57,614 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,352,894 total rows written
2025-12-24 19:26:41,037 INFO [src.stage_a.wrds_extractor]   Chunk 11: 954,496 trades
2025-12-24 19:26:41,038 INFO [src.stage_a.parquet_writer]   Chunk 11: 954,496 rows
2025-12-24 19:26:41,335 INFO [src.stage_a.parquet_writer] ✓ Wrote 27,307,390 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-13
2025-12-24 19:26:41,337 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 19:26:41,337 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 19:26:41,337 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 19:26:41,337 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 19:26:41,337 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 19:26:41,337 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 19:26:41,337 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 19:26:42,902 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 19:26:42,902 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-13...
2025-12-24 19:26:43,006 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241113 for 519 symbols
2025-12-24 19:31:14,879 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,586,321 NBBO records
2025-12-24 19:31:14,879 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,586,321 rows
2025-12-24 19:34:07,960 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,589,493 NBBO records
2025-12-24 19:34:07,961 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,589,493 rows
2025-12-24 19:38:14,315 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,634,629 NBBO records
2025-12-24 19:38:14,315 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,634,629 rows
2025-12-24 19:39:20,714 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,901,055 NBBO records
2025-12-24 19:39:20,715 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,901,055 rows
2025-12-24 19:40:50,031 INFO [src.stage_a.wrds_extractor]   Chunk 5: 6,291,895 NBBO records
2025-12-24 19:40:50,031 INFO [src.stage_a.parquet_writer]   Chunk 5: 6,291,895 rows
2025-12-24 19:44:06,917 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,310,387 NBBO records
2025-12-24 19:44:06,918 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,310,387 rows
2025-12-24 19:49:01,231 INFO [src.stage_a.wrds_extractor]   Chunk 7: 8,116,918 NBBO records
2025-12-24 19:49:01,234 INFO [src.stage_a.parquet_writer]   Chunk 7: 8,116,918 rows
2025-12-24 19:52:30,563 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,959,596 NBBO records
2025-12-24 19:52:30,570 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,959,596 rows
2025-12-24 19:54:54,859 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,353,192 NBBO records
2025-12-24 19:54:54,860 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,353,192 rows
2025-12-24 19:57:31,823 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,404,750 NBBO records
2025-12-24 19:57:31,823 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,404,750 rows
2025-12-24 19:57:32,157 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 52,148,236 total rows written
2025-12-24 20:01:39,414 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,228,309 NBBO records
2025-12-24 20:01:39,414 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,228,309 rows
2025-12-24 20:01:40,059 INFO [src.stage_a.parquet_writer] ✓ Wrote 59,376,545 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-13
2025-12-24 20:01:40,078 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 20:01:40,078 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 20:01:40,078 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 20:01:40,078 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 20:01:40,078 INFO [src.stage_a.stage_a] Trades: 27,307,390 rows
2025-12-24 20:01:40,078 INFO [src.stage_a.stage_a] Nbbo: 59,376,545 rows
2025-12-24 20:01:40,078 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 20:01:40,078 INFO [src.stage_a.stage_a] Processing date 109/140: 2024-11-14
2025-12-24 20:01:40,078 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 20:01:40,078 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 20:01:40,078 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-11-14 (519 symbols)
2025-12-24 20:01:40,078 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 20:01:40,078 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 20:01:40,078 INFO [src.stage_a.stage_a] Extract run ID: 038eeb35-d3d4-4165-82f7-f1d522e35028
2025-12-24 20:01:40,087 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 20:01:40,087 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 20:01:40,087 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 20:01:40,087 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 20:01:40,087 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 20:01:40,087 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 20:01:40,087 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 20:01:40,087 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 20:01:40,087 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 20:01:42,295 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 20:01:42,295 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-14...
2025-12-24 20:01:42,664 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241114 for 519 symbols
2025-12-24 20:04:32,909 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,274,562 trades
2025-12-24 20:04:32,910 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,274,562 rows
2025-12-24 20:06:10,486 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,157,929 trades
2025-12-24 20:06:10,486 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,157,929 rows
2025-12-24 20:06:55,636 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,612,472 trades
2025-12-24 20:06:55,636 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,612,472 rows
2025-12-24 20:08:40,553 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,885,570 trades
2025-12-24 20:08:40,553 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,885,570 rows
2025-12-24 20:11:25,371 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,604,417 trades
2025-12-24 20:11:25,371 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,604,417 rows
2025-12-24 20:12:42,760 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,382,914 trades
2025-12-24 20:12:42,760 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,382,914 rows
2025-12-24 20:14:07,509 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,034,080 trades
2025-12-24 20:14:07,509 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,034,080 rows
2025-12-24 20:15:08,770 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,350,461 trades
2025-12-24 20:15:08,778 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,350,461 rows
2025-12-24 20:18:03,814 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,608,946 trades
2025-12-24 20:18:03,815 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,608,946 rows
2025-12-24 20:21:59,584 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,579,453 trades
2025-12-24 20:21:59,585 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,579,453 rows
2025-12-24 20:22:00,026 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 27,490,804 total rows written
2025-12-24 20:23:02,848 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,057,494 trades
2025-12-24 20:23:02,850 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,057,494 rows
2025-12-24 20:23:03,210 INFO [src.stage_a.parquet_writer] ✓ Wrote 28,548,298 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-14
2025-12-24 20:23:03,211 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 20:23:03,211 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 20:23:03,211 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 20:23:03,211 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 20:23:03,212 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 20:23:03,212 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 20:23:03,212 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 20:23:04,541 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 20:23:04,542 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-14...
2025-12-24 20:23:04,604 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241114 for 519 symbols
2025-12-24 20:26:02,169 INFO [src.stage_a.wrds_extractor]   Chunk 1: 7,001,451 NBBO records
2025-12-24 20:26:02,169 INFO [src.stage_a.parquet_writer]   Chunk 1: 7,001,451 rows
2025-12-24 20:26:44,652 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,587,102 NBBO records
2025-12-24 20:26:44,653 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,587,102 rows
2025-12-24 20:27:40,595 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,479,123 NBBO records
2025-12-24 20:27:40,595 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,479,123 rows
2025-12-24 20:28:15,759 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,002,085 NBBO records
2025-12-24 20:28:15,760 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,002,085 rows
2025-12-24 20:31:19,575 INFO [src.stage_a.wrds_extractor]   Chunk 5: 7,187,099 NBBO records
2025-12-24 20:31:19,575 INFO [src.stage_a.parquet_writer]   Chunk 5: 7,187,099 rows
2025-12-24 20:33:56,434 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,083,136 NBBO records
2025-12-24 20:33:56,435 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,083,136 rows
2025-12-24 20:36:25,213 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,822,352 NBBO records
2025-12-24 20:36:25,217 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,822,352 rows
2025-12-24 20:39:26,827 INFO [src.stage_a.wrds_extractor]   Chunk 8: 6,061,276 NBBO records
2025-12-24 20:39:26,834 INFO [src.stage_a.parquet_writer]   Chunk 8: 6,061,276 rows
2025-12-24 20:41:57,761 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,674,183 NBBO records
2025-12-24 20:41:57,770 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,674,183 rows
2025-12-24 20:44:13,597 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,692,307 NBBO records
2025-12-24 20:44:13,597 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,692,307 rows
2025-12-24 20:44:13,945 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 53,590,114 total rows written
2025-12-24 20:47:57,995 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,216,255 NBBO records
2025-12-24 20:47:57,995 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,216,255 rows
2025-12-24 20:47:58,631 INFO [src.stage_a.parquet_writer] ✓ Wrote 60,806,369 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-14
2025-12-24 20:47:58,653 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 20:47:58,653 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 20:47:58,653 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 20:47:58,653 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 20:47:58,653 INFO [src.stage_a.stage_a] Trades: 28,548,298 rows
2025-12-24 20:47:58,653 INFO [src.stage_a.stage_a] Nbbo: 60,806,369 rows
2025-12-24 20:47:58,654 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 20:47:58,654 INFO [src.stage_a.stage_a] Processing date 110/140: 2024-11-15
2025-12-24 20:47:58,654 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 20:47:58,654 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 20:47:58,654 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-11-15 (519 symbols)
2025-12-24 20:47:58,654 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 20:47:58,654 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 20:47:58,654 INFO [src.stage_a.stage_a] Extract run ID: a8a7c5de-5f0d-4782-b334-921b43d737ed
2025-12-24 20:47:58,662 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 20:47:58,662 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 20:47:58,662 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 20:47:58,662 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 20:47:58,662 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 20:47:58,662 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 20:47:58,662 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 20:47:58,662 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 20:47:58,662 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 20:47:59,729 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 20:47:59,730 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-15...
2025-12-24 20:47:59,809 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241115 for 519 symbols
2025-12-24 20:51:58,637 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,239,188 trades
2025-12-24 20:51:58,637 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,239,188 rows
2025-12-24 20:54:08,585 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,282,538 trades
2025-12-24 20:54:08,587 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,282,538 rows
2025-12-24 20:56:52,419 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,732,530 trades
2025-12-24 20:56:52,419 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,732,530 rows
2025-12-24 20:58:19,666 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,985,632 trades
2025-12-24 20:58:19,666 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,985,632 rows
2025-12-24 21:00:48,488 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,817,726 trades
2025-12-24 21:00:48,488 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,817,726 rows
2025-12-24 21:03:25,410 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,946,564 trades
2025-12-24 21:03:25,410 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,946,564 rows
2025-12-24 21:08:00,792 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,997,780 trades
2025-12-24 21:08:00,793 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,997,780 rows
2025-12-24 21:11:09,206 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,142,116 trades
2025-12-24 21:11:09,232 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,142,116 rows
2025-12-24 21:14:06,415 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,689,282 trades
2025-12-24 21:14:06,416 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,689,282 rows
2025-12-24 21:17:37,226 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,630,503 trades
2025-12-24 21:17:37,227 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,630,503 rows
2025-12-24 21:17:37,696 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 31,463,859 total rows written
2025-12-24 21:18:50,656 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,156,970 trades
2025-12-24 21:18:50,660 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,156,970 rows
2025-12-24 21:18:51,006 INFO [src.stage_a.parquet_writer] ✓ Wrote 32,620,829 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-15
2025-12-24 21:18:51,007 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 21:18:51,007 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 21:18:51,007 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 21:18:51,007 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 21:18:51,007 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 21:18:51,007 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 21:18:51,007 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 21:18:52,147 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 21:18:52,147 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-15...
2025-12-24 21:18:52,211 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241115 for 519 symbols
2025-12-24 21:24:37,556 INFO [src.stage_a.wrds_extractor]   Chunk 1: 6,886,283 NBBO records
2025-12-24 21:24:37,556 INFO [src.stage_a.parquet_writer]   Chunk 1: 6,886,283 rows
2025-12-24 21:27:47,118 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,586,696 NBBO records
2025-12-24 21:27:47,119 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,586,696 rows
2025-12-24 21:32:35,506 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,579,890 NBBO records
2025-12-24 21:32:35,506 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,579,890 rows
2025-12-24 21:34:26,619 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,215,976 NBBO records
2025-12-24 21:34:26,620 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,215,976 rows
2025-12-24 21:38:38,906 INFO [src.stage_a.wrds_extractor]   Chunk 5: 6,013,251 NBBO records
2025-12-24 21:38:38,906 INFO [src.stage_a.parquet_writer]   Chunk 5: 6,013,251 rows
2025-12-24 21:43:16,793 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,878,574 NBBO records
2025-12-24 21:43:16,795 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,878,574 rows
2025-12-24 21:48:01,184 INFO [src.stage_a.wrds_extractor]   Chunk 7: 7,635,561 NBBO records
2025-12-24 21:48:01,185 INFO [src.stage_a.parquet_writer]   Chunk 7: 7,635,561 rows
2025-12-24 21:53:28,795 INFO [src.stage_a.wrds_extractor]   Chunk 8: 7,119,067 NBBO records
2025-12-24 21:53:28,798 INFO [src.stage_a.parquet_writer]   Chunk 8: 7,119,067 rows
2025-12-24 21:57:28,251 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,640,262 NBBO records
2025-12-24 21:57:28,253 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,640,262 rows
2025-12-24 22:01:36,708 INFO [src.stage_a.wrds_extractor]   Chunk 10: 5,290,250 NBBO records
2025-12-24 22:01:36,708 INFO [src.stage_a.parquet_writer]   Chunk 10: 5,290,250 rows
2025-12-24 22:01:37,065 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 55,845,810 total rows written
2025-12-24 22:07:03,787 INFO [src.stage_a.wrds_extractor]   Chunk 11: 8,361,560 NBBO records
2025-12-24 22:07:03,788 INFO [src.stage_a.parquet_writer]   Chunk 11: 8,361,560 rows
2025-12-24 22:07:04,520 INFO [src.stage_a.parquet_writer] ✓ Wrote 64,207,370 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-15
2025-12-24 22:07:04,536 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 22:07:04,536 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 22:07:04,536 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 22:07:04,536 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 22:07:04,536 INFO [src.stage_a.stage_a] Trades: 32,620,829 rows
2025-12-24 22:07:04,536 INFO [src.stage_a.stage_a] Nbbo: 64,207,370 rows
2025-12-24 22:07:04,536 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 22:07:04,536 INFO [src.stage_a.stage_a] Processing date 111/140: 2024-11-18
2025-12-24 22:07:04,536 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 22:07:04,536 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 22:07:04,536 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-11-18 (519 symbols)
2025-12-24 22:07:04,536 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 22:07:04,536 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 22:07:04,536 INFO [src.stage_a.stage_a] Extract run ID: e02325d9-6f89-45a7-95d2-1413819d30dc
2025-12-24 22:07:04,544 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 22:07:04,544 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 22:07:04,544 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 22:07:04,544 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 22:07:04,544 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 22:07:04,544 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 22:07:04,544 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 22:07:04,544 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 22:07:04,544 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 22:07:07,085 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 22:07:07,085 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-18...
2025-12-24 22:07:07,195 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241118 for 519 symbols
2025-12-24 22:10:24,350 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,053,280 trades
2025-12-24 22:10:24,350 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,053,280 rows
2025-12-24 22:12:25,403 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,029,812 trades
2025-12-24 22:12:25,403 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,029,812 rows
2025-12-24 22:15:01,161 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,225,993 trades
2025-12-24 22:15:01,161 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,225,993 rows
2025-12-24 22:16:53,824 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,828,175 trades
2025-12-24 22:16:53,824 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,828,175 rows
2025-12-24 22:19:13,517 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,316,550 trades
2025-12-24 22:19:13,517 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,316,550 rows
2025-12-24 22:21:36,905 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,431,381 trades
2025-12-24 22:21:36,905 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,431,381 rows
2025-12-24 22:26:14,213 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,309,206 trades
2025-12-24 22:26:14,213 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,309,206 rows
2025-12-24 22:28:33,958 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,316,053 trades
2025-12-24 22:28:33,965 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,316,053 rows
2025-12-24 22:31:31,082 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,778,463 trades
2025-12-24 22:31:31,084 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,778,463 rows
2025-12-24 22:36:07,103 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,898,507 trades
2025-12-24 22:36:07,104 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,898,507 rows
2025-12-24 22:36:07,599 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 27,187,420 total rows written
2025-12-24 22:37:14,348 INFO [src.stage_a.wrds_extractor]   Chunk 11: 908,922 trades
2025-12-24 22:37:14,358 INFO [src.stage_a.parquet_writer]   Chunk 11: 908,922 rows
2025-12-24 22:37:14,648 INFO [src.stage_a.parquet_writer] ✓ Wrote 28,096,342 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-18
2025-12-24 22:37:14,649 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 22:37:14,649 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 22:37:14,649 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 22:37:14,649 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 22:37:14,649 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 22:37:14,649 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 22:37:14,649 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 22:37:16,540 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 22:37:16,540 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-18...
2025-12-24 22:37:16,662 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241118 for 519 symbols
2025-12-24 22:39:52,317 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,536,013 NBBO records
2025-12-24 22:39:52,317 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,536,013 rows
2025-12-24 22:41:18,425 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,806,778 NBBO records
2025-12-24 22:41:18,425 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,806,778 rows
2025-12-24 22:44:05,570 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,812,430 NBBO records
2025-12-24 22:44:05,570 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,812,430 rows
2025-12-24 22:45:47,567 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,308,099 NBBO records
2025-12-24 22:45:47,568 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,308,099 rows
2025-12-24 22:48:27,293 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,761,194 NBBO records
2025-12-24 22:48:27,293 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,761,194 rows
2025-12-24 22:51:18,412 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,928,348 NBBO records
2025-12-24 22:51:18,412 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,928,348 rows
2025-12-24 22:55:11,852 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,645,426 NBBO records
2025-12-24 22:55:11,852 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,645,426 rows
2025-12-24 22:58:21,782 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,705,692 NBBO records
2025-12-24 22:58:21,783 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,705,692 rows
2025-12-24 23:01:26,179 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,913,844 NBBO records
2025-12-24 23:01:26,179 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,913,844 rows
2025-12-24 23:03:43,273 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,776,602 NBBO records
2025-12-24 23:03:43,273 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,776,602 rows
2025-12-24 23:03:43,579 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 38,194,426 total rows written
2025-12-24 23:07:45,202 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,804,171 NBBO records
2025-12-24 23:07:45,202 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,804,171 rows
2025-12-24 23:07:45,729 INFO [src.stage_a.parquet_writer] ✓ Wrote 43,998,597 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-18
2025-12-24 23:07:45,735 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 23:07:45,735 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 23:07:45,735 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 23:07:45,735 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 23:07:45,735 INFO [src.stage_a.stage_a] Trades: 28,096,342 rows
2025-12-24 23:07:45,735 INFO [src.stage_a.stage_a] Nbbo: 43,998,597 rows
2025-12-24 23:07:45,735 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 23:07:45,735 INFO [src.stage_a.stage_a] Processing date 112/140: 2024-11-19
2025-12-24 23:07:45,735 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 23:07:45,735 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 23:07:45,735 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-11-19 (519 symbols)
2025-12-24 23:07:45,735 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 23:07:45,735 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 23:07:45,735 INFO [src.stage_a.stage_a] Extract run ID: 2d144558-d0e2-401c-a390-5c1ceaa603c2
2025-12-24 23:07:45,743 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 23:07:45,743 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 23:07:45,743 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 23:07:45,743 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 23:07:45,743 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 23:07:45,743 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 23:07:45,743 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 23:07:45,743 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 23:07:45,743 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 23:07:49,732 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 23:07:49,732 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-19...
2025-12-24 23:07:49,847 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241119 for 519 symbols
2025-12-24 23:11:00,943 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,783,220 trades
2025-12-24 23:11:00,943 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,783,220 rows
2025-12-24 23:13:16,858 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,873,741 trades
2025-12-24 23:13:16,858 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,873,741 rows
2025-12-24 23:15:58,518 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,051,138 trades
2025-12-24 23:15:58,518 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,051,138 rows
2025-12-24 23:17:26,468 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,659,357 trades
2025-12-24 23:17:26,468 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,659,357 rows
2025-12-24 23:20:12,493 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,368,369 trades
2025-12-24 23:20:12,493 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,368,369 rows
2025-12-24 23:22:06,988 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,176,441 trades
2025-12-24 23:22:06,988 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,176,441 rows
2025-12-24 23:26:28,169 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,884,510 trades
2025-12-24 23:26:28,169 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,884,510 rows
2025-12-24 23:28:23,494 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,089,514 trades
2025-12-24 23:28:23,507 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,089,514 rows
2025-12-24 23:31:58,865 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,104,482 trades
2025-12-24 23:31:58,865 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,104,482 rows
2025-12-24 23:35:26,608 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,262,379 trades
2025-12-24 23:35:26,608 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,262,379 rows
2025-12-24 23:35:27,042 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,253,151 total rows written
2025-12-24 23:36:23,640 INFO [src.stage_a.wrds_extractor]   Chunk 11: 827,972 trades
2025-12-24 23:36:23,642 INFO [src.stage_a.parquet_writer]   Chunk 11: 827,972 rows
2025-12-24 23:36:23,921 INFO [src.stage_a.parquet_writer] ✓ Wrote 26,081,123 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-19
2025-12-24 23:36:23,922 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 23:36:23,922 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 23:36:23,922 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 23:36:23,922 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 23:36:23,922 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 23:36:23,922 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 23:36:23,922 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 23:36:25,051 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 23:36:25,051 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-19...
2025-12-24 23:36:25,097 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241119 for 519 symbols
2025-12-24 23:38:18,119 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,847,626 NBBO records
2025-12-24 23:38:18,119 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,847,626 rows
2025-12-24 23:39:46,438 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,621,010 NBBO records
2025-12-24 23:39:46,438 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,621,010 rows
2025-12-24 23:42:12,089 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,908,861 NBBO records
2025-12-24 23:42:12,089 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,908,861 rows
2025-12-24 23:43:24,052 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,210,485 NBBO records
2025-12-24 23:43:24,052 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,210,485 rows
2025-12-24 23:45:29,387 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,650,004 NBBO records
2025-12-24 23:45:29,387 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,650,004 rows
2025-12-24 23:47:31,088 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,889,732 NBBO records
2025-12-24 23:47:31,088 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,889,732 rows
2025-12-24 23:50:36,290 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,456,600 NBBO records
2025-12-24 23:50:36,290 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,456,600 rows
2025-12-24 23:52:58,821 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,224,853 NBBO records
2025-12-24 23:52:58,822 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,224,853 rows
2025-12-24 23:55:23,926 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,517,432 NBBO records
2025-12-24 23:55:23,926 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,517,432 rows
2025-12-24 23:57:23,635 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,236,221 NBBO records
2025-12-24 23:57:23,635 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,236,221 rows
2025-12-24 23:57:23,909 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 37,562,824 total rows written
2025-12-25 00:00:38,963 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,585,123 NBBO records
2025-12-25 00:00:38,963 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,585,123 rows
2025-12-25 00:00:39,455 INFO [src.stage_a.parquet_writer] ✓ Wrote 43,147,947 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-19
2025-12-25 00:00:39,459 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 00:00:39,459 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 00:00:39,459 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 00:00:39,459 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 00:00:39,459 INFO [src.stage_a.stage_a] Trades: 26,081,123 rows
2025-12-25 00:00:39,459 INFO [src.stage_a.stage_a] Nbbo: 43,147,947 rows
2025-12-25 00:00:39,459 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 00:00:39,459 INFO [src.stage_a.stage_a] Processing date 113/140: 2024-11-20
2025-12-25 00:00:39,459 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 00:00:39,459 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 00:00:39,459 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-11-20 (519 symbols)
2025-12-25 00:00:39,459 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 00:00:39,459 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 00:00:39,459 INFO [src.stage_a.stage_a] Extract run ID: 5f9fb742-e299-4661-b7b2-aa42ef3c97b3
2025-12-25 00:00:39,467 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 00:00:39,467 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 00:00:39,467 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 00:00:39,467 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 00:00:39,467 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 00:00:39,467 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 00:00:39,467 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 00:00:39,467 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 00:00:39,467 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 00:00:40,674 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 00:00:40,675 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-20...
2025-12-25 00:00:40,759 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241120 for 519 symbols
2025-12-25 00:03:37,579 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,909,618 trades
2025-12-25 00:03:37,579 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,909,618 rows
2025-12-25 00:05:21,436 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,815,491 trades
2025-12-25 00:05:21,436 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,815,491 rows
2025-12-25 00:07:38,410 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,972,484 trades
2025-12-25 00:07:38,410 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,972,484 rows
2025-12-25 00:09:11,768 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,739,995 trades
2025-12-25 00:09:11,768 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,739,995 rows
2025-12-25 00:11:21,664 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,273,580 trades
2025-12-25 00:11:21,664 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,273,580 rows
2025-12-25 00:13:07,151 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,006,108 trades
2025-12-25 00:13:07,151 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,006,108 rows
2025-12-25 00:16:22,563 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,222,582 trades
2025-12-25 00:16:22,564 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,222,582 rows
2025-12-25 00:18:08,973 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,188,562 trades
2025-12-25 00:18:08,985 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,188,562 rows
2025-12-25 00:20:36,426 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,941,797 trades
2025-12-25 00:20:36,426 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,941,797 rows
2025-12-25 00:23:17,184 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,888,745 trades
2025-12-25 00:23:17,184 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,888,745 rows
2025-12-25 00:23:17,614 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 24,958,962 total rows written
2025-12-25 00:23:58,317 INFO [src.stage_a.wrds_extractor]   Chunk 11: 911,228 trades
2025-12-25 00:23:58,317 INFO [src.stage_a.parquet_writer]   Chunk 11: 911,228 rows
2025-12-25 00:23:58,598 INFO [src.stage_a.parquet_writer] ✓ Wrote 25,870,190 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-20
2025-12-25 00:23:58,599 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 00:23:58,599 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 00:23:58,599 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 00:23:58,599 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 00:23:58,599 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 00:23:58,599 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 00:23:58,599 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 00:24:01,452 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 00:24:01,462 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-20...
2025-12-25 00:24:01,645 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241120 for 519 symbols
2025-12-25 00:26:43,994 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,697,248 NBBO records
2025-12-25 00:26:43,994 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,697,248 rows
2025-12-25 00:28:39,637 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,612,699 NBBO records
2025-12-25 00:28:39,637 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,612,699 rows
2025-12-25 00:30:33,529 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,627,758 NBBO records
2025-12-25 00:30:33,529 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,627,758 rows
2025-12-25 00:31:59,769 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,489,526 NBBO records
2025-12-25 00:31:59,769 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,489,526 rows
2025-12-25 00:33:54,528 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,776,163 NBBO records
2025-12-25 00:33:54,528 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,776,163 rows
2025-12-25 00:36:19,369 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,932,328 NBBO records
2025-12-25 00:36:19,369 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,932,328 rows
2025-12-25 00:40:02,176 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,592,041 NBBO records
2025-12-25 00:40:02,176 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,592,041 rows
2025-12-25 00:42:43,902 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,878,209 NBBO records
2025-12-25 00:42:43,904 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,878,209 rows
2025-12-25 00:45:37,746 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,300,323 NBBO records
2025-12-25 00:45:37,746 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,300,323 rows
2025-12-25 00:46:53,751 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,406,445 NBBO records
2025-12-25 00:46:53,751 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,406,445 rows
2025-12-25 00:46:54,037 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 40,312,740 total rows written
2025-12-25 00:50:47,663 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,455,279 NBBO records
2025-12-25 00:50:47,663 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,455,279 rows
2025-12-25 00:50:48,207 INFO [src.stage_a.parquet_writer] ✓ Wrote 46,768,019 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-20
2025-12-25 00:50:48,213 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 00:50:48,213 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 00:50:48,213 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 00:50:48,213 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 00:50:48,213 INFO [src.stage_a.stage_a] Trades: 25,870,190 rows
2025-12-25 00:50:48,213 INFO [src.stage_a.stage_a] Nbbo: 46,768,019 rows
2025-12-25 00:50:48,213 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 00:50:48,213 INFO [src.stage_a.stage_a] Processing date 114/140: 2024-11-21
2025-12-25 00:50:48,213 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 00:50:48,213 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 00:50:48,213 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-11-21 (519 symbols)
2025-12-25 00:50:48,213 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 00:50:48,213 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 00:50:48,213 INFO [src.stage_a.stage_a] Extract run ID: 901b3e11-a3e0-4e79-b223-546a2b4475f5
2025-12-25 00:50:48,221 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 00:50:48,221 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 00:50:48,221 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 00:50:48,221 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 00:50:48,221 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 00:50:48,221 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 00:50:48,221 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 00:50:48,221 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 00:50:48,221 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 00:50:50,249 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 00:50:50,249 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-21...
2025-12-25 00:50:50,405 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241121 for 519 symbols
2025-12-25 00:53:54,999 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,496,685 trades
2025-12-25 00:53:54,999 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,496,685 rows
2025-12-25 00:55:33,051 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,978,793 trades
2025-12-25 00:55:33,051 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,978,793 rows
2025-12-25 00:57:32,151 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,271,680 trades
2025-12-25 00:57:32,151 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,271,680 rows
2025-12-25 00:59:06,397 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,729,284 trades
2025-12-25 00:59:06,397 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,729,284 rows
2025-12-25 01:02:16,528 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,292,947 trades
2025-12-25 01:02:16,528 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,292,947 rows
2025-12-25 01:04:43,065 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,145,829 trades
2025-12-25 01:04:43,065 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,145,829 rows
2025-12-25 01:09:44,429 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,374,798 trades
2025-12-25 01:09:44,429 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,374,798 rows
2025-12-25 01:12:06,361 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,449,530 trades
2025-12-25 01:12:06,378 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,449,530 rows
2025-12-25 01:14:57,246 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,790,413 trades
2025-12-25 01:14:57,247 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,790,413 rows
2025-12-25 01:18:20,336 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,026,649 trades
2025-12-25 01:18:20,336 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,026,649 rows
2025-12-25 01:18:20,773 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 28,556,608 total rows written
2025-12-25 01:19:30,928 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,029,351 trades
2025-12-25 01:19:30,928 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,029,351 rows
2025-12-25 01:19:31,234 INFO [src.stage_a.parquet_writer] ✓ Wrote 29,585,959 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-21
2025-12-25 01:19:31,234 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 01:19:31,234 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 01:19:31,234 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 01:19:31,234 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 01:19:31,234 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 01:19:31,234 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 01:19:31,234 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 01:19:33,178 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 01:19:33,178 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-21...
2025-12-25 01:19:33,279 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241121 for 519 symbols
2025-12-25 01:22:26,685 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,302,659 NBBO records
2025-12-25 01:22:26,685 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,302,659 rows
2025-12-25 01:24:20,022 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,751,039 NBBO records
2025-12-25 01:24:20,023 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,751,039 rows
2025-12-25 01:26:50,672 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,081,388 NBBO records
2025-12-25 01:26:50,673 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,081,388 rows
2025-12-25 01:28:34,554 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,395,156 NBBO records
2025-12-25 01:28:34,554 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,395,156 rows
2025-12-25 01:31:18,824 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,593,583 NBBO records
2025-12-25 01:31:18,824 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,593,583 rows
2025-12-25 01:34:15,953 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,401,956 NBBO records
2025-12-25 01:34:15,953 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,401,956 rows
2025-12-25 01:38:56,170 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,440,721 NBBO records
2025-12-25 01:38:56,170 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,440,721 rows
2025-12-25 01:43:15,311 INFO [src.stage_a.wrds_extractor]   Chunk 8: 6,079,125 NBBO records
2025-12-25 01:43:15,317 INFO [src.stage_a.parquet_writer]   Chunk 8: 6,079,125 rows
2025-12-25 01:46:37,012 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,842,869 NBBO records
2025-12-25 01:46:37,017 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,842,869 rows
2025-12-25 01:49:21,439 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,873,851 NBBO records
2025-12-25 01:49:21,440 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,873,851 rows
2025-12-25 01:49:21,767 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 44,762,347 total rows written
2025-12-25 01:53:24,078 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,568,216 NBBO records
2025-12-25 01:53:24,078 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,568,216 rows
2025-12-25 01:53:24,728 INFO [src.stage_a.parquet_writer] ✓ Wrote 52,330,563 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-21
2025-12-25 01:53:24,734 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 01:53:24,734 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 01:53:24,734 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 01:53:24,734 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 01:53:24,734 INFO [src.stage_a.stage_a] Trades: 29,585,959 rows
2025-12-25 01:53:24,734 INFO [src.stage_a.stage_a] Nbbo: 52,330,563 rows
2025-12-25 01:53:24,734 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 01:53:24,734 INFO [src.stage_a.stage_a] Processing date 115/140: 2024-11-22
2025-12-25 01:53:24,734 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 01:53:24,734 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 01:53:24,734 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-11-22 (519 symbols)
2025-12-25 01:53:24,734 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 01:53:24,734 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 01:53:24,734 INFO [src.stage_a.stage_a] Extract run ID: 2278ddfa-fa60-445c-a8cb-25a2b6423d68
2025-12-25 01:53:24,742 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 01:53:24,742 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 01:53:24,742 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 01:53:24,742 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 01:53:24,742 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 01:53:24,742 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 01:53:24,742 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 01:53:24,742 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 01:53:24,742 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 01:53:25,981 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 01:53:25,982 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-22...
2025-12-25 01:53:26,051 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241122 for 519 symbols
2025-12-25 01:56:03,180 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,870,557 trades
2025-12-25 01:56:03,180 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,870,557 rows
2025-12-25 01:57:50,815 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,048,828 trades
2025-12-25 01:57:50,815 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,048,828 rows
2025-12-25 01:59:31,613 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,125,960 trades
2025-12-25 01:59:31,613 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,125,960 rows
2025-12-25 02:01:01,861 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,684,998 trades
2025-12-25 02:01:01,861 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,684,998 rows
2025-12-25 02:03:10,378 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,646,465 trades
2025-12-25 02:03:10,379 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,646,465 rows
2025-12-25 02:04:47,963 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,044,880 trades
2025-12-25 02:04:47,964 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,044,880 rows
2025-12-25 02:08:26,714 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,291,104 trades
2025-12-25 02:08:26,714 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,291,104 rows
2025-12-25 02:10:39,608 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,208,692 trades
2025-12-25 02:10:39,613 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,208,692 rows
2025-12-25 02:13:05,116 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,006,661 trades
2025-12-25 02:13:05,116 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,006,661 rows
2025-12-25 02:16:06,519 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,282,431 trades
2025-12-25 02:16:06,519 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,282,431 rows
2025-12-25 02:16:06,970 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,210,576 total rows written
2025-12-25 02:17:03,321 INFO [src.stage_a.wrds_extractor]   Chunk 11: 945,122 trades
2025-12-25 02:17:03,329 INFO [src.stage_a.parquet_writer]   Chunk 11: 945,122 rows
2025-12-25 02:17:03,634 INFO [src.stage_a.parquet_writer] ✓ Wrote 27,155,698 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-22
2025-12-25 02:17:03,635 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 02:17:03,635 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 02:17:03,635 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 02:17:03,635 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 02:17:03,635 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 02:17:03,635 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 02:17:03,635 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 02:17:05,884 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 02:17:05,884 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-22...
2025-12-25 02:17:05,998 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241122 for 519 symbols
2025-12-25 02:19:09,002 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,268,389 NBBO records
2025-12-25 02:19:09,002 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,268,389 rows
2025-12-25 02:20:13,311 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,348,831 NBBO records
2025-12-25 02:20:13,311 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,348,831 rows
2025-12-25 02:22:25,737 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,333,924 NBBO records
2025-12-25 02:22:25,737 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,333,924 rows
2025-12-25 02:23:54,714 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,037,700 NBBO records
2025-12-25 02:23:54,714 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,037,700 rows
2025-12-25 02:26:27,432 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,766,519 NBBO records
2025-12-25 02:26:27,432 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,766,519 rows
2025-12-25 02:28:11,401 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,401,687 NBBO records
2025-12-25 02:28:11,401 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,401,687 rows
2025-12-25 02:31:14,940 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,729,386 NBBO records
2025-12-25 02:31:14,940 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,729,386 rows
2025-12-25 02:34:10,303 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,304,599 NBBO records
2025-12-25 02:34:10,304 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,304,599 rows
2025-12-25 02:37:00,890 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,330,528 NBBO records
2025-12-25 02:37:00,890 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,330,528 rows
2025-12-25 02:38:42,675 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,926,934 NBBO records
2025-12-25 02:38:42,676 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,926,934 rows
2025-12-25 02:38:42,943 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 34,448,497 total rows written
2025-12-25 02:43:14,424 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,070,503 NBBO records
2025-12-25 02:43:14,424 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,070,503 rows
2025-12-25 02:43:14,945 INFO [src.stage_a.parquet_writer] ✓ Wrote 40,519,000 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-22
2025-12-25 02:43:14,952 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 02:43:14,952 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 02:43:14,952 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 02:43:14,952 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 02:43:14,952 INFO [src.stage_a.stage_a] Trades: 27,155,698 rows
2025-12-25 02:43:14,952 INFO [src.stage_a.stage_a] Nbbo: 40,519,000 rows
2025-12-25 02:43:14,952 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 02:43:14,952 INFO [src.stage_a.stage_a] Processing date 116/140: 2024-11-25
2025-12-25 02:43:14,952 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 02:43:14,952 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 02:43:14,952 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-11-25 (519 symbols)
2025-12-25 02:43:14,952 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 02:43:14,952 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 02:43:14,952 INFO [src.stage_a.stage_a] Extract run ID: 56d9dd2c-b8f5-470b-af59-f2af2a8aafb3
2025-12-25 02:43:14,960 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 02:43:14,960 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 02:43:14,960 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 02:43:14,960 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 02:43:14,960 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 02:43:14,960 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 02:43:14,960 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 02:43:14,960 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 02:43:14,960 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 02:43:16,208 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 02:43:16,208 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-25...
2025-12-25 02:43:16,302 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241125 for 519 symbols
2025-12-25 02:46:17,566 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,441,887 trades
2025-12-25 02:46:17,566 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,441,887 rows
2025-12-25 02:48:17,380 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,469,285 trades
2025-12-25 02:48:17,380 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,469,285 rows
2025-12-25 02:50:07,102 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,520,062 trades
2025-12-25 02:50:07,103 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,520,062 rows
2025-12-25 02:51:46,712 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,120,733 trades
2025-12-25 02:51:46,712 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,120,733 rows
2025-12-25 02:53:57,833 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,873,472 trades
2025-12-25 02:53:57,833 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,873,472 rows
2025-12-25 02:56:01,125 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,484,651 trades
2025-12-25 02:56:01,125 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,484,651 rows
2025-12-25 03:00:33,204 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,206,784 trades
2025-12-25 03:00:33,204 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,206,784 rows
2025-12-25 03:02:48,443 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,631,304 trades
2025-12-25 03:02:48,460 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,631,304 rows
2025-12-25 03:05:38,251 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,309,601 trades
2025-12-25 03:05:38,251 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,309,601 rows
2025-12-25 03:08:55,021 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,606,556 trades
2025-12-25 03:08:55,021 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,606,556 rows
2025-12-25 03:08:55,484 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 30,664,335 total rows written
2025-12-25 03:10:08,198 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,093,728 trades
2025-12-25 03:10:08,203 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,093,728 rows
2025-12-25 03:10:08,548 INFO [src.stage_a.parquet_writer] ✓ Wrote 31,758,063 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-25
2025-12-25 03:10:08,549 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 03:10:08,549 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 03:10:08,549 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 03:10:08,549 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 03:10:08,549 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 03:10:08,549 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 03:10:08,549 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 03:10:10,523 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 03:10:10,523 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-25...
2025-12-25 03:10:10,626 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241125 for 519 symbols
2025-12-25 03:13:02,925 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,308,720 NBBO records
2025-12-25 03:13:02,925 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,308,720 rows
2025-12-25 03:14:34,212 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,647,556 NBBO records
2025-12-25 03:14:34,212 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,647,556 rows
2025-12-25 03:17:19,913 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,461,837 NBBO records
2025-12-25 03:17:19,913 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,461,837 rows
2025-12-25 03:19:00,538 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,498,748 NBBO records
2025-12-25 03:19:00,538 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,498,748 rows
2025-12-25 03:22:02,755 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,758,013 NBBO records
2025-12-25 03:22:02,755 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,758,013 rows
2025-12-25 03:24:18,457 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,860,512 NBBO records
2025-12-25 03:24:18,457 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,860,512 rows
2025-12-25 03:28:06,116 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,665,995 NBBO records
2025-12-25 03:28:06,116 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,665,995 rows
2025-12-25 03:31:05,363 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,903,892 NBBO records
2025-12-25 03:31:05,364 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,903,892 rows
2025-12-25 03:34:38,974 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,197,138 NBBO records
2025-12-25 03:34:38,975 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,197,138 rows
2025-12-25 03:36:30,949 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,424,004 NBBO records
2025-12-25 03:36:30,950 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,424,004 rows
2025-12-25 03:36:31,250 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 38,726,415 total rows written
2025-12-25 03:39:47,145 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,772,249 NBBO records
2025-12-25 03:39:47,145 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,772,249 rows
2025-12-25 03:39:47,643 INFO [src.stage_a.parquet_writer] ✓ Wrote 44,498,664 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-25
2025-12-25 03:39:47,651 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 03:39:47,651 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 03:39:47,651 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 03:39:47,651 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 03:39:47,651 INFO [src.stage_a.stage_a] Trades: 31,758,063 rows
2025-12-25 03:39:47,651 INFO [src.stage_a.stage_a] Nbbo: 44,498,664 rows
2025-12-25 03:39:47,651 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 03:39:47,651 INFO [src.stage_a.stage_a] Processing date 117/140: 2024-11-26
2025-12-25 03:39:47,651 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 03:39:47,651 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 03:39:47,651 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-11-26 (519 symbols)
2025-12-25 03:39:47,651 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 03:39:47,651 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 03:39:47,651 INFO [src.stage_a.stage_a] Extract run ID: cc186e34-0025-41db-b367-9c767650c3be
2025-12-25 03:39:47,659 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 03:39:47,659 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 03:39:47,659 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 03:39:47,659 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 03:39:47,659 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 03:39:47,659 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 03:39:47,659 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 03:39:47,659 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 03:39:47,659 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 03:39:49,775 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 03:39:49,775 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-26...
2025-12-25 03:39:49,910 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241126 for 519 symbols
2025-12-25 03:43:31,286 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,389,790 trades
2025-12-25 03:43:31,286 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,389,790 rows
2025-12-25 03:45:42,070 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,033,440 trades
2025-12-25 03:45:42,070 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,033,440 rows
2025-12-25 03:47:53,401 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,040,772 trades
2025-12-25 03:47:53,401 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,040,772 rows
2025-12-25 03:49:45,132 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,725,784 trades
2025-12-25 03:49:45,133 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,725,784 rows
2025-12-25 03:52:16,302 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,423,444 trades
2025-12-25 03:52:16,302 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,423,444 rows
2025-12-25 03:54:57,353 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,112,070 trades
2025-12-25 03:54:57,354 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,112,070 rows
2025-12-25 03:59:10,744 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,862,174 trades
2025-12-25 03:59:10,744 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,862,174 rows
2025-12-25 04:01:38,032 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,137,597 trades
2025-12-25 04:01:38,036 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,137,597 rows
2025-12-25 04:05:28,374 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,668,848 trades
2025-12-25 04:05:28,374 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,668,848 rows
2025-12-25 04:08:52,877 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,938,378 trades
2025-12-25 04:08:52,877 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,938,378 rows
2025-12-25 04:08:53,289 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,332,297 total rows written
2025-12-25 04:10:10,374 INFO [src.stage_a.wrds_extractor]   Chunk 11: 928,827 trades
2025-12-25 04:10:10,374 INFO [src.stage_a.parquet_writer]   Chunk 11: 928,827 rows
2025-12-25 04:10:10,673 INFO [src.stage_a.parquet_writer] ✓ Wrote 26,261,124 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-26
2025-12-25 04:10:10,674 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 04:10:10,674 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 04:10:10,674 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 04:10:10,674 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 04:10:10,674 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 04:10:10,674 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 04:10:10,674 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 04:10:13,020 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 04:10:13,020 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-26...
2025-12-25 04:10:13,208 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241126 for 519 symbols
2025-12-25 04:12:22,803 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,993,436 NBBO records
2025-12-25 04:12:22,803 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,993,436 rows
2025-12-25 04:13:44,937 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,173,321 NBBO records
2025-12-25 04:13:44,938 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,173,321 rows
2025-12-25 04:15:53,893 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,803,598 NBBO records
2025-12-25 04:15:53,893 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,803,598 rows
2025-12-25 04:17:02,716 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,739,724 NBBO records
2025-12-25 04:17:02,716 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,739,724 rows
2025-12-25 04:18:34,730 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,324,558 NBBO records
2025-12-25 04:18:34,730 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,324,558 rows
2025-12-25 04:20:26,526 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,423,893 NBBO records
2025-12-25 04:20:26,526 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,423,893 rows
2025-12-25 04:22:47,168 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,413,563 NBBO records
2025-12-25 04:22:47,168 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,413,563 rows
2025-12-25 04:24:23,962 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,764,017 NBBO records
2025-12-25 04:24:23,962 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,764,017 rows
2025-12-25 04:26:15,856 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,396,479 NBBO records
2025-12-25 04:26:15,856 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,396,479 rows
2025-12-25 04:27:25,456 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,587,546 NBBO records
2025-12-25 04:27:25,456 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,587,546 rows
2025-12-25 04:27:25,710 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 31,620,135 total rows written
2025-12-25 04:30:17,921 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,994,910 NBBO records
2025-12-25 04:30:17,921 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,994,910 rows
2025-12-25 04:30:18,361 INFO [src.stage_a.parquet_writer] ✓ Wrote 36,615,045 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-26
2025-12-25 04:30:18,365 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 04:30:18,365 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 04:30:18,365 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 04:30:18,365 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 04:30:18,365 INFO [src.stage_a.stage_a] Trades: 26,261,124 rows
2025-12-25 04:30:18,365 INFO [src.stage_a.stage_a] Nbbo: 36,615,045 rows
2025-12-25 04:30:18,365 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 04:30:18,365 INFO [src.stage_a.stage_a] Processing date 118/140: 2024-11-27
2025-12-25 04:30:18,365 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 04:30:18,365 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 04:30:18,365 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-11-27 (519 symbols)
2025-12-25 04:30:18,365 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 04:30:18,365 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 04:30:18,365 INFO [src.stage_a.stage_a] Extract run ID: 62647760-6cb8-4939-a47a-b0eac7b69cea
2025-12-25 04:30:18,373 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 04:30:18,373 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 04:30:18,373 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 04:30:18,373 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 04:30:18,373 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 04:30:18,373 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 04:30:18,373 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 04:30:18,373 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 04:30:18,373 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 04:30:20,851 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 04:30:20,851 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-27...
2025-12-25 04:30:20,953 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241127 for 519 symbols
2025-12-25 04:33:00,312 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,739,525 trades
2025-12-25 04:33:00,312 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,739,525 rows
2025-12-25 04:34:39,872 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,644,009 trades
2025-12-25 04:34:39,872 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,644,009 rows
2025-12-25 04:36:57,314 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,845,824 trades
2025-12-25 04:36:57,314 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,845,824 rows
2025-12-25 04:38:40,644 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,387,977 trades
2025-12-25 04:38:40,644 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,387,977 rows
2025-12-25 04:42:16,682 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,090,341 trades
2025-12-25 04:42:16,682 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,090,341 rows
2025-12-25 04:44:33,615 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,713,908 trades
2025-12-25 04:44:33,615 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,713,908 rows
2025-12-25 04:49:01,939 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,791,169 trades
2025-12-25 04:49:01,939 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,791,169 rows
2025-12-25 04:51:30,928 INFO [src.stage_a.wrds_extractor]   Chunk 8: 1,916,552 trades
2025-12-25 04:51:30,943 INFO [src.stage_a.parquet_writer]   Chunk 8: 1,916,552 rows
2025-12-25 04:54:02,158 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,109,265 trades
2025-12-25 04:54:02,158 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,109,265 rows
2025-12-25 04:57:12,421 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,615,788 trades
2025-12-25 04:57:12,421 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,615,788 rows
2025-12-25 04:57:12,795 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 21,854,358 total rows written
2025-12-25 04:58:07,430 INFO [src.stage_a.wrds_extractor]   Chunk 11: 834,900 trades
2025-12-25 04:58:07,430 INFO [src.stage_a.parquet_writer]   Chunk 11: 834,900 rows
2025-12-25 04:58:07,695 INFO [src.stage_a.parquet_writer] ✓ Wrote 22,689,258 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-27
2025-12-25 04:58:07,696 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 04:58:07,696 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 04:58:07,696 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 04:58:07,696 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 04:58:07,696 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 04:58:07,696 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 04:58:07,696 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 04:58:08,986 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 04:58:08,986 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-27...
2025-12-25 04:58:09,052 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241127 for 519 symbols
2025-12-25 05:00:25,657 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,907,978 NBBO records
2025-12-25 05:00:25,657 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,907,978 rows
2025-12-25 05:02:11,488 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,728,284 NBBO records
2025-12-25 05:02:11,488 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,728,284 rows
2025-12-25 05:03:25,897 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,318,057 NBBO records
2025-12-25 05:03:25,897 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,318,057 rows
2025-12-25 05:04:32,410 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,531,648 NBBO records
2025-12-25 05:04:32,410 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,531,648 rows
2025-12-25 05:06:08,846 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,559,286 NBBO records
2025-12-25 05:06:08,846 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,559,286 rows
2025-12-25 05:08:06,489 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,686,326 NBBO records
2025-12-25 05:08:06,489 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,686,326 rows
2025-12-25 05:10:41,498 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,720,730 NBBO records
2025-12-25 05:10:41,498 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,720,730 rows
2025-12-25 05:13:17,583 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,482,716 NBBO records
2025-12-25 05:13:17,583 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,482,716 rows
2025-12-25 05:14:55,281 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,662,247 NBBO records
2025-12-25 05:14:55,281 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,662,247 rows
2025-12-25 05:16:48,329 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,365,960 NBBO records
2025-12-25 05:16:48,330 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,365,960 rows
2025-12-25 05:16:48,560 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,963,232 total rows written
2025-12-25 05:20:15,771 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,486,366 NBBO records
2025-12-25 05:20:15,771 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,486,366 rows
2025-12-25 05:20:16,163 INFO [src.stage_a.parquet_writer] ✓ Wrote 30,449,598 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-27
2025-12-25 05:20:16,168 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 05:20:16,168 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 05:20:16,168 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 05:20:16,168 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 05:20:16,168 INFO [src.stage_a.stage_a] Trades: 22,689,258 rows
2025-12-25 05:20:16,168 INFO [src.stage_a.stage_a] Nbbo: 30,449,598 rows
2025-12-25 05:20:16,168 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 05:20:16,168 INFO [src.stage_a.stage_a] Processing date 119/140: 2024-11-29
2025-12-25 05:20:16,168 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 05:20:16,168 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 05:20:16,168 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-11-29 (519 symbols)
2025-12-25 05:20:16,168 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 05:20:16,168 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 05:20:16,168 INFO [src.stage_a.stage_a] Extract run ID: df1f15f9-0d7d-4e6d-8d96-5cf6296c8267
2025-12-25 05:20:16,176 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 05:20:16,176 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 05:20:16,176 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 05:20:16,176 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 05:20:16,176 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 05:20:16,176 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 05:20:16,176 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 05:20:16,176 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 05:20:16,176 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 05:20:18,154 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 05:20:18,155 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-29...
2025-12-25 05:20:18,330 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241129 for 519 symbols
2025-12-25 05:22:46,696 INFO [src.stage_a.wrds_extractor]   Chunk 1: 1,752,547 trades
2025-12-25 05:22:46,696 INFO [src.stage_a.parquet_writer]   Chunk 1: 1,752,547 rows
2025-12-25 05:24:12,631 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,124,980 trades
2025-12-25 05:24:12,631 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,124,980 rows
2025-12-25 05:25:01,055 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,149,481 trades
2025-12-25 05:25:01,056 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,149,481 rows
2025-12-25 05:26:03,636 INFO [src.stage_a.wrds_extractor]   Chunk 4: 920,212 trades
2025-12-25 05:26:03,636 INFO [src.stage_a.parquet_writer]   Chunk 4: 920,212 rows
2025-12-25 05:28:05,067 INFO [src.stage_a.wrds_extractor]   Chunk 5: 1,337,273 trades
2025-12-25 05:28:05,067 INFO [src.stage_a.parquet_writer]   Chunk 5: 1,337,273 rows
2025-12-25 05:28:59,538 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,226,108 trades
2025-12-25 05:28:59,538 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,226,108 rows
2025-12-25 05:31:41,811 INFO [src.stage_a.wrds_extractor]   Chunk 7: 2,317,953 trades
2025-12-25 05:31:41,811 INFO [src.stage_a.parquet_writer]   Chunk 7: 2,317,953 rows
2025-12-25 05:33:15,761 INFO [src.stage_a.wrds_extractor]   Chunk 8: 1,237,014 trades
2025-12-25 05:33:15,761 INFO [src.stage_a.parquet_writer]   Chunk 8: 1,237,014 rows
2025-12-25 05:35:25,540 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,466,687 trades
2025-12-25 05:35:25,540 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,466,687 rows
2025-12-25 05:37:49,854 INFO [src.stage_a.wrds_extractor]   Chunk 10: 1,619,567 trades
2025-12-25 05:37:49,854 INFO [src.stage_a.parquet_writer]   Chunk 10: 1,619,567 rows
2025-12-25 05:37:50,156 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 14,151,822 total rows written
2025-12-25 05:38:12,030 INFO [src.stage_a.wrds_extractor]   Chunk 11: 526,251 trades
2025-12-25 05:38:12,030 INFO [src.stage_a.parquet_writer]   Chunk 11: 526,251 rows
2025-12-25 05:38:12,211 INFO [src.stage_a.parquet_writer] ✓ Wrote 14,678,073 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-11-29
2025-12-25 05:38:12,211 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 05:38:12,211 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 05:38:12,211 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 05:38:12,211 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 05:38:12,211 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 05:38:12,211 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 05:38:12,211 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 05:38:13,557 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 05:38:13,557 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-29...
2025-12-25 05:38:13,614 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241129 for 519 symbols
2025-12-25 05:39:10,454 INFO [src.stage_a.wrds_extractor]   Chunk 1: 1,895,634 NBBO records
2025-12-25 05:39:10,454 INFO [src.stage_a.parquet_writer]   Chunk 1: 1,895,634 rows
2025-12-25 05:40:11,502 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,062,767 NBBO records
2025-12-25 05:40:11,502 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,062,767 rows
2025-12-25 05:41:15,687 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,412,485 NBBO records
2025-12-25 05:41:15,688 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,412,485 rows
2025-12-25 05:41:53,811 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,030,926 NBBO records
2025-12-25 05:41:53,811 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,030,926 rows
2025-12-25 05:43:25,157 INFO [src.stage_a.wrds_extractor]   Chunk 5: 1,847,451 NBBO records
2025-12-25 05:43:25,158 INFO [src.stage_a.parquet_writer]   Chunk 5: 1,847,451 rows
2025-12-25 05:44:21,979 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,669,746 NBBO records
2025-12-25 05:44:21,979 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,669,746 rows
2025-12-25 05:45:54,313 INFO [src.stage_a.wrds_extractor]   Chunk 7: 2,271,718 NBBO records
2025-12-25 05:45:54,313 INFO [src.stage_a.parquet_writer]   Chunk 7: 2,271,718 rows
2025-12-25 05:47:25,955 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,131,479 NBBO records
2025-12-25 05:47:25,955 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,131,479 rows
2025-12-25 05:48:40,019 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,645,962 NBBO records
2025-12-25 05:48:40,020 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,645,962 rows
2025-12-25 05:49:28,566 INFO [src.stage_a.wrds_extractor]   Chunk 10: 1,377,932 NBBO records
2025-12-25 05:49:28,566 INFO [src.stage_a.parquet_writer]   Chunk 10: 1,377,932 rows
2025-12-25 05:49:28,740 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 16,346,100 total rows written
2025-12-25 05:51:11,968 INFO [src.stage_a.wrds_extractor]   Chunk 11: 2,427,508 NBBO records
2025-12-25 05:51:11,968 INFO [src.stage_a.parquet_writer]   Chunk 11: 2,427,508 rows
2025-12-25 05:51:12,215 INFO [src.stage_a.parquet_writer] ✓ Wrote 18,773,608 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-11-29
2025-12-25 05:51:12,218 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 05:51:12,218 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 05:51:12,218 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 05:51:12,218 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 05:51:12,218 INFO [src.stage_a.stage_a] Trades: 14,678,073 rows
2025-12-25 05:51:12,218 INFO [src.stage_a.stage_a] Nbbo: 18,773,608 rows
2025-12-25 05:51:12,218 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 05:51:12,218 INFO [src.stage_a.stage_a] Processing date 120/140: 2024-12-02
2025-12-25 05:51:12,218 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 05:51:12,218 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 05:51:12,218 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-12-02 (519 symbols)
2025-12-25 05:51:12,218 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 05:51:12,218 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 05:51:12,218 INFO [src.stage_a.stage_a] Extract run ID: 522e6955-9d58-478d-a427-d5d768bc4589
2025-12-25 05:51:12,226 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 05:51:12,226 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 05:51:12,226 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 05:51:12,226 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 05:51:12,226 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 05:51:12,226 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 05:51:12,226 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 05:51:12,226 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 05:51:12,226 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 05:51:13,643 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 05:51:13,643 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-02...
2025-12-25 05:51:13,707 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241202 for 519 symbols
2025-12-25 05:54:40,368 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,138,036 trades
2025-12-25 05:54:40,368 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,138,036 rows
2025-12-25 05:56:46,354 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,002,307 trades
2025-12-25 05:56:46,355 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,002,307 rows
2025-12-25 05:58:53,044 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,052,704 trades
2025-12-25 05:58:53,045 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,052,704 rows
2025-12-25 06:00:27,492 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,729,068 trades
2025-12-25 06:00:27,492 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,729,068 rows
2025-12-25 06:02:51,336 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,580,779 trades
2025-12-25 06:02:51,336 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,580,779 rows
2025-12-25 06:05:07,001 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,174,074 trades
2025-12-25 06:05:07,001 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,174,074 rows
2025-12-25 06:08:52,993 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,707,618 trades
2025-12-25 06:08:52,994 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,707,618 rows
2025-12-25 06:11:22,995 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,340,842 trades
2025-12-25 06:11:22,998 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,340,842 rows
2025-12-25 06:14:33,913 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,460,323 trades
2025-12-25 06:14:33,913 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,460,323 rows
2025-12-25 06:17:47,612 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,037,450 trades
2025-12-25 06:17:47,614 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,037,450 rows
2025-12-25 06:17:48,057 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,223,201 total rows written
2025-12-25 06:18:54,463 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,002,653 trades
2025-12-25 06:18:54,463 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,002,653 rows
2025-12-25 06:18:54,796 INFO [src.stage_a.parquet_writer] ✓ Wrote 27,225,854 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-02
2025-12-25 06:18:54,797 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 06:18:54,797 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 06:18:54,797 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 06:18:54,797 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 06:18:54,797 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 06:18:54,797 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 06:18:54,797 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 06:18:56,677 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 06:18:56,677 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-02...
2025-12-25 06:18:56,789 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241202 for 519 symbols
2025-12-25 06:21:03,682 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,291,046 NBBO records
2025-12-25 06:21:03,682 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,291,046 rows
2025-12-25 06:22:16,153 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,884,023 NBBO records
2025-12-25 06:22:16,154 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,884,023 rows
2025-12-25 06:23:49,273 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,519,573 NBBO records
2025-12-25 06:23:49,273 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,519,573 rows
2025-12-25 06:25:12,402 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,814,726 NBBO records
2025-12-25 06:25:12,402 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,814,726 rows
2025-12-25 06:27:26,519 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,074,739 NBBO records
2025-12-25 06:27:26,519 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,074,739 rows
2025-12-25 06:29:36,286 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,153,996 NBBO records
2025-12-25 06:29:36,286 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,153,996 rows
2025-12-25 06:31:44,361 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,777,847 NBBO records
2025-12-25 06:31:44,361 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,777,847 rows
2025-12-25 06:33:59,097 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,628,040 NBBO records
2025-12-25 06:33:59,097 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,628,040 rows
2025-12-25 06:36:52,725 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,896,559 NBBO records
2025-12-25 06:36:52,725 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,896,559 rows
2025-12-25 06:38:45,872 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,502,798 NBBO records
2025-12-25 06:38:45,872 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,502,798 rows
2025-12-25 06:38:46,123 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 29,543,347 total rows written
2025-12-25 06:41:09,237 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,245,008 NBBO records
2025-12-25 06:41:09,237 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,245,008 rows
2025-12-25 06:41:09,639 INFO [src.stage_a.parquet_writer] ✓ Wrote 33,788,355 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-02
2025-12-25 06:41:09,646 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 06:41:09,646 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 06:41:09,646 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 06:41:09,646 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 06:41:09,646 INFO [src.stage_a.stage_a] Trades: 27,225,854 rows
2025-12-25 06:41:09,646 INFO [src.stage_a.stage_a] Nbbo: 33,788,355 rows
2025-12-25 06:41:09,646 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 06:41:09,646 INFO [src.stage_a.stage_a] Processing date 121/140: 2024-12-03
2025-12-25 06:41:09,646 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 06:41:09,646 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 06:41:09,646 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-12-03 (519 symbols)
2025-12-25 06:41:09,646 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 06:41:09,646 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 06:41:09,646 INFO [src.stage_a.stage_a] Extract run ID: 829d7774-5cb4-45b1-8f25-e768a215f0d8
2025-12-25 06:41:09,654 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 06:41:09,654 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 06:41:09,654 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 06:41:09,654 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 06:41:09,654 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 06:41:09,654 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 06:41:09,654 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 06:41:09,654 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 06:41:09,654 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 06:41:11,791 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 06:41:11,791 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-03...
2025-12-25 06:41:11,914 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241203 for 519 symbols
2025-12-25 06:43:08,421 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,703,960 trades
2025-12-25 06:43:08,421 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,703,960 rows
2025-12-25 06:44:49,253 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,786,794 trades
2025-12-25 06:44:49,253 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,786,794 rows
2025-12-25 06:46:12,863 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,969,538 trades
2025-12-25 06:46:12,863 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,969,538 rows
2025-12-25 06:47:21,041 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,576,175 trades
2025-12-25 06:47:21,041 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,576,175 rows
2025-12-25 06:49:01,437 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,355,628 trades
2025-12-25 06:49:01,437 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,355,628 rows
2025-12-25 06:50:41,636 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,991,215 trades
2025-12-25 06:50:41,636 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,991,215 rows
2025-12-25 06:53:21,605 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,471,177 trades
2025-12-25 06:53:21,605 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,471,177 rows
2025-12-25 06:55:03,805 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,153,713 trades
2025-12-25 06:55:03,807 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,153,713 rows
2025-12-25 06:57:05,104 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,044,142 trades
2025-12-25 06:57:05,104 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,044,142 rows
2025-12-25 06:58:59,218 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,642,025 trades
2025-12-25 06:58:59,218 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,642,025 rows
2025-12-25 06:58:59,597 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,694,367 total rows written
2025-12-25 06:59:38,134 INFO [src.stage_a.wrds_extractor]   Chunk 11: 926,462 trades
2025-12-25 06:59:38,134 INFO [src.stage_a.parquet_writer]   Chunk 11: 926,462 rows
2025-12-25 06:59:38,421 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,620,829 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-03
2025-12-25 06:59:38,422 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 06:59:38,422 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 06:59:38,422 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 06:59:38,422 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 06:59:38,422 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 06:59:38,422 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 06:59:38,422 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 06:59:40,202 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 06:59:40,202 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-03...
2025-12-25 06:59:40,313 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241203 for 519 symbols
2025-12-25 07:01:08,196 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,939,765 NBBO records
2025-12-25 07:01:08,197 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,939,765 rows
2025-12-25 07:01:57,964 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,714,863 NBBO records
2025-12-25 07:01:57,964 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,714,863 rows
2025-12-25 07:03:08,600 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,466,894 NBBO records
2025-12-25 07:03:08,600 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,466,894 rows
2025-12-25 07:04:00,910 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,886,635 NBBO records
2025-12-25 07:04:00,910 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,886,635 rows
2025-12-25 07:05:19,758 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,647,282 NBBO records
2025-12-25 07:05:19,758 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,647,282 rows
2025-12-25 07:06:36,745 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,900,931 NBBO records
2025-12-25 07:06:36,745 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,900,931 rows
2025-12-25 07:08:13,545 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,565,072 NBBO records
2025-12-25 07:08:13,545 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,565,072 rows
2025-12-25 07:09:42,078 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,281,239 NBBO records
2025-12-25 07:09:42,079 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,281,239 rows
2025-12-25 07:11:29,569 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,794,869 NBBO records
2025-12-25 07:11:29,569 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,794,869 rows
2025-12-25 07:12:25,641 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,198,275 NBBO records
2025-12-25 07:12:25,641 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,198,275 rows
2025-12-25 07:12:25,870 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 27,395,825 total rows written
2025-12-25 07:13:55,238 INFO [src.stage_a.wrds_extractor]   Chunk 11: 3,722,227 NBBO records
2025-12-25 07:13:55,238 INFO [src.stage_a.parquet_writer]   Chunk 11: 3,722,227 rows
2025-12-25 07:13:55,599 INFO [src.stage_a.parquet_writer] ✓ Wrote 31,118,052 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-03
2025-12-25 07:13:55,604 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 07:13:55,604 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 07:13:55,604 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 07:13:55,604 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 07:13:55,604 INFO [src.stage_a.stage_a] Trades: 24,620,829 rows
2025-12-25 07:13:55,604 INFO [src.stage_a.stage_a] Nbbo: 31,118,052 rows
2025-12-25 07:13:55,604 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 07:13:55,604 INFO [src.stage_a.stage_a] Processing date 122/140: 2024-12-04
2025-12-25 07:13:55,604 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 07:13:55,604 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 07:13:55,604 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-12-04 (519 symbols)
2025-12-25 07:13:55,605 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 07:13:55,605 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 07:13:55,605 INFO [src.stage_a.stage_a] Extract run ID: 3668f55d-a947-4d15-94c2-16b5a89f43cc
2025-12-25 07:13:55,613 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 07:13:55,613 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 07:13:55,613 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 07:13:55,613 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 07:13:55,613 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 07:13:55,613 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 07:13:55,613 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 07:13:55,613 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 07:13:55,613 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 07:13:57,386 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 07:13:57,386 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-04...
2025-12-25 07:13:57,486 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241204 for 519 symbols
2025-12-25 07:16:42,638 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,130,513 trades
2025-12-25 07:16:42,639 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,130,513 rows
2025-12-25 07:18:01,019 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,838,502 trades
2025-12-25 07:18:01,019 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,838,502 rows
2025-12-25 07:20:26,775 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,369,789 trades
2025-12-25 07:20:26,775 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,369,789 rows
2025-12-25 07:22:15,704 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,719,335 trades
2025-12-25 07:22:15,705 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,719,335 rows
2025-12-25 07:24:30,089 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,464,414 trades
2025-12-25 07:24:30,089 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,464,414 rows
2025-12-25 07:26:24,307 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,155,623 trades
2025-12-25 07:26:24,307 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,155,623 rows
2025-12-25 07:30:36,968 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,924,949 trades
2025-12-25 07:30:36,968 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,924,949 rows
2025-12-25 07:33:43,739 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,319,531 trades
2025-12-25 07:33:43,743 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,319,531 rows
2025-12-25 07:35:39,299 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,387,982 trades
2025-12-25 07:35:39,299 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,387,982 rows
2025-12-25 07:38:17,403 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,651,385 trades
2025-12-25 07:38:17,403 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,651,385 rows
2025-12-25 07:38:17,795 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 24,962,023 total rows written
2025-12-25 07:39:09,724 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,049,114 trades
2025-12-25 07:39:09,724 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,049,114 rows
2025-12-25 07:39:10,043 INFO [src.stage_a.parquet_writer] ✓ Wrote 26,011,137 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-04
2025-12-25 07:39:10,044 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 07:39:10,044 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 07:39:10,044 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 07:39:10,044 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 07:39:10,044 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 07:39:10,044 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 07:39:10,044 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 07:39:11,278 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 07:39:11,278 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-04...
2025-12-25 07:39:11,356 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241204 for 519 symbols
2025-12-25 07:40:48,954 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,871,546 NBBO records
2025-12-25 07:40:48,954 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,871,546 rows
2025-12-25 07:41:50,407 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,903,832 NBBO records
2025-12-25 07:41:50,407 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,903,832 rows
2025-12-25 07:43:12,025 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,452,618 NBBO records
2025-12-25 07:43:12,025 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,452,618 rows
2025-12-25 07:44:09,967 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,715,994 NBBO records
2025-12-25 07:44:09,967 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,715,994 rows
2025-12-25 07:45:22,665 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,950,242 NBBO records
2025-12-25 07:45:22,666 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,950,242 rows
2025-12-25 07:46:41,522 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,821,846 NBBO records
2025-12-25 07:46:41,522 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,821,846 rows
2025-12-25 07:48:59,943 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,068,241 NBBO records
2025-12-25 07:48:59,943 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,068,241 rows
2025-12-25 07:50:58,037 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,297,142 NBBO records
2025-12-25 07:50:58,037 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,297,142 rows
2025-12-25 07:52:31,910 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,086,058 NBBO records
2025-12-25 07:52:31,910 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,086,058 rows
2025-12-25 07:53:35,768 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,317,715 NBBO records
2025-12-25 07:53:35,768 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,317,715 rows
2025-12-25 07:53:36,016 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 27,485,234 total rows written
2025-12-25 07:55:24,780 INFO [src.stage_a.wrds_extractor]   Chunk 11: 3,988,514 NBBO records
2025-12-25 07:55:24,780 INFO [src.stage_a.parquet_writer]   Chunk 11: 3,988,514 rows
2025-12-25 07:55:25,152 INFO [src.stage_a.parquet_writer] ✓ Wrote 31,473,748 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-04
2025-12-25 07:55:25,158 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 07:55:25,158 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 07:55:25,158 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 07:55:25,158 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 07:55:25,158 INFO [src.stage_a.stage_a] Trades: 26,011,137 rows
2025-12-25 07:55:25,158 INFO [src.stage_a.stage_a] Nbbo: 31,473,748 rows
2025-12-25 07:55:25,158 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 07:55:25,158 INFO [src.stage_a.stage_a] Processing date 123/140: 2024-12-05
2025-12-25 07:55:25,158 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 07:55:25,158 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 07:55:25,158 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-12-05 (519 symbols)
2025-12-25 07:55:25,158 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 07:55:25,158 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 07:55:25,158 INFO [src.stage_a.stage_a] Extract run ID: 53beab93-09d6-4a5a-aad3-3ac45f75d1c9
2025-12-25 07:55:25,166 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 07:55:25,166 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 07:55:25,166 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 07:55:25,166 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 07:55:25,166 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 07:55:25,166 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 07:55:25,166 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 07:55:25,166 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 07:55:25,166 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 07:55:26,979 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 07:55:26,979 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-05...
2025-12-25 07:55:27,170 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241205 for 519 symbols
2025-12-25 07:58:06,543 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,225,023 trades
2025-12-25 07:58:06,543 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,225,023 rows
2025-12-25 07:59:41,797 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,933,808 trades
2025-12-25 07:59:41,797 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,933,808 rows
2025-12-25 08:01:47,738 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,242,430 trades
2025-12-25 08:01:47,738 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,242,430 rows
2025-12-25 08:03:10,100 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,713,205 trades
2025-12-25 08:03:10,100 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,713,205 rows
2025-12-25 08:05:31,073 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,653,858 trades
2025-12-25 08:05:31,074 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,653,858 rows
2025-12-25 08:07:18,474 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,137,054 trades
2025-12-25 08:07:18,474 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,137,054 rows
2025-12-25 08:10:24,034 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,554,502 trades
2025-12-25 08:10:24,035 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,554,502 rows
2025-12-25 08:12:19,957 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,076,154 trades
2025-12-25 08:12:19,958 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,076,154 rows
2025-12-25 08:13:58,644 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,315,386 trades
2025-12-25 08:13:58,645 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,315,386 rows
2025-12-25 08:17:04,452 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,631,762 trades
2025-12-25 08:17:04,452 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,631,762 rows
2025-12-25 08:17:04,888 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,483,182 total rows written
2025-12-25 08:18:07,665 INFO [src.stage_a.wrds_extractor]   Chunk 11: 954,300 trades
2025-12-25 08:18:07,666 INFO [src.stage_a.parquet_writer]   Chunk 11: 954,300 rows
2025-12-25 08:18:07,954 INFO [src.stage_a.parquet_writer] ✓ Wrote 26,437,482 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-05
2025-12-25 08:18:07,955 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 08:18:07,955 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 08:18:07,955 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 08:18:07,955 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 08:18:07,955 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 08:18:07,955 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 08:18:07,955 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 08:18:10,333 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 08:18:10,334 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-05...
2025-12-25 08:18:10,507 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241205 for 519 symbols
2025-12-25 08:19:47,794 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,937,540 NBBO records
2025-12-25 08:19:47,794 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,937,540 rows
2025-12-25 08:21:03,134 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,885,269 NBBO records
2025-12-25 08:21:03,134 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,885,269 rows
2025-12-25 08:22:24,124 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,659,118 NBBO records
2025-12-25 08:22:24,125 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,659,118 rows
2025-12-25 08:23:35,521 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,772,869 NBBO records
2025-12-25 08:23:35,522 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,772,869 rows
2025-12-25 08:25:54,317 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,058,656 NBBO records
2025-12-25 08:25:54,317 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,058,656 rows
2025-12-25 08:27:30,530 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,992,881 NBBO records
2025-12-25 08:27:30,530 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,992,881 rows
2025-12-25 08:30:07,497 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,928,992 NBBO records
2025-12-25 08:30:07,497 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,928,992 rows
2025-12-25 08:32:41,676 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,119,560 NBBO records
2025-12-25 08:32:41,676 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,119,560 rows
2025-12-25 08:34:50,717 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,010,449 NBBO records
2025-12-25 08:34:50,717 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,010,449 rows
2025-12-25 08:37:01,764 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,790,619 NBBO records
2025-12-25 08:37:01,764 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,790,619 rows
2025-12-25 08:37:02,030 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 28,155,953 total rows written
2025-12-25 08:39:55,502 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,708,114 NBBO records
2025-12-25 08:39:55,502 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,708,114 rows
2025-12-25 08:39:55,917 INFO [src.stage_a.parquet_writer] ✓ Wrote 32,864,067 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-05
2025-12-25 08:39:55,922 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 08:39:55,922 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 08:39:55,922 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 08:39:55,922 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 08:39:55,922 INFO [src.stage_a.stage_a] Trades: 26,437,482 rows
2025-12-25 08:39:55,923 INFO [src.stage_a.stage_a] Nbbo: 32,864,067 rows
2025-12-25 08:39:55,923 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 08:39:55,923 INFO [src.stage_a.stage_a] Processing date 124/140: 2024-12-06
2025-12-25 08:39:55,923 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 08:39:55,923 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 08:39:55,923 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-12-06 (519 symbols)
2025-12-25 08:39:55,923 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 08:39:55,923 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 08:39:55,923 INFO [src.stage_a.stage_a] Extract run ID: e3b4237f-108f-4c86-978c-bddecb174470
2025-12-25 08:39:55,931 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 08:39:55,931 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 08:39:55,931 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 08:39:55,931 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 08:39:55,931 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 08:39:55,931 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 08:39:55,931 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 08:39:55,931 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 08:39:55,931 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 08:39:58,364 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 08:39:58,364 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-06...
2025-12-25 08:39:58,469 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241206 for 519 symbols
2025-12-25 08:42:49,877 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,211,238 trades
2025-12-25 08:42:49,878 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,211,238 rows
2025-12-25 08:44:49,517 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,847,245 trades
2025-12-25 08:44:49,517 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,847,245 rows
2025-12-25 08:46:55,071 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,157,523 trades
2025-12-25 08:46:55,071 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,157,523 rows
2025-12-25 08:48:46,459 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,724,796 trades
2025-12-25 08:48:46,459 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,724,796 rows
2025-12-25 08:50:25,899 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,406,893 trades
2025-12-25 08:50:25,899 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,406,893 rows
2025-12-25 08:52:45,968 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,126,915 trades
2025-12-25 08:52:45,968 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,126,915 rows
2025-12-25 08:56:49,751 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,699,421 trades
2025-12-25 08:56:49,751 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,699,421 rows
2025-12-25 08:59:14,414 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,234,737 trades
2025-12-25 08:59:14,416 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,234,737 rows
2025-12-25 09:01:32,025 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,557,917 trades
2025-12-25 09:01:32,026 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,557,917 rows
2025-12-25 09:04:44,282 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,288,605 trades
2025-12-25 09:04:44,282 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,288,605 rows
2025-12-25 09:04:44,703 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,255,290 total rows written
2025-12-25 09:05:42,171 INFO [src.stage_a.wrds_extractor]   Chunk 11: 907,233 trades
2025-12-25 09:05:42,172 INFO [src.stage_a.parquet_writer]   Chunk 11: 907,233 rows
2025-12-25 09:05:42,461 INFO [src.stage_a.parquet_writer] ✓ Wrote 26,162,523 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-06
2025-12-25 09:05:42,462 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 09:05:42,462 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 09:05:42,462 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 09:05:42,462 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 09:05:42,462 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 09:05:42,462 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 09:05:42,462 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 09:05:43,767 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 09:05:43,778 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-06...
2025-12-25 09:05:43,953 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241206 for 519 symbols
2025-12-25 09:07:42,891 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,167,729 NBBO records
2025-12-25 09:07:42,891 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,167,729 rows
2025-12-25 09:08:43,303 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,730,874 NBBO records
2025-12-25 09:08:43,303 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,730,874 rows
2025-12-25 09:09:54,619 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,263,151 NBBO records
2025-12-25 09:09:54,619 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,263,151 rows
2025-12-25 09:10:46,507 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,660,668 NBBO records
2025-12-25 09:10:46,507 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,660,668 rows
2025-12-25 09:11:47,802 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,449,451 NBBO records
2025-12-25 09:11:47,802 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,449,451 rows
2025-12-25 09:12:55,587 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,689,162 NBBO records
2025-12-25 09:12:55,587 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,689,162 rows
2025-12-25 09:15:17,303 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,696,705 NBBO records
2025-12-25 09:15:17,303 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,696,705 rows
2025-12-25 09:17:16,906 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,299,524 NBBO records
2025-12-25 09:17:16,906 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,299,524 rows
2025-12-25 09:19:32,179 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,265,156 NBBO records
2025-12-25 09:19:32,179 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,265,156 rows
2025-12-25 09:21:05,065 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,642,795 NBBO records
2025-12-25 09:21:05,065 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,642,795 rows
2025-12-25 09:21:05,304 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,865,215 total rows written
2025-12-25 09:23:45,001 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,387,152 NBBO records
2025-12-25 09:23:45,001 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,387,152 rows
2025-12-25 09:23:45,399 INFO [src.stage_a.parquet_writer] ✓ Wrote 31,252,367 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-06
2025-12-25 09:23:45,404 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 09:23:45,404 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 09:23:45,404 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 09:23:45,404 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 09:23:45,404 INFO [src.stage_a.stage_a] Trades: 26,162,523 rows
2025-12-25 09:23:45,404 INFO [src.stage_a.stage_a] Nbbo: 31,252,367 rows
2025-12-25 09:23:45,404 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 09:23:45,404 INFO [src.stage_a.stage_a] Processing date 125/140: 2024-12-09
2025-12-25 09:23:45,404 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 09:23:45,404 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 09:23:45,404 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-12-09 (519 symbols)
2025-12-25 09:23:45,404 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 09:23:45,404 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 09:23:45,404 INFO [src.stage_a.stage_a] Extract run ID: 4291a7f5-c3df-4a61-a640-fe79f99e9644
2025-12-25 09:23:45,412 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 09:23:45,412 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 09:23:45,412 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 09:23:45,413 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 09:23:45,413 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 09:23:45,413 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 09:23:45,413 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 09:23:45,413 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 09:23:45,413 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 09:23:46,568 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 09:23:46,569 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-09...
2025-12-25 09:23:46,651 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241209 for 519 symbols
2025-12-25 09:26:26,504 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,846,134 trades
2025-12-25 09:26:26,505 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,846,134 rows
2025-12-25 09:27:52,284 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,259,728 trades
2025-12-25 09:27:52,286 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,259,728 rows
2025-12-25 09:29:34,748 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,326,753 trades
2025-12-25 09:29:34,748 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,326,753 rows
2025-12-25 09:30:38,663 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,873,306 trades
2025-12-25 09:30:38,664 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,873,306 rows
2025-12-25 09:32:49,364 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,019,963 trades
2025-12-25 09:32:49,364 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,019,963 rows
2025-12-25 09:34:33,851 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,399,234 trades
2025-12-25 09:34:33,851 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,399,234 rows
2025-12-25 09:38:00,462 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,336,774 trades
2025-12-25 09:38:00,462 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,336,774 rows
2025-12-25 09:40:09,202 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,613,143 trades
2025-12-25 09:40:09,223 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,613,143 rows
2025-12-25 09:42:33,151 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,850,702 trades
2025-12-25 09:42:33,151 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,850,702 rows
2025-12-25 09:46:11,723 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,809,673 trades
2025-12-25 09:46:11,723 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,809,673 rows
2025-12-25 09:46:12,210 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 29,335,410 total rows written
2025-12-25 09:47:05,470 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,127,162 trades
2025-12-25 09:47:05,474 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,127,162 rows
2025-12-25 09:47:05,825 INFO [src.stage_a.parquet_writer] ✓ Wrote 30,462,572 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-09
2025-12-25 09:47:05,826 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 09:47:05,826 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 09:47:05,826 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 09:47:05,826 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 09:47:05,826 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 09:47:05,826 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 09:47:05,826 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 09:47:07,439 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 09:47:07,439 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-09...
2025-12-25 09:47:07,547 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241209 for 519 symbols
2025-12-25 09:48:32,659 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,394,493 NBBO records
2025-12-25 09:48:32,659 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,394,493 rows
2025-12-25 09:49:58,628 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,206,580 NBBO records
2025-12-25 09:49:58,628 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,206,580 rows
2025-12-25 09:51:36,336 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,859,441 NBBO records
2025-12-25 09:51:36,336 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,859,441 rows
2025-12-25 09:52:55,795 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,911,904 NBBO records
2025-12-25 09:52:55,795 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,911,904 rows
2025-12-25 09:54:56,142 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,281,826 NBBO records
2025-12-25 09:54:56,142 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,281,826 rows
2025-12-25 09:57:08,127 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,368,451 NBBO records
2025-12-25 09:57:08,127 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,368,451 rows
2025-12-25 09:59:32,038 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,082,683 NBBO records
2025-12-25 09:59:32,038 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,082,683 rows
2025-12-25 10:02:11,862 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,998,742 NBBO records
2025-12-25 10:02:11,862 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,998,742 rows
2025-12-25 10:05:02,907 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,522,903 NBBO records
2025-12-25 10:05:02,907 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,522,903 rows
2025-12-25 10:07:29,639 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,957,364 NBBO records
2025-12-25 10:07:29,639 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,957,364 rows
2025-12-25 10:07:29,900 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 31,584,387 total rows written
2025-12-25 10:10:45,365 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,288,721 NBBO records
2025-12-25 10:10:45,365 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,288,721 rows
2025-12-25 10:10:45,816 INFO [src.stage_a.parquet_writer] ✓ Wrote 36,873,108 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-09
2025-12-25 10:10:45,823 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 10:10:45,823 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 10:10:45,823 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 10:10:45,823 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 10:10:45,823 INFO [src.stage_a.stage_a] Trades: 30,462,572 rows
2025-12-25 10:10:45,823 INFO [src.stage_a.stage_a] Nbbo: 36,873,108 rows
2025-12-25 10:10:45,823 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 10:10:45,823 INFO [src.stage_a.stage_a] Processing date 126/140: 2024-12-10
2025-12-25 10:10:45,823 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 10:10:45,823 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 10:10:45,823 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-12-10 (519 symbols)
2025-12-25 10:10:45,823 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 10:10:45,823 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 10:10:45,823 INFO [src.stage_a.stage_a] Extract run ID: 7318d816-ea0f-4c49-b255-0262d9825a93
2025-12-25 10:10:45,831 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 10:10:45,831 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 10:10:45,831 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 10:10:45,831 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 10:10:45,831 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 10:10:45,831 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 10:10:45,831 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 10:10:45,831 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 10:10:45,831 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 10:10:48,831 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 10:10:48,831 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-10...
2025-12-25 10:10:48,912 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241210 for 519 symbols
2025-12-25 10:14:23,541 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,462,297 trades
2025-12-25 10:14:23,541 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,462,297 rows
2025-12-25 10:16:37,095 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,234,579 trades
2025-12-25 10:16:37,095 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,234,579 rows
2025-12-25 10:19:01,953 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,161,533 trades
2025-12-25 10:19:01,954 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,161,533 rows
2025-12-25 10:20:41,501 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,795,036 trades
2025-12-25 10:20:41,501 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,795,036 rows
2025-12-25 10:24:06,168 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,375,693 trades
2025-12-25 10:24:06,168 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,375,693 rows
2025-12-25 10:25:57,456 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,245,557 trades
2025-12-25 10:25:57,457 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,245,557 rows
2025-12-25 10:29:57,477 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,395,762 trades
2025-12-25 10:29:57,477 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,395,762 rows
2025-12-25 10:32:25,952 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,589,450 trades
2025-12-25 10:32:25,970 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,589,450 rows
2025-12-25 10:34:54,040 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,569,515 trades
2025-12-25 10:34:54,040 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,569,515 rows
2025-12-25 10:38:08,794 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,830,010 trades
2025-12-25 10:38:08,794 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,830,010 rows
2025-12-25 10:38:09,270 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 28,659,432 total rows written
2025-12-25 10:38:57,483 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,090,212 trades
2025-12-25 10:38:57,486 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,090,212 rows
2025-12-25 10:38:57,845 INFO [src.stage_a.parquet_writer] ✓ Wrote 29,749,644 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-10
2025-12-25 10:38:57,846 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 10:38:57,846 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 10:38:57,846 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 10:38:57,846 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 10:38:57,846 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 10:38:57,846 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 10:38:57,846 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 10:38:59,188 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 10:38:59,188 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-10...
2025-12-25 10:38:59,245 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241210 for 519 symbols
2025-12-25 10:42:02,597 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,306,028 NBBO records
2025-12-25 10:42:02,597 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,306,028 rows
2025-12-25 10:43:22,428 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,063,277 NBBO records
2025-12-25 10:43:22,428 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,063,277 rows
2025-12-25 10:44:41,265 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,531,398 NBBO records
2025-12-25 10:44:41,265 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,531,398 rows
2025-12-25 10:45:51,542 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,779,196 NBBO records
2025-12-25 10:45:51,542 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,779,196 rows
2025-12-25 10:48:15,729 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,784,193 NBBO records
2025-12-25 10:48:15,729 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,784,193 rows
2025-12-25 10:50:33,677 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,515,083 NBBO records
2025-12-25 10:50:33,677 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,515,083 rows
2025-12-25 10:54:09,222 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,442,594 NBBO records
2025-12-25 10:54:09,222 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,442,594 rows
2025-12-25 10:55:54,284 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,597,985 NBBO records
2025-12-25 10:55:54,284 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,597,985 rows
2025-12-25 10:58:33,714 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,636,912 NBBO records
2025-12-25 10:58:33,714 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,636,912 rows
2025-12-25 11:00:30,733 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,202,206 NBBO records
2025-12-25 11:00:30,733 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,202,206 rows
2025-12-25 11:00:31,003 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 31,858,872 total rows written
2025-12-25 11:03:48,854 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,281,063 NBBO records
2025-12-25 11:03:48,854 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,281,063 rows
2025-12-25 11:03:49,313 INFO [src.stage_a.parquet_writer] ✓ Wrote 37,139,935 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-10
2025-12-25 11:03:49,320 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 11:03:49,320 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 11:03:49,320 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 11:03:49,320 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 11:03:49,320 INFO [src.stage_a.stage_a] Trades: 29,749,644 rows
2025-12-25 11:03:49,320 INFO [src.stage_a.stage_a] Nbbo: 37,139,935 rows
2025-12-25 11:03:49,320 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 11:03:49,320 INFO [src.stage_a.stage_a] Processing date 127/140: 2024-12-11
2025-12-25 11:03:49,320 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 11:03:49,320 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 11:03:49,320 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-12-11 (519 symbols)
2025-12-25 11:03:49,320 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 11:03:49,320 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 11:03:49,320 INFO [src.stage_a.stage_a] Extract run ID: ec0fc96c-8ecd-4a0d-8213-0a815f64e8b9
2025-12-25 11:03:49,328 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 11:03:49,328 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 11:03:49,328 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 11:03:49,328 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 11:03:49,328 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 11:03:49,328 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 11:03:49,328 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 11:03:49,328 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 11:03:49,328 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 11:03:51,896 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 11:03:51,897 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-11...
2025-12-25 11:03:52,053 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241211 for 519 symbols
2025-12-25 11:07:18,886 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,306,661 trades
2025-12-25 11:07:18,886 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,306,661 rows
2025-12-25 11:10:00,255 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,107,467 trades
2025-12-25 11:10:00,255 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,107,467 rows
2025-12-25 11:12:04,270 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,111,155 trades
2025-12-25 11:12:04,270 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,111,155 rows
2025-12-25 11:13:56,963 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,732,723 trades
2025-12-25 11:13:56,963 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,732,723 rows
2025-12-25 11:17:28,790 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,455,365 trades
2025-12-25 11:17:28,790 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,455,365 rows
2025-12-25 11:19:42,672 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,138,242 trades
2025-12-25 11:19:42,673 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,138,242 rows
2025-12-25 11:23:21,394 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,870,529 trades
2025-12-25 11:23:21,394 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,870,529 rows
2025-12-25 11:25:37,133 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,287,012 trades
2025-12-25 11:25:37,137 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,287,012 rows
2025-12-25 11:27:39,643 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,316,049 trades
2025-12-25 11:27:39,643 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,316,049 rows
2025-12-25 11:31:16,571 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,843,185 trades
2025-12-25 11:31:16,571 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,843,185 rows
2025-12-25 11:31:17,056 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 27,168,388 total rows written
2025-12-25 11:32:08,098 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,018,630 trades
2025-12-25 11:32:08,106 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,018,630 rows
2025-12-25 11:32:08,412 INFO [src.stage_a.parquet_writer] ✓ Wrote 28,187,018 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-11
2025-12-25 11:32:08,413 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 11:32:08,413 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 11:32:08,413 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 11:32:08,413 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 11:32:08,413 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 11:32:08,413 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 11:32:08,413 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 11:32:12,018 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 11:32:12,019 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-11...
2025-12-25 11:32:12,225 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241211 for 519 symbols
2025-12-25 11:34:28,589 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,072,778 NBBO records
2025-12-25 11:34:28,589 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,072,778 rows
2025-12-25 11:36:00,743 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,042,828 NBBO records
2025-12-25 11:36:00,743 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,042,828 rows
2025-12-25 11:37:57,514 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,414,294 NBBO records
2025-12-25 11:37:57,514 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,414,294 rows
2025-12-25 11:38:57,563 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,728,469 NBBO records
2025-12-25 11:38:57,563 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,728,469 rows
2025-12-25 11:41:20,160 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,672,753 NBBO records
2025-12-25 11:41:20,160 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,672,753 rows
2025-12-25 11:43:26,103 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,982,642 NBBO records
2025-12-25 11:43:26,104 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,982,642 rows
2025-12-25 11:45:22,243 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,672,301 NBBO records
2025-12-25 11:45:22,244 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,672,301 rows
2025-12-25 11:47:33,780 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,317,993 NBBO records
2025-12-25 11:47:33,780 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,317,993 rows
2025-12-25 11:49:22,354 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,649,996 NBBO records
2025-12-25 11:49:22,354 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,649,996 rows
2025-12-25 11:51:03,385 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,538,846 NBBO records
2025-12-25 11:51:03,385 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,538,846 rows
2025-12-25 11:51:03,615 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 28,092,900 total rows written
2025-12-25 11:53:58,610 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,708,708 NBBO records
2025-12-25 11:53:58,610 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,708,708 rows
2025-12-25 11:53:59,014 INFO [src.stage_a.parquet_writer] ✓ Wrote 32,801,608 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-11
2025-12-25 11:53:59,019 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 11:53:59,019 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 11:53:59,019 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 11:53:59,020 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 11:53:59,020 INFO [src.stage_a.stage_a] Trades: 28,187,018 rows
2025-12-25 11:53:59,020 INFO [src.stage_a.stage_a] Nbbo: 32,801,608 rows
2025-12-25 11:53:59,020 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 11:53:59,020 INFO [src.stage_a.stage_a] Processing date 128/140: 2024-12-12
2025-12-25 11:53:59,020 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 11:53:59,020 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 11:53:59,020 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-12-12 (519 symbols)
2025-12-25 11:53:59,020 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 11:53:59,020 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 11:53:59,020 INFO [src.stage_a.stage_a] Extract run ID: 0dca2283-7ffe-4395-84d3-df4109926b26
2025-12-25 11:53:59,028 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 11:53:59,028 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 11:53:59,028 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 11:53:59,028 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 11:53:59,028 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 11:53:59,028 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 11:53:59,028 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 11:53:59,028 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 11:53:59,028 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 11:54:01,187 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 11:54:01,188 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-12...
2025-12-25 11:54:01,402 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241212 for 519 symbols
2025-12-25 11:57:21,301 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,176,043 trades
2025-12-25 11:57:21,301 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,176,043 rows
2025-12-25 11:58:54,646 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,883,498 trades
2025-12-25 11:58:54,646 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,883,498 rows
2025-12-25 12:00:44,120 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,072,605 trades
2025-12-25 12:00:44,121 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,072,605 rows
2025-12-25 12:02:10,378 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,573,731 trades
2025-12-25 12:02:10,378 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,573,731 rows
2025-12-25 12:04:53,704 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,610,878 trades
2025-12-25 12:04:53,704 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,610,878 rows
2025-12-25 12:07:09,658 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,973,430 trades
2025-12-25 12:07:09,658 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,973,430 rows
2025-12-25 12:10:43,356 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,490,799 trades
2025-12-25 12:10:43,356 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,490,799 rows
2025-12-25 12:12:39,730 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,027,861 trades
2025-12-25 12:12:39,732 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,027,861 rows
2025-12-25 12:14:56,904 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,018,750 trades
2025-12-25 12:14:56,904 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,018,750 rows
2025-12-25 12:18:47,364 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,558,190 trades
2025-12-25 12:18:47,364 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,558,190 rows
2025-12-25 12:18:47,807 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 24,385,785 total rows written
2025-12-25 12:20:05,655 INFO [src.stage_a.wrds_extractor]   Chunk 11: 909,693 trades
2025-12-25 12:20:05,656 INFO [src.stage_a.parquet_writer]   Chunk 11: 909,693 rows
2025-12-25 12:20:05,932 INFO [src.stage_a.parquet_writer] ✓ Wrote 25,295,478 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-12
2025-12-25 12:20:05,932 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 12:20:05,932 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 12:20:05,932 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 12:20:05,932 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 12:20:05,932 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 12:20:05,932 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 12:20:05,932 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 12:20:07,508 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 12:20:07,508 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-12...
2025-12-25 12:20:07,574 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241212 for 519 symbols
2025-12-25 12:21:40,378 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,683,398 NBBO records
2025-12-25 12:21:40,378 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,683,398 rows
2025-12-25 12:23:00,841 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,799,638 NBBO records
2025-12-25 12:23:00,841 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,799,638 rows
2025-12-25 12:24:20,239 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,454,443 NBBO records
2025-12-25 12:24:20,239 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,454,443 rows
2025-12-25 12:25:42,706 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,614,737 NBBO records
2025-12-25 12:25:42,706 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,614,737 rows
2025-12-25 12:27:38,234 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,154,949 NBBO records
2025-12-25 12:27:38,234 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,154,949 rows
2025-12-25 12:29:33,643 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,086,657 NBBO records
2025-12-25 12:29:33,643 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,086,657 rows
2025-12-25 12:32:06,292 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,742,471 NBBO records
2025-12-25 12:32:06,292 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,742,471 rows
2025-12-25 12:33:47,666 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,037,447 NBBO records
2025-12-25 12:33:47,666 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,037,447 rows
2025-12-25 12:35:47,179 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,737,952 NBBO records
2025-12-25 12:35:47,180 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,737,952 rows
2025-12-25 12:37:41,375 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,015,603 NBBO records
2025-12-25 12:37:41,376 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,015,603 rows
2025-12-25 12:37:41,628 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 27,327,295 total rows written
2025-12-25 12:40:44,601 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,619,141 NBBO records
2025-12-25 12:40:44,601 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,619,141 rows
2025-12-25 12:40:45,018 INFO [src.stage_a.parquet_writer] ✓ Wrote 31,946,436 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-12
2025-12-25 12:40:45,024 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 12:40:45,025 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 12:40:45,025 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 12:40:45,025 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 12:40:45,025 INFO [src.stage_a.stage_a] Trades: 25,295,478 rows
2025-12-25 12:40:45,025 INFO [src.stage_a.stage_a] Nbbo: 31,946,436 rows
2025-12-25 12:40:45,025 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 12:40:45,025 INFO [src.stage_a.stage_a] Processing date 129/140: 2024-12-13
2025-12-25 12:40:45,025 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 12:40:45,025 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 12:40:45,025 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-12-13 (519 symbols)
2025-12-25 12:40:45,025 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 12:40:45,025 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 12:40:45,025 INFO [src.stage_a.stage_a] Extract run ID: 9f8ff101-f1d8-46f3-9448-5c083bafe5fd
2025-12-25 12:40:45,033 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 12:40:45,033 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 12:40:45,033 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 12:40:45,033 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 12:40:45,033 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 12:40:45,033 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 12:40:45,033 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 12:40:45,033 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 12:40:45,033 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 12:40:47,075 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 12:40:47,075 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-13...
2025-12-25 12:40:47,177 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241213 for 519 symbols
2025-12-25 12:44:18,140 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,265,544 trades
2025-12-25 12:44:18,140 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,265,544 rows
2025-12-25 12:46:02,490 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,820,640 trades
2025-12-25 12:46:02,493 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,820,640 rows
2025-12-25 12:47:38,199 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,092,969 trades
2025-12-25 12:47:38,199 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,092,969 rows
2025-12-25 12:48:54,481 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,569,793 trades
2025-12-25 12:48:54,481 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,569,793 rows
2025-12-25 12:50:43,886 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,236,255 trades
2025-12-25 12:50:43,886 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,236,255 rows
2025-12-25 12:52:14,888 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,950,457 trades
2025-12-25 12:52:14,888 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,950,457 rows
2025-12-25 12:55:49,293 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,106,058 trades
2025-12-25 12:55:49,293 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,106,058 rows
2025-12-25 12:57:27,806 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,098,105 trades
2025-12-25 12:57:27,822 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,098,105 rows
2025-12-25 12:59:41,808 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,277,193 trades
2025-12-25 12:59:41,808 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,277,193 rows
2025-12-25 13:02:40,167 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,442,750 trades
2025-12-25 13:02:40,167 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,442,750 rows
2025-12-25 13:02:40,607 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,859,764 total rows written
2025-12-25 13:03:37,733 INFO [src.stage_a.wrds_extractor]   Chunk 11: 941,544 trades
2025-12-25 13:03:37,736 INFO [src.stage_a.parquet_writer]   Chunk 11: 941,544 rows
2025-12-25 13:03:38,038 INFO [src.stage_a.parquet_writer] ✓ Wrote 26,801,308 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-13
2025-12-25 13:03:38,039 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 13:03:38,039 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 13:03:38,039 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 13:03:38,039 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 13:03:38,039 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 13:03:38,039 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 13:03:38,039 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 13:03:40,033 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 13:03:40,033 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-13...
2025-12-25 13:03:40,157 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241213 for 519 symbols
2025-12-25 13:05:06,339 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,944,537 NBBO records
2025-12-25 13:05:06,339 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,944,537 rows
2025-12-25 13:05:59,258 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,711,093 NBBO records
2025-12-25 13:05:59,258 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,711,093 rows
2025-12-25 13:07:25,645 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,796,097 NBBO records
2025-12-25 13:07:25,645 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,796,097 rows
2025-12-25 13:08:14,103 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,521,193 NBBO records
2025-12-25 13:08:14,103 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,521,193 rows
2025-12-25 13:09:33,579 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,819,664 NBBO records
2025-12-25 13:09:33,579 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,819,664 rows
2025-12-25 13:11:13,676 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,902,363 NBBO records
2025-12-25 13:11:13,677 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,902,363 rows
2025-12-25 13:13:16,937 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,140,588 NBBO records
2025-12-25 13:13:16,937 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,140,588 rows
2025-12-25 13:14:43,127 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,497,691 NBBO records
2025-12-25 13:14:43,127 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,497,691 rows
2025-12-25 13:16:24,810 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,115,986 NBBO records
2025-12-25 13:16:24,811 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,115,986 rows
2025-12-25 13:17:41,988 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,516,450 NBBO records
2025-12-25 13:17:41,989 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,516,450 rows
2025-12-25 13:17:42,229 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 27,965,662 total rows written
2025-12-25 13:20:28,911 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,968,773 NBBO records
2025-12-25 13:20:28,911 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,968,773 rows
2025-12-25 13:20:29,333 INFO [src.stage_a.parquet_writer] ✓ Wrote 32,934,435 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-13
2025-12-25 13:20:29,337 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 13:20:29,337 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 13:20:29,337 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 13:20:29,337 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 13:20:29,337 INFO [src.stage_a.stage_a] Trades: 26,801,308 rows
2025-12-25 13:20:29,337 INFO [src.stage_a.stage_a] Nbbo: 32,934,435 rows
2025-12-25 13:20:29,337 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 13:20:29,337 INFO [src.stage_a.stage_a] Processing date 130/140: 2024-12-16
2025-12-25 13:20:29,337 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 13:20:29,337 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 13:20:29,337 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-12-16 (519 symbols)
2025-12-25 13:20:29,337 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 13:20:29,337 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 13:20:29,337 INFO [src.stage_a.stage_a] Extract run ID: 67913568-199f-4286-9f13-fb7ceb8a7f2e
2025-12-25 13:20:29,346 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 13:20:29,346 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 13:20:29,346 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 13:20:29,346 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 13:20:29,346 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 13:20:29,346 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 13:20:29,346 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 13:20:29,346 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 13:20:29,346 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 13:20:31,592 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 13:20:31,592 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-16...
2025-12-25 13:20:31,747 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241216 for 519 symbols
2025-12-25 13:23:11,172 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,179,535 trades
2025-12-25 13:23:11,172 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,179,535 rows
2025-12-25 13:24:51,424 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,165,579 trades
2025-12-25 13:24:51,424 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,165,579 rows
2025-12-25 13:27:22,727 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,323,875 trades
2025-12-25 13:27:22,727 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,323,875 rows
2025-12-25 13:28:59,931 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,918,483 trades
2025-12-25 13:28:59,931 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,918,483 rows
2025-12-25 13:30:16,892 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,957,977 trades
2025-12-25 13:30:16,892 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,957,977 rows
2025-12-25 13:31:29,954 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,285,090 trades
2025-12-25 13:31:29,954 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,285,090 rows
2025-12-25 13:33:51,670 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,847,823 trades
2025-12-25 13:33:51,670 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,847,823 rows
2025-12-25 13:36:20,222 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,496,117 trades
2025-12-25 13:36:20,255 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,496,117 rows
2025-12-25 13:38:50,416 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,816,890 trades
2025-12-25 13:38:50,417 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,816,890 rows
2025-12-25 13:40:32,942 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,176,175 trades
2025-12-25 13:40:32,942 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,176,175 rows
2025-12-25 13:40:33,434 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 30,167,544 total rows written
2025-12-25 13:40:55,918 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,109,601 trades
2025-12-25 13:40:55,925 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,109,601 rows
2025-12-25 13:40:56,268 INFO [src.stage_a.parquet_writer] ✓ Wrote 31,277,145 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-16
2025-12-25 13:40:56,269 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 13:40:56,269 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 13:40:56,269 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 13:40:56,269 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 13:40:56,269 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 13:40:56,269 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 13:40:56,269 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 13:40:57,460 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 13:40:57,460 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-16...
2025-12-25 13:40:57,516 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241216 for 519 symbols
2025-12-25 13:42:45,493 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,371,600 NBBO records
2025-12-25 13:42:45,493 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,371,600 rows
2025-12-25 13:43:38,756 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,895,716 NBBO records
2025-12-25 13:43:38,756 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,895,716 rows
2025-12-25 13:44:54,117 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,416,358 NBBO records
2025-12-25 13:44:54,118 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,416,358 rows
2025-12-25 13:45:45,803 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,684,309 NBBO records
2025-12-25 13:45:45,803 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,684,309 rows
2025-12-25 13:47:24,926 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,185,844 NBBO records
2025-12-25 13:47:24,926 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,185,844 rows
2025-12-25 13:48:35,184 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,627,275 NBBO records
2025-12-25 13:48:35,184 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,627,275 rows
2025-12-25 13:50:40,418 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,053,099 NBBO records
2025-12-25 13:50:40,418 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,053,099 rows
2025-12-25 13:51:46,564 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,037,504 NBBO records
2025-12-25 13:51:46,564 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,037,504 rows
2025-12-25 13:52:24,249 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,168,275 NBBO records
2025-12-25 13:52:24,249 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,168,275 rows
2025-12-25 13:53:03,018 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,965,480 NBBO records
2025-12-25 13:53:03,018 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,965,480 rows
2025-12-25 13:53:03,272 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 28,405,460 total rows written
2025-12-25 13:54:28,117 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,718,701 NBBO records
2025-12-25 13:54:28,118 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,718,701 rows
2025-12-25 13:54:28,528 INFO [src.stage_a.parquet_writer] ✓ Wrote 33,124,161 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-16
2025-12-25 13:54:28,531 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 13:54:28,531 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 13:54:28,531 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 13:54:28,531 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 13:54:28,531 INFO [src.stage_a.stage_a] Trades: 31,277,145 rows
2025-12-25 13:54:28,531 INFO [src.stage_a.stage_a] Nbbo: 33,124,161 rows
2025-12-25 13:54:28,531 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 13:54:28,531 INFO [src.stage_a.stage_a] Processing date 131/140: 2024-12-17
2025-12-25 13:54:28,531 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 13:54:28,531 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 13:54:28,531 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-12-17 (519 symbols)
2025-12-25 13:54:28,531 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 13:54:28,531 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 13:54:28,531 INFO [src.stage_a.stage_a] Extract run ID: 852855e8-9e09-4310-90fc-cf464b503671
2025-12-25 13:54:28,539 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 13:54:28,539 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 13:54:28,539 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 13:54:28,539 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 13:54:28,539 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 13:54:28,539 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 13:54:28,539 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 13:54:28,539 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 13:54:28,539 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 13:54:30,381 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 13:54:30,381 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-17...
2025-12-25 13:54:30,520 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241217 for 519 symbols
2025-12-25 13:57:33,676 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,958,956 trades
2025-12-25 13:57:33,676 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,958,956 rows
2025-12-25 13:59:04,398 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,191,744 trades
2025-12-25 13:59:04,401 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,191,744 rows
2025-12-25 14:00:46,845 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,498,477 trades
2025-12-25 14:00:46,846 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,498,477 rows
2025-12-25 14:02:30,441 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,004,489 trades
2025-12-25 14:02:30,441 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,004,489 rows
2025-12-25 14:04:26,452 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,978,101 trades
2025-12-25 14:04:26,452 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,978,101 rows
2025-12-25 14:05:17,304 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,352,208 trades
2025-12-25 14:05:17,304 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,352,208 rows
2025-12-25 14:09:00,426 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,829,577 trades
2025-12-25 14:09:00,426 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,829,577 rows
2025-12-25 14:10:59,989 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,558,853 trades
2025-12-25 14:11:00,003 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,558,853 rows
2025-12-25 14:12:57,226 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,537,057 trades
2025-12-25 14:12:57,227 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,537,057 rows
2025-12-25 14:16:29,560 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,500,390 trades
2025-12-25 14:16:29,560 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,500,390 rows
2025-12-25 14:16:30,054 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 30,409,852 total rows written
2025-12-25 14:17:14,396 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,196,575 trades
2025-12-25 14:17:14,406 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,196,575 rows
2025-12-25 14:17:14,746 INFO [src.stage_a.parquet_writer] ✓ Wrote 31,606,427 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-17
2025-12-25 14:17:14,750 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 14:17:14,750 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 14:17:14,750 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 14:17:14,750 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 14:17:14,750 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 14:17:14,750 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 14:17:14,750 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 14:17:16,276 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 14:17:16,276 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-17...
2025-12-25 14:17:16,420 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241217 for 519 symbols
2025-12-25 14:19:50,598 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,970,465 NBBO records
2025-12-25 14:19:50,598 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,970,465 rows
2025-12-25 14:21:04,037 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,101,526 NBBO records
2025-12-25 14:21:04,037 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,101,526 rows
2025-12-25 14:22:44,417 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,019,955 NBBO records
2025-12-25 14:22:44,417 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,019,955 rows
2025-12-25 14:24:15,644 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,017,377 NBBO records
2025-12-25 14:24:15,645 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,017,377 rows
2025-12-25 14:26:29,189 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,444,150 NBBO records
2025-12-25 14:26:29,190 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,444,150 rows
2025-12-25 14:28:24,947 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,107,903 NBBO records
2025-12-25 14:28:24,947 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,107,903 rows
2025-12-25 14:31:23,099 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,495,456 NBBO records
2025-12-25 14:31:23,099 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,495,456 rows
2025-12-25 14:34:04,295 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,888,397 NBBO records
2025-12-25 14:34:04,295 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,888,397 rows
2025-12-25 14:35:52,200 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,391,252 NBBO records
2025-12-25 14:35:52,201 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,391,252 rows
2025-12-25 14:36:47,222 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,407,957 NBBO records
2025-12-25 14:36:47,222 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,407,957 rows
2025-12-25 14:36:47,506 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 32,844,438 total rows written
2025-12-25 14:40:23,945 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,666,979 NBBO records
2025-12-25 14:40:23,945 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,666,979 rows
2025-12-25 14:40:24,444 INFO [src.stage_a.parquet_writer] ✓ Wrote 38,511,417 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-17
2025-12-25 14:40:24,448 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 14:40:24,448 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 14:40:24,448 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 14:40:24,448 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 14:40:24,448 INFO [src.stage_a.stage_a] Trades: 31,606,427 rows
2025-12-25 14:40:24,448 INFO [src.stage_a.stage_a] Nbbo: 38,511,417 rows
2025-12-25 14:40:24,448 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 14:40:24,448 INFO [src.stage_a.stage_a] Processing date 132/140: 2024-12-18
2025-12-25 14:40:24,448 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 14:40:24,448 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 14:40:24,448 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-12-18 (519 symbols)
2025-12-25 14:40:24,448 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 14:40:24,448 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 14:40:24,448 INFO [src.stage_a.stage_a] Extract run ID: 28fee7a4-27c8-4110-8afc-9ae3833eef26
2025-12-25 14:40:24,456 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 14:40:24,456 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 14:40:24,456 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 14:40:24,456 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 14:40:24,456 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 14:40:24,456 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 14:40:24,456 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 14:40:24,456 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 14:40:24,456 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 14:40:26,555 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 14:40:26,555 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-18...
2025-12-25 14:40:26,667 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241218 for 519 symbols
2025-12-25 14:43:01,085 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,149,778 trades
2025-12-25 14:43:01,086 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,149,778 rows
2025-12-25 14:44:56,623 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,460,932 trades
2025-12-25 14:44:56,625 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,460,932 rows
2025-12-25 14:47:26,702 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,647,260 trades
2025-12-25 14:47:26,702 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,647,260 rows
2025-12-25 14:48:55,495 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,180,386 trades
2025-12-25 14:48:55,495 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,180,386 rows
2025-12-25 14:50:39,793 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,027,993 trades
2025-12-25 14:50:39,793 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,027,993 rows
2025-12-25 14:53:37,797 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,836,805 trades
2025-12-25 14:53:37,798 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,836,805 rows
2025-12-25 14:56:34,612 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,165,556 trades
2025-12-25 14:56:34,612 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,165,556 rows
2025-12-25 14:59:42,012 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,947,826 trades
2025-12-25 14:59:42,044 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,947,826 rows
2025-12-25 15:02:05,042 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,005,229 trades
2025-12-25 15:02:05,042 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,005,229 rows
2025-12-25 15:05:52,799 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,990,988 trades
2025-12-25 15:05:52,799 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,990,988 rows
2025-12-25 15:05:53,353 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 33,412,753 total rows written
2025-12-25 15:07:18,752 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,462,276 trades
2025-12-25 15:07:18,760 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,462,276 rows
2025-12-25 15:07:19,201 INFO [src.stage_a.parquet_writer] ✓ Wrote 34,875,029 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-18
2025-12-25 15:07:19,224 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 15:07:19,224 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 15:07:19,224 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 15:07:19,224 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 15:07:19,224 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 15:07:19,224 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 15:07:19,224 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 15:07:20,523 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 15:07:20,523 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-18...
2025-12-25 15:07:20,599 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241218 for 519 symbols
2025-12-25 15:08:33,833 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,430,601 NBBO records
2025-12-25 15:08:33,833 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,430,601 rows
2025-12-25 15:09:06,364 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,814,859 NBBO records
2025-12-25 15:09:06,364 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,814,859 rows
2025-12-25 15:09:52,893 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,838,827 NBBO records
2025-12-25 15:09:52,893 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,838,827 rows
2025-12-25 15:11:03,298 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,282,732 NBBO records
2025-12-25 15:11:03,298 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,282,732 rows
2025-12-25 15:13:04,464 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,114,767 NBBO records
2025-12-25 15:13:04,464 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,114,767 rows
2025-12-25 15:15:08,473 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,542,215 NBBO records
2025-12-25 15:15:08,473 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,542,215 rows
2025-12-25 15:17:33,729 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,325,294 NBBO records
2025-12-25 15:17:33,730 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,325,294 rows
2025-12-25 15:19:56,634 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,540,549 NBBO records
2025-12-25 15:19:56,636 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,540,549 rows
2025-12-25 15:22:26,862 INFO [src.stage_a.wrds_extractor]   Chunk 9: 5,110,443 NBBO records
2025-12-25 15:22:26,863 INFO [src.stage_a.parquet_writer]   Chunk 9: 5,110,443 rows
2025-12-25 15:24:12,686 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,186,340 NBBO records
2025-12-25 15:24:12,687 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,186,340 rows
2025-12-25 15:24:12,998 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 42,186,627 total rows written
2025-12-25 15:27:50,740 INFO [src.stage_a.wrds_extractor]   Chunk 11: 8,084,734 NBBO records
2025-12-25 15:27:50,740 INFO [src.stage_a.parquet_writer]   Chunk 11: 8,084,734 rows
2025-12-25 15:27:51,404 INFO [src.stage_a.parquet_writer] ✓ Wrote 50,271,361 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-18
2025-12-25 15:27:51,409 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 15:27:51,409 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 15:27:51,409 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 15:27:51,409 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 15:27:51,409 INFO [src.stage_a.stage_a] Trades: 34,875,029 rows
2025-12-25 15:27:51,409 INFO [src.stage_a.stage_a] Nbbo: 50,271,361 rows
2025-12-25 15:27:51,409 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 15:27:51,409 INFO [src.stage_a.stage_a] Processing date 133/140: 2024-12-19
2025-12-25 15:27:51,409 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 15:27:51,409 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 15:27:51,409 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-12-19 (519 symbols)
2025-12-25 15:27:51,409 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 15:27:51,409 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 15:27:51,409 INFO [src.stage_a.stage_a] Extract run ID: ae7d5de0-9703-4a72-ad85-574de464dd00
2025-12-25 15:27:51,417 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 15:27:51,417 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 15:27:51,417 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 15:27:51,417 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 15:27:51,417 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 15:27:51,417 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 15:27:51,417 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 15:27:51,417 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 15:27:51,417 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 15:27:53,720 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 15:27:53,720 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-19...
2025-12-25 15:27:53,838 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241219 for 519 symbols
2025-12-25 15:30:58,920 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,950,094 trades
2025-12-25 15:30:58,920 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,950,094 rows
2025-12-25 15:32:15,241 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,529,731 trades
2025-12-25 15:32:15,245 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,529,731 rows
2025-12-25 15:33:19,654 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,745,695 trades
2025-12-25 15:33:19,654 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,745,695 rows
2025-12-25 15:35:25,948 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,193,543 trades
2025-12-25 15:35:25,948 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,193,543 rows
2025-12-25 15:38:19,012 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,068,183 trades
2025-12-25 15:38:19,012 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,068,183 rows
2025-12-25 15:39:43,023 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,987,792 trades
2025-12-25 15:39:43,023 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,987,792 rows
2025-12-25 15:44:26,245 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,141,545 trades
2025-12-25 15:44:26,245 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,141,545 rows
2025-12-25 15:47:11,600 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,018,801 trades
2025-12-25 15:47:11,622 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,018,801 rows
2025-12-25 15:49:53,920 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,950,384 trades
2025-12-25 15:49:53,921 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,950,384 rows
2025-12-25 15:53:54,265 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,452,147 trades
2025-12-25 15:53:54,265 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,452,147 rows
2025-12-25 15:53:54,789 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 33,037,915 total rows written
2025-12-25 15:55:23,858 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,467,457 trades
2025-12-25 15:55:23,865 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,467,457 rows
2025-12-25 15:55:24,287 INFO [src.stage_a.parquet_writer] ✓ Wrote 34,505,372 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-19
2025-12-25 15:55:24,293 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 15:55:24,293 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 15:55:24,293 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 15:55:24,293 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 15:55:24,293 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 15:55:24,293 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 15:55:24,293 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 15:55:26,147 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 15:55:26,148 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-19...
2025-12-25 15:55:26,209 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241219 for 519 symbols
2025-12-25 15:58:54,583 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,397,887 NBBO records
2025-12-25 15:58:54,583 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,397,887 rows
2025-12-25 16:00:38,996 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,017,326 NBBO records
2025-12-25 16:00:38,997 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,017,326 rows
2025-12-25 16:02:59,283 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,677,612 NBBO records
2025-12-25 16:02:59,283 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,677,612 rows
2025-12-25 16:04:48,518 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,559,907 NBBO records
2025-12-25 16:04:48,518 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,559,907 rows
2025-12-25 16:07:28,071 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,279,423 NBBO records
2025-12-25 16:07:28,071 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,279,423 rows
2025-12-25 16:11:04,584 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,237,082 NBBO records
2025-12-25 16:11:04,585 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,237,082 rows
2025-12-25 16:12:53,612 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,767,050 NBBO records
2025-12-25 16:12:53,612 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,767,050 rows
2025-12-25 16:14:14,154 INFO [src.stage_a.wrds_extractor]   Chunk 8: 6,061,798 NBBO records
2025-12-25 16:14:14,156 INFO [src.stage_a.parquet_writer]   Chunk 8: 6,061,798 rows
2025-12-25 16:15:20,930 INFO [src.stage_a.wrds_extractor]   Chunk 9: 6,161,378 NBBO records
2025-12-25 16:15:20,932 INFO [src.stage_a.parquet_writer]   Chunk 9: 6,161,378 rows
2025-12-25 16:15:59,175 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,609,292 NBBO records
2025-12-25 16:15:59,177 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,609,292 rows
2025-12-25 16:15:59,502 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 46,768,755 total rows written
2025-12-25 16:17:42,799 INFO [src.stage_a.wrds_extractor]   Chunk 11: 9,394,839 NBBO records
2025-12-25 16:17:42,800 INFO [src.stage_a.parquet_writer]   Chunk 11: 9,394,839 rows
2025-12-25 16:17:43,635 INFO [src.stage_a.parquet_writer] ✓ Wrote 56,163,594 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-19
2025-12-25 16:17:43,677 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 16:17:43,677 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 16:17:43,677 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 16:17:43,677 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 16:17:43,677 INFO [src.stage_a.stage_a] Trades: 34,505,372 rows
2025-12-25 16:17:43,677 INFO [src.stage_a.stage_a] Nbbo: 56,163,594 rows
2025-12-25 16:17:43,677 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 16:17:43,677 INFO [src.stage_a.stage_a] Processing date 134/140: 2024-12-20
2025-12-25 16:17:43,677 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 16:17:43,677 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 16:17:43,677 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-12-20 (519 symbols)
2025-12-25 16:17:43,677 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 16:17:43,677 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 16:17:43,677 INFO [src.stage_a.stage_a] Extract run ID: bc63e5ce-1e1a-4cdc-93e4-9d6a9758650e
2025-12-25 16:17:43,686 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 16:17:43,686 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 16:17:43,686 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 16:17:43,686 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 16:17:43,686 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 16:17:43,686 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 16:17:43,686 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 16:17:43,686 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 16:17:43,686 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 16:17:44,968 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 16:17:44,968 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-20...
2025-12-25 16:17:45,044 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241220 for 519 symbols
2025-12-25 16:20:01,039 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,842,922 trades
2025-12-25 16:20:01,039 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,842,922 rows
2025-12-25 16:21:26,194 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,471,071 trades
2025-12-25 16:21:26,195 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,471,071 rows
2025-12-25 16:22:56,632 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,580,767 trades
2025-12-25 16:22:56,633 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,580,767 rows
2025-12-25 16:24:11,142 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,194,372 trades
2025-12-25 16:24:11,142 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,194,372 rows
2025-12-25 16:25:44,433 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,946,725 trades
2025-12-25 16:25:44,433 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,946,725 rows
2025-12-25 16:27:14,312 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,706,855 trades
2025-12-25 16:27:14,312 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,706,855 rows
2025-12-25 16:29:10,353 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,774,503 trades
2025-12-25 16:29:10,354 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,774,503 rows
2025-12-25 16:29:54,436 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,895,416 trades
2025-12-25 16:29:54,450 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,895,416 rows
2025-12-25 16:30:40,502 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,923,471 trades
2025-12-25 16:30:40,503 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,923,471 rows
2025-12-25 16:32:01,107 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,069,207 trades
2025-12-25 16:32:01,107 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,069,207 rows
2025-12-25 16:32:01,634 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 31,405,309 total rows written
2025-12-25 16:32:47,139 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,380,208 trades
2025-12-25 16:32:47,147 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,380,208 rows
2025-12-25 16:32:47,601 INFO [src.stage_a.parquet_writer] ✓ Wrote 32,785,517 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-20
2025-12-25 16:32:47,607 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 16:32:47,607 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 16:32:47,607 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 16:32:47,607 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 16:32:47,607 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 16:32:47,607 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 16:32:47,607 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 16:32:49,020 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 16:32:49,020 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-20...
2025-12-25 16:32:49,112 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241220 for 519 symbols
2025-12-25 16:34:32,062 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,657,699 NBBO records
2025-12-25 16:34:32,062 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,657,699 rows
2025-12-25 16:35:45,134 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,165,055 NBBO records
2025-12-25 16:35:45,134 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,165,055 rows
2025-12-25 16:37:23,754 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,071,087 NBBO records
2025-12-25 16:37:23,754 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,071,087 rows
2025-12-25 16:38:20,091 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,427,832 NBBO records
2025-12-25 16:38:20,091 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,427,832 rows
2025-12-25 16:40:04,722 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,658,756 NBBO records
2025-12-25 16:40:04,722 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,658,756 rows
2025-12-25 16:41:57,372 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,954,313 NBBO records
2025-12-25 16:41:57,373 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,954,313 rows
2025-12-25 16:44:03,020 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,770,342 NBBO records
2025-12-25 16:44:03,021 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,770,342 rows
2025-12-25 16:46:05,564 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,606,111 NBBO records
2025-12-25 16:46:05,568 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,606,111 rows
2025-12-25 16:47:29,250 INFO [src.stage_a.wrds_extractor]   Chunk 9: 5,319,402 NBBO records
2025-12-25 16:47:29,251 INFO [src.stage_a.parquet_writer]   Chunk 9: 5,319,402 rows
2025-12-25 16:48:08,496 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,858,405 NBBO records
2025-12-25 16:48:08,498 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,858,405 rows
2025-12-25 16:48:08,824 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 44,489,002 total rows written
2025-12-25 16:50:41,134 INFO [src.stage_a.wrds_extractor]   Chunk 11: 9,136,823 NBBO records
2025-12-25 16:50:41,134 INFO [src.stage_a.parquet_writer]   Chunk 11: 9,136,823 rows
2025-12-25 16:50:41,950 INFO [src.stage_a.parquet_writer] ✓ Wrote 53,625,825 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-20
2025-12-25 16:50:41,965 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 16:50:41,965 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 16:50:41,965 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 16:50:41,965 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 16:50:41,965 INFO [src.stage_a.stage_a] Trades: 32,785,517 rows
2025-12-25 16:50:41,965 INFO [src.stage_a.stage_a] Nbbo: 53,625,825 rows
2025-12-25 16:50:41,965 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 16:50:41,965 INFO [src.stage_a.stage_a] Processing date 135/140: 2024-12-23
2025-12-25 16:50:41,965 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 16:50:41,965 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 16:50:41,965 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-12-23 (519 symbols)
2025-12-25 16:50:41,965 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 16:50:41,965 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 16:50:41,965 INFO [src.stage_a.stage_a] Extract run ID: 89878712-2336-477b-836b-6934bdf57b28
2025-12-25 16:50:41,973 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 16:50:41,973 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 16:50:41,973 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 16:50:41,973 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 16:50:41,973 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 16:50:41,973 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 16:50:41,973 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 16:50:41,973 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 16:50:41,973 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 16:50:43,209 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 16:50:43,209 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-23...
2025-12-25 16:50:43,282 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241223 for 519 symbols
2025-12-25 16:52:30,578 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,100,534 trades
2025-12-25 16:52:30,578 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,100,534 rows
2025-12-25 16:53:41,096 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,861,913 trades
2025-12-25 16:53:41,096 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,861,913 rows
2025-12-25 16:54:59,038 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,947,030 trades
2025-12-25 16:54:59,038 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,947,030 rows
2025-12-25 16:55:51,377 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,522,112 trades
2025-12-25 16:55:51,377 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,522,112 rows
2025-12-25 16:57:08,432 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,176,006 trades
2025-12-25 16:57:08,432 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,176,006 rows
2025-12-25 16:58:22,908 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,042,294 trades
2025-12-25 16:58:22,908 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,042,294 rows
2025-12-25 16:59:49,716 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,627,970 trades
2025-12-25 16:59:49,716 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,627,970 rows
2025-12-25 17:00:23,181 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,174,819 trades
2025-12-25 17:00:23,186 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,174,819 rows
2025-12-25 17:00:54,641 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,052,959 trades
2025-12-25 17:00:54,641 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,052,959 rows
2025-12-25 17:02:48,052 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,080,315 trades
2025-12-25 17:02:48,052 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,080,315 rows
2025-12-25 17:02:48,484 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,585,952 total rows written
2025-12-25 17:03:24,825 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,019,701 trades
2025-12-25 17:03:24,825 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,019,701 rows
2025-12-25 17:03:25,174 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,605,653 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-23
2025-12-25 17:03:25,175 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 17:03:25,175 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 17:03:25,175 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 17:03:25,175 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 17:03:25,175 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 17:03:25,175 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 17:03:25,175 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 17:03:26,706 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 17:03:26,706 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-23...
2025-12-25 17:03:26,870 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241223 for 519 symbols
2025-12-25 17:04:38,330 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,215,849 NBBO records
2025-12-25 17:04:38,330 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,215,849 rows
2025-12-25 17:05:28,169 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,101,441 NBBO records
2025-12-25 17:05:28,169 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,101,441 rows
2025-12-25 17:06:30,649 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,938,502 NBBO records
2025-12-25 17:06:30,649 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,938,502 rows
2025-12-25 17:06:47,733 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,651,167 NBBO records
2025-12-25 17:06:47,733 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,651,167 rows
2025-12-25 17:07:15,003 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,672,130 NBBO records
2025-12-25 17:07:15,004 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,672,130 rows
2025-12-25 17:07:58,309 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,339,474 NBBO records
2025-12-25 17:07:58,309 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,339,474 rows
2025-12-25 17:08:39,662 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,796,399 NBBO records
2025-12-25 17:08:39,662 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,796,399 rows
2025-12-25 17:10:03,993 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,500,396 NBBO records
2025-12-25 17:10:03,994 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,500,396 rows
2025-12-25 17:11:23,112 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,750,498 NBBO records
2025-12-25 17:11:23,113 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,750,498 rows
2025-12-25 17:12:20,022 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,564,208 NBBO records
2025-12-25 17:12:20,022 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,564,208 rows
2025-12-25 17:12:20,279 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 29,530,064 total rows written
2025-12-25 17:14:35,346 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,404,230 NBBO records
2025-12-25 17:14:35,346 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,404,230 rows
2025-12-25 17:14:35,889 INFO [src.stage_a.parquet_writer] ✓ Wrote 35,934,294 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-23
2025-12-25 17:14:35,898 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 17:14:35,898 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 17:14:35,898 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 17:14:35,898 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 17:14:35,898 INFO [src.stage_a.stage_a] Trades: 24,605,653 rows
2025-12-25 17:14:35,898 INFO [src.stage_a.stage_a] Nbbo: 35,934,294 rows
2025-12-25 17:14:35,898 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 17:14:35,898 INFO [src.stage_a.stage_a] Processing date 136/140: 2024-12-24
2025-12-25 17:14:35,898 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 17:14:35,898 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 17:14:35,898 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-12-24 (519 symbols)
2025-12-25 17:14:35,898 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 17:14:35,898 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 17:14:35,898 INFO [src.stage_a.stage_a] Extract run ID: 2882be19-da1c-4d46-b535-071ddc270c8e
2025-12-25 17:14:35,906 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 17:14:35,906 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 17:14:35,906 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 17:14:35,906 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 17:14:35,906 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 17:14:35,906 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 17:14:35,906 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 17:14:35,906 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 17:14:35,906 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 17:14:37,228 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 17:14:37,228 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-24...
2025-12-25 17:14:37,299 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241224 for 519 symbols
2025-12-25 17:15:01,587 INFO [src.stage_a.wrds_extractor]   Chunk 1: 1,701,696 trades
2025-12-25 17:15:01,587 INFO [src.stage_a.parquet_writer]   Chunk 1: 1,701,696 rows
2025-12-25 17:15:15,190 INFO [src.stage_a.wrds_extractor]   Chunk 2: 848,276 trades
2025-12-25 17:15:15,190 INFO [src.stage_a.parquet_writer]   Chunk 2: 848,276 rows
2025-12-25 17:15:30,514 INFO [src.stage_a.wrds_extractor]   Chunk 3: 925,797 trades
2025-12-25 17:15:30,514 INFO [src.stage_a.parquet_writer]   Chunk 3: 925,797 rows
2025-12-25 17:15:42,078 INFO [src.stage_a.wrds_extractor]   Chunk 4: 726,303 trades
2025-12-25 17:15:42,078 INFO [src.stage_a.parquet_writer]   Chunk 4: 726,303 rows
2025-12-25 17:15:59,731 INFO [src.stage_a.wrds_extractor]   Chunk 5: 1,039,487 trades
2025-12-25 17:15:59,731 INFO [src.stage_a.parquet_writer]   Chunk 5: 1,039,487 rows
2025-12-25 17:16:14,514 INFO [src.stage_a.wrds_extractor]   Chunk 6: 968,155 trades
2025-12-25 17:16:14,515 INFO [src.stage_a.parquet_writer]   Chunk 6: 968,155 rows
2025-12-25 17:16:47,352 INFO [src.stage_a.wrds_extractor]   Chunk 7: 1,997,437 trades
2025-12-25 17:16:47,352 INFO [src.stage_a.parquet_writer]   Chunk 7: 1,997,437 rows
2025-12-25 17:17:03,493 INFO [src.stage_a.wrds_extractor]   Chunk 8: 1,101,011 trades
2025-12-25 17:17:03,493 INFO [src.stage_a.parquet_writer]   Chunk 8: 1,101,011 rows
2025-12-25 17:27:30,391 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,132,350 trades
2025-12-25 17:27:30,391 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,132,350 rows
2025-12-25 17:28:34,103 INFO [src.stage_a.wrds_extractor]   Chunk 10: 1,871,410 trades
2025-12-25 17:28:34,103 INFO [src.stage_a.parquet_writer]   Chunk 10: 1,871,410 rows
2025-12-25 17:28:34,403 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 12,311,922 total rows written
2025-12-25 17:28:52,094 INFO [src.stage_a.wrds_extractor]   Chunk 11: 462,008 trades
2025-12-25 17:28:52,094 INFO [src.stage_a.parquet_writer]   Chunk 11: 462,008 rows
2025-12-25 17:28:52,274 INFO [src.stage_a.parquet_writer] ✓ Wrote 12,773,930 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-24
2025-12-25 17:28:52,275 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 17:28:52,275 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 17:28:52,275 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 17:28:52,275 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 17:28:52,275 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 17:28:52,275 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 17:28:52,275 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 17:28:54,144 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 17:28:54,144 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-24...
2025-12-25 17:28:54,220 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241224 for 519 symbols
2025-12-25 17:29:33,609 INFO [src.stage_a.wrds_extractor]   Chunk 1: 1,784,950 NBBO records
2025-12-25 17:29:33,609 INFO [src.stage_a.parquet_writer]   Chunk 1: 1,784,950 rows
2025-12-25 17:29:56,890 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,003,954 NBBO records
2025-12-25 17:29:56,890 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,003,954 rows
2025-12-25 17:30:25,116 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,270,936 NBBO records
2025-12-25 17:30:25,117 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,270,936 rows
2025-12-25 17:30:56,139 INFO [src.stage_a.wrds_extractor]   Chunk 4: 855,386 NBBO records
2025-12-25 17:30:56,139 INFO [src.stage_a.parquet_writer]   Chunk 4: 855,386 rows
2025-12-25 17:31:30,518 INFO [src.stage_a.wrds_extractor]   Chunk 5: 1,509,850 NBBO records
2025-12-25 17:31:30,518 INFO [src.stage_a.parquet_writer]   Chunk 5: 1,509,850 rows
2025-12-25 17:32:06,833 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,620,333 NBBO records
2025-12-25 17:32:06,833 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,620,333 rows
2025-12-25 17:32:54,444 INFO [src.stage_a.wrds_extractor]   Chunk 7: 2,153,819 NBBO records
2025-12-25 17:32:54,444 INFO [src.stage_a.parquet_writer]   Chunk 7: 2,153,819 rows
2025-12-25 17:33:34,089 INFO [src.stage_a.wrds_extractor]   Chunk 8: 1,817,475 NBBO records
2025-12-25 17:33:34,090 INFO [src.stage_a.parquet_writer]   Chunk 8: 1,817,475 rows
2025-12-25 17:34:16,154 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,778,726 NBBO records
2025-12-25 17:34:16,154 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,778,726 rows
2025-12-25 17:34:52,913 INFO [src.stage_a.wrds_extractor]   Chunk 10: 1,546,299 NBBO records
2025-12-25 17:34:52,913 INFO [src.stage_a.parquet_writer]   Chunk 10: 1,546,299 rows
2025-12-25 17:34:53,108 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 15,341,728 total rows written
2025-12-25 17:35:49,496 INFO [src.stage_a.wrds_extractor]   Chunk 11: 2,599,430 NBBO records
2025-12-25 17:35:49,496 INFO [src.stage_a.parquet_writer]   Chunk 11: 2,599,430 rows
2025-12-25 17:35:49,763 INFO [src.stage_a.parquet_writer] ✓ Wrote 17,941,158 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-24
2025-12-25 17:35:49,766 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 17:35:49,766 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 17:35:49,766 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 17:35:49,766 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 17:35:49,766 INFO [src.stage_a.stage_a] Trades: 12,773,930 rows
2025-12-25 17:35:49,766 INFO [src.stage_a.stage_a] Nbbo: 17,941,158 rows
2025-12-25 17:35:49,766 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 17:35:49,766 INFO [src.stage_a.stage_a] Processing date 137/140: 2024-12-26
2025-12-25 17:35:49,766 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 17:35:49,766 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 17:35:49,766 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-12-26 (519 symbols)
2025-12-25 17:35:49,767 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 17:35:49,767 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 17:35:49,767 INFO [src.stage_a.stage_a] Extract run ID: 2d9d3701-413a-4cd3-8fe8-97a07240b0bf
2025-12-25 17:35:49,775 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 17:35:49,775 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 17:35:49,775 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 17:35:49,775 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 17:35:49,775 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 17:35:49,775 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 17:35:49,775 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 17:35:49,775 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 17:35:49,775 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 17:35:58,040 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 17:35:58,040 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-26...
2025-12-25 17:35:58,122 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241226 for 519 symbols
2025-12-25 17:36:31,079 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,230,007 trades
2025-12-25 17:36:31,079 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,230,007 rows
2025-12-25 17:36:50,123 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,212,859 trades
2025-12-25 17:36:50,123 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,212,859 rows
2025-12-25 17:37:13,458 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,368,930 trades
2025-12-25 17:37:13,458 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,368,930 rows
2025-12-25 17:37:30,018 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,100,282 trades
2025-12-25 17:37:30,018 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,100,282 rows
2025-12-25 17:38:08,511 INFO [src.stage_a.wrds_extractor]   Chunk 5: 1,474,975 trades
2025-12-25 17:38:08,511 INFO [src.stage_a.parquet_writer]   Chunk 5: 1,474,975 rows
2025-12-25 17:38:59,773 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,420,942 trades
2025-12-25 17:38:59,773 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,420,942 rows
2025-12-25 17:40:31,544 INFO [src.stage_a.wrds_extractor]   Chunk 7: 2,528,234 trades
2025-12-25 17:40:31,545 INFO [src.stage_a.parquet_writer]   Chunk 7: 2,528,234 rows
2025-12-25 17:41:28,258 INFO [src.stage_a.wrds_extractor]   Chunk 8: 1,573,149 trades
2025-12-25 17:41:28,259 INFO [src.stage_a.parquet_writer]   Chunk 8: 1,573,149 rows
2025-12-25 17:42:24,093 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,536,813 trades
2025-12-25 17:42:24,093 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,536,813 rows
2025-12-25 17:43:56,868 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,467,508 trades
2025-12-25 17:43:56,868 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,467,508 rows
2025-12-25 17:43:57,237 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 16,913,699 total rows written
2025-12-25 17:44:25,938 INFO [src.stage_a.wrds_extractor]   Chunk 11: 709,535 trades
2025-12-25 17:44:25,938 INFO [src.stage_a.parquet_writer]   Chunk 11: 709,535 rows
2025-12-25 17:44:26,164 INFO [src.stage_a.parquet_writer] ✓ Wrote 17,623,234 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-26
2025-12-25 17:44:26,165 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 17:44:26,165 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 17:44:26,165 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 17:44:26,165 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 17:44:26,165 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 17:44:26,165 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 17:44:26,165 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 17:44:27,553 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 17:44:27,554 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-26...
2025-12-25 17:44:27,615 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241226 for 519 symbols
2025-12-25 17:45:21,334 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,335,456 NBBO records
2025-12-25 17:45:21,334 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,335,456 rows
2025-12-25 17:46:02,027 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,576,678 NBBO records
2025-12-25 17:46:02,027 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,576,678 rows
2025-12-25 17:46:48,815 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,036,810 NBBO records
2025-12-25 17:46:48,815 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,036,810 rows
2025-12-25 17:47:21,426 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,379,749 NBBO records
2025-12-25 17:47:21,426 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,379,749 rows
2025-12-25 17:48:20,845 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,214,493 NBBO records
2025-12-25 17:48:20,845 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,214,493 rows
2025-12-25 17:49:16,707 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,596,382 NBBO records
2025-12-25 17:49:16,707 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,596,382 rows
2025-12-25 17:50:22,480 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,092,046 NBBO records
2025-12-25 17:50:22,480 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,092,046 rows
2025-12-25 17:51:24,248 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,684,653 NBBO records
2025-12-25 17:51:24,248 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,684,653 rows
2025-12-25 17:52:19,223 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,523,293 NBBO records
2025-12-25 17:52:19,223 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,523,293 rows
2025-12-25 17:53:10,497 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,354,313 NBBO records
2025-12-25 17:53:10,497 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,354,313 rows
2025-12-25 17:53:10,737 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 22,793,873 total rows written
2025-12-25 17:55:02,076 INFO [src.stage_a.wrds_extractor]   Chunk 11: 4,740,281 NBBO records
2025-12-25 17:55:02,076 INFO [src.stage_a.parquet_writer]   Chunk 11: 4,740,281 rows
2025-12-25 17:55:02,493 INFO [src.stage_a.parquet_writer] ✓ Wrote 27,534,154 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-26
2025-12-25 17:55:02,496 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 17:55:02,496 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 17:55:02,496 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 17:55:02,496 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 17:55:02,496 INFO [src.stage_a.stage_a] Trades: 17,623,234 rows
2025-12-25 17:55:02,496 INFO [src.stage_a.stage_a] Nbbo: 27,534,154 rows
2025-12-25 17:55:02,496 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 17:55:02,496 INFO [src.stage_a.stage_a] Processing date 138/140: 2024-12-27
2025-12-25 17:55:02,496 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 17:55:02,496 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 17:55:02,497 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-12-27 (519 symbols)
2025-12-25 17:55:02,497 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 17:55:02,497 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 17:55:02,497 INFO [src.stage_a.stage_a] Extract run ID: 1c62badb-0ea0-44d4-a9b7-257468b0db5f
2025-12-25 17:55:02,505 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 17:55:02,505 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 17:55:02,505 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 17:55:02,505 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 17:55:02,505 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 17:55:02,505 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 17:55:02,505 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 17:55:02,505 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 17:55:02,505 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 17:55:04,047 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 17:55:04,048 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-27...
2025-12-25 17:55:04,123 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241227 for 519 symbols
2025-12-25 17:56:36,600 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,717,244 trades
2025-12-25 17:56:36,601 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,717,244 rows
2025-12-25 17:57:27,484 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,440,166 trades
2025-12-25 17:57:27,484 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,440,166 rows
2025-12-25 17:58:21,092 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,577,423 trades
2025-12-25 17:58:21,092 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,577,423 rows
2025-12-25 17:58:49,290 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,289,367 trades
2025-12-25 17:58:49,290 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,289,367 rows
2025-12-25 17:59:22,258 INFO [src.stage_a.wrds_extractor]   Chunk 5: 1,817,622 trades
2025-12-25 17:59:22,258 INFO [src.stage_a.parquet_writer]   Chunk 5: 1,817,622 rows
2025-12-25 17:59:51,559 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,599,174 trades
2025-12-25 17:59:51,559 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,599,174 rows
2025-12-25 18:01:06,864 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,315,537 trades
2025-12-25 18:01:06,864 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,315,537 rows
2025-12-25 18:02:16,025 INFO [src.stage_a.wrds_extractor]   Chunk 8: 1,951,133 trades
2025-12-25 18:02:16,025 INFO [src.stage_a.parquet_writer]   Chunk 8: 1,951,133 rows
2025-12-25 18:03:23,582 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,855,641 trades
2025-12-25 18:03:23,582 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,855,641 rows
2025-12-25 18:04:56,622 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,835,001 trades
2025-12-25 18:04:56,622 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,835,001 rows
2025-12-25 18:04:57,024 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 20,398,308 total rows written
2025-12-25 18:05:26,442 INFO [src.stage_a.wrds_extractor]   Chunk 11: 912,679 trades
2025-12-25 18:05:26,442 INFO [src.stage_a.parquet_writer]   Chunk 11: 912,679 rows
2025-12-25 18:05:26,742 INFO [src.stage_a.parquet_writer] ✓ Wrote 21,310,987 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-27
2025-12-25 18:05:26,743 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 18:05:26,743 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 18:05:26,743 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 18:05:26,743 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 18:05:26,743 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 18:05:26,743 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 18:05:26,743 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 18:05:41,965 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 18:05:41,965 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-27...
2025-12-25 18:05:42,074 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241227 for 519 symbols
2025-12-25 18:06:17,729 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,388,647 NBBO records
2025-12-25 18:06:17,729 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,388,647 rows
2025-12-25 18:06:39,726 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,092,913 NBBO records
2025-12-25 18:06:39,727 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,092,913 rows
2025-12-25 18:07:53,320 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,271,209 NBBO records
2025-12-25 18:07:53,321 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,271,209 rows
2025-12-25 18:08:37,254 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,932,173 NBBO records
2025-12-25 18:08:37,254 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,932,173 rows
2025-12-25 18:09:46,946 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,241,191 NBBO records
2025-12-25 18:09:46,946 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,241,191 rows
2025-12-25 18:11:12,461 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,810,262 NBBO records
2025-12-25 18:11:12,461 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,810,262 rows
2025-12-25 18:13:09,148 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,013,801 NBBO records
2025-12-25 18:13:09,148 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,013,801 rows
2025-12-25 18:14:38,251 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,304,481 NBBO records
2025-12-25 18:14:38,252 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,304,481 rows
2025-12-25 18:15:55,937 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,775,778 NBBO records
2025-12-25 18:15:55,937 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,775,778 rows
2025-12-25 18:16:54,410 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,852,910 NBBO records
2025-12-25 18:16:54,411 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,852,910 rows
2025-12-25 18:16:54,681 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 33,683,365 total rows written
2025-12-25 18:19:50,917 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,586,393 NBBO records
2025-12-25 18:19:50,917 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,586,393 rows
2025-12-25 18:19:51,537 INFO [src.stage_a.parquet_writer] ✓ Wrote 41,269,758 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-27
2025-12-25 18:19:51,544 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 18:19:51,548 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 18:19:51,548 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 18:19:51,548 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 18:19:51,548 INFO [src.stage_a.stage_a] Trades: 21,310,987 rows
2025-12-25 18:19:51,548 INFO [src.stage_a.stage_a] Nbbo: 41,269,758 rows
2025-12-25 18:19:51,548 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 18:19:51,548 INFO [src.stage_a.stage_a] Processing date 139/140: 2024-12-30
2025-12-25 18:19:51,548 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 18:19:51,548 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 18:19:51,548 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-12-30 (519 symbols)
2025-12-25 18:19:51,548 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 18:19:51,548 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 18:19:51,548 INFO [src.stage_a.stage_a] Extract run ID: af7c6ef4-c46a-41ca-be59-6a43106436cc
2025-12-25 18:19:51,556 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 18:19:51,556 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 18:19:51,556 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 18:19:51,556 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 18:19:51,556 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 18:19:51,556 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 18:19:51,556 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 18:19:51,556 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 18:19:51,556 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 18:19:53,451 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 18:19:53,451 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-30...
2025-12-25 18:19:53,520 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241230 for 519 symbols
2025-12-25 18:21:16,705 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,718,706 trades
2025-12-25 18:21:16,705 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,718,706 rows
2025-12-25 18:22:17,755 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,671,022 trades
2025-12-25 18:22:17,755 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,671,022 rows
2025-12-25 18:22:51,409 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,794,358 trades
2025-12-25 18:22:51,409 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,794,358 rows
2025-12-25 18:23:20,284 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,518,522 trades
2025-12-25 18:23:20,284 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,518,522 rows
2025-12-25 18:24:08,885 INFO [src.stage_a.wrds_extractor]   Chunk 5: 1,888,414 trades
2025-12-25 18:24:08,885 INFO [src.stage_a.parquet_writer]   Chunk 5: 1,888,414 rows
2025-12-25 18:25:06,787 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,783,471 trades
2025-12-25 18:25:06,787 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,783,471 rows
2025-12-25 18:26:54,381 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,453,948 trades
2025-12-25 18:26:54,381 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,453,948 rows
2025-12-25 18:27:57,167 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,104,210 trades
2025-12-25 18:27:57,168 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,104,210 rows
2025-12-25 18:29:05,290 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,996,671 trades
2025-12-25 18:29:05,290 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,996,671 rows
2025-12-25 18:30:12,031 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,795,864 trades
2025-12-25 18:30:12,031 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,795,864 rows
2025-12-25 18:30:12,428 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 21,725,186 total rows written
2025-12-25 18:30:40,163 INFO [src.stage_a.wrds_extractor]   Chunk 11: 916,550 trades
2025-12-25 18:30:40,163 INFO [src.stage_a.parquet_writer]   Chunk 11: 916,550 rows
2025-12-25 18:30:40,455 INFO [src.stage_a.parquet_writer] ✓ Wrote 22,641,736 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-30
2025-12-25 18:30:40,456 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 18:30:40,456 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 18:30:40,456 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 18:30:40,456 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 18:30:40,456 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 18:30:40,456 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 18:30:40,456 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 18:30:41,876 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 18:30:41,876 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-30...
2025-12-25 18:30:41,945 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241230 for 519 symbols
2025-12-25 18:31:49,797 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,403,469 NBBO records
2025-12-25 18:31:49,797 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,403,469 rows
2025-12-25 18:32:34,495 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,217,901 NBBO records
2025-12-25 18:32:34,495 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,217,901 rows
2025-12-25 18:33:43,726 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,326,964 NBBO records
2025-12-25 18:33:43,726 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,326,964 rows
2025-12-25 18:34:26,283 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,931,716 NBBO records
2025-12-25 18:34:26,283 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,931,716 rows
2025-12-25 18:35:17,038 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,426,236 NBBO records
2025-12-25 18:35:17,038 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,426,236 rows
2025-12-25 18:36:32,864 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,213,982 NBBO records
2025-12-25 18:36:32,864 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,213,982 rows
2025-12-25 18:38:06,657 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,372,627 NBBO records
2025-12-25 18:38:06,657 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,372,627 rows
2025-12-25 18:39:26,149 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,862,974 NBBO records
2025-12-25 18:39:26,149 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,862,974 rows
2025-12-25 18:41:01,595 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,179,112 NBBO records
2025-12-25 18:41:01,595 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,179,112 rows
2025-12-25 18:42:00,290 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,747,440 NBBO records
2025-12-25 18:42:00,291 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,747,440 rows
2025-12-25 18:42:00,553 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 32,682,421 total rows written
2025-12-25 18:44:31,592 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,361,521 NBBO records
2025-12-25 18:44:31,592 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,361,521 rows
2025-12-25 18:44:32,184 INFO [src.stage_a.parquet_writer] ✓ Wrote 40,043,942 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-30
2025-12-25 18:44:32,192 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 18:44:32,192 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 18:44:32,192 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 18:44:32,192 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 18:44:32,192 INFO [src.stage_a.stage_a] Trades: 22,641,736 rows
2025-12-25 18:44:32,192 INFO [src.stage_a.stage_a] Nbbo: 40,043,942 rows
2025-12-25 18:44:32,192 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 18:44:32,192 INFO [src.stage_a.stage_a] Processing date 140/140: 2024-12-31
2025-12-25 18:44:32,192 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 18:44:32,192 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 18:44:32,192 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-12-31 (519 symbols)
2025-12-25 18:44:32,192 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 18:44:32,192 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 18:44:32,192 INFO [src.stage_a.stage_a] Extract run ID: bd2bea15-1b5e-4afc-8100-c4091b161357
2025-12-25 18:44:32,200 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 18:44:32,200 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 18:44:32,200 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 18:44:32,200 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 18:44:32,200 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 18:44:32,200 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 18:44:32,200 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 18:44:32,200 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 18:44:32,200 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 18:44:33,575 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 18:44:33,575 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-31...
2025-12-25 18:44:33,640 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20241231 for 519 symbols
2025-12-25 18:46:02,249 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,367,539 trades
2025-12-25 18:46:02,249 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,367,539 rows
2025-12-25 18:46:51,845 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,458,488 trades
2025-12-25 18:46:51,845 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,458,488 rows
2025-12-25 18:47:46,528 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,640,014 trades
2025-12-25 18:47:46,528 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,640,014 rows
2025-12-25 18:48:31,979 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,368,298 trades
2025-12-25 18:48:31,979 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,368,298 rows
2025-12-25 18:49:31,885 INFO [src.stage_a.wrds_extractor]   Chunk 5: 1,747,395 trades
2025-12-25 18:49:31,886 INFO [src.stage_a.parquet_writer]   Chunk 5: 1,747,395 rows
2025-12-25 18:50:28,216 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,599,869 trades
2025-12-25 18:50:28,216 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,599,869 rows
2025-12-25 18:52:18,408 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,097,226 trades
2025-12-25 18:52:18,408 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,097,226 rows
2025-12-25 18:53:19,469 INFO [src.stage_a.wrds_extractor]   Chunk 8: 1,867,335 trades
2025-12-25 18:53:19,469 INFO [src.stage_a.parquet_writer]   Chunk 8: 1,867,335 rows
2025-12-25 18:54:20,379 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,773,890 trades
2025-12-25 18:54:20,379 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,773,890 rows
2025-12-25 18:55:56,435 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,724,957 trades
2025-12-25 18:55:56,435 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,724,957 rows
2025-12-25 18:55:56,830 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 19,645,011 total rows written
2025-12-25 18:56:17,387 INFO [src.stage_a.wrds_extractor]   Chunk 11: 819,659 trades
2025-12-25 18:56:17,387 INFO [src.stage_a.parquet_writer]   Chunk 11: 819,659 rows
2025-12-25 18:56:17,654 INFO [src.stage_a.parquet_writer] ✓ Wrote 20,464,670 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-12-31
2025-12-25 18:56:17,655 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 18:56:17,655 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 18:56:17,655 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 18:56:17,655 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 18:56:17,655 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 18:56:17,655 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 18:56:17,655 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 18:56:18,765 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 18:56:18,765 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-31...
2025-12-25 18:56:18,819 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20241231 for 519 symbols
2025-12-25 18:56:57,897 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,494,808 NBBO records
2025-12-25 18:56:57,897 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,494,808 rows
2025-12-25 18:57:18,042 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,033,038 NBBO records
2025-12-25 18:57:18,042 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,033,038 rows
2025-12-25 18:58:41,171 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,525,093 NBBO records
2025-12-25 18:58:41,171 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,525,093 rows
2025-12-25 18:59:23,836 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,932,908 NBBO records
2025-12-25 18:59:23,836 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,932,908 rows
2025-12-25 19:00:37,505 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,372,523 NBBO records
2025-12-25 19:00:37,506 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,372,523 rows
2025-12-25 19:01:49,758 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,334,196 NBBO records
2025-12-25 19:01:49,758 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,334,196 rows
2025-12-25 19:03:05,829 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,568,064 NBBO records
2025-12-25 19:03:05,830 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,568,064 rows
2025-12-25 19:03:48,022 INFO [src.stage_a.wrds_extractor]   Chunk 8: 4,110,699 NBBO records
2025-12-25 19:03:48,023 INFO [src.stage_a.parquet_writer]   Chunk 8: 4,110,699 rows
2025-12-25 19:04:31,996 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,285,855 NBBO records
2025-12-25 19:04:31,996 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,285,855 rows
2025-12-25 19:05:01,035 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,739,462 NBBO records
2025-12-25 19:05:01,035 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,739,462 rows
2025-12-25 19:05:01,295 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 33,396,646 total rows written
2025-12-25 19:06:52,285 INFO [src.stage_a.wrds_extractor]   Chunk 11: 8,059,213 NBBO records
2025-12-25 19:06:52,285 INFO [src.stage_a.parquet_writer]   Chunk 11: 8,059,213 rows
2025-12-25 19:06:52,922 INFO [src.stage_a.parquet_writer] ✓ Wrote 41,455,859 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-12-31
2025-12-25 19:06:52,927 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 19:06:52,927 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 19:06:52,927 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 19:06:52,927 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 19:06:52,927 INFO [src.stage_a.stage_a] Trades: 20,464,670 rows
2025-12-25 19:06:52,927 INFO [src.stage_a.stage_a] Nbbo: 41,455,859 rows
2025-12-25 19:06:52,927 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 19:06:52,927 INFO [src.stage_a.stage_a] Date Range Extraction Summary
2025-12-25 19:06:52,927 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 19:06:52,927 INFO [src.stage_a.stage_a] Dates processed: 140
2025-12-25 19:06:52,927 INFO [src.stage_a.stage_a] Dates skipped: 5
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a] 
Total rows extracted:
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   Trades: 3,808,778,703 rows
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   Nbbo: 6,293,983,755 rows
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a] 
Per-date breakdown:
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-06-12: trades: 30,757,277, nbbo: 50,407,807
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-06-13: trades: 25,744,393, nbbo: 36,945,034
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-06-14: trades: 24,801,434, nbbo: 33,780,047
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-06-17: trades: 27,880,520, nbbo: 36,406,347
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-06-18: trades: 26,994,871, nbbo: 33,225,040
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-06-20: trades: 31,587,830, nbbo: 43,490,181
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-06-21: trades: 29,480,202, nbbo: 39,678,302
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-06-24: trades: 28,712,268, nbbo: 40,684,136
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-06-25: trades: 24,824,953, nbbo: 35,022,039
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-06-26: trades: 25,608,659, nbbo: 35,792,670
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-06-27: trades: 25,234,240, nbbo: 36,199,143
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-06-28: trades: 30,111,522, nbbo: 46,202,047
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-07-01: trades: 26,846,229, nbbo: 40,874,640
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-07-02: trades: 24,308,919, nbbo: 35,488,745
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-07-03: trades: 17,673,667, nbbo: 23,372,198
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-07-05: trades: 23,849,984, nbbo: 31,460,540
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-07-08: trades: 24,602,411, nbbo: 33,848,690
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-07-09: trades: 24,476,432, nbbo: 33,123,805
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-07-10: trades: 24,038,816, nbbo: 32,065,024
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-07-11: trades: 31,333,654, nbbo: 49,646,190
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-07-12: trades: 26,740,335, nbbo: 38,563,893
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-07-15: trades: 27,036,924, nbbo: 42,195,916
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-07-16: trades: 27,696,567, nbbo: 41,858,452
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-07-17: trades: 35,119,433, nbbo: 53,682,090
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-07-18: trades: 32,499,501, nbbo: 56,506,635
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-07-19: trades: 26,266,218, nbbo: 46,875,147
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-07-22: trades: 25,676,781, nbbo: 43,187,885
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-07-23: trades: 24,785,811, nbbo: 38,792,414
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-07-24: trades: 32,956,414, nbbo: 46,676,702
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-07-25: trades: 36,480,597, nbbo: 60,979,980
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-07-26: trades: 27,955,781, nbbo: 49,884,524
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-07-29: trades: 25,480,772, nbbo: 45,045,762
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-07-30: trades: 30,419,426, nbbo: 48,921,698
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-07-31: trades: 32,457,159, nbbo: 53,584,711
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-08-01: trades: 36,963,866, nbbo: 61,004,597
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-08-02: trades: 41,896,772, nbbo: 67,188,970
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-08-05: trades: 45,823,552, nbbo: 77,404,768
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-08-06: trades: 33,573,110, nbbo: 62,797,693
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-08-07: trades: 31,842,694, nbbo: 59,086,804
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-08-08: trades: 28,328,788, nbbo: 51,020,135
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-08-09: trades: 23,739,726, nbbo: 44,841,303
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-08-12: trades: 24,117,955, nbbo: 43,851,441
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-08-13: trades: 26,420,386, nbbo: 36,356,346
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-08-14: trades: 24,188,768, nbbo: 39,071,319
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-08-15: trades: 26,874,522, nbbo: 36,033,837
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-08-16: trades: 22,785,218, nbbo: 33,921,474
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-08-19: trades: 22,353,400, nbbo: 30,529,264
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-08-20: trades: 22,469,379, nbbo: 33,493,965
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-08-21: trades: 21,620,566, nbbo: 37,955,885
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-08-22: trades: 23,478,180, nbbo: 46,254,745
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-08-23: trades: 23,403,785, nbbo: 49,144,779
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-08-26: trades: 22,206,136, nbbo: 36,054,766
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-08-27: trades: 20,638,726, nbbo: 30,442,772
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-08-28: trades: 23,523,532, nbbo: 37,968,052
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-08-29: trades: 25,818,708, nbbo: 45,855,290
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-08-30: trades: 24,150,938, nbbo: 39,025,701
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-09-03: trades: 33,316,742, nbbo: 45,964,483
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-09-04: trades: 27,672,467, nbbo: 45,668,185
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-09-05: trades: 27,564,348, nbbo: 44,076,522
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-09-06: trades: 30,452,079, nbbo: 53,961,846
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-09-09: trades: 28,277,180, nbbo: 39,815,884
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-09-10: trades: 27,228,121, nbbo: 43,382,896
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-09-11: trades: 29,586,766, nbbo: 56,278,182
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-09-12: trades: 27,302,243, nbbo: 48,715,899
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-09-13: trades: 24,831,757, nbbo: 41,235,307
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-09-16: trades: 25,158,001, nbbo: 37,768,387
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-09-17: trades: 25,601,689, nbbo: 47,021,025
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-09-18: trades: 28,210,295, nbbo: 62,554,701
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-09-19: trades: 29,905,346, nbbo: 46,491,130
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-09-20: trades: 30,245,318, nbbo: 46,158,177
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-09-23: trades: 24,661,644, nbbo: 38,254,735
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-09-24: trades: 25,327,803, nbbo: 38,936,817
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-09-25: trades: 24,363,480, nbbo: 37,564,391
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-09-26: trades: 29,118,192, nbbo: 45,900,381
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-09-27: trades: 25,104,624, nbbo: 39,637,540
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-09-30: trades: 25,113,491, nbbo: 41,365,664
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-10-01: trades: 29,646,850, nbbo: 57,741,360
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-10-02: trades: 24,446,754, nbbo: 38,861,849
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-10-03: trades: 24,208,235, nbbo: 43,005,083
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-10-04: trades: 25,225,357, nbbo: 43,841,196
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-10-07: trades: 26,454,739, nbbo: 42,990,628
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-10-08: trades: 24,085,843, nbbo: 46,445,349
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-10-09: trades: 24,359,859, nbbo: 53,047,362
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-10-10: trades: 23,325,063, nbbo: 61,367,834
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-10-11: trades: 23,941,277, nbbo: 51,141,814
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-10-14: trades: 23,127,567, nbbo: 50,575,527
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-10-15: trades: 31,306,210, nbbo: 72,107,190
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-10-16: trades: 24,892,589, nbbo: 52,375,432
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-10-17: trades: 25,465,980, nbbo: 55,933,352
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-10-18: trades: 22,780,916, nbbo: 46,493,098
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-10-21: trades: 23,408,827, nbbo: 49,713,816
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-10-22: trades: 24,049,497, nbbo: 47,984,880
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-10-23: trades: 27,102,656, nbbo: 57,682,556
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-10-24: trades: 25,910,793, nbbo: 48,008,866
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-10-25: trades: 26,453,748, nbbo: 53,594,658
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-10-28: trades: 24,790,869, nbbo: 47,119,343
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-10-29: trades: 27,492,985, nbbo: 48,777,044
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-10-30: trades: 30,606,336, nbbo: 52,215,722
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-10-31: trades: 34,173,669, nbbo: 65,233,058
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-11-01: trades: 29,712,657, nbbo: 63,365,323
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-11-04: trades: 27,202,705, nbbo: 58,221,192
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-11-05: trades: 24,955,987, nbbo: 56,439,199
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-11-06: trades: 44,878,712, nbbo: 81,757,065
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-11-07: trades: 33,240,520, nbbo: 60,969,205
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-11-08: trades: 31,129,704, nbbo: 53,464,660
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-11-11: trades: 29,770,870, nbbo: 52,180,665
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-11-12: trades: 28,854,744, nbbo: 57,245,978
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-11-13: trades: 27,307,390, nbbo: 59,376,545
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-11-14: trades: 28,548,298, nbbo: 60,806,369
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-11-15: trades: 32,620,829, nbbo: 64,207,370
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-11-18: trades: 28,096,342, nbbo: 43,998,597
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-11-19: trades: 26,081,123, nbbo: 43,147,947
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-11-20: trades: 25,870,190, nbbo: 46,768,019
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-11-21: trades: 29,585,959, nbbo: 52,330,563
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-11-22: trades: 27,155,698, nbbo: 40,519,000
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-11-25: trades: 31,758,063, nbbo: 44,498,664
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-11-26: trades: 26,261,124, nbbo: 36,615,045
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-11-27: trades: 22,689,258, nbbo: 30,449,598
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-11-29: trades: 14,678,073, nbbo: 18,773,608
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-12-02: trades: 27,225,854, nbbo: 33,788,355
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-12-03: trades: 24,620,829, nbbo: 31,118,052
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-12-04: trades: 26,011,137, nbbo: 31,473,748
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-12-05: trades: 26,437,482, nbbo: 32,864,067
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-12-06: trades: 26,162,523, nbbo: 31,252,367
2025-12-25 19:06:52,928 INFO [src.stage_a.stage_a]   2024-12-09: trades: 30,462,572, nbbo: 36,873,108
2025-12-25 19:06:52,929 INFO [src.stage_a.stage_a]   2024-12-10: trades: 29,749,644, nbbo: 37,139,935
2025-12-25 19:06:52,929 INFO [src.stage_a.stage_a]   2024-12-11: trades: 28,187,018, nbbo: 32,801,608
2025-12-25 19:06:52,929 INFO [src.stage_a.stage_a]   2024-12-12: trades: 25,295,478, nbbo: 31,946,436
2025-12-25 19:06:52,929 INFO [src.stage_a.stage_a]   2024-12-13: trades: 26,801,308, nbbo: 32,934,435
2025-12-25 19:06:52,929 INFO [src.stage_a.stage_a]   2024-12-16: trades: 31,277,145, nbbo: 33,124,161
2025-12-25 19:06:52,929 INFO [src.stage_a.stage_a]   2024-12-17: trades: 31,606,427, nbbo: 38,511,417
2025-12-25 19:06:52,929 INFO [src.stage_a.stage_a]   2024-12-18: trades: 34,875,029, nbbo: 50,271,361
2025-12-25 19:06:52,929 INFO [src.stage_a.stage_a]   2024-12-19: trades: 34,505,372, nbbo: 56,163,594
2025-12-25 19:06:52,929 INFO [src.stage_a.stage_a]   2024-12-20: trades: 32,785,517, nbbo: 53,625,825
2025-12-25 19:06:52,929 INFO [src.stage_a.stage_a]   2024-12-23: trades: 24,605,653, nbbo: 35,934,294
2025-12-25 19:06:52,929 INFO [src.stage_a.stage_a]   2024-12-24: trades: 12,773,930, nbbo: 17,941,158
2025-12-25 19:06:52,929 INFO [src.stage_a.stage_a]   2024-12-26: trades: 17,623,234, nbbo: 27,534,154
2025-12-25 19:06:52,929 INFO [src.stage_a.stage_a]   2024-12-27: trades: 21,310,987, nbbo: 41,269,758
2025-12-25 19:06:52,929 INFO [src.stage_a.stage_a]   2024-12-30: trades: 22,641,736, nbbo: 40,043,942
2025-12-25 19:06:52,929 INFO [src.stage_a.stage_a]   2024-12-31: trades: 20,464,670, nbbo: 41,455,859
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
