2025-12-22 07:55:31,499 INFO [__main__] Loaded config from config.yaml
2025-12-22 07:55:31,499 INFO [__main__]   Parquet root: /home/mingyuan/data/taq/parquet_raw
2025-12-22 07:55:31,499 INFO [__main__]   CSV root: None
2025-12-22 07:55:31,499 INFO [__main__] No --symbols provided. Fetching S&P 500 constituents + top ETFs...
2025-12-22 07:55:31,499 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 07:55:32,630 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 07:55:32,630 INFO [src.stage_a.wrds_extractor] Fetching S&P 500 constituents as of 2024-01-01...
2025-12-22 07:55:32,700 INFO [src.stage_a.wrds_extractor] ✓ Found 503 S&P 500 stocks
2025-12-22 07:55:32,700 INFO [src.stage_a.wrds_extractor] Adding 16 top ETFs...
2025-12-22 07:55:32,700 INFO [src.stage_a.wrds_extractor] ✓ Total symbols: 519 (503 stocks + 16 ETFs)
2025-12-22 07:55:32,701 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 07:55:32,701 INFO [__main__] Will process 519 symbols (S&P 500 + ETFs)
2025-12-22 07:55:32,701 INFO [__main__] Extracting default data types: trades, nbbo
2025-12-22 07:55:32,701 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 07:55:32,701 INFO [src.stage_a.stage_a] Stage A: Extract raw data for date range 2024-01-01 to 2024-04-30 (inclusive)
2025-12-22 07:55:32,701 INFO [src.stage_a.stage_a] Symbols: 519
2025-12-22 07:55:32,701 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 07:55:32,701 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 07:55:32,701 INFO [src.stage_a.stage_a] Total dates in range: 121
2025-12-22 07:55:32,701 INFO [src.stage_a.stage_a] Trading days (weekdays): 87
2025-12-22 07:55:32,701 INFO [src.stage_a.stage_a] 
Checking TAQ table availability...
2025-12-22 07:55:32,701 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 07:55:33,856 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 07:55:33,873 INFO [src.stage_a.stage_a]   ✗ 2024-01-01: Tables not available (skipping)
2025-12-22 07:55:34,058 INFO [src.stage_a.stage_a]   ✓ 2024-01-02: Tables available
2025-12-22 07:55:34,141 INFO [src.stage_a.stage_a]   ✓ 2024-01-03: Tables available
2025-12-22 07:55:34,225 INFO [src.stage_a.stage_a]   ✓ 2024-01-04: Tables available
2025-12-22 07:55:34,345 INFO [src.stage_a.stage_a]   ✓ 2024-01-05: Tables available
2025-12-22 07:55:34,470 INFO [src.stage_a.stage_a]   ✓ 2024-01-08: Tables available
2025-12-22 07:55:34,551 INFO [src.stage_a.stage_a]   ✓ 2024-01-09: Tables available
2025-12-22 07:55:34,630 INFO [src.stage_a.stage_a]   ✓ 2024-01-10: Tables available
2025-12-22 07:55:34,705 INFO [src.stage_a.stage_a]   ✓ 2024-01-11: Tables available
2025-12-22 07:55:34,773 INFO [src.stage_a.stage_a]   ✓ 2024-01-12: Tables available
2025-12-22 07:55:34,808 INFO [src.stage_a.stage_a]   ✗ 2024-01-15: Tables not available (skipping)
2025-12-22 07:55:34,907 INFO [src.stage_a.stage_a]   ✓ 2024-01-16: Tables available
2025-12-22 07:55:34,990 INFO [src.stage_a.stage_a]   ✓ 2024-01-17: Tables available
2025-12-22 07:55:35,074 INFO [src.stage_a.stage_a]   ✓ 2024-01-18: Tables available
2025-12-22 07:55:35,209 INFO [src.stage_a.stage_a]   ✓ 2024-01-19: Tables available
2025-12-22 07:55:35,384 INFO [src.stage_a.stage_a]   ✓ 2024-01-22: Tables available
2025-12-22 07:55:35,531 INFO [src.stage_a.stage_a]   ✓ 2024-01-23: Tables available
2025-12-22 07:55:35,699 INFO [src.stage_a.stage_a]   ✓ 2024-01-24: Tables available
2025-12-22 07:55:35,862 INFO [src.stage_a.stage_a]   ✓ 2024-01-25: Tables available
2025-12-22 07:55:36,018 INFO [src.stage_a.stage_a]   ✓ 2024-01-26: Tables available
2025-12-22 07:55:36,186 INFO [src.stage_a.stage_a]   ✓ 2024-01-29: Tables available
2025-12-22 07:55:36,350 INFO [src.stage_a.stage_a]   ✓ 2024-01-30: Tables available
2025-12-22 07:55:36,501 INFO [src.stage_a.stage_a]   ✓ 2024-01-31: Tables available
2025-12-22 07:55:36,669 INFO [src.stage_a.stage_a]   ✓ 2024-02-01: Tables available
2025-12-22 07:55:36,833 INFO [src.stage_a.stage_a]   ✓ 2024-02-02: Tables available
2025-12-22 07:55:37,013 INFO [src.stage_a.stage_a]   ✓ 2024-02-05: Tables available
2025-12-22 07:55:37,084 INFO [src.stage_a.stage_a]   ✓ 2024-02-06: Tables available
2025-12-22 07:55:37,155 INFO [src.stage_a.stage_a]   ✓ 2024-02-07: Tables available
2025-12-22 07:55:37,341 INFO [src.stage_a.stage_a]   ✓ 2024-02-08: Tables available
2025-12-22 07:55:37,527 INFO [src.stage_a.stage_a]   ✓ 2024-02-09: Tables available
2025-12-22 07:55:37,689 INFO [src.stage_a.stage_a]   ✓ 2024-02-12: Tables available
2025-12-22 07:55:37,870 INFO [src.stage_a.stage_a]   ✓ 2024-02-13: Tables available
2025-12-22 07:55:37,976 INFO [src.stage_a.stage_a]   ✓ 2024-02-14: Tables available
2025-12-22 07:55:38,108 INFO [src.stage_a.stage_a]   ✓ 2024-02-15: Tables available
2025-12-22 07:55:38,275 INFO [src.stage_a.stage_a]   ✓ 2024-02-16: Tables available
2025-12-22 07:55:38,317 INFO [src.stage_a.stage_a]   ✗ 2024-02-19: Tables not available (skipping)
2025-12-22 07:55:38,435 INFO [src.stage_a.stage_a]   ✓ 2024-02-20: Tables available
2025-12-22 07:55:38,595 INFO [src.stage_a.stage_a]   ✓ 2024-02-21: Tables available
2025-12-22 07:55:38,770 INFO [src.stage_a.stage_a]   ✓ 2024-02-22: Tables available
2025-12-22 07:55:38,932 INFO [src.stage_a.stage_a]   ✓ 2024-02-23: Tables available
2025-12-22 07:55:39,101 INFO [src.stage_a.stage_a]   ✓ 2024-02-26: Tables available
2025-12-22 07:55:39,265 INFO [src.stage_a.stage_a]   ✓ 2024-02-27: Tables available
2025-12-22 07:55:39,437 INFO [src.stage_a.stage_a]   ✓ 2024-02-28: Tables available
2025-12-22 07:55:39,613 INFO [src.stage_a.stage_a]   ✓ 2024-02-29: Tables available
2025-12-22 07:55:39,739 INFO [src.stage_a.stage_a]   ✓ 2024-03-01: Tables available
2025-12-22 07:55:39,881 INFO [src.stage_a.stage_a]   ✓ 2024-03-04: Tables available
2025-12-22 07:55:40,033 INFO [src.stage_a.stage_a]   ✓ 2024-03-05: Tables available
2025-12-22 07:55:40,204 INFO [src.stage_a.stage_a]   ✓ 2024-03-06: Tables available
2025-12-22 07:55:40,476 INFO [src.stage_a.stage_a]   ✓ 2024-03-07: Tables available
2025-12-22 07:55:40,643 INFO [src.stage_a.stage_a]   ✓ 2024-03-08: Tables available
2025-12-22 07:55:40,798 INFO [src.stage_a.stage_a]   ✓ 2024-03-11: Tables available
2025-12-22 07:55:40,970 INFO [src.stage_a.stage_a]   ✓ 2024-03-12: Tables available
2025-12-22 07:55:41,146 INFO [src.stage_a.stage_a]   ✓ 2024-03-13: Tables available
2025-12-22 07:55:41,317 INFO [src.stage_a.stage_a]   ✓ 2024-03-14: Tables available
2025-12-22 07:55:41,482 INFO [src.stage_a.stage_a]   ✓ 2024-03-15: Tables available
2025-12-22 07:55:41,645 INFO [src.stage_a.stage_a]   ✓ 2024-03-18: Tables available
2025-12-22 07:55:41,805 INFO [src.stage_a.stage_a]   ✓ 2024-03-19: Tables available
2025-12-22 07:55:41,936 INFO [src.stage_a.stage_a]   ✓ 2024-03-20: Tables available
2025-12-22 07:55:42,066 INFO [src.stage_a.stage_a]   ✓ 2024-03-21: Tables available
2025-12-22 07:55:42,242 INFO [src.stage_a.stage_a]   ✓ 2024-03-22: Tables available
2025-12-22 07:55:42,407 INFO [src.stage_a.stage_a]   ✓ 2024-03-25: Tables available
2025-12-22 07:55:42,586 INFO [src.stage_a.stage_a]   ✓ 2024-03-26: Tables available
2025-12-22 07:55:42,758 INFO [src.stage_a.stage_a]   ✓ 2024-03-27: Tables available
2025-12-22 07:55:42,926 INFO [src.stage_a.stage_a]   ✓ 2024-03-28: Tables available
2025-12-22 07:55:42,955 INFO [src.stage_a.stage_a]   ✗ 2024-03-29: Tables not available (skipping)
2025-12-22 07:55:43,096 INFO [src.stage_a.stage_a]   ✓ 2024-04-01: Tables available
2025-12-22 07:55:43,267 INFO [src.stage_a.stage_a]   ✓ 2024-04-02: Tables available
2025-12-22 07:55:43,432 INFO [src.stage_a.stage_a]   ✓ 2024-04-03: Tables available
2025-12-22 07:55:43,610 INFO [src.stage_a.stage_a]   ✓ 2024-04-04: Tables available
2025-12-22 07:55:43,777 INFO [src.stage_a.stage_a]   ✓ 2024-04-05: Tables available
2025-12-22 07:55:43,948 INFO [src.stage_a.stage_a]   ✓ 2024-04-08: Tables available
2025-12-22 07:55:44,125 INFO [src.stage_a.stage_a]   ✓ 2024-04-09: Tables available
2025-12-22 07:55:44,298 INFO [src.stage_a.stage_a]   ✓ 2024-04-10: Tables available
2025-12-22 07:55:44,376 INFO [src.stage_a.stage_a]   ✓ 2024-04-11: Tables available
2025-12-22 07:55:44,506 INFO [src.stage_a.stage_a]   ✓ 2024-04-12: Tables available
2025-12-22 07:55:44,675 INFO [src.stage_a.stage_a]   ✓ 2024-04-15: Tables available
2025-12-22 07:55:44,850 INFO [src.stage_a.stage_a]   ✓ 2024-04-16: Tables available
2025-12-22 07:55:45,021 INFO [src.stage_a.stage_a]   ✓ 2024-04-17: Tables available
2025-12-22 07:55:45,184 INFO [src.stage_a.stage_a]   ✓ 2024-04-18: Tables available
2025-12-22 07:55:45,358 INFO [src.stage_a.stage_a]   ✓ 2024-04-19: Tables available
2025-12-22 07:55:45,530 INFO [src.stage_a.stage_a]   ✓ 2024-04-22: Tables available
2025-12-22 07:55:45,701 INFO [src.stage_a.stage_a]   ✓ 2024-04-23: Tables available
2025-12-22 07:55:45,870 INFO [src.stage_a.stage_a]   ✓ 2024-04-24: Tables available
2025-12-22 07:55:46,042 INFO [src.stage_a.stage_a]   ✓ 2024-04-25: Tables available
2025-12-22 07:55:46,214 INFO [src.stage_a.stage_a]   ✓ 2024-04-26: Tables available
2025-12-22 07:55:46,382 INFO [src.stage_a.stage_a]   ✓ 2024-04-29: Tables available
2025-12-22 07:55:46,545 INFO [src.stage_a.stage_a]   ✓ 2024-04-30: Tables available
2025-12-22 07:55:46,546 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 07:55:46,546 INFO [src.stage_a.stage_a] 
Found 83 dates with available TAQ tables
2025-12-22 07:55:46,546 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 07:55:46,546 INFO [src.stage_a.stage_a] Processing date 1/83: 2024-01-02
2025-12-22 07:55:46,546 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 07:55:46,546 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 07:55:46,546 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-01-02 (519 symbols)
2025-12-22 07:55:46,546 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 07:55:46,546 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 07:55:46,546 INFO [src.stage_a.stage_a] Extract run ID: 1244ff6d-0d9f-4cea-b01e-fc6735abd9fa
2025-12-22 07:55:46,562 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 07:55:46,562 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 07:55:46,562 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 07:55:46,562 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 07:55:46,562 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 07:55:46,562 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 07:55:46,562 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 07:55:46,562 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 07:55:46,562 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 07:55:47,676 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 07:55:47,677 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-02...
2025-12-22 07:55:47,755 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240102 for 519 symbols
2025-12-22 07:57:10,701 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,775,315 trades
2025-12-22 07:57:10,711 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,775,315 rows
2025-12-22 07:57:51,718 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,205,206 trades
2025-12-22 07:57:51,720 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,205,206 rows
2025-12-22 07:58:40,005 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,153,535 trades
2025-12-22 07:58:40,005 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,153,535 rows
2025-12-22 07:59:51,909 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,734,580 trades
2025-12-22 07:59:51,913 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,734,580 rows
2025-12-22 08:03:19,309 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,480,055 trades
2025-12-22 08:03:19,309 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,480,055 rows
2025-12-22 08:04:46,738 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,527,141 trades
2025-12-22 08:04:46,748 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,527,141 rows
2025-12-22 08:06:15,527 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,736,887 trades
2025-12-22 08:06:15,528 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,736,887 rows
2025-12-22 08:07:15,570 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,863,358 trades
2025-12-22 08:07:15,601 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,863,358 rows
2025-12-22 08:08:13,054 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,525,505 trades
2025-12-22 08:08:13,054 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,525,505 rows
2025-12-22 08:09:25,819 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,441,027 trades
2025-12-22 08:09:25,819 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,441,027 rows
2025-12-22 08:09:26,264 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 27,442,609 total rows written
2025-12-22 08:10:00,644 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,287,090 trades
2025-12-22 08:10:00,650 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,287,090 rows
2025-12-22 08:10:01,071 INFO [src.stage_a.parquet_writer] ✓ Wrote 28,729,699 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-02
2025-12-22 08:10:01,096 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 08:10:01,096 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 08:10:01,096 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 08:10:01,096 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 08:10:01,096 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 08:10:01,096 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 08:10:01,096 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 08:10:02,307 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 08:10:02,308 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-02...
2025-12-22 08:10:02,449 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240102 for 519 symbols
2025-12-22 08:11:44,367 INFO [src.stage_a.wrds_extractor]   Chunk 1: 8,391,371 NBBO records
2025-12-22 08:11:44,367 INFO [src.stage_a.parquet_writer]   Chunk 1: 8,391,371 rows
2025-12-22 08:12:59,724 INFO [src.stage_a.wrds_extractor]   Chunk 2: 5,970,855 NBBO records
2025-12-22 08:12:59,733 INFO [src.stage_a.parquet_writer]   Chunk 2: 5,970,855 rows
2025-12-22 08:14:21,846 INFO [src.stage_a.wrds_extractor]   Chunk 3: 7,446,697 NBBO records
2025-12-22 08:14:21,847 INFO [src.stage_a.parquet_writer]   Chunk 3: 7,446,697 rows
2025-12-22 08:15:29,986 INFO [src.stage_a.wrds_extractor]   Chunk 4: 5,493,199 NBBO records
2025-12-22 08:15:29,987 INFO [src.stage_a.parquet_writer]   Chunk 4: 5,493,199 rows
2025-12-22 08:17:00,406 INFO [src.stage_a.wrds_extractor]   Chunk 5: 7,797,341 NBBO records
2025-12-22 08:17:00,407 INFO [src.stage_a.parquet_writer]   Chunk 5: 7,797,341 rows
2025-12-22 08:19:01,495 INFO [src.stage_a.wrds_extractor]   Chunk 6: 8,352,473 NBBO records
2025-12-22 08:19:01,496 INFO [src.stage_a.parquet_writer]   Chunk 6: 8,352,473 rows
2025-12-22 08:20:57,031 INFO [src.stage_a.wrds_extractor]   Chunk 7: 9,143,165 NBBO records
2025-12-22 08:20:57,038 INFO [src.stage_a.parquet_writer]   Chunk 7: 9,143,165 rows
2025-12-22 08:23:29,685 INFO [src.stage_a.wrds_extractor]   Chunk 8: 11,304,074 NBBO records
2025-12-22 08:23:29,691 INFO [src.stage_a.parquet_writer]   Chunk 8: 11,304,074 rows
2025-12-22 08:25:11,590 INFO [src.stage_a.wrds_extractor]   Chunk 9: 9,095,825 NBBO records
2025-12-22 08:25:11,598 INFO [src.stage_a.parquet_writer]   Chunk 9: 9,095,825 rows
2025-12-22 08:26:40,500 INFO [src.stage_a.wrds_extractor]   Chunk 10: 7,973,221 NBBO records
2025-12-22 08:26:40,505 INFO [src.stage_a.parquet_writer]   Chunk 10: 7,973,221 rows
2025-12-22 08:26:40,986 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 80,968,221 total rows written
2025-12-22 08:28:27,113 INFO [src.stage_a.wrds_extractor]   Chunk 11: 9,569,837 NBBO records
2025-12-22 08:28:27,114 INFO [src.stage_a.parquet_writer]   Chunk 11: 9,569,837 rows
2025-12-22 08:28:27,993 INFO [src.stage_a.parquet_writer] ✓ Wrote 90,538,058 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-02
2025-12-22 08:28:28,015 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 08:28:28,015 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 08:28:28,015 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 08:28:28,015 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 08:28:28,015 INFO [src.stage_a.stage_a] Trades: 28,729,699 rows
2025-12-22 08:28:28,015 INFO [src.stage_a.stage_a] Nbbo: 90,538,058 rows
2025-12-22 08:28:28,015 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 08:28:28,015 INFO [src.stage_a.stage_a] Processing date 2/83: 2024-01-03
2025-12-22 08:28:28,015 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 08:28:28,015 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 08:28:28,015 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-01-03 (519 symbols)
2025-12-22 08:28:28,015 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 08:28:28,015 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 08:28:28,015 INFO [src.stage_a.stage_a] Extract run ID: 1202484f-8fb1-466c-8058-05c4ab32225d
2025-12-22 08:28:28,023 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 08:28:28,023 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 08:28:28,023 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 08:28:28,023 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 08:28:28,023 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 08:28:28,023 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 08:28:28,023 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 08:28:28,023 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 08:28:28,024 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 08:28:29,115 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 08:28:29,115 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-03...
2025-12-22 08:28:29,189 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240103 for 519 symbols
2025-12-22 08:29:23,759 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,281,892 trades
2025-12-22 08:29:23,759 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,281,892 rows
2025-12-22 08:30:02,426 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,254,207 trades
2025-12-22 08:30:02,427 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,254,207 rows
2025-12-22 08:30:34,901 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,131,189 trades
2025-12-22 08:30:34,901 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,131,189 rows
2025-12-22 08:31:05,103 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,874,004 trades
2025-12-22 08:31:05,103 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,874,004 rows
2025-12-22 08:31:44,181 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,331,719 trades
2025-12-22 08:31:44,182 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,331,719 rows
2025-12-22 08:32:24,229 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,522,646 trades
2025-12-22 08:32:24,229 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,522,646 rows
2025-12-22 08:33:15,301 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,225,295 trades
2025-12-22 08:33:15,301 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,225,295 rows
2025-12-22 08:33:57,660 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,663,498 trades
2025-12-22 08:33:57,660 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,663,498 rows
2025-12-22 08:34:37,653 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,387,981 trades
2025-12-22 08:34:37,653 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,387,981 rows
2025-12-22 08:35:36,135 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,451,870 trades
2025-12-22 08:35:36,136 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,451,870 rows
2025-12-22 08:35:36,573 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,124,301 total rows written
2025-12-22 08:35:55,595 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,305,837 trades
2025-12-22 08:35:55,596 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,305,837 rows
2025-12-22 08:35:55,992 INFO [src.stage_a.parquet_writer] ✓ Wrote 27,430,138 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-03
2025-12-22 08:35:55,997 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 08:35:55,997 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 08:35:55,997 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 08:35:55,997 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 08:35:55,997 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 08:35:55,997 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 08:35:55,997 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 08:35:57,066 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 08:35:57,067 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-03...
2025-12-22 08:35:57,129 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240103 for 519 symbols
2025-12-22 08:38:00,416 INFO [src.stage_a.wrds_extractor]   Chunk 1: 9,607,756 NBBO records
2025-12-22 08:38:00,417 INFO [src.stage_a.parquet_writer]   Chunk 1: 9,607,756 rows
2025-12-22 08:39:29,524 INFO [src.stage_a.wrds_extractor]   Chunk 2: 6,589,351 NBBO records
2025-12-22 08:39:29,531 INFO [src.stage_a.parquet_writer]   Chunk 2: 6,589,351 rows
2025-12-22 08:41:31,805 INFO [src.stage_a.wrds_extractor]   Chunk 3: 8,084,904 NBBO records
2025-12-22 08:41:31,806 INFO [src.stage_a.parquet_writer]   Chunk 3: 8,084,904 rows
2025-12-22 08:43:14,870 INFO [src.stage_a.wrds_extractor]   Chunk 4: 5,948,995 NBBO records
2025-12-22 08:43:14,872 INFO [src.stage_a.parquet_writer]   Chunk 4: 5,948,995 rows
2025-12-22 08:44:56,300 INFO [src.stage_a.wrds_extractor]   Chunk 5: 8,527,273 NBBO records
2025-12-22 08:44:56,301 INFO [src.stage_a.parquet_writer]   Chunk 5: 8,527,273 rows
2025-12-22 08:47:02,356 INFO [src.stage_a.wrds_extractor]   Chunk 6: 9,044,164 NBBO records
2025-12-22 08:47:02,365 INFO [src.stage_a.parquet_writer]   Chunk 6: 9,044,164 rows
2025-12-22 08:49:11,104 INFO [src.stage_a.wrds_extractor]   Chunk 7: 9,583,448 NBBO records
2025-12-22 08:49:11,110 INFO [src.stage_a.parquet_writer]   Chunk 7: 9,583,448 rows
2025-12-22 08:51:46,086 INFO [src.stage_a.wrds_extractor]   Chunk 8: 11,831,511 NBBO records
2025-12-22 08:51:46,094 INFO [src.stage_a.parquet_writer]   Chunk 8: 11,831,511 rows
2025-12-22 08:54:17,952 INFO [src.stage_a.wrds_extractor]   Chunk 9: 10,425,909 NBBO records
2025-12-22 08:54:17,962 INFO [src.stage_a.parquet_writer]   Chunk 9: 10,425,909 rows
2025-12-22 08:56:09,194 INFO [src.stage_a.wrds_extractor]   Chunk 10: 8,957,730 NBBO records
2025-12-22 08:56:09,206 INFO [src.stage_a.parquet_writer]   Chunk 10: 8,957,730 rows
2025-12-22 08:56:09,719 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 88,601,041 total rows written
2025-12-22 08:58:19,737 INFO [src.stage_a.wrds_extractor]   Chunk 11: 10,437,784 NBBO records
2025-12-22 08:58:19,747 INFO [src.stage_a.parquet_writer]   Chunk 11: 10,437,784 rows
2025-12-22 08:58:20,759 INFO [src.stage_a.parquet_writer] ✓ Wrote 99,038,825 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-03
2025-12-22 08:58:20,800 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 08:58:20,800 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 08:58:20,800 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 08:58:20,800 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 08:58:20,800 INFO [src.stage_a.stage_a] Trades: 27,430,138 rows
2025-12-22 08:58:20,800 INFO [src.stage_a.stage_a] Nbbo: 99,038,825 rows
2025-12-22 08:58:20,800 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 08:58:20,800 INFO [src.stage_a.stage_a] Processing date 3/83: 2024-01-04
2025-12-22 08:58:20,800 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 08:58:20,800 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 08:58:20,800 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-01-04 (519 symbols)
2025-12-22 08:58:20,800 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 08:58:20,800 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 08:58:20,800 INFO [src.stage_a.stage_a] Extract run ID: 5e7610ae-2199-40c4-9f11-9494a3ec9651
2025-12-22 08:58:20,808 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 08:58:20,808 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 08:58:20,808 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 08:58:20,808 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 08:58:20,808 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 08:58:20,808 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 08:58:20,808 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 08:58:20,808 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 08:58:20,808 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 08:58:21,939 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 08:58:21,939 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-04...
2025-12-22 08:58:22,022 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240104 for 519 symbols
2025-12-22 08:59:14,300 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,390,102 trades
2025-12-22 08:59:14,300 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,390,102 rows
2025-12-22 08:59:45,261 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,962,500 trades
2025-12-22 08:59:45,261 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,962,500 rows
2025-12-22 09:00:28,119 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,885,870 trades
2025-12-22 09:00:28,119 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,885,870 rows
2025-12-22 09:00:59,075 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,643,660 trades
2025-12-22 09:00:59,075 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,643,660 rows
2025-12-22 09:01:40,401 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,144,540 trades
2025-12-22 09:01:40,402 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,144,540 rows
2025-12-22 09:02:24,426 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,184,880 trades
2025-12-22 09:02:24,426 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,184,880 rows
2025-12-22 09:03:21,261 INFO [src.stage_a.wrds_extractor]   Chunk 7: 2,885,272 trades
2025-12-22 09:03:21,261 INFO [src.stage_a.parquet_writer]   Chunk 7: 2,885,272 rows
2025-12-22 09:04:16,919 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,481,091 trades
2025-12-22 09:04:16,919 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,481,091 rows
2025-12-22 09:05:08,072 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,073,985 trades
2025-12-22 09:05:08,072 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,073,985 rows
2025-12-22 09:06:03,924 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,109,036 trades
2025-12-22 09:06:03,924 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,109,036 rows
2025-12-22 09:06:04,322 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,760,936 total rows written
2025-12-22 09:06:27,558 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,111,694 trades
2025-12-22 09:06:27,558 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,111,694 rows
2025-12-22 09:06:27,915 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,872,630 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-04
2025-12-22 09:06:27,916 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 09:06:27,917 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 09:06:27,917 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 09:06:27,917 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 09:06:27,917 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 09:06:27,917 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 09:06:27,917 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 09:06:29,388 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 09:06:29,388 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-04...
2025-12-22 09:06:29,436 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240104 for 519 symbols
2025-12-22 09:08:08,819 INFO [src.stage_a.wrds_extractor]   Chunk 1: 8,368,744 NBBO records
2025-12-22 09:08:08,820 INFO [src.stage_a.parquet_writer]   Chunk 1: 8,368,744 rows
2025-12-22 09:12:35,418 INFO [src.stage_a.wrds_extractor]   Chunk 2: 5,571,612 NBBO records
2025-12-22 09:12:35,424 INFO [src.stage_a.parquet_writer]   Chunk 2: 5,571,612 rows
2025-12-22 09:14:31,195 INFO [src.stage_a.wrds_extractor]   Chunk 3: 6,948,497 NBBO records
2025-12-22 09:14:31,196 INFO [src.stage_a.parquet_writer]   Chunk 3: 6,948,497 rows
2025-12-22 09:15:37,563 INFO [src.stage_a.wrds_extractor]   Chunk 4: 4,951,933 NBBO records
2025-12-22 09:15:37,564 INFO [src.stage_a.parquet_writer]   Chunk 4: 4,951,933 rows
2025-12-22 09:21:48,932 INFO [src.stage_a.wrds_extractor]   Chunk 5: 7,230,922 NBBO records
2025-12-22 09:21:48,932 INFO [src.stage_a.parquet_writer]   Chunk 5: 7,230,922 rows
2025-12-22 09:27:31,730 INFO [src.stage_a.wrds_extractor]   Chunk 6: 7,677,976 NBBO records
2025-12-22 09:27:31,731 INFO [src.stage_a.parquet_writer]   Chunk 6: 7,677,976 rows
2025-12-22 09:32:02,717 INFO [src.stage_a.wrds_extractor]   Chunk 7: 8,136,633 NBBO records
2025-12-22 09:32:02,718 INFO [src.stage_a.parquet_writer]   Chunk 7: 8,136,633 rows
2025-12-22 09:34:16,452 INFO [src.stage_a.wrds_extractor]   Chunk 8: 10,728,462 NBBO records
2025-12-22 09:34:16,454 INFO [src.stage_a.parquet_writer]   Chunk 8: 10,728,462 rows
2025-12-22 09:35:58,078 INFO [src.stage_a.wrds_extractor]   Chunk 9: 8,404,098 NBBO records
2025-12-22 09:35:58,082 INFO [src.stage_a.parquet_writer]   Chunk 9: 8,404,098 rows
2025-12-22 09:37:18,556 INFO [src.stage_a.wrds_extractor]   Chunk 10: 7,355,787 NBBO records
2025-12-22 09:37:18,572 INFO [src.stage_a.parquet_writer]   Chunk 10: 7,355,787 rows
2025-12-22 09:37:19,029 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 75,374,664 total rows written
2025-12-22 09:38:55,336 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,751,787 NBBO records
2025-12-22 09:38:55,337 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,751,787 rows
2025-12-22 09:38:56,119 INFO [src.stage_a.parquet_writer] ✓ Wrote 83,126,451 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-04
2025-12-22 09:38:56,139 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 09:38:56,140 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 09:38:56,140 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 09:38:56,140 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 09:38:56,140 INFO [src.stage_a.stage_a] Trades: 24,872,630 rows
2025-12-22 09:38:56,140 INFO [src.stage_a.stage_a] Nbbo: 83,126,451 rows
2025-12-22 09:38:56,140 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 09:38:56,140 INFO [src.stage_a.stage_a] Processing date 4/83: 2024-01-05
2025-12-22 09:38:56,140 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 09:38:56,140 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 09:38:56,140 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-01-05 (519 symbols)
2025-12-22 09:38:56,140 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 09:38:56,140 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 09:38:56,140 INFO [src.stage_a.stage_a] Extract run ID: 57bb6826-a1ff-4eec-9e05-e6aa12278a92
2025-12-22 09:38:56,148 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 09:38:56,148 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 09:38:56,148 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 09:38:56,148 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 09:38:56,148 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 09:38:56,148 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 09:38:56,148 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 09:38:56,148 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 09:38:56,148 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 09:38:57,271 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 09:38:57,271 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-05...
2025-12-22 09:38:57,336 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240105 for 519 symbols
2025-12-22 09:39:43,171 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,044,115 trades
2025-12-22 09:39:43,171 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,044,115 rows
2025-12-22 09:40:16,000 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,883,662 trades
2025-12-22 09:40:16,001 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,883,662 rows
2025-12-22 09:40:43,883 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,811,249 trades
2025-12-22 09:40:43,884 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,811,249 rows
2025-12-22 09:41:08,871 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,523,224 trades
2025-12-22 09:41:08,871 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,523,224 rows
2025-12-22 09:41:42,850 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,097,705 trades
2025-12-22 09:41:42,850 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,097,705 rows
2025-12-22 09:42:13,003 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,050,957 trades
2025-12-22 09:42:13,003 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,050,957 rows
2025-12-22 09:43:01,022 INFO [src.stage_a.wrds_extractor]   Chunk 7: 2,894,780 trades
2025-12-22 09:43:01,023 INFO [src.stage_a.parquet_writer]   Chunk 7: 2,894,780 rows
2025-12-22 09:43:39,123 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,326,538 trades
2025-12-22 09:43:39,123 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,326,538 rows
2025-12-22 09:44:13,079 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,098,965 trades
2025-12-22 09:44:13,079 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,098,965 rows
2025-12-22 09:45:16,948 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,981,864 trades
2025-12-22 09:45:16,948 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,981,864 rows
2025-12-22 09:45:17,344 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 22,713,059 total rows written
2025-12-22 09:45:32,876 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,081,111 trades
2025-12-22 09:45:32,876 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,081,111 rows
2025-12-22 09:45:33,248 INFO [src.stage_a.parquet_writer] ✓ Wrote 23,794,170 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-05
2025-12-22 09:45:33,249 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 09:45:33,249 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 09:45:33,249 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 09:45:33,249 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 09:45:33,249 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 09:45:33,249 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 09:45:33,249 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 09:45:34,461 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 09:45:34,462 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-05...
2025-12-22 09:45:34,518 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240105 for 519 symbols
2025-12-22 09:47:10,817 INFO [src.stage_a.wrds_extractor]   Chunk 1: 8,498,505 NBBO records
2025-12-22 09:47:10,817 INFO [src.stage_a.parquet_writer]   Chunk 1: 8,498,505 rows
2025-12-22 09:48:16,000 INFO [src.stage_a.wrds_extractor]   Chunk 2: 6,002,497 NBBO records
2025-12-22 09:48:16,003 INFO [src.stage_a.parquet_writer]   Chunk 2: 6,002,497 rows
2025-12-22 09:54:19,038 INFO [src.stage_a.wrds_extractor]   Chunk 3: 7,296,344 NBBO records
2025-12-22 09:54:19,039 INFO [src.stage_a.parquet_writer]   Chunk 3: 7,296,344 rows
2025-12-22 09:55:38,002 INFO [src.stage_a.wrds_extractor]   Chunk 4: 5,313,375 NBBO records
2025-12-22 09:55:38,004 INFO [src.stage_a.parquet_writer]   Chunk 4: 5,313,375 rows
2025-12-22 09:57:38,321 INFO [src.stage_a.wrds_extractor]   Chunk 5: 8,009,700 NBBO records
2025-12-22 09:57:38,322 INFO [src.stage_a.parquet_writer]   Chunk 5: 8,009,700 rows
2025-12-22 10:01:16,284 INFO [src.stage_a.wrds_extractor]   Chunk 6: 7,753,468 NBBO records
2025-12-22 10:01:16,285 INFO [src.stage_a.parquet_writer]   Chunk 6: 7,753,468 rows
2025-12-22 10:05:07,860 INFO [src.stage_a.wrds_extractor]   Chunk 7: 8,636,869 NBBO records
2025-12-22 10:05:07,861 INFO [src.stage_a.parquet_writer]   Chunk 7: 8,636,869 rows
2025-12-22 10:12:06,937 INFO [src.stage_a.wrds_extractor]   Chunk 8: 9,457,360 NBBO records
2025-12-22 10:12:06,944 INFO [src.stage_a.parquet_writer]   Chunk 8: 9,457,360 rows
2025-12-22 10:16:07,162 INFO [src.stage_a.wrds_extractor]   Chunk 9: 8,224,288 NBBO records
2025-12-22 10:16:07,176 INFO [src.stage_a.parquet_writer]   Chunk 9: 8,224,288 rows
2025-12-22 10:17:46,899 INFO [src.stage_a.wrds_extractor]   Chunk 10: 7,888,480 NBBO records
2025-12-22 10:17:46,905 INFO [src.stage_a.parquet_writer]   Chunk 10: 7,888,480 rows
2025-12-22 10:17:47,390 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 77,080,886 total rows written
2025-12-22 10:19:43,186 INFO [src.stage_a.wrds_extractor]   Chunk 11: 8,502,151 NBBO records
2025-12-22 10:19:43,187 INFO [src.stage_a.parquet_writer]   Chunk 11: 8,502,151 rows
2025-12-22 10:19:44,016 INFO [src.stage_a.parquet_writer] ✓ Wrote 85,583,037 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-05
2025-12-22 10:19:44,032 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 10:19:44,032 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 10:19:44,032 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 10:19:44,032 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 10:19:44,032 INFO [src.stage_a.stage_a] Trades: 23,794,170 rows
2025-12-22 10:19:44,032 INFO [src.stage_a.stage_a] Nbbo: 85,583,037 rows
2025-12-22 10:19:44,032 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 10:19:44,032 INFO [src.stage_a.stage_a] Processing date 5/83: 2024-01-08
2025-12-22 10:19:44,032 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 10:19:44,032 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 10:19:44,032 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-01-08 (519 symbols)
2025-12-22 10:19:44,032 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 10:19:44,032 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 10:19:44,032 INFO [src.stage_a.stage_a] Extract run ID: d137c68e-e8ac-4c3b-a564-0d23bb835107
2025-12-22 10:19:44,040 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 10:19:44,040 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 10:19:44,040 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 10:19:44,040 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 10:19:44,040 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 10:19:44,040 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 10:19:44,040 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 10:19:44,040 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 10:19:44,040 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 10:19:45,198 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 10:19:45,198 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-08...
2025-12-22 10:19:45,261 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240108 for 519 symbols
2025-12-22 10:20:54,025 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,249,200 trades
2025-12-22 10:20:54,026 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,249,200 rows
2025-12-22 10:21:44,240 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,344,066 trades
2025-12-22 10:21:44,241 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,344,066 rows
2025-12-22 10:22:33,469 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,045,045 trades
2025-12-22 10:22:33,470 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,045,045 rows
2025-12-22 10:23:01,635 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,576,540 trades
2025-12-22 10:23:01,635 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,576,540 rows
2025-12-22 10:23:34,559 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,227,480 trades
2025-12-22 10:23:34,559 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,227,480 rows
2025-12-22 10:24:14,348 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,153,471 trades
2025-12-22 10:24:14,348 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,153,471 rows
2025-12-22 10:25:22,380 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,426,226 trades
2025-12-22 10:25:22,380 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,426,226 rows
2025-12-22 10:25:58,601 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,332,319 trades
2025-12-22 10:25:58,602 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,332,319 rows
2025-12-22 10:26:49,531 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,151,275 trades
2025-12-22 10:26:49,531 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,151,275 rows
2025-12-22 10:28:57,718 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,009,641 trades
2025-12-22 10:28:57,718 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,009,641 rows
2025-12-22 10:28:58,113 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 24,515,263 total rows written
2025-12-22 10:30:35,583 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,151,764 trades
2025-12-22 10:30:35,584 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,151,764 rows
2025-12-22 10:30:35,968 INFO [src.stage_a.parquet_writer] ✓ Wrote 25,667,027 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-08
2025-12-22 10:30:35,969 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 10:30:35,969 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 10:30:35,969 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 10:30:35,969 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 10:30:35,969 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 10:30:35,969 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 10:30:35,969 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 10:30:38,640 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 10:30:38,641 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-08...
2025-12-22 10:30:38,833 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240108 for 519 symbols
2025-12-22 10:33:42,794 INFO [src.stage_a.wrds_extractor]   Chunk 1: 7,229,188 NBBO records
2025-12-22 10:33:42,794 INFO [src.stage_a.parquet_writer]   Chunk 1: 7,229,188 rows
2025-12-22 10:35:06,866 INFO [src.stage_a.wrds_extractor]   Chunk 2: 5,223,197 NBBO records
2025-12-22 10:35:06,867 INFO [src.stage_a.parquet_writer]   Chunk 2: 5,223,197 rows
2025-12-22 10:37:40,761 INFO [src.stage_a.wrds_extractor]   Chunk 3: 6,168,491 NBBO records
2025-12-22 10:37:40,762 INFO [src.stage_a.parquet_writer]   Chunk 3: 6,168,491 rows
2025-12-22 10:40:59,168 INFO [src.stage_a.wrds_extractor]   Chunk 4: 4,490,415 NBBO records
2025-12-22 10:40:59,169 INFO [src.stage_a.parquet_writer]   Chunk 4: 4,490,415 rows
2025-12-22 10:45:55,983 INFO [src.stage_a.wrds_extractor]   Chunk 5: 6,783,769 NBBO records
2025-12-22 10:45:55,983 INFO [src.stage_a.parquet_writer]   Chunk 5: 6,783,769 rows
2025-12-22 10:50:37,234 INFO [src.stage_a.wrds_extractor]   Chunk 6: 6,812,239 NBBO records
2025-12-22 10:50:37,235 INFO [src.stage_a.parquet_writer]   Chunk 6: 6,812,239 rows
2025-12-22 10:55:19,633 INFO [src.stage_a.wrds_extractor]   Chunk 7: 7,467,546 NBBO records
2025-12-22 10:55:19,634 INFO [src.stage_a.parquet_writer]   Chunk 7: 7,467,546 rows
2025-12-22 10:58:16,045 INFO [src.stage_a.wrds_extractor]   Chunk 8: 7,934,965 NBBO records
2025-12-22 10:58:16,046 INFO [src.stage_a.parquet_writer]   Chunk 8: 7,934,965 rows
2025-12-22 10:59:35,375 INFO [src.stage_a.wrds_extractor]   Chunk 9: 6,732,415 NBBO records
2025-12-22 10:59:35,376 INFO [src.stage_a.parquet_writer]   Chunk 9: 6,732,415 rows
2025-12-22 11:00:49,718 INFO [src.stage_a.wrds_extractor]   Chunk 10: 6,804,507 NBBO records
2025-12-22 11:00:49,720 INFO [src.stage_a.parquet_writer]   Chunk 10: 6,804,507 rows
2025-12-22 11:00:50,193 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 65,646,732 total rows written
2025-12-22 11:02:17,416 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,430,787 NBBO records
2025-12-22 11:02:17,418 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,430,787 rows
2025-12-22 11:02:18,182 INFO [src.stage_a.parquet_writer] ✓ Wrote 73,077,519 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-08
2025-12-22 11:02:18,193 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 11:02:18,193 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 11:02:18,193 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 11:02:18,193 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 11:02:18,193 INFO [src.stage_a.stage_a] Trades: 25,667,027 rows
2025-12-22 11:02:18,193 INFO [src.stage_a.stage_a] Nbbo: 73,077,519 rows
2025-12-22 11:02:18,193 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 11:02:18,193 INFO [src.stage_a.stage_a] Processing date 6/83: 2024-01-09
2025-12-22 11:02:18,193 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 11:02:18,193 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 11:02:18,193 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-01-09 (519 symbols)
2025-12-22 11:02:18,193 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 11:02:18,193 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 11:02:18,193 INFO [src.stage_a.stage_a] Extract run ID: f8e01bdf-2acf-4325-81aa-72de077bc23a
2025-12-22 11:02:18,201 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 11:02:18,201 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 11:02:18,201 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 11:02:18,201 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 11:02:18,201 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 11:02:18,201 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 11:02:18,201 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 11:02:18,201 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 11:02:18,201 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 11:02:22,743 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 11:02:22,743 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-09...
2025-12-22 11:02:22,878 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240109 for 519 symbols
2025-12-22 11:05:09,663 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,888,940 trades
2025-12-22 11:05:09,663 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,888,940 rows
2025-12-22 11:07:21,406 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,046,167 trades
2025-12-22 11:07:21,406 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,046,167 rows
2025-12-22 11:09:26,080 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,039,442 trades
2025-12-22 11:09:26,080 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,039,442 rows
2025-12-22 11:10:34,335 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,600,444 trades
2025-12-22 11:10:34,335 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,600,444 rows
2025-12-22 11:12:45,026 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,324,375 trades
2025-12-22 11:12:45,026 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,324,375 rows
2025-12-22 11:14:29,857 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,049,523 trades
2025-12-22 11:14:29,857 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,049,523 rows
2025-12-22 11:17:26,293 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,480,453 trades
2025-12-22 11:17:26,293 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,480,453 rows
2025-12-22 11:19:06,378 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,355,787 trades
2025-12-22 11:19:06,381 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,355,787 rows
2025-12-22 11:20:14,969 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,008,244 trades
2025-12-22 11:20:14,969 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,008,244 rows
2025-12-22 11:22:13,361 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,976,792 trades
2025-12-22 11:22:13,361 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,976,792 rows
2025-12-22 11:22:13,753 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,770,167 total rows written
2025-12-22 11:23:13,571 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,030,070 trades
2025-12-22 11:23:13,571 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,030,070 rows
2025-12-22 11:23:13,968 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,800,237 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-09
2025-12-22 11:23:13,969 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 11:23:13,969 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 11:23:13,969 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 11:23:13,969 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 11:23:13,969 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 11:23:13,969 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 11:23:13,969 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 11:23:15,928 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 11:23:15,928 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-09...
2025-12-22 11:23:16,080 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240109 for 519 symbols
2025-12-22 11:26:47,010 INFO [src.stage_a.wrds_extractor]   Chunk 1: 8,057,552 NBBO records
2025-12-22 11:26:47,010 INFO [src.stage_a.parquet_writer]   Chunk 1: 8,057,552 rows
2025-12-22 11:29:36,065 INFO [src.stage_a.wrds_extractor]   Chunk 2: 5,301,735 NBBO records
2025-12-22 11:29:36,067 INFO [src.stage_a.parquet_writer]   Chunk 2: 5,301,735 rows
2025-12-22 11:33:13,432 INFO [src.stage_a.wrds_extractor]   Chunk 3: 6,628,109 NBBO records
2025-12-22 11:33:13,433 INFO [src.stage_a.parquet_writer]   Chunk 3: 6,628,109 rows
2025-12-22 11:35:47,391 INFO [src.stage_a.wrds_extractor]   Chunk 4: 4,811,220 NBBO records
2025-12-22 11:35:47,392 INFO [src.stage_a.parquet_writer]   Chunk 4: 4,811,220 rows
2025-12-22 11:39:36,939 INFO [src.stage_a.wrds_extractor]   Chunk 5: 7,364,821 NBBO records
2025-12-22 11:39:36,939 INFO [src.stage_a.parquet_writer]   Chunk 5: 7,364,821 rows
2025-12-22 11:43:24,095 INFO [src.stage_a.wrds_extractor]   Chunk 6: 7,340,908 NBBO records
2025-12-22 11:43:24,099 INFO [src.stage_a.parquet_writer]   Chunk 6: 7,340,908 rows
2025-12-22 11:49:13,661 INFO [src.stage_a.wrds_extractor]   Chunk 7: 8,180,991 NBBO records
2025-12-22 11:49:13,662 INFO [src.stage_a.parquet_writer]   Chunk 7: 8,180,991 rows
2025-12-22 11:55:57,958 INFO [src.stage_a.wrds_extractor]   Chunk 8: 9,302,333 NBBO records
2025-12-22 11:55:57,963 INFO [src.stage_a.parquet_writer]   Chunk 8: 9,302,333 rows
2025-12-22 12:01:50,925 INFO [src.stage_a.wrds_extractor]   Chunk 9: 7,434,928 NBBO records
2025-12-22 12:01:50,931 INFO [src.stage_a.parquet_writer]   Chunk 9: 7,434,928 rows
2025-12-22 12:07:19,418 INFO [src.stage_a.wrds_extractor]   Chunk 10: 7,263,560 NBBO records
2025-12-22 12:07:19,420 INFO [src.stage_a.parquet_writer]   Chunk 10: 7,263,560 rows
2025-12-22 12:07:19,893 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 71,686,157 total rows written
2025-12-22 12:11:35,761 INFO [src.stage_a.wrds_extractor]   Chunk 11: 8,548,972 NBBO records
2025-12-22 12:11:35,763 INFO [src.stage_a.parquet_writer]   Chunk 11: 8,548,972 rows
2025-12-22 12:11:36,629 INFO [src.stage_a.parquet_writer] ✓ Wrote 80,235,129 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-09
2025-12-22 12:11:36,644 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 12:11:36,644 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 12:11:36,644 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 12:11:36,644 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 12:11:36,644 INFO [src.stage_a.stage_a] Trades: 24,800,237 rows
2025-12-22 12:11:36,644 INFO [src.stage_a.stage_a] Nbbo: 80,235,129 rows
2025-12-22 12:11:36,644 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 12:11:36,644 INFO [src.stage_a.stage_a] Processing date 7/83: 2024-01-10
2025-12-22 12:11:36,644 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 12:11:36,644 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 12:11:36,644 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-01-10 (519 symbols)
2025-12-22 12:11:36,644 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 12:11:36,644 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 12:11:36,644 INFO [src.stage_a.stage_a] Extract run ID: eed36b3a-aeda-4519-8610-6555a4bd3e34
2025-12-22 12:11:36,652 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 12:11:36,652 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 12:11:36,652 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 12:11:36,652 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 12:11:36,652 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 12:11:36,652 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 12:11:36,652 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 12:11:36,652 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 12:11:36,652 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 12:11:37,947 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 12:11:37,948 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-10...
2025-12-22 12:11:38,023 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240110 for 519 symbols
2025-12-22 12:12:27,804 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,866,779 trades
2025-12-22 12:12:27,804 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,866,779 rows
2025-12-22 12:13:03,940 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,920,866 trades
2025-12-22 12:13:03,940 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,920,866 rows
2025-12-22 12:13:34,596 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,990,724 trades
2025-12-22 12:13:34,596 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,990,724 rows
2025-12-22 12:14:05,462 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,522,527 trades
2025-12-22 12:14:05,462 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,522,527 rows
2025-12-22 12:14:44,921 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,231,658 trades
2025-12-22 12:14:44,921 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,231,658 rows
2025-12-22 12:15:26,523 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,231,564 trades
2025-12-22 12:15:26,523 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,231,564 rows
2025-12-22 12:16:26,853 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,278,277 trades
2025-12-22 12:16:26,853 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,278,277 rows
2025-12-22 12:17:02,796 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,384,703 trades
2025-12-22 12:17:02,799 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,384,703 rows
2025-12-22 12:17:35,779 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,985,688 trades
2025-12-22 12:17:35,779 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,985,688 rows
2025-12-22 12:18:23,389 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,890,826 trades
2025-12-22 12:18:23,389 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,890,826 rows
2025-12-22 12:18:23,773 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,303,612 total rows written
2025-12-22 12:18:40,387 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,032,228 trades
2025-12-22 12:18:40,388 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,032,228 rows
2025-12-22 12:18:40,725 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,335,840 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-10
2025-12-22 12:18:40,726 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 12:18:40,726 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 12:18:40,726 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 12:18:40,726 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 12:18:40,726 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 12:18:40,726 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 12:18:40,726 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 12:18:42,060 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 12:18:42,060 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-10...
2025-12-22 12:18:42,133 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240110 for 519 symbols
2025-12-22 12:20:06,168 INFO [src.stage_a.wrds_extractor]   Chunk 1: 7,289,725 NBBO records
2025-12-22 12:20:06,168 INFO [src.stage_a.parquet_writer]   Chunk 1: 7,289,725 rows
2025-12-22 12:20:56,772 INFO [src.stage_a.wrds_extractor]   Chunk 2: 4,790,822 NBBO records
2025-12-22 12:20:56,773 INFO [src.stage_a.parquet_writer]   Chunk 2: 4,790,822 rows
2025-12-22 12:22:01,481 INFO [src.stage_a.wrds_extractor]   Chunk 3: 6,173,217 NBBO records
2025-12-22 12:22:01,482 INFO [src.stage_a.parquet_writer]   Chunk 3: 6,173,217 rows
2025-12-22 12:22:44,263 INFO [src.stage_a.wrds_extractor]   Chunk 4: 4,361,702 NBBO records
2025-12-22 12:22:44,264 INFO [src.stage_a.parquet_writer]   Chunk 4: 4,361,702 rows
2025-12-22 12:23:58,305 INFO [src.stage_a.wrds_extractor]   Chunk 5: 6,580,222 NBBO records
2025-12-22 12:23:58,306 INFO [src.stage_a.parquet_writer]   Chunk 5: 6,580,222 rows
2025-12-22 12:25:08,925 INFO [src.stage_a.wrds_extractor]   Chunk 6: 6,418,914 NBBO records
2025-12-22 12:25:08,927 INFO [src.stage_a.parquet_writer]   Chunk 6: 6,418,914 rows
2025-12-22 12:26:27,379 INFO [src.stage_a.wrds_extractor]   Chunk 7: 7,141,646 NBBO records
2025-12-22 12:26:27,380 INFO [src.stage_a.parquet_writer]   Chunk 7: 7,141,646 rows
2025-12-22 12:27:57,897 INFO [src.stage_a.wrds_extractor]   Chunk 8: 8,777,731 NBBO records
2025-12-22 12:27:57,898 INFO [src.stage_a.parquet_writer]   Chunk 8: 8,777,731 rows
2025-12-22 12:29:21,904 INFO [src.stage_a.wrds_extractor]   Chunk 9: 7,111,131 NBBO records
2025-12-22 12:29:21,909 INFO [src.stage_a.parquet_writer]   Chunk 9: 7,111,131 rows
2025-12-22 12:30:46,653 INFO [src.stage_a.wrds_extractor]   Chunk 10: 6,908,063 NBBO records
2025-12-22 12:30:46,654 INFO [src.stage_a.parquet_writer]   Chunk 10: 6,908,063 rows
2025-12-22 12:30:47,098 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 65,553,173 total rows written
2025-12-22 12:32:19,103 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,676,673 NBBO records
2025-12-22 12:32:19,104 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,676,673 rows
2025-12-22 12:32:19,860 INFO [src.stage_a.parquet_writer] ✓ Wrote 73,229,846 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-10
2025-12-22 12:32:19,872 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 12:32:19,872 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 12:32:19,872 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 12:32:19,872 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 12:32:19,872 INFO [src.stage_a.stage_a] Trades: 24,335,840 rows
2025-12-22 12:32:19,872 INFO [src.stage_a.stage_a] Nbbo: 73,229,846 rows
2025-12-22 12:32:19,872 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 12:32:19,872 INFO [src.stage_a.stage_a] Processing date 8/83: 2024-01-11
2025-12-22 12:32:19,872 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 12:32:19,872 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 12:32:19,872 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-01-11 (519 symbols)
2025-12-22 12:32:19,872 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 12:32:19,872 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 12:32:19,872 INFO [src.stage_a.stage_a] Extract run ID: f9103b6c-c66b-465f-aa4d-c1708268b521
2025-12-22 12:32:19,880 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 12:32:19,880 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 12:32:19,880 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 12:32:19,880 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 12:32:19,880 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 12:32:19,880 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 12:32:19,880 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 12:32:19,880 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 12:32:19,880 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 12:32:21,191 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 12:32:21,191 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-11...
2025-12-22 12:32:21,260 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240111 for 519 symbols
2025-12-22 12:33:20,537 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,054,090 trades
2025-12-22 12:33:20,537 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,054,090 rows
2025-12-22 12:34:09,775 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,105,225 trades
2025-12-22 12:34:09,775 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,105,225 rows
2025-12-22 12:34:45,861 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,034,590 trades
2025-12-22 12:34:45,861 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,034,590 rows
2025-12-22 12:35:11,884 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,680,284 trades
2025-12-22 12:35:11,884 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,680,284 rows
2025-12-22 12:35:48,814 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,292,483 trades
2025-12-22 12:35:48,814 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,292,483 rows
2025-12-22 12:36:23,088 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,211,995 trades
2025-12-22 12:36:23,088 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,211,995 rows
2025-12-22 12:37:24,169 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,472,081 trades
2025-12-22 12:37:24,169 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,472,081 rows
2025-12-22 12:38:04,438 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,612,001 trades
2025-12-22 12:38:04,440 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,612,001 rows
2025-12-22 12:38:44,326 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,232,979 trades
2025-12-22 12:38:44,326 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,232,979 rows
2025-12-22 12:39:47,433 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,393,213 trades
2025-12-22 12:39:47,433 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,393,213 rows
2025-12-22 12:39:47,868 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,088,941 total rows written
2025-12-22 12:40:08,508 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,118,340 trades
2025-12-22 12:40:08,509 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,118,340 rows
2025-12-22 12:40:08,904 INFO [src.stage_a.parquet_writer] ✓ Wrote 26,207,281 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-11
2025-12-22 12:40:08,905 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 12:40:08,905 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 12:40:08,905 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 12:40:08,905 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 12:40:08,905 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 12:40:08,905 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 12:40:08,905 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 12:40:10,164 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 12:40:10,164 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-11...
2025-12-22 12:40:10,227 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240111 for 519 symbols
2025-12-22 12:41:51,266 INFO [src.stage_a.wrds_extractor]   Chunk 1: 8,645,885 NBBO records
2025-12-22 12:41:51,266 INFO [src.stage_a.parquet_writer]   Chunk 1: 8,645,885 rows
2025-12-22 12:43:00,450 INFO [src.stage_a.wrds_extractor]   Chunk 2: 6,026,377 NBBO records
2025-12-22 12:43:00,454 INFO [src.stage_a.parquet_writer]   Chunk 2: 6,026,377 rows
2025-12-22 12:44:37,454 INFO [src.stage_a.wrds_extractor]   Chunk 3: 7,518,551 NBBO records
2025-12-22 12:44:37,455 INFO [src.stage_a.parquet_writer]   Chunk 3: 7,518,551 rows
2025-12-22 12:45:52,497 INFO [src.stage_a.wrds_extractor]   Chunk 4: 5,901,116 NBBO records
2025-12-22 12:45:52,498 INFO [src.stage_a.parquet_writer]   Chunk 4: 5,901,116 rows
2025-12-22 12:47:54,160 INFO [src.stage_a.wrds_extractor]   Chunk 5: 8,877,431 NBBO records
2025-12-22 12:47:54,161 INFO [src.stage_a.parquet_writer]   Chunk 5: 8,877,431 rows
2025-12-22 12:50:07,424 INFO [src.stage_a.wrds_extractor]   Chunk 6: 8,514,466 NBBO records
2025-12-22 12:50:07,429 INFO [src.stage_a.parquet_writer]   Chunk 6: 8,514,466 rows
2025-12-22 12:57:21,500 INFO [src.stage_a.wrds_extractor]   Chunk 7: 9,675,114 NBBO records
2025-12-22 12:57:21,506 INFO [src.stage_a.parquet_writer]   Chunk 7: 9,675,114 rows
2025-12-22 13:04:14,840 INFO [src.stage_a.wrds_extractor]   Chunk 8: 11,438,846 NBBO records
2025-12-22 13:04:14,846 INFO [src.stage_a.parquet_writer]   Chunk 8: 11,438,846 rows
2025-12-22 13:09:45,310 INFO [src.stage_a.wrds_extractor]   Chunk 9: 9,201,199 NBBO records
2025-12-22 13:09:45,317 INFO [src.stage_a.parquet_writer]   Chunk 9: 9,201,199 rows
2025-12-22 13:15:32,824 INFO [src.stage_a.wrds_extractor]   Chunk 10: 8,843,120 NBBO records
2025-12-22 13:15:32,833 INFO [src.stage_a.parquet_writer]   Chunk 10: 8,843,120 rows
2025-12-22 13:15:33,335 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 84,642,105 total rows written
2025-12-22 13:23:20,397 INFO [src.stage_a.wrds_extractor]   Chunk 11: 10,497,690 NBBO records
2025-12-22 13:23:20,403 INFO [src.stage_a.parquet_writer]   Chunk 11: 10,497,690 rows
2025-12-22 13:23:21,329 INFO [src.stage_a.parquet_writer] ✓ Wrote 95,139,795 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-11
2025-12-22 13:23:21,353 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 13:23:21,353 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 13:23:21,353 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 13:23:21,353 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 13:23:21,353 INFO [src.stage_a.stage_a] Trades: 26,207,281 rows
2025-12-22 13:23:21,353 INFO [src.stage_a.stage_a] Nbbo: 95,139,795 rows
2025-12-22 13:23:21,353 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 13:23:21,353 INFO [src.stage_a.stage_a] Processing date 9/83: 2024-01-12
2025-12-22 13:23:21,353 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 13:23:21,353 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 13:23:21,354 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-01-12 (519 symbols)
2025-12-22 13:23:21,354 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 13:23:21,354 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 13:23:21,354 INFO [src.stage_a.stage_a] Extract run ID: 2923efa8-9a33-4fe4-8a31-851a875936c1
2025-12-22 13:23:21,362 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 13:23:21,362 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 13:23:21,362 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 13:23:21,362 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 13:23:21,362 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 13:23:21,362 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 13:23:21,362 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 13:23:21,362 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 13:23:21,362 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 13:23:28,475 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 13:23:28,476 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-12...
2025-12-22 13:23:28,953 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240112 for 519 symbols
2025-12-22 13:26:49,872 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,600,753 trades
2025-12-22 13:26:49,872 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,600,753 rows
2025-12-22 13:29:28,751 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,187,806 trades
2025-12-22 13:29:28,751 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,187,806 rows
2025-12-22 13:32:12,274 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,134,619 trades
2025-12-22 13:32:12,274 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,134,619 rows
2025-12-22 13:34:11,497 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,510,236 trades
2025-12-22 13:34:11,497 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,510,236 rows
2025-12-22 13:36:16,826 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,052,166 trades
2025-12-22 13:36:16,827 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,052,166 rows
2025-12-22 13:38:57,539 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,044,827 trades
2025-12-22 13:38:57,539 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,044,827 rows
2025-12-22 13:42:15,427 INFO [src.stage_a.wrds_extractor]   Chunk 7: 2,774,539 trades
2025-12-22 13:42:15,428 INFO [src.stage_a.parquet_writer]   Chunk 7: 2,774,539 rows
2025-12-22 13:44:55,839 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,188,157 trades
2025-12-22 13:44:55,839 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,188,157 rows
2025-12-22 13:47:07,153 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,001,397 trades
2025-12-22 13:47:07,154 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,001,397 rows
2025-12-22 13:51:01,533 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,533,640 trades
2025-12-22 13:51:01,533 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,533,640 rows
2025-12-22 13:51:01,952 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,028,140 total rows written
2025-12-22 13:52:21,451 INFO [src.stage_a.wrds_extractor]   Chunk 11: 956,904 trades
2025-12-22 13:52:21,452 INFO [src.stage_a.parquet_writer]   Chunk 11: 956,904 rows
2025-12-22 13:52:21,767 INFO [src.stage_a.parquet_writer] ✓ Wrote 23,985,044 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-12
2025-12-22 13:52:21,769 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 13:52:21,769 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 13:52:21,769 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 13:52:21,769 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 13:52:21,769 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 13:52:21,769 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 13:52:21,769 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 13:52:27,042 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 13:52:27,042 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-12...
2025-12-22 13:52:27,332 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240112 for 519 symbols
2025-12-22 13:59:49,365 INFO [src.stage_a.wrds_extractor]   Chunk 1: 8,819,077 NBBO records
2025-12-22 13:59:49,365 INFO [src.stage_a.parquet_writer]   Chunk 1: 8,819,077 rows
2025-12-22 14:04:08,970 INFO [src.stage_a.wrds_extractor]   Chunk 2: 5,407,431 NBBO records
2025-12-22 14:04:08,978 INFO [src.stage_a.parquet_writer]   Chunk 2: 5,407,431 rows
2025-12-22 14:09:28,210 INFO [src.stage_a.wrds_extractor]   Chunk 3: 7,041,663 NBBO records
2025-12-22 14:09:28,211 INFO [src.stage_a.parquet_writer]   Chunk 3: 7,041,663 rows
2025-12-22 14:13:20,609 INFO [src.stage_a.wrds_extractor]   Chunk 4: 4,885,477 NBBO records
2025-12-22 14:13:20,610 INFO [src.stage_a.parquet_writer]   Chunk 4: 4,885,477 rows
2025-12-22 14:20:04,372 INFO [src.stage_a.wrds_extractor]   Chunk 5: 7,717,325 NBBO records
2025-12-22 14:20:04,372 INFO [src.stage_a.parquet_writer]   Chunk 5: 7,717,325 rows
2025-12-22 14:26:32,434 INFO [src.stage_a.wrds_extractor]   Chunk 6: 7,853,699 NBBO records
2025-12-22 14:26:32,435 INFO [src.stage_a.parquet_writer]   Chunk 6: 7,853,699 rows
2025-12-22 14:31:34,672 INFO [src.stage_a.wrds_extractor]   Chunk 7: 7,632,431 NBBO records
2025-12-22 14:31:34,673 INFO [src.stage_a.parquet_writer]   Chunk 7: 7,632,431 rows
2025-12-22 14:36:39,004 INFO [src.stage_a.wrds_extractor]   Chunk 8: 10,027,739 NBBO records
2025-12-22 14:36:39,005 INFO [src.stage_a.parquet_writer]   Chunk 8: 10,027,739 rows
2025-12-22 14:38:34,716 INFO [src.stage_a.wrds_extractor]   Chunk 9: 8,809,229 NBBO records
2025-12-22 14:38:34,720 INFO [src.stage_a.parquet_writer]   Chunk 9: 8,809,229 rows
2025-12-22 14:40:10,188 INFO [src.stage_a.wrds_extractor]   Chunk 10: 7,605,662 NBBO records
2025-12-22 14:40:10,193 INFO [src.stage_a.parquet_writer]   Chunk 10: 7,605,662 rows
2025-12-22 14:40:10,655 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 75,799,733 total rows written
2025-12-22 14:44:10,370 INFO [src.stage_a.wrds_extractor]   Chunk 11: 9,283,087 NBBO records
2025-12-22 14:44:10,372 INFO [src.stage_a.parquet_writer]   Chunk 11: 9,283,087 rows
2025-12-22 14:44:11,189 INFO [src.stage_a.parquet_writer] ✓ Wrote 85,082,820 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-12
2025-12-22 14:44:11,199 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 14:44:11,199 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 14:44:11,199 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 14:44:11,199 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 14:44:11,199 INFO [src.stage_a.stage_a] Trades: 23,985,044 rows
2025-12-22 14:44:11,199 INFO [src.stage_a.stage_a] Nbbo: 85,082,820 rows
2025-12-22 14:44:11,199 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 14:44:11,199 INFO [src.stage_a.stage_a] Processing date 10/83: 2024-01-16
2025-12-22 14:44:11,199 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 14:44:11,199 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 14:44:11,199 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-01-16 (519 symbols)
2025-12-22 14:44:11,199 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 14:44:11,199 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 14:44:11,199 INFO [src.stage_a.stage_a] Extract run ID: 8816049b-4825-4662-8cdf-04b4124bf554
2025-12-22 14:44:11,207 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 14:44:11,207 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 14:44:11,207 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 14:44:11,207 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 14:44:11,207 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 14:44:11,207 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 14:44:11,207 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 14:44:11,207 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 14:44:11,207 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 14:44:13,939 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 14:44:13,939 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-16...
2025-12-22 14:44:14,132 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240116 for 519 symbols
2025-12-22 14:48:39,689 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,672,433 trades
2025-12-22 14:48:39,689 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,672,433 rows
2025-12-22 14:51:57,590 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,432,814 trades
2025-12-22 14:51:57,590 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,432,814 rows
2025-12-22 14:52:39,401 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,417,221 trades
2025-12-22 14:52:39,401 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,417,221 rows
2025-12-22 14:53:14,127 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,869,674 trades
2025-12-22 14:53:14,127 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,869,674 rows
2025-12-22 14:54:28,583 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,460,628 trades
2025-12-22 14:54:28,583 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,460,628 rows
2025-12-22 14:56:56,393 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,419,703 trades
2025-12-22 14:56:56,394 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,419,703 rows
2025-12-22 15:01:02,897 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,555,082 trades
2025-12-22 15:01:02,897 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,555,082 rows
2025-12-22 15:04:04,831 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,745,795 trades
2025-12-22 15:04:04,834 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,745,795 rows
2025-12-22 15:06:31,926 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,425,365 trades
2025-12-22 15:06:31,927 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,425,365 rows
2025-12-22 15:10:29,903 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,678,577 trades
2025-12-22 15:10:29,903 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,678,577 rows
2025-12-22 15:10:30,356 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 27,677,292 total rows written
2025-12-22 15:11:35,157 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,201,851 trades
2025-12-22 15:11:35,161 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,201,851 rows
2025-12-22 15:11:35,547 INFO [src.stage_a.parquet_writer] ✓ Wrote 28,879,143 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-16
2025-12-22 15:11:35,548 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 15:11:35,548 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 15:11:35,548 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 15:11:35,548 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 15:11:35,548 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 15:11:35,548 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 15:11:35,548 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 15:11:36,735 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 15:11:36,735 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-16...
2025-12-22 15:11:36,799 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240116 for 519 symbols
2025-12-22 15:17:25,456 INFO [src.stage_a.wrds_extractor]   Chunk 1: 8,741,562 NBBO records
2025-12-22 15:17:25,456 INFO [src.stage_a.parquet_writer]   Chunk 1: 8,741,562 rows
2025-12-22 15:21:27,039 INFO [src.stage_a.wrds_extractor]   Chunk 2: 6,077,899 NBBO records
2025-12-22 15:21:27,043 INFO [src.stage_a.parquet_writer]   Chunk 2: 6,077,899 rows
2025-12-22 15:26:56,783 INFO [src.stage_a.wrds_extractor]   Chunk 3: 7,517,537 NBBO records
2025-12-22 15:26:56,784 INFO [src.stage_a.parquet_writer]   Chunk 3: 7,517,537 rows
2025-12-22 15:30:43,081 INFO [src.stage_a.wrds_extractor]   Chunk 4: 5,321,345 NBBO records
2025-12-22 15:30:43,083 INFO [src.stage_a.parquet_writer]   Chunk 4: 5,321,345 rows
2025-12-22 15:37:00,756 INFO [src.stage_a.wrds_extractor]   Chunk 5: 8,308,392 NBBO records
2025-12-22 15:37:00,756 INFO [src.stage_a.parquet_writer]   Chunk 5: 8,308,392 rows
2025-12-22 15:43:15,262 INFO [src.stage_a.wrds_extractor]   Chunk 6: 8,940,312 NBBO records
2025-12-22 15:43:15,266 INFO [src.stage_a.parquet_writer]   Chunk 6: 8,940,312 rows
2025-12-22 15:49:23,991 INFO [src.stage_a.wrds_extractor]   Chunk 7: 8,722,504 NBBO records
2025-12-22 15:49:23,995 INFO [src.stage_a.parquet_writer]   Chunk 7: 8,722,504 rows
2025-12-22 15:56:15,508 INFO [src.stage_a.wrds_extractor]   Chunk 8: 10,282,033 NBBO records
2025-12-22 15:56:15,512 INFO [src.stage_a.parquet_writer]   Chunk 8: 10,282,033 rows
2025-12-22 16:02:16,279 INFO [src.stage_a.wrds_extractor]   Chunk 9: 9,542,680 NBBO records
2025-12-22 16:02:16,285 INFO [src.stage_a.parquet_writer]   Chunk 9: 9,542,680 rows
2025-12-22 16:07:30,191 INFO [src.stage_a.wrds_extractor]   Chunk 10: 8,424,186 NBBO records
2025-12-22 16:07:30,195 INFO [src.stage_a.parquet_writer]   Chunk 10: 8,424,186 rows
2025-12-22 16:07:30,699 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 81,878,450 total rows written
2025-12-22 16:13:39,903 INFO [src.stage_a.wrds_extractor]   Chunk 11: 9,905,560 NBBO records
2025-12-22 16:13:39,909 INFO [src.stage_a.parquet_writer]   Chunk 11: 9,905,560 rows
2025-12-22 16:13:40,799 INFO [src.stage_a.parquet_writer] ✓ Wrote 91,784,010 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-16
2025-12-22 16:13:40,825 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 16:13:40,825 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 16:13:40,825 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 16:13:40,825 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 16:13:40,825 INFO [src.stage_a.stage_a] Trades: 28,879,143 rows
2025-12-22 16:13:40,825 INFO [src.stage_a.stage_a] Nbbo: 91,784,010 rows
2025-12-22 16:13:40,825 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 16:13:40,825 INFO [src.stage_a.stage_a] Processing date 11/83: 2024-01-17
2025-12-22 16:13:40,825 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 16:13:40,825 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 16:13:40,825 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-01-17 (519 symbols)
2025-12-22 16:13:40,825 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 16:13:40,825 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 16:13:40,825 INFO [src.stage_a.stage_a] Extract run ID: 32f617ab-ea27-4cd9-b909-a3c862f8a951
2025-12-22 16:13:40,833 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 16:13:40,833 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 16:13:40,833 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 16:13:40,833 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 16:13:40,833 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 16:13:40,833 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 16:13:40,833 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 16:13:40,833 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 16:13:40,833 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 16:13:42,028 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 16:13:42,029 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-17...
2025-12-22 16:13:42,107 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240117 for 519 symbols
2025-12-22 16:16:25,202 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,312,840 trades
2025-12-22 16:16:25,202 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,312,840 rows
2025-12-22 16:18:10,178 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,206,980 trades
2025-12-22 16:18:10,178 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,206,980 rows
2025-12-22 16:19:53,827 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,093,672 trades
2025-12-22 16:19:53,827 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,093,672 rows
2025-12-22 16:21:28,496 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,822,296 trades
2025-12-22 16:21:28,497 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,822,296 rows
2025-12-22 16:23:15,120 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,327,003 trades
2025-12-22 16:23:15,120 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,327,003 rows
2025-12-22 16:24:55,472 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,171,758 trades
2025-12-22 16:24:55,472 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,171,758 rows
2025-12-22 16:27:20,947 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,274,855 trades
2025-12-22 16:27:20,947 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,274,855 rows
2025-12-22 16:29:22,559 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,700,863 trades
2025-12-22 16:29:22,560 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,700,863 rows
2025-12-22 16:31:27,393 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,384,035 trades
2025-12-22 16:31:27,393 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,384,035 rows
2025-12-22 16:34:00,907 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,292,173 trades
2025-12-22 16:34:00,907 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,292,173 rows
2025-12-22 16:34:01,323 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,586,475 total rows written
2025-12-22 16:34:44,222 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,114,369 trades
2025-12-22 16:34:44,223 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,114,369 rows
2025-12-22 16:34:44,565 INFO [src.stage_a.parquet_writer] ✓ Wrote 26,700,844 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-17
2025-12-22 16:34:44,566 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 16:34:44,566 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 16:34:44,566 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 16:34:44,566 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 16:34:44,566 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 16:34:44,566 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 16:34:44,566 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 16:34:46,590 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 16:34:46,591 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-17...
2025-12-22 16:34:46,713 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240117 for 519 symbols
2025-12-22 16:39:57,519 INFO [src.stage_a.wrds_extractor]   Chunk 1: 8,416,823 NBBO records
2025-12-22 16:39:57,519 INFO [src.stage_a.parquet_writer]   Chunk 1: 8,416,823 rows
2025-12-22 16:43:00,896 INFO [src.stage_a.wrds_extractor]   Chunk 2: 5,399,427 NBBO records
2025-12-22 16:43:00,902 INFO [src.stage_a.parquet_writer]   Chunk 2: 5,399,427 rows
2025-12-22 16:47:37,913 INFO [src.stage_a.wrds_extractor]   Chunk 3: 6,766,523 NBBO records
2025-12-22 16:47:37,914 INFO [src.stage_a.parquet_writer]   Chunk 3: 6,766,523 rows
2025-12-22 16:50:44,983 INFO [src.stage_a.wrds_extractor]   Chunk 4: 4,705,447 NBBO records
2025-12-22 16:50:44,984 INFO [src.stage_a.parquet_writer]   Chunk 4: 4,705,447 rows
2025-12-22 16:55:09,876 INFO [src.stage_a.wrds_extractor]   Chunk 5: 7,147,969 NBBO records
2025-12-22 16:55:09,876 INFO [src.stage_a.parquet_writer]   Chunk 5: 7,147,969 rows
2025-12-22 17:00:00,880 INFO [src.stage_a.wrds_extractor]   Chunk 6: 7,573,056 NBBO records
2025-12-22 17:00:00,882 INFO [src.stage_a.parquet_writer]   Chunk 6: 7,573,056 rows
2025-12-22 17:04:37,579 INFO [src.stage_a.wrds_extractor]   Chunk 7: 8,055,012 NBBO records
2025-12-22 17:04:37,580 INFO [src.stage_a.parquet_writer]   Chunk 7: 8,055,012 rows
2025-12-22 17:10:47,755 INFO [src.stage_a.wrds_extractor]   Chunk 8: 9,488,379 NBBO records
2025-12-22 17:10:47,757 INFO [src.stage_a.parquet_writer]   Chunk 8: 9,488,379 rows
2025-12-22 17:16:30,434 INFO [src.stage_a.wrds_extractor]   Chunk 9: 8,078,800 NBBO records
2025-12-22 17:16:30,439 INFO [src.stage_a.parquet_writer]   Chunk 9: 8,078,800 rows
2025-12-22 17:21:28,031 INFO [src.stage_a.wrds_extractor]   Chunk 10: 7,080,833 NBBO records
2025-12-22 17:21:28,032 INFO [src.stage_a.parquet_writer]   Chunk 10: 7,080,833 rows
2025-12-22 17:21:28,474 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 72,712,269 total rows written
2025-12-22 17:28:13,336 INFO [src.stage_a.wrds_extractor]   Chunk 11: 8,761,561 NBBO records
2025-12-22 17:28:13,336 INFO [src.stage_a.parquet_writer]   Chunk 11: 8,761,561 rows
2025-12-22 17:28:14,125 INFO [src.stage_a.parquet_writer] ✓ Wrote 81,473,830 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-17
2025-12-22 17:28:14,134 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 17:28:14,134 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 17:28:14,134 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 17:28:14,134 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 17:28:14,134 INFO [src.stage_a.stage_a] Trades: 26,700,844 rows
2025-12-22 17:28:14,134 INFO [src.stage_a.stage_a] Nbbo: 81,473,830 rows
2025-12-22 17:28:14,134 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 17:28:14,134 INFO [src.stage_a.stage_a] Processing date 12/83: 2024-01-18
2025-12-22 17:28:14,134 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 17:28:14,134 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 17:28:14,134 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-01-18 (519 symbols)
2025-12-22 17:28:14,134 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 17:28:14,134 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 17:28:14,134 INFO [src.stage_a.stage_a] Extract run ID: 0871209f-a757-4984-a64e-4deff8b79ef4
2025-12-22 17:28:14,142 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 17:28:14,142 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 17:28:14,142 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 17:28:14,142 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 17:28:14,142 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 17:28:14,142 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 17:28:14,142 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 17:28:14,142 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 17:28:14,142 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 17:28:17,390 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 17:28:17,390 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-18...
2025-12-22 17:28:17,501 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240118 for 519 symbols
2025-12-22 17:32:23,824 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,754,217 trades
2025-12-22 17:32:23,824 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,754,217 rows
2025-12-22 17:34:58,929 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,053,920 trades
2025-12-22 17:34:58,930 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,053,920 rows
2025-12-22 17:37:24,540 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,263,617 trades
2025-12-22 17:37:24,541 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,263,617 rows
2025-12-22 17:39:16,983 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,863,698 trades
2025-12-22 17:39:16,984 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,863,698 rows
2025-12-22 17:41:43,481 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,445,406 trades
2025-12-22 17:41:43,481 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,445,406 rows
2025-12-22 17:44:09,094 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,330,296 trades
2025-12-22 17:44:09,094 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,330,296 rows
2025-12-22 17:47:31,946 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,288,250 trades
2025-12-22 17:47:31,947 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,288,250 rows
2025-12-22 17:50:38,824 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,842,948 trades
2025-12-22 17:50:38,824 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,842,948 rows
2025-12-22 17:53:01,077 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,321,519 trades
2025-12-22 17:53:01,077 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,321,519 rows
2025-12-22 17:56:04,370 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,343,000 trades
2025-12-22 17:56:04,371 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,343,000 rows
2025-12-22 17:56:04,805 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,506,871 total rows written
2025-12-22 17:57:12,679 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,173,782 trades
2025-12-22 17:57:12,679 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,173,782 rows
2025-12-22 17:57:13,047 INFO [src.stage_a.parquet_writer] ✓ Wrote 27,680,653 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-18
2025-12-22 17:57:13,048 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 17:57:13,048 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 17:57:13,048 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 17:57:13,048 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 17:57:13,048 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 17:57:13,048 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 17:57:13,048 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 17:57:15,558 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 17:57:15,558 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-18...
2025-12-22 17:57:15,677 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240118 for 519 symbols
2025-12-22 18:03:19,927 INFO [src.stage_a.wrds_extractor]   Chunk 1: 8,453,043 NBBO records
2025-12-22 18:03:19,927 INFO [src.stage_a.parquet_writer]   Chunk 1: 8,453,043 rows
2025-12-22 18:07:24,502 INFO [src.stage_a.wrds_extractor]   Chunk 2: 5,536,967 NBBO records
2025-12-22 18:07:24,505 INFO [src.stage_a.parquet_writer]   Chunk 2: 5,536,967 rows
2025-12-22 18:13:09,136 INFO [src.stage_a.wrds_extractor]   Chunk 3: 7,051,349 NBBO records
2025-12-22 18:13:09,137 INFO [src.stage_a.parquet_writer]   Chunk 3: 7,051,349 rows
2025-12-22 18:16:53,353 INFO [src.stage_a.wrds_extractor]   Chunk 4: 4,965,551 NBBO records
2025-12-22 18:16:53,354 INFO [src.stage_a.parquet_writer]   Chunk 4: 4,965,551 rows
2025-12-22 18:22:26,914 INFO [src.stage_a.wrds_extractor]   Chunk 5: 7,583,197 NBBO records
2025-12-22 18:22:26,914 INFO [src.stage_a.parquet_writer]   Chunk 5: 7,583,197 rows
2025-12-22 18:28:02,900 INFO [src.stage_a.wrds_extractor]   Chunk 6: 7,630,447 NBBO records
2025-12-22 18:28:02,902 INFO [src.stage_a.parquet_writer]   Chunk 6: 7,630,447 rows
2025-12-22 18:34:11,009 INFO [src.stage_a.wrds_extractor]   Chunk 7: 7,973,462 NBBO records
2025-12-22 18:34:11,010 INFO [src.stage_a.parquet_writer]   Chunk 7: 7,973,462 rows
2025-12-22 18:41:58,768 INFO [src.stage_a.wrds_extractor]   Chunk 8: 10,227,965 NBBO records
2025-12-22 18:41:58,769 INFO [src.stage_a.parquet_writer]   Chunk 8: 10,227,965 rows
2025-12-22 18:47:39,917 INFO [src.stage_a.wrds_extractor]   Chunk 9: 8,253,156 NBBO records
2025-12-22 18:47:39,924 INFO [src.stage_a.parquet_writer]   Chunk 9: 8,253,156 rows
2025-12-22 18:53:22,251 INFO [src.stage_a.wrds_extractor]   Chunk 10: 7,540,103 NBBO records
2025-12-22 18:53:22,257 INFO [src.stage_a.parquet_writer]   Chunk 10: 7,540,103 rows
2025-12-22 18:53:22,726 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 75,215,240 total rows written
2025-12-22 18:59:42,701 INFO [src.stage_a.wrds_extractor]   Chunk 11: 9,191,036 NBBO records
2025-12-22 18:59:42,702 INFO [src.stage_a.parquet_writer]   Chunk 11: 9,191,036 rows
2025-12-22 18:59:43,558 INFO [src.stage_a.parquet_writer] ✓ Wrote 84,406,276 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-18
2025-12-22 18:59:43,568 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 18:59:43,568 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 18:59:43,568 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 18:59:43,568 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 18:59:43,568 INFO [src.stage_a.stage_a] Trades: 27,680,653 rows
2025-12-22 18:59:43,568 INFO [src.stage_a.stage_a] Nbbo: 84,406,276 rows
2025-12-22 18:59:43,568 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 18:59:43,568 INFO [src.stage_a.stage_a] Processing date 13/83: 2024-01-19
2025-12-22 18:59:43,568 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 18:59:43,568 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 18:59:43,568 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-01-19 (519 symbols)
2025-12-22 18:59:43,568 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 18:59:43,568 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 18:59:43,568 INFO [src.stage_a.stage_a] Extract run ID: ba708e5d-dff4-4531-8770-7383a8850404
2025-12-22 18:59:43,576 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 18:59:43,576 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 18:59:43,576 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 18:59:43,576 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 18:59:43,576 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 18:59:43,576 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 18:59:43,576 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 18:59:43,576 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 18:59:43,576 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 18:59:44,657 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 18:59:44,657 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-19...
2025-12-22 18:59:44,829 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240119 for 519 symbols
2025-12-22 19:03:25,198 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,915,632 trades
2025-12-22 19:03:25,198 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,915,632 rows
2025-12-22 19:05:32,556 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,116,961 trades
2025-12-22 19:05:32,557 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,116,961 rows
2025-12-22 19:07:58,687 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,254,776 trades
2025-12-22 19:07:58,687 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,254,776 rows
2025-12-22 19:09:56,200 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,893,266 trades
2025-12-22 19:09:56,200 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,893,266 rows
2025-12-22 19:12:36,985 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,617,295 trades
2025-12-22 19:12:36,985 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,617,295 rows
2025-12-22 19:15:01,584 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,364,800 trades
2025-12-22 19:15:01,584 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,364,800 rows
2025-12-22 19:18:27,053 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,500,543 trades
2025-12-22 19:18:27,053 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,500,543 rows
2025-12-22 19:21:26,266 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,014,606 trades
2025-12-22 19:21:26,266 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,014,606 rows
2025-12-22 19:23:57,565 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,429,898 trades
2025-12-22 19:23:57,567 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,429,898 rows
2025-12-22 19:27:08,272 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,327,663 trades
2025-12-22 19:27:08,272 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,327,663 rows
2025-12-22 19:27:08,710 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 27,435,440 total rows written
2025-12-22 19:28:33,161 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,131,275 trades
2025-12-22 19:28:33,161 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,131,275 rows
2025-12-22 19:28:33,520 INFO [src.stage_a.parquet_writer] ✓ Wrote 28,566,715 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-19
2025-12-22 19:28:33,521 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 19:28:33,521 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 19:28:33,521 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 19:28:33,521 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 19:28:33,521 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 19:28:33,521 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 19:28:33,521 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 19:28:38,071 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 19:28:38,071 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-19...
2025-12-22 19:28:38,266 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240119 for 519 symbols
2025-12-22 19:34:12,076 INFO [src.stage_a.wrds_extractor]   Chunk 1: 8,202,923 NBBO records
2025-12-22 19:34:12,076 INFO [src.stage_a.parquet_writer]   Chunk 1: 8,202,923 rows
2025-12-22 19:38:26,491 INFO [src.stage_a.wrds_extractor]   Chunk 2: 5,931,968 NBBO records
2025-12-22 19:38:26,496 INFO [src.stage_a.parquet_writer]   Chunk 2: 5,931,968 rows
2025-12-22 19:43:15,791 INFO [src.stage_a.wrds_extractor]   Chunk 3: 7,151,651 NBBO records
2025-12-22 19:43:15,792 INFO [src.stage_a.parquet_writer]   Chunk 3: 7,151,651 rows
2025-12-22 19:46:05,074 INFO [src.stage_a.wrds_extractor]   Chunk 4: 4,653,936 NBBO records
2025-12-22 19:46:05,076 INFO [src.stage_a.parquet_writer]   Chunk 4: 4,653,936 rows
2025-12-22 19:51:38,801 INFO [src.stage_a.wrds_extractor]   Chunk 5: 8,219,406 NBBO records
2025-12-22 19:51:38,801 INFO [src.stage_a.parquet_writer]   Chunk 5: 8,219,406 rows
2025-12-22 19:57:07,045 INFO [src.stage_a.wrds_extractor]   Chunk 6: 8,249,999 NBBO records
2025-12-22 19:57:07,048 INFO [src.stage_a.parquet_writer]   Chunk 6: 8,249,999 rows
2025-12-22 20:02:45,645 INFO [src.stage_a.wrds_extractor]   Chunk 7: 7,963,448 NBBO records
2025-12-22 20:02:45,649 INFO [src.stage_a.parquet_writer]   Chunk 7: 7,963,448 rows
2025-12-22 20:09:50,492 INFO [src.stage_a.wrds_extractor]   Chunk 8: 10,386,748 NBBO records
2025-12-22 20:09:50,494 INFO [src.stage_a.parquet_writer]   Chunk 8: 10,386,748 rows
2025-12-22 20:15:28,570 INFO [src.stage_a.wrds_extractor]   Chunk 9: 8,057,513 NBBO records
2025-12-22 20:15:28,573 INFO [src.stage_a.parquet_writer]   Chunk 9: 8,057,513 rows
2025-12-22 20:20:33,231 INFO [src.stage_a.wrds_extractor]   Chunk 10: 7,208,277 NBBO records
2025-12-22 20:20:33,232 INFO [src.stage_a.parquet_writer]   Chunk 10: 7,208,277 rows
2025-12-22 20:20:33,685 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 76,025,869 total rows written
2025-12-22 20:26:47,302 INFO [src.stage_a.wrds_extractor]   Chunk 11: 8,672,983 NBBO records
2025-12-22 20:26:47,303 INFO [src.stage_a.parquet_writer]   Chunk 11: 8,672,983 rows
2025-12-22 20:26:48,065 INFO [src.stage_a.parquet_writer] ✓ Wrote 84,698,852 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-19
2025-12-22 20:26:48,077 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 20:26:48,077 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 20:26:48,077 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 20:26:48,077 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 20:26:48,077 INFO [src.stage_a.stage_a] Trades: 28,566,715 rows
2025-12-22 20:26:48,077 INFO [src.stage_a.stage_a] Nbbo: 84,698,852 rows
2025-12-22 20:26:48,077 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 20:26:48,077 INFO [src.stage_a.stage_a] Processing date 14/83: 2024-01-22
2025-12-22 20:26:48,077 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 20:26:48,077 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 20:26:48,077 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-01-22 (519 symbols)
2025-12-22 20:26:48,077 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 20:26:48,077 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 20:26:48,077 INFO [src.stage_a.stage_a] Extract run ID: 5d5553c5-4500-413e-bab7-f31f6b915f7f
2025-12-22 20:26:48,085 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 20:26:48,085 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 20:26:48,085 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 20:26:48,085 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 20:26:48,085 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 20:26:48,085 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 20:26:48,085 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 20:26:48,085 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 20:26:48,085 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 20:26:50,521 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 20:26:50,521 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-22...
2025-12-22 20:26:50,662 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240122 for 519 symbols
2025-12-22 20:32:01,297 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,089,569 trades
2025-12-22 20:32:01,297 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,089,569 rows
2025-12-22 20:34:57,021 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,108,724 trades
2025-12-22 20:34:57,022 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,108,724 rows
2025-12-22 20:37:19,402 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,121,217 trades
2025-12-22 20:37:19,403 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,121,217 rows
2025-12-22 20:39:36,417 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,823,153 trades
2025-12-22 20:39:36,417 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,823,153 rows
2025-12-22 20:41:59,717 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,563,299 trades
2025-12-22 20:41:59,717 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,563,299 rows
2025-12-22 20:44:22,793 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,249,320 trades
2025-12-22 20:44:22,793 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,249,320 rows
2025-12-22 20:47:56,521 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,419,572 trades
2025-12-22 20:47:56,521 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,419,572 rows
2025-12-22 20:51:02,645 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,821,369 trades
2025-12-22 20:51:02,645 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,821,369 rows
2025-12-22 20:53:10,977 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,351,179 trades
2025-12-22 20:53:10,977 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,351,179 rows
2025-12-22 20:56:34,456 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,500,871 trades
2025-12-22 20:56:34,456 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,500,871 rows
2025-12-22 20:56:34,893 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 27,048,273 total rows written
2025-12-22 20:57:35,979 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,119,803 trades
2025-12-22 20:57:35,979 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,119,803 rows
2025-12-22 20:57:36,309 INFO [src.stage_a.parquet_writer] ✓ Wrote 28,168,076 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-22
2025-12-22 20:57:36,315 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 20:57:36,315 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 20:57:36,315 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 20:57:36,315 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 20:57:36,315 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 20:57:36,315 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 20:57:36,315 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 20:57:37,838 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 20:57:37,838 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-22...
2025-12-22 20:57:37,921 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240122 for 519 symbols
2025-12-22 21:02:26,120 INFO [src.stage_a.wrds_extractor]   Chunk 1: 8,253,020 NBBO records
2025-12-22 21:02:26,121 INFO [src.stage_a.parquet_writer]   Chunk 1: 8,253,020 rows
2025-12-22 21:05:49,680 INFO [src.stage_a.wrds_extractor]   Chunk 2: 5,660,967 NBBO records
2025-12-22 21:05:49,684 INFO [src.stage_a.parquet_writer]   Chunk 2: 5,660,967 rows
2025-12-22 21:09:24,284 INFO [src.stage_a.wrds_extractor]   Chunk 3: 6,422,601 NBBO records
2025-12-22 21:09:24,285 INFO [src.stage_a.parquet_writer]   Chunk 3: 6,422,601 rows
2025-12-22 21:11:26,341 INFO [src.stage_a.wrds_extractor]   Chunk 4: 4,880,705 NBBO records
2025-12-22 21:11:26,342 INFO [src.stage_a.parquet_writer]   Chunk 4: 4,880,705 rows
2025-12-22 21:12:47,396 INFO [src.stage_a.wrds_extractor]   Chunk 5: 7,273,995 NBBO records
2025-12-22 21:12:47,396 INFO [src.stage_a.parquet_writer]   Chunk 5: 7,273,995 rows
2025-12-22 21:14:12,735 INFO [src.stage_a.wrds_extractor]   Chunk 6: 7,036,419 NBBO records
2025-12-22 21:14:12,736 INFO [src.stage_a.parquet_writer]   Chunk 6: 7,036,419 rows
2025-12-22 21:17:19,914 INFO [src.stage_a.wrds_extractor]   Chunk 7: 7,585,475 NBBO records
2025-12-22 21:17:19,915 INFO [src.stage_a.parquet_writer]   Chunk 7: 7,585,475 rows
2025-12-22 21:22:12,344 INFO [src.stage_a.wrds_extractor]   Chunk 8: 9,780,162 NBBO records
2025-12-22 21:22:12,345 INFO [src.stage_a.parquet_writer]   Chunk 8: 9,780,162 rows
2025-12-22 21:27:14,211 INFO [src.stage_a.wrds_extractor]   Chunk 9: 9,063,101 NBBO records
2025-12-22 21:27:14,218 INFO [src.stage_a.parquet_writer]   Chunk 9: 9,063,101 rows
2025-12-22 21:31:29,375 INFO [src.stage_a.wrds_extractor]   Chunk 10: 7,289,999 NBBO records
2025-12-22 21:31:29,379 INFO [src.stage_a.parquet_writer]   Chunk 10: 7,289,999 rows
2025-12-22 21:31:29,834 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 73,246,444 total rows written
2025-12-22 21:35:34,089 INFO [src.stage_a.wrds_extractor]   Chunk 11: 8,184,766 NBBO records
2025-12-22 21:35:34,090 INFO [src.stage_a.parquet_writer]   Chunk 11: 8,184,766 rows
2025-12-22 21:35:34,821 INFO [src.stage_a.parquet_writer] ✓ Wrote 81,431,210 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-22
2025-12-22 21:35:34,829 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 21:35:34,829 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 21:35:34,829 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 21:35:34,829 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 21:35:34,829 INFO [src.stage_a.stage_a] Trades: 28,168,076 rows
2025-12-22 21:35:34,829 INFO [src.stage_a.stage_a] Nbbo: 81,431,210 rows
2025-12-22 21:35:34,829 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 21:35:34,829 INFO [src.stage_a.stage_a] Processing date 15/83: 2024-01-23
2025-12-22 21:35:34,829 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 21:35:34,829 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 21:35:34,829 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-01-23 (519 symbols)
2025-12-22 21:35:34,829 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 21:35:34,829 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 21:35:34,829 INFO [src.stage_a.stage_a] Extract run ID: cb4e6174-e6a5-4ddb-b35c-90c0a08de11a
2025-12-22 21:35:34,837 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 21:35:34,837 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 21:35:34,837 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 21:35:34,837 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 21:35:34,837 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 21:35:34,837 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 21:35:34,837 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 21:35:34,838 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 21:35:34,838 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 21:35:36,006 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 21:35:36,006 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-23...
2025-12-22 21:35:36,115 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240123 for 519 symbols
2025-12-22 21:36:54,428 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,178,815 trades
2025-12-22 21:36:54,428 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,178,815 rows
2025-12-22 21:38:23,798 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,940,107 trades
2025-12-22 21:38:23,798 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,940,107 rows
2025-12-22 21:40:12,277 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,015,007 trades
2025-12-22 21:40:12,277 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,015,007 rows
2025-12-22 21:41:38,311 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,780,212 trades
2025-12-22 21:41:38,311 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,780,212 rows
2025-12-22 21:42:22,257 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,226,494 trades
2025-12-22 21:42:22,257 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,226,494 rows
2025-12-22 21:43:04,559 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,301,155 trades
2025-12-22 21:43:04,559 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,301,155 rows
2025-12-22 21:45:37,444 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,291,492 trades
2025-12-22 21:45:37,444 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,291,492 rows
2025-12-22 21:47:41,207 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,480,526 trades
2025-12-22 21:47:41,207 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,480,526 rows
2025-12-22 21:49:49,000 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,238,328 trades
2025-12-22 21:49:49,000 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,238,328 rows
2025-12-22 21:52:46,731 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,295,453 trades
2025-12-22 21:52:46,731 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,295,453 rows
2025-12-22 21:52:47,138 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 24,747,589 total rows written
2025-12-22 21:53:35,445 INFO [src.stage_a.wrds_extractor]   Chunk 11: 975,473 trades
2025-12-22 21:53:35,445 INFO [src.stage_a.parquet_writer]   Chunk 11: 975,473 rows
2025-12-22 21:53:35,752 INFO [src.stage_a.parquet_writer] ✓ Wrote 25,723,062 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-23
2025-12-22 21:53:35,753 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 21:53:35,753 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 21:53:35,753 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 21:53:35,753 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 21:53:35,753 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 21:53:35,753 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 21:53:35,753 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 21:53:40,024 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 21:53:40,024 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-23...
2025-12-22 21:53:40,230 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240123 for 519 symbols
2025-12-22 21:55:02,398 INFO [src.stage_a.wrds_extractor]   Chunk 1: 7,121,530 NBBO records
2025-12-22 21:55:02,398 INFO [src.stage_a.parquet_writer]   Chunk 1: 7,121,530 rows
2025-12-22 21:56:02,703 INFO [src.stage_a.wrds_extractor]   Chunk 2: 4,988,238 NBBO records
2025-12-22 21:56:02,704 INFO [src.stage_a.parquet_writer]   Chunk 2: 4,988,238 rows
2025-12-22 21:57:07,464 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,699,254 NBBO records
2025-12-22 21:57:07,465 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,699,254 rows
2025-12-22 21:58:03,960 INFO [src.stage_a.wrds_extractor]   Chunk 4: 4,259,523 NBBO records
2025-12-22 21:58:03,961 INFO [src.stage_a.parquet_writer]   Chunk 4: 4,259,523 rows
2025-12-22 22:01:29,511 INFO [src.stage_a.wrds_extractor]   Chunk 5: 6,174,594 NBBO records
2025-12-22 22:01:29,511 INFO [src.stage_a.parquet_writer]   Chunk 5: 6,174,594 rows
2025-12-22 22:04:20,672 INFO [src.stage_a.wrds_extractor]   Chunk 6: 6,588,692 NBBO records
2025-12-22 22:04:20,673 INFO [src.stage_a.parquet_writer]   Chunk 6: 6,588,692 rows
2025-12-22 22:05:37,823 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,629,485 NBBO records
2025-12-22 22:05:37,824 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,629,485 rows
2025-12-22 22:07:10,144 INFO [src.stage_a.wrds_extractor]   Chunk 8: 7,973,571 NBBO records
2025-12-22 22:07:10,146 INFO [src.stage_a.parquet_writer]   Chunk 8: 7,973,571 rows
2025-12-22 22:08:58,033 INFO [src.stage_a.wrds_extractor]   Chunk 9: 7,359,072 NBBO records
2025-12-22 22:08:58,034 INFO [src.stage_a.parquet_writer]   Chunk 9: 7,359,072 rows
2025-12-22 22:13:01,603 INFO [src.stage_a.wrds_extractor]   Chunk 10: 6,475,438 NBBO records
2025-12-22 22:13:01,604 INFO [src.stage_a.parquet_writer]   Chunk 10: 6,475,438 rows
2025-12-22 22:13:02,024 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 63,269,397 total rows written
2025-12-22 22:17:44,206 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,559,852 NBBO records
2025-12-22 22:17:44,207 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,559,852 rows
2025-12-22 22:17:44,840 INFO [src.stage_a.parquet_writer] ✓ Wrote 69,829,249 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-23
2025-12-22 22:17:44,849 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 22:17:44,849 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 22:17:44,849 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 22:17:44,849 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 22:17:44,849 INFO [src.stage_a.stage_a] Trades: 25,723,062 rows
2025-12-22 22:17:44,849 INFO [src.stage_a.stage_a] Nbbo: 69,829,249 rows
2025-12-22 22:17:44,849 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 22:17:44,849 INFO [src.stage_a.stage_a] Processing date 16/83: 2024-01-24
2025-12-22 22:17:44,849 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 22:17:44,849 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 22:17:44,849 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-01-24 (519 symbols)
2025-12-22 22:17:44,849 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 22:17:44,849 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 22:17:44,849 INFO [src.stage_a.stage_a] Extract run ID: 72d79a86-7536-4cfe-8e38-8ce88d4434ec
2025-12-22 22:17:44,857 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 22:17:44,857 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 22:17:44,857 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 22:17:44,857 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 22:17:44,857 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 22:17:44,857 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 22:17:44,857 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 22:17:44,857 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 22:17:44,857 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 22:17:48,694 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 22:17:48,694 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-24...
2025-12-22 22:17:49,007 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240124 for 519 symbols
2025-12-22 22:21:58,103 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,928,181 trades
2025-12-22 22:21:58,103 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,928,181 rows
2025-12-22 22:23:57,508 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,153,307 trades
2025-12-22 22:23:57,509 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,153,307 rows
2025-12-22 22:25:55,395 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,272,077 trades
2025-12-22 22:25:55,395 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,272,077 rows
2025-12-22 22:27:52,823 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,026,332 trades
2025-12-22 22:27:52,823 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,026,332 rows
2025-12-22 22:29:20,586 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,541,908 trades
2025-12-22 22:29:20,586 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,541,908 rows
2025-12-22 22:30:11,668 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,393,200 trades
2025-12-22 22:30:11,668 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,393,200 rows
2025-12-22 22:31:41,690 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,020,768 trades
2025-12-22 22:31:41,690 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,020,768 rows
2025-12-22 22:34:46,371 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,757,218 trades
2025-12-22 22:34:46,373 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,757,218 rows
2025-12-22 22:37:49,822 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,598,025 trades
2025-12-22 22:37:49,822 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,598,025 rows
2025-12-22 22:41:45,843 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,441,559 trades
2025-12-22 22:41:45,843 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,441,559 rows
2025-12-22 22:41:46,263 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 28,132,575 total rows written
2025-12-22 22:42:32,134 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,171,145 trades
2025-12-22 22:42:32,134 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,171,145 rows
2025-12-22 22:42:32,465 INFO [src.stage_a.parquet_writer] ✓ Wrote 29,303,720 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-24
2025-12-22 22:42:32,466 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 22:42:32,466 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 22:42:32,466 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 22:42:32,466 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 22:42:32,466 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 22:42:32,466 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 22:42:32,466 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 22:42:33,942 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 22:42:33,942 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-24...
2025-12-22 22:42:34,012 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240124 for 519 symbols
2025-12-22 22:44:31,188 INFO [src.stage_a.wrds_extractor]   Chunk 1: 8,260,959 NBBO records
2025-12-22 22:44:31,189 INFO [src.stage_a.parquet_writer]   Chunk 1: 8,260,959 rows
2025-12-22 22:47:53,963 INFO [src.stage_a.wrds_extractor]   Chunk 2: 5,851,507 NBBO records
2025-12-22 22:47:53,969 INFO [src.stage_a.parquet_writer]   Chunk 2: 5,851,507 rows
2025-12-22 22:50:15,657 INFO [src.stage_a.wrds_extractor]   Chunk 3: 6,851,587 NBBO records
2025-12-22 22:50:15,658 INFO [src.stage_a.parquet_writer]   Chunk 3: 6,851,587 rows
2025-12-22 22:51:20,438 INFO [src.stage_a.wrds_extractor]   Chunk 4: 5,183,068 NBBO records
2025-12-22 22:51:20,439 INFO [src.stage_a.parquet_writer]   Chunk 4: 5,183,068 rows
2025-12-22 22:52:54,284 INFO [src.stage_a.wrds_extractor]   Chunk 5: 7,544,124 NBBO records
2025-12-22 22:52:54,284 INFO [src.stage_a.parquet_writer]   Chunk 5: 7,544,124 rows
2025-12-22 22:54:30,684 INFO [src.stage_a.wrds_extractor]   Chunk 6: 7,630,041 NBBO records
2025-12-22 22:54:30,685 INFO [src.stage_a.parquet_writer]   Chunk 6: 7,630,041 rows
2025-12-22 22:58:28,626 INFO [src.stage_a.wrds_extractor]   Chunk 7: 8,273,086 NBBO records
2025-12-22 22:58:28,627 INFO [src.stage_a.parquet_writer]   Chunk 7: 8,273,086 rows
2025-12-22 23:02:02,058 INFO [src.stage_a.wrds_extractor]   Chunk 8: 9,566,860 NBBO records
2025-12-22 23:02:02,061 INFO [src.stage_a.parquet_writer]   Chunk 8: 9,566,860 rows
2025-12-22 23:06:59,447 INFO [src.stage_a.wrds_extractor]   Chunk 9: 9,596,537 NBBO records
2025-12-22 23:06:59,454 INFO [src.stage_a.parquet_writer]   Chunk 9: 9,596,537 rows
2025-12-22 23:11:04,922 INFO [src.stage_a.wrds_extractor]   Chunk 10: 7,096,775 NBBO records
2025-12-22 23:11:04,927 INFO [src.stage_a.parquet_writer]   Chunk 10: 7,096,775 rows
2025-12-22 23:11:05,400 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 75,854,544 total rows written
2025-12-22 23:16:02,744 INFO [src.stage_a.wrds_extractor]   Chunk 11: 8,418,655 NBBO records
2025-12-22 23:16:02,745 INFO [src.stage_a.parquet_writer]   Chunk 11: 8,418,655 rows
2025-12-22 23:16:03,493 INFO [src.stage_a.parquet_writer] ✓ Wrote 84,273,199 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-24
2025-12-22 23:16:03,510 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 23:16:03,510 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 23:16:03,510 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-22 23:16:03,510 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 23:16:03,510 INFO [src.stage_a.stage_a] Trades: 29,303,720 rows
2025-12-22 23:16:03,510 INFO [src.stage_a.stage_a] Nbbo: 84,273,199 rows
2025-12-22 23:16:03,510 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 23:16:03,510 INFO [src.stage_a.stage_a] Processing date 17/83: 2024-01-25
2025-12-22 23:16:03,510 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 23:16:03,510 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 23:16:03,510 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-01-25 (519 symbols)
2025-12-22 23:16:03,510 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-22 23:16:03,510 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 23:16:03,510 INFO [src.stage_a.stage_a] Extract run ID: b1e1d3e2-2e37-4645-af95-b2a72f19c18e
2025-12-22 23:16:03,518 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-22 23:16:03,518 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-22 23:16:03,518 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-22 23:16:03,518 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 23:16:03,518 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-22 23:16:03,518 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 23:16:03,518 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 23:16:03,518 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 23:16:03,518 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 23:16:05,420 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 23:16:05,420 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-25...
2025-12-22 23:16:05,547 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240125 for 519 symbols
2025-12-22 23:18:56,023 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,131,644 trades
2025-12-22 23:18:56,023 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,131,644 rows
2025-12-22 23:20:48,146 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,431,259 trades
2025-12-22 23:20:48,146 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,431,259 rows
2025-12-22 23:21:40,377 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,466,807 trades
2025-12-22 23:21:40,378 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,466,807 rows
2025-12-22 23:22:14,356 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,945,459 trades
2025-12-22 23:22:14,357 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,945,459 rows
2025-12-22 23:23:15,900 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,207,674 trades
2025-12-22 23:23:15,900 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,207,674 rows
2025-12-22 23:24:00,805 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,480,196 trades
2025-12-22 23:24:00,805 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,480,196 rows
2025-12-22 23:25:04,287 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,701,573 trades
2025-12-22 23:25:04,287 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,701,573 rows
2025-12-22 23:25:53,979 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,035,911 trades
2025-12-22 23:25:53,983 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,035,911 rows
2025-12-22 23:27:52,272 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,517,013 trades
2025-12-22 23:27:52,272 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,517,013 rows
2025-12-22 23:31:33,374 INFO [src.stage_a.wrds_extractor]   Chunk 10: 5,220,013 trades
2025-12-22 23:31:33,374 INFO [src.stage_a.parquet_writer]   Chunk 10: 5,220,013 rows
2025-12-22 23:31:33,913 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 31,137,549 total rows written
2025-12-22 23:31:54,258 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,236,114 trades
2025-12-22 23:31:54,264 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,236,114 rows
2025-12-22 23:31:54,628 INFO [src.stage_a.parquet_writer] ✓ Wrote 32,373,663 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-25
2025-12-22 23:31:54,629 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-22 23:31:54,629 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-22 23:31:54,629 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-22 23:31:54,629 INFO [src.stage_a.stage_a] ================================================================================
2025-12-22 23:31:54,629 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-22 23:31:54,629 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-22 23:31:54,629 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-22 23:31:55,898 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-22 23:31:55,898 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-25...
2025-12-22 23:31:55,959 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240125 for 519 symbols
2025-12-22 23:35:17,295 INFO [src.stage_a.wrds_extractor]   Chunk 1: 9,666,161 NBBO records
2025-12-22 23:35:17,295 INFO [src.stage_a.parquet_writer]   Chunk 1: 9,666,161 rows
2025-12-22 23:38:31,553 INFO [src.stage_a.wrds_extractor]   Chunk 2: 5,973,809 NBBO records
2025-12-22 23:38:31,560 INFO [src.stage_a.parquet_writer]   Chunk 2: 5,973,809 rows
2025-12-22 23:42:06,001 INFO [src.stage_a.wrds_extractor]   Chunk 3: 7,271,103 NBBO records
2025-12-22 23:42:06,002 INFO [src.stage_a.parquet_writer]   Chunk 3: 7,271,103 rows
2025-12-22 23:44:43,483 INFO [src.stage_a.wrds_extractor]   Chunk 4: 5,342,466 NBBO records
2025-12-22 23:44:43,485 INFO [src.stage_a.parquet_writer]   Chunk 4: 5,342,466 rows
2025-12-22 23:48:52,607 INFO [src.stage_a.wrds_extractor]   Chunk 5: 8,158,538 NBBO records
2025-12-22 23:48:52,607 INFO [src.stage_a.parquet_writer]   Chunk 5: 8,158,538 rows
2025-12-22 23:52:36,978 INFO [src.stage_a.wrds_extractor]   Chunk 6: 7,878,553 NBBO records
2025-12-22 23:52:36,983 INFO [src.stage_a.parquet_writer]   Chunk 6: 7,878,553 rows
2025-12-22 23:56:45,974 INFO [src.stage_a.wrds_extractor]   Chunk 7: 8,560,832 NBBO records
2025-12-22 23:56:45,975 INFO [src.stage_a.parquet_writer]   Chunk 7: 8,560,832 rows
2025-12-23 00:01:40,871 INFO [src.stage_a.wrds_extractor]   Chunk 8: 10,725,529 NBBO records
2025-12-23 00:01:40,876 INFO [src.stage_a.parquet_writer]   Chunk 8: 10,725,529 rows
2025-12-23 00:07:08,679 INFO [src.stage_a.wrds_extractor]   Chunk 9: 10,075,614 NBBO records
2025-12-23 00:07:08,683 INFO [src.stage_a.parquet_writer]   Chunk 9: 10,075,614 rows
2025-12-23 00:11:41,381 INFO [src.stage_a.wrds_extractor]   Chunk 10: 8,292,995 NBBO records
2025-12-23 00:11:41,386 INFO [src.stage_a.parquet_writer]   Chunk 10: 8,292,995 rows
2025-12-23 00:11:41,903 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 81,945,600 total rows written
2025-12-23 00:16:20,741 INFO [src.stage_a.wrds_extractor]   Chunk 11: 9,115,575 NBBO records
2025-12-23 00:16:20,744 INFO [src.stage_a.parquet_writer]   Chunk 11: 9,115,575 rows
2025-12-23 00:16:21,573 INFO [src.stage_a.parquet_writer] ✓ Wrote 91,061,175 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-25
2025-12-23 00:16:21,586 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 00:16:21,586 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 00:16:21,586 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 00:16:21,586 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 00:16:21,586 INFO [src.stage_a.stage_a] Trades: 32,373,663 rows
2025-12-23 00:16:21,586 INFO [src.stage_a.stage_a] Nbbo: 91,061,175 rows
2025-12-23 00:16:21,586 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 00:16:21,586 INFO [src.stage_a.stage_a] Processing date 18/83: 2024-01-26
2025-12-23 00:16:21,586 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 00:16:21,586 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 00:16:21,586 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-01-26 (519 symbols)
2025-12-23 00:16:21,586 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 00:16:21,586 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 00:16:21,586 INFO [src.stage_a.stage_a] Extract run ID: 210eb09c-be8b-4b33-bbf0-dbd17f5c9da4
2025-12-23 00:16:21,594 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 00:16:21,594 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 00:16:21,595 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 00:16:21,595 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 00:16:21,595 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 00:16:21,595 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 00:16:21,595 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 00:16:21,595 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 00:16:21,595 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 00:16:23,267 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 00:16:23,267 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-26...
2025-12-23 00:16:23,357 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240126 for 519 symbols
2025-12-23 00:19:20,770 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,576,028 trades
2025-12-23 00:19:20,770 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,576,028 rows
2025-12-23 00:21:05,846 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,882,322 trades
2025-12-23 00:21:05,846 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,882,322 rows
2025-12-23 00:22:59,985 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,064,456 trades
2025-12-23 00:22:59,985 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,064,456 rows
2025-12-23 00:24:42,379 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,577,027 trades
2025-12-23 00:24:42,379 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,577,027 rows
2025-12-23 00:27:15,371 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,802,312 trades
2025-12-23 00:27:15,371 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,802,312 rows
2025-12-23 00:29:30,704 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,081,087 trades
2025-12-23 00:29:30,704 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,081,087 rows
2025-12-23 00:32:41,945 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,213,463 trades
2025-12-23 00:32:41,945 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,213,463 rows
2025-12-23 00:35:11,758 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,351,081 trades
2025-12-23 00:35:11,758 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,351,081 rows
2025-12-23 00:37:14,854 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,207,570 trades
2025-12-23 00:37:14,854 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,207,570 rows
2025-12-23 00:40:35,680 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,416,901 trades
2025-12-23 00:40:35,680 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,416,901 rows
2025-12-23 00:40:36,113 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,172,247 total rows written
2025-12-23 00:41:25,370 INFO [src.stage_a.wrds_extractor]   Chunk 11: 940,540 trades
2025-12-23 00:41:25,371 INFO [src.stage_a.parquet_writer]   Chunk 11: 940,540 rows
2025-12-23 00:41:25,649 INFO [src.stage_a.parquet_writer] ✓ Wrote 26,112,787 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-26
2025-12-23 00:41:25,650 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 00:41:25,650 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 00:41:25,650 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 00:41:25,650 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 00:41:25,650 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 00:41:25,650 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 00:41:25,650 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 00:41:27,866 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 00:41:27,866 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-26...
2025-12-23 00:41:27,950 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240126 for 519 symbols
2025-12-23 00:45:36,081 INFO [src.stage_a.wrds_extractor]   Chunk 1: 7,890,541 NBBO records
2025-12-23 00:45:36,081 INFO [src.stage_a.parquet_writer]   Chunk 1: 7,890,541 rows
2025-12-23 00:48:14,330 INFO [src.stage_a.wrds_extractor]   Chunk 2: 4,959,343 NBBO records
2025-12-23 00:48:14,332 INFO [src.stage_a.parquet_writer]   Chunk 2: 4,959,343 rows
2025-12-23 00:51:04,308 INFO [src.stage_a.wrds_extractor]   Chunk 3: 6,093,129 NBBO records
2025-12-23 00:51:04,308 INFO [src.stage_a.parquet_writer]   Chunk 3: 6,093,129 rows
2025-12-23 00:53:04,219 INFO [src.stage_a.wrds_extractor]   Chunk 4: 4,604,157 NBBO records
2025-12-23 00:53:04,220 INFO [src.stage_a.parquet_writer]   Chunk 4: 4,604,157 rows
2025-12-23 00:56:46,473 INFO [src.stage_a.wrds_extractor]   Chunk 5: 6,686,666 NBBO records
2025-12-23 00:56:46,473 INFO [src.stage_a.parquet_writer]   Chunk 5: 6,686,666 rows
2025-12-23 01:01:31,573 INFO [src.stage_a.wrds_extractor]   Chunk 6: 6,618,468 NBBO records
2025-12-23 01:01:31,574 INFO [src.stage_a.parquet_writer]   Chunk 6: 6,618,468 rows
2025-12-23 01:06:20,843 INFO [src.stage_a.wrds_extractor]   Chunk 7: 7,381,458 NBBO records
2025-12-23 01:06:20,844 INFO [src.stage_a.parquet_writer]   Chunk 7: 7,381,458 rows
2025-12-23 01:11:58,501 INFO [src.stage_a.wrds_extractor]   Chunk 8: 8,830,024 NBBO records
2025-12-23 01:11:58,503 INFO [src.stage_a.parquet_writer]   Chunk 8: 8,830,024 rows
2025-12-23 01:17:33,789 INFO [src.stage_a.wrds_extractor]   Chunk 9: 8,210,782 NBBO records
2025-12-23 01:17:33,796 INFO [src.stage_a.parquet_writer]   Chunk 9: 8,210,782 rows
2025-12-23 01:21:15,580 INFO [src.stage_a.wrds_extractor]   Chunk 10: 6,428,578 NBBO records
2025-12-23 01:21:15,583 INFO [src.stage_a.parquet_writer]   Chunk 10: 6,428,578 rows
2025-12-23 01:21:16,024 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 67,703,146 total rows written
2025-12-23 01:26:24,967 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,444,792 NBBO records
2025-12-23 01:26:24,968 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,444,792 rows
2025-12-23 01:26:25,667 INFO [src.stage_a.parquet_writer] ✓ Wrote 75,147,938 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-26
2025-12-23 01:26:25,677 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 01:26:25,677 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 01:26:25,677 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 01:26:25,677 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 01:26:25,677 INFO [src.stage_a.stage_a] Trades: 26,112,787 rows
2025-12-23 01:26:25,678 INFO [src.stage_a.stage_a] Nbbo: 75,147,938 rows
2025-12-23 01:26:25,678 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 01:26:25,678 INFO [src.stage_a.stage_a] Processing date 19/83: 2024-01-29
2025-12-23 01:26:25,678 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 01:26:25,678 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 01:26:25,678 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-01-29 (519 symbols)
2025-12-23 01:26:25,678 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 01:26:25,678 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 01:26:25,678 INFO [src.stage_a.stage_a] Extract run ID: 265820df-7379-4dc8-99e2-21e027c960dd
2025-12-23 01:26:25,686 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 01:26:25,686 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 01:26:25,686 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 01:26:25,686 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 01:26:25,686 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 01:26:25,686 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 01:26:25,686 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 01:26:25,686 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 01:26:25,686 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 01:26:29,944 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 01:26:29,944 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-29...
2025-12-23 01:26:30,261 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240129 for 519 symbols
2025-12-23 01:29:49,999 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,441,049 trades
2025-12-23 01:29:49,999 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,441,049 rows
2025-12-23 01:31:17,213 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,940,903 trades
2025-12-23 01:31:17,213 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,940,903 rows
2025-12-23 01:33:20,125 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,944,192 trades
2025-12-23 01:33:20,125 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,944,192 rows
2025-12-23 01:34:26,448 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,574,996 trades
2025-12-23 01:34:26,449 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,574,996 rows
2025-12-23 01:36:52,225 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,394,508 trades
2025-12-23 01:36:52,225 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,394,508 rows
2025-12-23 01:38:29,950 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,059,747 trades
2025-12-23 01:38:29,951 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,059,747 rows
2025-12-23 01:41:04,297 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,245,900 trades
2025-12-23 01:41:04,297 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,245,900 rows
2025-12-23 01:43:00,858 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,443,990 trades
2025-12-23 01:43:00,858 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,443,990 rows
2025-12-23 01:44:58,806 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,171,560 trades
2025-12-23 01:44:58,806 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,171,560 rows
2025-12-23 01:47:59,982 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,442,441 trades
2025-12-23 01:47:59,983 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,442,441 rows
2025-12-23 01:48:00,410 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 24,659,286 total rows written
2025-12-23 01:49:04,223 INFO [src.stage_a.wrds_extractor]   Chunk 11: 875,742 trades
2025-12-23 01:49:04,223 INFO [src.stage_a.parquet_writer]   Chunk 11: 875,742 rows
2025-12-23 01:49:04,521 INFO [src.stage_a.parquet_writer] ✓ Wrote 25,535,028 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-29
2025-12-23 01:49:04,522 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 01:49:04,522 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 01:49:04,522 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 01:49:04,522 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 01:49:04,522 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 01:49:04,522 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 01:49:04,522 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 01:49:08,870 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 01:49:08,871 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-29...
2025-12-23 01:49:09,061 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240129 for 519 symbols
2025-12-23 01:53:47,483 INFO [src.stage_a.wrds_extractor]   Chunk 1: 6,902,288 NBBO records
2025-12-23 01:53:47,483 INFO [src.stage_a.parquet_writer]   Chunk 1: 6,902,288 rows
2025-12-23 01:56:35,079 INFO [src.stage_a.wrds_extractor]   Chunk 2: 4,487,395 NBBO records
2025-12-23 01:56:35,079 INFO [src.stage_a.parquet_writer]   Chunk 2: 4,487,395 rows
2025-12-23 01:59:57,757 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,311,430 NBBO records
2025-12-23 01:59:57,757 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,311,430 rows
2025-12-23 02:02:35,469 INFO [src.stage_a.wrds_extractor]   Chunk 4: 4,165,059 NBBO records
2025-12-23 02:02:35,469 INFO [src.stage_a.parquet_writer]   Chunk 4: 4,165,059 rows
2025-12-23 02:06:00,882 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,584,114 NBBO records
2025-12-23 02:06:00,883 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,584,114 rows
2025-12-23 02:10:02,239 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,774,871 NBBO records
2025-12-23 02:10:02,240 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,774,871 rows
2025-12-23 02:13:49,110 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,254,076 NBBO records
2025-12-23 02:13:49,110 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,254,076 rows
2025-12-23 02:18:39,799 INFO [src.stage_a.wrds_extractor]   Chunk 8: 8,153,357 NBBO records
2025-12-23 02:18:39,800 INFO [src.stage_a.parquet_writer]   Chunk 8: 8,153,357 rows
2025-12-23 02:22:38,051 INFO [src.stage_a.wrds_extractor]   Chunk 9: 6,856,215 NBBO records
2025-12-23 02:22:38,056 INFO [src.stage_a.parquet_writer]   Chunk 9: 6,856,215 rows
2025-12-23 02:26:35,382 INFO [src.stage_a.wrds_extractor]   Chunk 10: 6,296,022 NBBO records
2025-12-23 02:26:35,383 INFO [src.stage_a.parquet_writer]   Chunk 10: 6,296,022 rows
2025-12-23 02:26:35,811 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 59,784,827 total rows written
2025-12-23 02:30:23,141 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,057,450 NBBO records
2025-12-23 02:30:23,142 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,057,450 rows
2025-12-23 02:30:23,740 INFO [src.stage_a.parquet_writer] ✓ Wrote 65,842,277 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-29
2025-12-23 02:30:23,747 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 02:30:23,747 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 02:30:23,747 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 02:30:23,747 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 02:30:23,747 INFO [src.stage_a.stage_a] Trades: 25,535,028 rows
2025-12-23 02:30:23,747 INFO [src.stage_a.stage_a] Nbbo: 65,842,277 rows
2025-12-23 02:30:23,747 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 02:30:23,747 INFO [src.stage_a.stage_a] Processing date 20/83: 2024-01-30
2025-12-23 02:30:23,747 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 02:30:23,747 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 02:30:23,747 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-01-30 (519 symbols)
2025-12-23 02:30:23,747 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 02:30:23,747 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 02:30:23,747 INFO [src.stage_a.stage_a] Extract run ID: e492c803-fa01-49eb-936c-3b32f8c5e607
2025-12-23 02:30:23,756 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 02:30:23,756 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 02:30:23,756 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 02:30:23,756 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 02:30:23,756 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 02:30:23,756 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 02:30:23,756 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 02:30:23,756 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 02:30:23,756 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 02:30:25,734 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 02:30:25,734 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-30...
2025-12-23 02:30:25,808 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240130 for 519 symbols
2025-12-23 02:33:43,738 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,621,389 trades
2025-12-23 02:33:43,738 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,621,389 rows
2025-12-23 02:36:17,693 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,345,528 trades
2025-12-23 02:36:17,693 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,345,528 rows
2025-12-23 02:38:00,824 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,001,427 trades
2025-12-23 02:38:00,824 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,001,427 rows
2025-12-23 02:39:21,674 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,700,416 trades
2025-12-23 02:39:21,674 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,700,416 rows
2025-12-23 02:41:59,777 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,847,408 trades
2025-12-23 02:41:59,777 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,847,408 rows
2025-12-23 02:44:31,260 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,023,766 trades
2025-12-23 02:44:31,260 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,023,766 rows
2025-12-23 02:48:32,140 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,397,593 trades
2025-12-23 02:48:32,140 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,397,593 rows
2025-12-23 02:51:15,198 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,640,825 trades
2025-12-23 02:51:15,199 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,640,825 rows
2025-12-23 02:53:48,178 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,412,110 trades
2025-12-23 02:53:48,178 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,412,110 rows
2025-12-23 02:57:36,242 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,371,567 trades
2025-12-23 02:57:36,242 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,371,567 rows
2025-12-23 02:57:36,699 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,362,029 total rows written
2025-12-23 02:58:34,758 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,036,827 trades
2025-12-23 02:58:34,759 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,036,827 rows
2025-12-23 02:58:35,090 INFO [src.stage_a.parquet_writer] ✓ Wrote 27,398,856 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-30
2025-12-23 02:58:35,091 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 02:58:35,091 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 02:58:35,091 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 02:58:35,091 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 02:58:35,091 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 02:58:35,091 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 02:58:35,091 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 02:58:37,156 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 02:58:37,166 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-30...
2025-12-23 02:58:37,335 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240130 for 519 symbols
2025-12-23 03:02:55,772 INFO [src.stage_a.wrds_extractor]   Chunk 1: 7,227,983 NBBO records
2025-12-23 03:02:55,772 INFO [src.stage_a.parquet_writer]   Chunk 1: 7,227,983 rows
2025-12-23 03:05:52,983 INFO [src.stage_a.wrds_extractor]   Chunk 2: 4,971,197 NBBO records
2025-12-23 03:05:52,984 INFO [src.stage_a.parquet_writer]   Chunk 2: 4,971,197 rows
2025-12-23 03:09:04,626 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,579,030 NBBO records
2025-12-23 03:09:04,626 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,579,030 rows
2025-12-23 03:11:31,566 INFO [src.stage_a.wrds_extractor]   Chunk 4: 4,229,366 NBBO records
2025-12-23 03:11:31,567 INFO [src.stage_a.parquet_writer]   Chunk 4: 4,229,366 rows
2025-12-23 03:14:59,628 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,776,375 NBBO records
2025-12-23 03:14:59,628 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,776,375 rows
2025-12-23 03:18:42,606 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,959,564 NBBO records
2025-12-23 03:18:42,607 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,959,564 rows
2025-12-23 03:22:44,621 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,253,034 NBBO records
2025-12-23 03:22:44,623 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,253,034 rows
2025-12-23 03:28:09,487 INFO [src.stage_a.wrds_extractor]   Chunk 8: 8,669,632 NBBO records
2025-12-23 03:28:09,488 INFO [src.stage_a.parquet_writer]   Chunk 8: 8,669,632 rows
2025-12-23 03:33:14,142 INFO [src.stage_a.wrds_extractor]   Chunk 9: 7,197,065 NBBO records
2025-12-23 03:33:14,146 INFO [src.stage_a.parquet_writer]   Chunk 9: 7,197,065 rows
2025-12-23 03:37:33,539 INFO [src.stage_a.wrds_extractor]   Chunk 10: 6,199,027 NBBO records
2025-12-23 03:37:33,542 INFO [src.stage_a.parquet_writer]   Chunk 10: 6,199,027 rows
2025-12-23 03:37:33,990 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 62,062,273 total rows written
2025-12-23 03:41:42,039 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,559,030 NBBO records
2025-12-23 03:41:42,050 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,559,030 rows
2025-12-23 03:41:42,704 INFO [src.stage_a.parquet_writer] ✓ Wrote 68,621,303 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-30
2025-12-23 03:41:42,712 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 03:41:42,712 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 03:41:42,712 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 03:41:42,712 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 03:41:42,712 INFO [src.stage_a.stage_a] Trades: 27,398,856 rows
2025-12-23 03:41:42,712 INFO [src.stage_a.stage_a] Nbbo: 68,621,303 rows
2025-12-23 03:41:42,712 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 03:41:42,712 INFO [src.stage_a.stage_a] Processing date 21/83: 2024-01-31
2025-12-23 03:41:42,712 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 03:41:42,712 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 03:41:42,712 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-01-31 (519 symbols)
2025-12-23 03:41:42,712 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 03:41:42,712 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 03:41:42,712 INFO [src.stage_a.stage_a] Extract run ID: bf85e6c3-1b0f-4041-80d1-f956f8f2a867
2025-12-23 03:41:42,730 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 03:41:42,730 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 03:41:42,730 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 03:41:42,730 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 03:41:42,730 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 03:41:42,730 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 03:41:42,730 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 03:41:42,730 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 03:41:42,730 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 03:41:44,294 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 03:41:44,304 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-31...
2025-12-23 03:41:44,394 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240131 for 519 symbols
2025-12-23 03:45:59,471 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,185,304 trades
2025-12-23 03:45:59,472 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,185,304 rows
2025-12-23 03:48:01,769 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,624,434 trades
2025-12-23 03:48:01,769 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,624,434 rows
2025-12-23 03:50:12,569 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,301,546 trades
2025-12-23 03:50:12,569 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,301,546 rows
2025-12-23 03:51:55,605 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,119,993 trades
2025-12-23 03:51:55,605 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,119,993 rows
2025-12-23 03:54:56,525 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,758,478 trades
2025-12-23 03:54:56,525 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,758,478 rows
2025-12-23 03:57:29,543 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,745,560 trades
2025-12-23 03:57:29,543 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,745,560 rows
2025-12-23 04:01:01,597 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,237,907 trades
2025-12-23 04:01:01,597 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,237,907 rows
2025-12-23 04:03:46,642 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,400,918 trades
2025-12-23 04:03:46,644 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,400,918 rows
2025-12-23 04:06:13,676 INFO [src.stage_a.wrds_extractor]   Chunk 9: 3,147,287 trades
2025-12-23 04:06:13,676 INFO [src.stage_a.parquet_writer]   Chunk 9: 3,147,287 rows
2025-12-23 04:09:01,935 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,626,469 trades
2025-12-23 04:09:01,935 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,626,469 rows
2025-12-23 04:09:02,421 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 32,147,896 total rows written
2025-12-23 04:10:01,654 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,498,974 trades
2025-12-23 04:10:01,659 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,498,974 rows
2025-12-23 04:10:02,100 INFO [src.stage_a.parquet_writer] ✓ Wrote 33,646,870 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-01-31
2025-12-23 04:10:02,103 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 04:10:02,103 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 04:10:02,103 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 04:10:02,103 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 04:10:02,103 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 04:10:02,103 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 04:10:02,103 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 04:10:03,848 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 04:10:03,849 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-31...
2025-12-23 04:10:03,974 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240131 for 519 symbols
2025-12-23 04:15:13,798 INFO [src.stage_a.wrds_extractor]   Chunk 1: 9,727,527 NBBO records
2025-12-23 04:15:13,798 INFO [src.stage_a.parquet_writer]   Chunk 1: 9,727,527 rows
2025-12-23 04:19:05,746 INFO [src.stage_a.wrds_extractor]   Chunk 2: 7,202,547 NBBO records
2025-12-23 04:19:05,753 INFO [src.stage_a.parquet_writer]   Chunk 2: 7,202,547 rows
2025-12-23 04:23:20,934 INFO [src.stage_a.wrds_extractor]   Chunk 3: 8,250,481 NBBO records
2025-12-23 04:23:20,941 INFO [src.stage_a.parquet_writer]   Chunk 3: 8,250,481 rows
2025-12-23 04:26:44,381 INFO [src.stage_a.wrds_extractor]   Chunk 4: 6,528,782 NBBO records
2025-12-23 04:26:44,391 INFO [src.stage_a.parquet_writer]   Chunk 4: 6,528,782 rows
2025-12-23 04:31:28,177 INFO [src.stage_a.wrds_extractor]   Chunk 5: 8,481,962 NBBO records
2025-12-23 04:31:28,178 INFO [src.stage_a.parquet_writer]   Chunk 5: 8,481,962 rows
2025-12-23 04:36:45,168 INFO [src.stage_a.wrds_extractor]   Chunk 6: 9,409,371 NBBO records
2025-12-23 04:36:45,179 INFO [src.stage_a.parquet_writer]   Chunk 6: 9,409,371 rows
2025-12-23 04:42:10,274 INFO [src.stage_a.wrds_extractor]   Chunk 7: 9,079,989 NBBO records
2025-12-23 04:42:10,282 INFO [src.stage_a.parquet_writer]   Chunk 7: 9,079,989 rows
2025-12-23 04:50:25,929 INFO [src.stage_a.wrds_extractor]   Chunk 8: 12,575,279 NBBO records
2025-12-23 04:50:25,934 INFO [src.stage_a.parquet_writer]   Chunk 8: 12,575,279 rows
2025-12-23 04:58:10,485 INFO [src.stage_a.wrds_extractor]   Chunk 9: 10,592,024 NBBO records
2025-12-23 04:58:10,493 INFO [src.stage_a.parquet_writer]   Chunk 9: 10,592,024 rows
2025-12-23 05:03:57,360 INFO [src.stage_a.wrds_extractor]   Chunk 10: 9,078,801 NBBO records
2025-12-23 05:03:57,381 INFO [src.stage_a.parquet_writer]   Chunk 10: 9,078,801 rows
2025-12-23 05:03:57,906 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 90,926,763 total rows written
2025-12-23 05:11:03,759 INFO [src.stage_a.wrds_extractor]   Chunk 11: 10,687,439 NBBO records
2025-12-23 05:11:03,765 INFO [src.stage_a.parquet_writer]   Chunk 11: 10,687,439 rows
2025-12-23 05:11:04,777 INFO [src.stage_a.parquet_writer] ✓ Wrote 101,614,202 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-01-31
2025-12-23 05:11:04,789 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 05:11:04,789 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 05:11:04,789 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 05:11:04,789 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 05:11:04,789 INFO [src.stage_a.stage_a] Trades: 33,646,870 rows
2025-12-23 05:11:04,789 INFO [src.stage_a.stage_a] Nbbo: 101,614,202 rows
2025-12-23 05:11:04,789 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 05:11:04,789 INFO [src.stage_a.stage_a] Processing date 22/83: 2024-02-01
2025-12-23 05:11:04,789 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 05:11:04,789 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 05:11:04,789 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-02-01 (519 symbols)
2025-12-23 05:11:04,789 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 05:11:04,789 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 05:11:04,789 INFO [src.stage_a.stage_a] Extract run ID: 025f8eb6-e0b4-486c-9d9b-e996146bee76
2025-12-23 05:11:04,797 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 05:11:04,797 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 05:11:04,797 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 05:11:04,797 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 05:11:04,797 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 05:11:04,798 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 05:11:04,798 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 05:11:04,798 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 05:11:04,798 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 05:11:08,000 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 05:11:08,000 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-01...
2025-12-23 05:11:08,153 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240201 for 519 symbols
2025-12-23 05:14:50,320 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,847,143 trades
2025-12-23 05:14:50,320 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,847,143 rows
2025-12-23 05:17:19,603 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,676,606 trades
2025-12-23 05:17:19,604 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,676,606 rows
2025-12-23 05:19:13,104 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,249,749 trades
2025-12-23 05:19:13,104 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,249,749 rows
2025-12-23 05:21:02,400 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,061,945 trades
2025-12-23 05:21:02,400 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,061,945 rows
2025-12-23 05:23:45,500 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,922,996 trades
2025-12-23 05:23:45,500 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,922,996 rows
2025-12-23 05:26:21,134 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,567,581 trades
2025-12-23 05:26:21,134 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,567,581 rows
2025-12-23 05:29:56,686 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,733,596 trades
2025-12-23 05:29:56,686 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,733,596 rows
2025-12-23 05:32:54,510 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,141,234 trades
2025-12-23 05:32:54,511 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,141,234 rows
2025-12-23 05:35:53,956 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,808,732 trades
2025-12-23 05:35:53,956 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,808,732 rows
2025-12-23 05:39:21,931 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,514,179 trades
2025-12-23 05:39:21,931 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,514,179 rows
2025-12-23 05:39:22,389 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 29,523,761 total rows written
2025-12-23 05:40:41,648 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,495,343 trades
2025-12-23 05:40:41,648 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,495,343 rows
2025-12-23 05:40:42,087 INFO [src.stage_a.parquet_writer] ✓ Wrote 31,019,104 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-01
2025-12-23 05:40:42,093 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 05:40:42,093 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 05:40:42,093 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 05:40:42,093 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 05:40:42,093 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 05:40:42,093 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 05:40:42,093 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 05:40:46,456 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 05:40:46,456 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-01...
2025-12-23 05:40:46,657 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240201 for 519 symbols
2025-12-23 05:47:01,453 INFO [src.stage_a.wrds_extractor]   Chunk 1: 8,524,417 NBBO records
2025-12-23 05:47:01,454 INFO [src.stage_a.parquet_writer]   Chunk 1: 8,524,417 rows
2025-12-23 05:51:49,397 INFO [src.stage_a.wrds_extractor]   Chunk 2: 6,667,457 NBBO records
2025-12-23 05:51:49,402 INFO [src.stage_a.parquet_writer]   Chunk 2: 6,667,457 rows
2025-12-23 05:57:09,417 INFO [src.stage_a.wrds_extractor]   Chunk 3: 8,412,047 NBBO records
2025-12-23 05:57:09,426 INFO [src.stage_a.parquet_writer]   Chunk 3: 8,412,047 rows
2025-12-23 06:00:50,224 INFO [src.stage_a.wrds_extractor]   Chunk 4: 6,130,402 NBBO records
2025-12-23 06:00:50,234 INFO [src.stage_a.parquet_writer]   Chunk 4: 6,130,402 rows
2025-12-23 06:05:22,569 INFO [src.stage_a.wrds_extractor]   Chunk 5: 8,104,906 NBBO records
2025-12-23 06:05:22,569 INFO [src.stage_a.parquet_writer]   Chunk 5: 8,104,906 rows
2025-12-23 06:09:40,013 INFO [src.stage_a.wrds_extractor]   Chunk 6: 8,796,517 NBBO records
2025-12-23 06:09:40,014 INFO [src.stage_a.parquet_writer]   Chunk 6: 8,796,517 rows
2025-12-23 06:13:28,663 INFO [src.stage_a.wrds_extractor]   Chunk 7: 8,965,227 NBBO records
2025-12-23 06:13:28,669 INFO [src.stage_a.parquet_writer]   Chunk 7: 8,965,227 rows
2025-12-23 06:21:37,232 INFO [src.stage_a.wrds_extractor]   Chunk 8: 11,370,362 NBBO records
2025-12-23 06:21:37,239 INFO [src.stage_a.parquet_writer]   Chunk 8: 11,370,362 rows
2025-12-23 06:28:10,655 INFO [src.stage_a.wrds_extractor]   Chunk 9: 11,080,162 NBBO records
2025-12-23 06:28:10,668 INFO [src.stage_a.parquet_writer]   Chunk 9: 11,080,162 rows
2025-12-23 06:31:45,642 INFO [src.stage_a.wrds_extractor]   Chunk 10: 8,678,051 NBBO records
2025-12-23 06:31:45,650 INFO [src.stage_a.parquet_writer]   Chunk 10: 8,678,051 rows
2025-12-23 06:31:46,198 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 86,729,548 total rows written
2025-12-23 06:38:05,349 INFO [src.stage_a.wrds_extractor]   Chunk 11: 9,984,133 NBBO records
2025-12-23 06:38:05,354 INFO [src.stage_a.parquet_writer]   Chunk 11: 9,984,133 rows
2025-12-23 06:38:06,269 INFO [src.stage_a.parquet_writer] ✓ Wrote 96,713,681 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-01
2025-12-23 06:38:06,285 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 06:38:06,285 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 06:38:06,285 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 06:38:06,285 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 06:38:06,286 INFO [src.stage_a.stage_a] Trades: 31,019,104 rows
2025-12-23 06:38:06,286 INFO [src.stage_a.stage_a] Nbbo: 96,713,681 rows
2025-12-23 06:38:06,286 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 06:38:06,286 INFO [src.stage_a.stage_a] Processing date 23/83: 2024-02-02
2025-12-23 06:38:06,286 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 06:38:06,286 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 06:38:06,286 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-02-02 (519 symbols)
2025-12-23 06:38:06,286 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 06:38:06,286 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 06:38:06,286 INFO [src.stage_a.stage_a] Extract run ID: 87979bba-b966-4a77-a501-7203ef9b8f7b
2025-12-23 06:38:06,294 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 06:38:06,294 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 06:38:06,294 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 06:38:06,294 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 06:38:06,294 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 06:38:06,294 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 06:38:06,294 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 06:38:06,294 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 06:38:06,294 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 06:38:08,097 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 06:38:08,098 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-02...
2025-12-23 06:38:08,284 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240202 for 519 symbols
2025-12-23 06:40:23,791 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,775,743 trades
2025-12-23 06:40:23,791 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,775,743 rows
2025-12-23 06:42:04,795 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,493,055 trades
2025-12-23 06:42:04,795 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,493,055 rows
2025-12-23 06:43:54,385 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,223,991 trades
2025-12-23 06:43:54,385 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,223,991 rows
2025-12-23 06:45:30,501 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,074,281 trades
2025-12-23 06:45:30,501 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,074,281 rows
2025-12-23 06:46:47,302 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,430,598 trades
2025-12-23 06:46:47,303 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,430,598 rows
2025-12-23 06:47:29,841 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,316,607 trades
2025-12-23 06:47:29,841 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,316,607 rows
2025-12-23 06:50:20,591 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,591,702 trades
2025-12-23 06:50:20,591 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,591,702 rows
2025-12-23 06:52:29,418 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,954,031 trades
2025-12-23 06:52:29,419 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,954,031 rows
2025-12-23 06:54:30,511 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,477,449 trades
2025-12-23 06:54:30,511 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,477,449 rows
2025-12-23 06:57:17,810 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,458,940 trades
2025-12-23 06:57:17,810 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,458,940 rows
2025-12-23 06:57:18,268 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 30,796,397 total rows written
2025-12-23 06:59:18,241 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,590,667 trades
2025-12-23 06:59:18,242 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,590,667 rows
2025-12-23 06:59:18,690 INFO [src.stage_a.parquet_writer] ✓ Wrote 32,387,064 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-02
2025-12-23 06:59:18,695 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 06:59:18,695 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 06:59:18,695 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 06:59:18,695 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 06:59:18,695 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 06:59:18,695 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 06:59:18,695 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 06:59:20,921 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 06:59:20,922 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-02...
2025-12-23 06:59:21,073 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240202 for 519 symbols
2025-12-23 07:05:38,665 INFO [src.stage_a.wrds_extractor]   Chunk 1: 9,257,643 NBBO records
2025-12-23 07:05:38,666 INFO [src.stage_a.parquet_writer]   Chunk 1: 9,257,643 rows
2025-12-23 07:10:04,451 INFO [src.stage_a.wrds_extractor]   Chunk 2: 6,858,697 NBBO records
2025-12-23 07:10:04,455 INFO [src.stage_a.parquet_writer]   Chunk 2: 6,858,697 rows
2025-12-23 07:14:40,088 INFO [src.stage_a.wrds_extractor]   Chunk 3: 7,651,886 NBBO records
2025-12-23 07:14:40,089 INFO [src.stage_a.parquet_writer]   Chunk 3: 7,651,886 rows
2025-12-23 07:17:41,202 INFO [src.stage_a.wrds_extractor]   Chunk 4: 5,644,744 NBBO records
2025-12-23 07:17:41,204 INFO [src.stage_a.parquet_writer]   Chunk 4: 5,644,744 rows
2025-12-23 07:23:18,615 INFO [src.stage_a.wrds_extractor]   Chunk 5: 8,654,105 NBBO records
2025-12-23 07:23:18,616 INFO [src.stage_a.parquet_writer]   Chunk 5: 8,654,105 rows
2025-12-23 07:27:49,294 INFO [src.stage_a.wrds_extractor]   Chunk 6: 8,082,093 NBBO records
2025-12-23 07:27:49,302 INFO [src.stage_a.parquet_writer]   Chunk 6: 8,082,093 rows
2025-12-23 07:32:13,234 INFO [src.stage_a.wrds_extractor]   Chunk 7: 8,646,370 NBBO records
2025-12-23 07:32:13,237 INFO [src.stage_a.parquet_writer]   Chunk 7: 8,646,370 rows
2025-12-23 07:38:55,646 INFO [src.stage_a.wrds_extractor]   Chunk 8: 11,594,792 NBBO records
2025-12-23 07:38:55,651 INFO [src.stage_a.parquet_writer]   Chunk 8: 11,594,792 rows
2025-12-23 07:44:48,524 INFO [src.stage_a.wrds_extractor]   Chunk 9: 10,974,553 NBBO records
2025-12-23 07:44:48,533 INFO [src.stage_a.parquet_writer]   Chunk 9: 10,974,553 rows
2025-12-23 07:50:12,012 INFO [src.stage_a.wrds_extractor]   Chunk 10: 8,806,662 NBBO records
2025-12-23 07:50:12,016 INFO [src.stage_a.parquet_writer]   Chunk 10: 8,806,662 rows
2025-12-23 07:50:12,539 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 86,171,545 total rows written
2025-12-23 07:57:22,045 INFO [src.stage_a.wrds_extractor]   Chunk 11: 10,990,102 NBBO records
2025-12-23 07:57:22,049 INFO [src.stage_a.parquet_writer]   Chunk 11: 10,990,102 rows
2025-12-23 07:57:23,022 INFO [src.stage_a.parquet_writer] ✓ Wrote 97,161,647 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-02
2025-12-23 07:57:23,035 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 07:57:23,035 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 07:57:23,035 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 07:57:23,035 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 07:57:23,035 INFO [src.stage_a.stage_a] Trades: 32,387,064 rows
2025-12-23 07:57:23,035 INFO [src.stage_a.stage_a] Nbbo: 97,161,647 rows
2025-12-23 07:57:23,035 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 07:57:23,035 INFO [src.stage_a.stage_a] Processing date 24/83: 2024-02-05
2025-12-23 07:57:23,035 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 07:57:23,035 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 07:57:23,035 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-02-05 (519 symbols)
2025-12-23 07:57:23,035 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 07:57:23,035 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 07:57:23,035 INFO [src.stage_a.stage_a] Extract run ID: d5e449f7-9fb0-4308-a301-b8f45e9d9a77
2025-12-23 07:57:23,044 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 07:57:23,044 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 07:57:23,044 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 07:57:23,044 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 07:57:23,044 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 07:57:23,044 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 07:57:23,044 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 07:57:23,044 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 07:57:23,044 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 07:57:24,741 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 07:57:24,741 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-05...
2025-12-23 07:57:24,863 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240205 for 519 symbols
2025-12-23 08:00:28,439 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,850,397 trades
2025-12-23 08:00:28,439 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,850,397 rows
2025-12-23 08:02:04,932 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,174,182 trades
2025-12-23 08:02:04,933 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,174,182 rows
2025-12-23 08:03:42,949 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,236,162 trades
2025-12-23 08:03:42,949 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,236,162 rows
2025-12-23 08:05:13,532 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,061,511 trades
2025-12-23 08:05:13,532 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,061,511 rows
2025-12-23 08:07:07,845 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,694,878 trades
2025-12-23 08:07:07,845 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,694,878 rows
2025-12-23 08:09:00,078 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,364,296 trades
2025-12-23 08:09:00,078 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,364,296 rows
2025-12-23 08:12:16,578 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,126,261 trades
2025-12-23 08:12:16,578 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,126,261 rows
2025-12-23 08:14:30,240 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,682,493 trades
2025-12-23 08:14:30,243 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,682,493 rows
2025-12-23 08:16:12,839 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,231,069 trades
2025-12-23 08:16:12,840 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,231,069 rows
2025-12-23 08:19:32,657 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,777,547 trades
2025-12-23 08:19:32,657 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,777,547 rows
2025-12-23 08:19:33,102 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 28,198,796 total rows written
2025-12-23 08:20:46,436 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,263,476 trades
2025-12-23 08:20:46,436 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,263,476 rows
2025-12-23 08:20:46,842 INFO [src.stage_a.parquet_writer] ✓ Wrote 29,462,272 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-05
2025-12-23 08:20:46,847 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 08:20:46,847 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 08:20:46,847 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 08:20:46,847 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 08:20:46,847 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 08:20:46,847 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 08:20:46,847 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 08:20:48,365 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 08:20:48,365 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-05...
2025-12-23 08:20:48,574 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240205 for 519 symbols
2025-12-23 08:25:31,133 INFO [src.stage_a.wrds_extractor]   Chunk 1: 6,991,591 NBBO records
2025-12-23 08:25:31,133 INFO [src.stage_a.parquet_writer]   Chunk 1: 6,991,591 rows
2025-12-23 08:29:04,311 INFO [src.stage_a.wrds_extractor]   Chunk 2: 5,016,686 NBBO records
2025-12-23 08:29:04,312 INFO [src.stage_a.parquet_writer]   Chunk 2: 5,016,686 rows
2025-12-23 08:33:02,191 INFO [src.stage_a.wrds_extractor]   Chunk 3: 6,188,523 NBBO records
2025-12-23 08:33:02,192 INFO [src.stage_a.parquet_writer]   Chunk 3: 6,188,523 rows
2025-12-23 08:36:00,470 INFO [src.stage_a.wrds_extractor]   Chunk 4: 4,722,460 NBBO records
2025-12-23 08:36:00,470 INFO [src.stage_a.parquet_writer]   Chunk 4: 4,722,460 rows
2025-12-23 08:40:45,415 INFO [src.stage_a.wrds_extractor]   Chunk 5: 6,860,154 NBBO records
2025-12-23 08:40:45,415 INFO [src.stage_a.parquet_writer]   Chunk 5: 6,860,154 rows
2025-12-23 08:44:59,856 INFO [src.stage_a.wrds_extractor]   Chunk 6: 6,707,453 NBBO records
2025-12-23 08:44:59,857 INFO [src.stage_a.parquet_writer]   Chunk 6: 6,707,453 rows
2025-12-23 08:49:22,928 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,780,504 NBBO records
2025-12-23 08:49:22,929 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,780,504 rows
2025-12-23 08:55:33,378 INFO [src.stage_a.wrds_extractor]   Chunk 8: 9,338,885 NBBO records
2025-12-23 08:55:33,379 INFO [src.stage_a.parquet_writer]   Chunk 8: 9,338,885 rows
2025-12-23 09:00:47,040 INFO [src.stage_a.wrds_extractor]   Chunk 9: 8,153,975 NBBO records
2025-12-23 09:00:47,047 INFO [src.stage_a.parquet_writer]   Chunk 9: 8,153,975 rows
2025-12-23 09:05:01,777 INFO [src.stage_a.wrds_extractor]   Chunk 10: 6,823,187 NBBO records
2025-12-23 09:05:01,787 INFO [src.stage_a.parquet_writer]   Chunk 10: 6,823,187 rows
2025-12-23 09:05:02,250 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 67,583,418 total rows written
2025-12-23 09:10:20,204 INFO [src.stage_a.wrds_extractor]   Chunk 11: 8,205,727 NBBO records
2025-12-23 09:10:20,205 INFO [src.stage_a.parquet_writer]   Chunk 11: 8,205,727 rows
2025-12-23 09:10:20,981 INFO [src.stage_a.parquet_writer] ✓ Wrote 75,789,145 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-05
2025-12-23 09:10:20,991 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 09:10:20,991 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 09:10:20,991 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 09:10:20,991 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 09:10:20,991 INFO [src.stage_a.stage_a] Trades: 29,462,272 rows
2025-12-23 09:10:20,991 INFO [src.stage_a.stage_a] Nbbo: 75,789,145 rows
2025-12-23 09:10:20,991 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 09:10:20,991 INFO [src.stage_a.stage_a] Processing date 25/83: 2024-02-06
2025-12-23 09:10:20,991 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 09:10:20,991 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 09:10:20,991 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-02-06 (519 symbols)
2025-12-23 09:10:20,991 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 09:10:20,991 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 09:10:20,991 INFO [src.stage_a.stage_a] Extract run ID: 0f55b4a5-7b8e-4101-9824-ba157bc87de0
2025-12-23 09:10:20,999 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 09:10:20,999 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 09:10:20,999 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 09:10:20,999 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 09:10:20,999 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 09:10:20,999 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 09:10:20,999 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 09:10:20,999 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 09:10:20,999 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 09:10:22,996 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 09:10:22,996 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-06...
2025-12-23 09:10:23,122 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240206 for 519 symbols
2025-12-23 09:13:35,452 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,386,639 trades
2025-12-23 09:13:35,452 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,386,639 rows
2025-12-23 09:16:03,068 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,017,957 trades
2025-12-23 09:16:03,068 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,017,957 rows
2025-12-23 09:18:21,058 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,164,344 trades
2025-12-23 09:18:21,058 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,164,344 rows
2025-12-23 09:20:34,210 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,943,420 trades
2025-12-23 09:20:34,210 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,943,420 rows
2025-12-23 09:23:10,308 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,445,374 trades
2025-12-23 09:23:10,308 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,445,374 rows
2025-12-23 09:25:37,325 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,303,269 trades
2025-12-23 09:25:37,326 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,303,269 rows
2025-12-23 09:29:41,924 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,640,602 trades
2025-12-23 09:29:41,924 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,640,602 rows
2025-12-23 09:33:00,604 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,596,402 trades
2025-12-23 09:33:00,604 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,596,402 rows
2025-12-23 09:35:30,614 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,115,869 trades
2025-12-23 09:35:30,614 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,115,869 rows
2025-12-23 09:39:40,083 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,290,936 trades
2025-12-23 09:39:40,083 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,290,936 rows
2025-12-23 09:39:40,496 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,904,812 total rows written
2025-12-23 09:40:29,567 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,169,544 trades
2025-12-23 09:40:29,567 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,169,544 rows
2025-12-23 09:40:29,945 INFO [src.stage_a.parquet_writer] ✓ Wrote 27,074,356 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-06
2025-12-23 09:40:29,946 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 09:40:29,946 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 09:40:29,946 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 09:40:29,946 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 09:40:29,946 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 09:40:29,946 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 09:40:29,946 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 09:40:32,353 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 09:40:32,353 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-06...
2025-12-23 09:40:32,475 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240206 for 519 symbols
2025-12-23 09:45:51,830 INFO [src.stage_a.wrds_extractor]   Chunk 1: 7,187,732 NBBO records
2025-12-23 09:45:51,830 INFO [src.stage_a.parquet_writer]   Chunk 1: 7,187,732 rows
2025-12-23 09:49:34,972 INFO [src.stage_a.wrds_extractor]   Chunk 2: 5,031,353 NBBO records
2025-12-23 09:49:34,973 INFO [src.stage_a.parquet_writer]   Chunk 2: 5,031,353 rows
2025-12-23 09:53:31,764 INFO [src.stage_a.wrds_extractor]   Chunk 3: 6,011,383 NBBO records
2025-12-23 09:53:31,765 INFO [src.stage_a.parquet_writer]   Chunk 3: 6,011,383 rows
2025-12-23 09:57:10,419 INFO [src.stage_a.wrds_extractor]   Chunk 4: 4,503,012 NBBO records
2025-12-23 09:57:10,425 INFO [src.stage_a.parquet_writer]   Chunk 4: 4,503,012 rows
2025-12-23 10:01:21,844 INFO [src.stage_a.wrds_extractor]   Chunk 5: 6,470,678 NBBO records
2025-12-23 10:01:21,844 INFO [src.stage_a.parquet_writer]   Chunk 5: 6,470,678 rows
2025-12-23 10:05:44,607 INFO [src.stage_a.wrds_extractor]   Chunk 6: 6,655,307 NBBO records
2025-12-23 10:05:44,611 INFO [src.stage_a.parquet_writer]   Chunk 6: 6,655,307 rows
2025-12-23 10:10:40,425 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,374,682 NBBO records
2025-12-23 10:10:40,426 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,374,682 rows
2025-12-23 10:17:08,084 INFO [src.stage_a.wrds_extractor]   Chunk 8: 8,852,742 NBBO records
2025-12-23 10:17:08,086 INFO [src.stage_a.parquet_writer]   Chunk 8: 8,852,742 rows
2025-12-23 10:24:26,399 INFO [src.stage_a.wrds_extractor]   Chunk 9: 8,715,531 NBBO records
2025-12-23 10:24:26,404 INFO [src.stage_a.parquet_writer]   Chunk 9: 8,715,531 rows
2025-12-23 10:29:57,506 INFO [src.stage_a.wrds_extractor]   Chunk 10: 6,841,216 NBBO records
2025-12-23 10:29:57,515 INFO [src.stage_a.parquet_writer]   Chunk 10: 6,841,216 rows
2025-12-23 10:29:57,972 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 66,643,636 total rows written
2025-12-23 10:35:42,457 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,851,436 NBBO records
2025-12-23 10:35:42,458 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,851,436 rows
2025-12-23 10:35:43,177 INFO [src.stage_a.parquet_writer] ✓ Wrote 74,495,072 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-06
2025-12-23 10:35:43,184 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 10:35:43,184 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 10:35:43,184 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 10:35:43,184 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 10:35:43,184 INFO [src.stage_a.stage_a] Trades: 27,074,356 rows
2025-12-23 10:35:43,184 INFO [src.stage_a.stage_a] Nbbo: 74,495,072 rows
2025-12-23 10:35:43,184 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 10:35:43,184 INFO [src.stage_a.stage_a] Processing date 26/83: 2024-02-07
2025-12-23 10:35:43,184 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 10:35:43,184 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 10:35:43,184 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-02-07 (519 symbols)
2025-12-23 10:35:43,184 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 10:35:43,184 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 10:35:43,185 INFO [src.stage_a.stage_a] Extract run ID: e25e5b4a-8127-4352-b596-b06280467078
2025-12-23 10:35:43,193 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 10:35:43,193 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 10:35:43,193 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 10:35:43,193 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 10:35:43,193 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 10:35:43,193 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 10:35:43,193 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 10:35:43,193 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 10:35:43,193 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 10:35:46,037 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 10:35:46,037 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-07...
2025-12-23 10:35:46,201 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240207 for 519 symbols
2025-12-23 10:39:24,958 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,237,304 trades
2025-12-23 10:39:24,958 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,237,304 rows
2025-12-23 10:41:54,186 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,071,545 trades
2025-12-23 10:41:54,187 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,071,545 rows
2025-12-23 10:44:47,385 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,150,618 trades
2025-12-23 10:44:47,385 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,150,618 rows
2025-12-23 10:47:03,104 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,293,245 trades
2025-12-23 10:47:03,104 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,293,245 rows
2025-12-23 10:50:00,860 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,430,325 trades
2025-12-23 10:50:00,860 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,430,325 rows
2025-12-23 10:51:20,764 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,197,114 trades
2025-12-23 10:51:20,764 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,197,114 rows
2025-12-23 10:55:19,094 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,286,725 trades
2025-12-23 10:55:19,094 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,286,725 rows
2025-12-23 10:58:47,205 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,643,567 trades
2025-12-23 10:58:47,205 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,643,567 rows
2025-12-23 11:01:22,739 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,156,734 trades
2025-12-23 11:01:22,740 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,156,734 rows
2025-12-23 11:05:28,355 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,472,569 trades
2025-12-23 11:05:28,356 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,472,569 rows
2025-12-23 11:05:28,801 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,939,746 total rows written
2025-12-23 11:06:44,701 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,068,479 trades
2025-12-23 11:06:44,702 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,068,479 rows
2025-12-23 11:06:45,030 INFO [src.stage_a.parquet_writer] ✓ Wrote 27,008,225 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-07
2025-12-23 11:06:45,031 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 11:06:45,031 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 11:06:45,031 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 11:06:45,031 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 11:06:45,031 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 11:06:45,031 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 11:06:45,031 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 11:06:58,926 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 11:06:58,926 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-07...
2025-12-23 11:06:59,127 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240207 for 519 symbols
2025-12-23 11:10:55,330 INFO [src.stage_a.wrds_extractor]   Chunk 1: 6,321,844 NBBO records
2025-12-23 11:10:55,330 INFO [src.stage_a.parquet_writer]   Chunk 1: 6,321,844 rows
2025-12-23 11:14:09,635 INFO [src.stage_a.wrds_extractor]   Chunk 2: 4,791,927 NBBO records
2025-12-23 11:14:09,636 INFO [src.stage_a.parquet_writer]   Chunk 2: 4,791,927 rows
2025-12-23 11:18:13,968 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,769,531 NBBO records
2025-12-23 11:18:13,968 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,769,531 rows
2025-12-23 11:21:57,651 INFO [src.stage_a.wrds_extractor]   Chunk 4: 4,625,639 NBBO records
2025-12-23 11:21:57,652 INFO [src.stage_a.parquet_writer]   Chunk 4: 4,625,639 rows
2025-12-23 11:26:49,375 INFO [src.stage_a.wrds_extractor]   Chunk 5: 6,122,211 NBBO records
2025-12-23 11:26:49,375 INFO [src.stage_a.parquet_writer]   Chunk 5: 6,122,211 rows
2025-12-23 11:31:34,512 INFO [src.stage_a.wrds_extractor]   Chunk 6: 6,026,341 NBBO records
2025-12-23 11:31:34,513 INFO [src.stage_a.parquet_writer]   Chunk 6: 6,026,341 rows
2025-12-23 11:33:49,917 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,010,800 NBBO records
2025-12-23 11:33:49,918 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,010,800 rows
2025-12-23 11:36:40,742 INFO [src.stage_a.wrds_extractor]   Chunk 8: 8,050,572 NBBO records
2025-12-23 11:36:40,743 INFO [src.stage_a.parquet_writer]   Chunk 8: 8,050,572 rows
2025-12-23 11:41:23,611 INFO [src.stage_a.wrds_extractor]   Chunk 9: 7,657,360 NBBO records
2025-12-23 11:41:23,619 INFO [src.stage_a.parquet_writer]   Chunk 9: 7,657,360 rows
2025-12-23 11:45:14,564 INFO [src.stage_a.wrds_extractor]   Chunk 10: 6,446,029 NBBO records
2025-12-23 11:45:14,565 INFO [src.stage_a.parquet_writer]   Chunk 10: 6,446,029 rows
2025-12-23 11:45:15,024 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 61,822,254 total rows written
2025-12-23 11:49:51,793 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,202,627 NBBO records
2025-12-23 11:49:51,795 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,202,627 rows
2025-12-23 11:49:52,428 INFO [src.stage_a.parquet_writer] ✓ Wrote 69,024,881 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-07
2025-12-23 11:49:52,437 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 11:49:52,437 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 11:49:52,437 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 11:49:52,437 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 11:49:52,437 INFO [src.stage_a.stage_a] Trades: 27,008,225 rows
2025-12-23 11:49:52,437 INFO [src.stage_a.stage_a] Nbbo: 69,024,881 rows
2025-12-23 11:49:52,437 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 11:49:52,437 INFO [src.stage_a.stage_a] Processing date 27/83: 2024-02-08
2025-12-23 11:49:52,437 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 11:49:52,437 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 11:49:52,437 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-02-08 (519 symbols)
2025-12-23 11:49:52,437 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 11:49:52,437 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 11:49:52,437 INFO [src.stage_a.stage_a] Extract run ID: f3bd3f0c-7619-48d7-9b32-986177f4f587
2025-12-23 11:49:52,446 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 11:49:52,446 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 11:49:52,446 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 11:49:52,446 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 11:49:52,446 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 11:49:52,446 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 11:49:52,446 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 11:49:52,446 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 11:49:52,446 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 11:49:53,817 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 11:49:53,818 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-08...
2025-12-23 11:49:53,941 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240208 for 519 symbols
2025-12-23 11:53:37,886 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,093,538 trades
2025-12-23 11:53:37,886 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,093,538 rows
2025-12-23 11:55:57,454 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,935,488 trades
2025-12-23 11:55:57,455 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,935,488 rows
2025-12-23 11:58:23,818 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,543,244 trades
2025-12-23 11:58:23,818 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,543,244 rows
2025-12-23 12:00:37,659 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,934,346 trades
2025-12-23 12:00:37,659 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,934,346 rows
2025-12-23 12:01:29,242 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,298,794 trades
2025-12-23 12:01:29,242 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,298,794 rows
2025-12-23 12:03:47,224 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,345,661 trades
2025-12-23 12:03:47,224 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,345,661 rows
2025-12-23 12:07:11,368 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,322,338 trades
2025-12-23 12:07:11,368 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,322,338 rows
2025-12-23 12:09:53,080 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,822,705 trades
2025-12-23 12:09:53,080 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,822,705 rows
2025-12-23 12:12:16,535 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,318,643 trades
2025-12-23 12:12:16,535 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,318,643 rows
2025-12-23 12:15:02,500 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,987,148 trades
2025-12-23 12:15:02,500 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,987,148 rows
2025-12-23 12:15:02,899 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,601,905 total rows written
2025-12-23 12:15:48,946 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,139,031 trades
2025-12-23 12:15:48,946 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,139,031 rows
2025-12-23 12:15:49,267 INFO [src.stage_a.parquet_writer] ✓ Wrote 26,740,936 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-08
2025-12-23 12:15:49,268 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 12:15:49,268 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 12:15:49,268 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 12:15:49,268 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 12:15:49,268 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 12:15:49,268 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 12:15:49,268 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 12:15:50,837 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 12:15:50,838 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-08...
2025-12-23 12:15:50,928 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240208 for 519 symbols
2025-12-23 12:20:07,666 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,897,149 NBBO records
2025-12-23 12:20:07,666 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,897,149 rows
2025-12-23 12:22:47,228 INFO [src.stage_a.wrds_extractor]   Chunk 2: 4,299,133 NBBO records
2025-12-23 12:22:47,228 INFO [src.stage_a.parquet_writer]   Chunk 2: 4,299,133 rows
2025-12-23 12:24:55,108 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,319,788 NBBO records
2025-12-23 12:24:55,108 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,319,788 rows
2025-12-23 12:27:01,587 INFO [src.stage_a.wrds_extractor]   Chunk 4: 4,093,296 NBBO records
2025-12-23 12:27:01,587 INFO [src.stage_a.parquet_writer]   Chunk 4: 4,093,296 rows
2025-12-23 12:28:51,346 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,396,737 NBBO records
2025-12-23 12:28:51,346 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,396,737 rows
2025-12-23 12:29:45,413 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,503,691 NBBO records
2025-12-23 12:29:45,413 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,503,691 rows
2025-12-23 12:30:46,550 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,159,380 NBBO records
2025-12-23 12:30:46,550 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,159,380 rows
2025-12-23 12:35:07,145 INFO [src.stage_a.wrds_extractor]   Chunk 8: 7,812,646 NBBO records
2025-12-23 12:35:07,147 INFO [src.stage_a.parquet_writer]   Chunk 8: 7,812,646 rows
2025-12-23 12:36:51,566 INFO [src.stage_a.wrds_extractor]   Chunk 9: 6,942,699 NBBO records
2025-12-23 12:36:51,569 INFO [src.stage_a.parquet_writer]   Chunk 9: 6,942,699 rows
2025-12-23 12:37:51,529 INFO [src.stage_a.wrds_extractor]   Chunk 10: 5,713,818 NBBO records
2025-12-23 12:37:51,531 INFO [src.stage_a.parquet_writer]   Chunk 10: 5,713,818 rows
2025-12-23 12:37:51,946 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 57,138,337 total rows written
2025-12-23 12:39:15,814 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,869,855 NBBO records
2025-12-23 12:39:15,815 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,869,855 rows
2025-12-23 12:39:16,469 INFO [src.stage_a.parquet_writer] ✓ Wrote 64,008,192 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-08
2025-12-23 12:39:16,476 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 12:39:16,476 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 12:39:16,476 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 12:39:16,476 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 12:39:16,476 INFO [src.stage_a.stage_a] Trades: 26,740,936 rows
2025-12-23 12:39:16,476 INFO [src.stage_a.stage_a] Nbbo: 64,008,192 rows
2025-12-23 12:39:16,476 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 12:39:16,476 INFO [src.stage_a.stage_a] Processing date 28/83: 2024-02-09
2025-12-23 12:39:16,476 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 12:39:16,476 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 12:39:16,476 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-02-09 (519 symbols)
2025-12-23 12:39:16,476 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 12:39:16,476 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 12:39:16,476 INFO [src.stage_a.stage_a] Extract run ID: b2449e82-7a36-49ec-91d7-fe99451d1745
2025-12-23 12:39:16,484 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 12:39:16,484 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 12:39:16,484 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 12:39:16,484 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 12:39:16,484 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 12:39:16,484 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 12:39:16,484 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 12:39:16,484 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 12:39:16,484 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 12:39:17,589 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 12:39:17,590 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-09...
2025-12-23 12:39:17,638 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240209 for 519 symbols
2025-12-23 12:40:10,571 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,250,132 trades
2025-12-23 12:40:10,571 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,250,132 rows
2025-12-23 12:41:34,088 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,960,953 trades
2025-12-23 12:41:34,088 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,960,953 rows
2025-12-23 12:43:12,409 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,138,198 trades
2025-12-23 12:43:12,409 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,138,198 rows
2025-12-23 12:44:45,425 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,969,712 trades
2025-12-23 12:44:45,425 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,969,712 rows
2025-12-23 12:46:07,599 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,477,417 trades
2025-12-23 12:46:07,599 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,477,417 rows
2025-12-23 12:47:39,284 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,115,494 trades
2025-12-23 12:47:39,284 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,115,494 rows
2025-12-23 12:50:07,438 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,389,799 trades
2025-12-23 12:50:07,438 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,389,799 rows
2025-12-23 12:52:16,648 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,649,222 trades
2025-12-23 12:52:16,648 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,649,222 rows
2025-12-23 12:53:49,740 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,150,696 trades
2025-12-23 12:53:49,740 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,150,696 rows
2025-12-23 12:56:04,693 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,024,573 trades
2025-12-23 12:56:04,693 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,024,573 rows
2025-12-23 12:56:05,089 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,126,196 total rows written
2025-12-23 12:56:57,237 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,153,016 trades
2025-12-23 12:56:57,237 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,153,016 rows
2025-12-23 12:56:57,559 INFO [src.stage_a.parquet_writer] ✓ Wrote 26,279,212 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-09
2025-12-23 12:56:57,560 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 12:56:57,560 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 12:56:57,560 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 12:56:57,560 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 12:56:57,560 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 12:56:57,560 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 12:56:57,560 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 12:56:59,520 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 12:56:59,520 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-09...
2025-12-23 12:56:59,592 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240209 for 519 symbols
2025-12-23 12:59:43,485 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,322,223 NBBO records
2025-12-23 12:59:43,486 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,322,223 rows
2025-12-23 13:01:48,616 INFO [src.stage_a.wrds_extractor]   Chunk 2: 4,167,427 NBBO records
2025-12-23 13:01:48,616 INFO [src.stage_a.parquet_writer]   Chunk 2: 4,167,427 rows
2025-12-23 13:02:48,687 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,019,330 NBBO records
2025-12-23 13:02:48,687 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,019,330 rows
2025-12-23 13:04:40,176 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,858,020 NBBO records
2025-12-23 13:04:40,176 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,858,020 rows
2025-12-23 13:07:37,274 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,563,881 NBBO records
2025-12-23 13:07:37,274 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,563,881 rows
2025-12-23 13:10:31,328 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,541,492 NBBO records
2025-12-23 13:10:31,328 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,541,492 rows
2025-12-23 13:13:18,959 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,674,586 NBBO records
2025-12-23 13:13:18,962 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,674,586 rows
2025-12-23 13:14:43,753 INFO [src.stage_a.wrds_extractor]   Chunk 8: 7,274,428 NBBO records
2025-12-23 13:14:43,754 INFO [src.stage_a.parquet_writer]   Chunk 8: 7,274,428 rows
2025-12-23 13:16:03,958 INFO [src.stage_a.wrds_extractor]   Chunk 9: 6,249,853 NBBO records
2025-12-23 13:16:03,960 INFO [src.stage_a.parquet_writer]   Chunk 9: 6,249,853 rows
2025-12-23 13:18:24,505 INFO [src.stage_a.wrds_extractor]   Chunk 10: 5,512,103 NBBO records
2025-12-23 13:18:24,506 INFO [src.stage_a.parquet_writer]   Chunk 10: 5,512,103 rows
2025-12-23 13:18:24,918 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 54,183,343 total rows written
2025-12-23 13:22:27,964 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,514,320 NBBO records
2025-12-23 13:22:27,964 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,514,320 rows
2025-12-23 13:22:28,567 INFO [src.stage_a.parquet_writer] ✓ Wrote 60,697,663 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-09
2025-12-23 13:22:28,576 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 13:22:28,576 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 13:22:28,576 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 13:22:28,576 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 13:22:28,576 INFO [src.stage_a.stage_a] Trades: 26,279,212 rows
2025-12-23 13:22:28,576 INFO [src.stage_a.stage_a] Nbbo: 60,697,663 rows
2025-12-23 13:22:28,576 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 13:22:28,576 INFO [src.stage_a.stage_a] Processing date 29/83: 2024-02-12
2025-12-23 13:22:28,576 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 13:22:28,576 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 13:22:28,576 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-02-12 (519 symbols)
2025-12-23 13:22:28,576 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 13:22:28,576 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 13:22:28,576 INFO [src.stage_a.stage_a] Extract run ID: 873b329e-aa4c-4411-85de-2824a6c6cf10
2025-12-23 13:22:28,584 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 13:22:28,584 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 13:22:28,584 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 13:22:28,584 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 13:22:28,584 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 13:22:28,584 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 13:22:28,584 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 13:22:28,584 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 13:22:28,584 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 13:22:30,485 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 13:22:30,495 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-12...
2025-12-23 13:22:30,700 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240212 for 519 symbols
2025-12-23 13:25:28,179 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,457,300 trades
2025-12-23 13:25:28,179 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,457,300 rows
2025-12-23 13:27:13,962 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,975,483 trades
2025-12-23 13:27:13,962 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,975,483 rows
2025-12-23 13:29:29,091 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,062,047 trades
2025-12-23 13:29:29,091 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,062,047 rows
2025-12-23 13:30:53,734 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,882,627 trades
2025-12-23 13:30:53,735 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,882,627 rows
2025-12-23 13:33:28,203 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,428,122 trades
2025-12-23 13:33:28,203 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,428,122 rows
2025-12-23 13:35:20,366 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,218,623 trades
2025-12-23 13:35:20,366 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,218,623 rows
2025-12-23 13:38:07,220 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,743,406 trades
2025-12-23 13:38:07,220 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,743,406 rows
2025-12-23 13:40:16,082 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,539,155 trades
2025-12-23 13:40:16,083 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,539,155 rows
2025-12-23 13:42:03,385 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,113,693 trades
2025-12-23 13:42:03,385 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,113,693 rows
2025-12-23 13:44:59,386 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,127,648 trades
2025-12-23 13:44:59,386 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,127,648 rows
2025-12-23 13:44:59,789 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,548,104 total rows written
2025-12-23 13:45:52,716 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,001,468 trades
2025-12-23 13:45:52,716 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,001,468 rows
2025-12-23 13:45:53,028 INFO [src.stage_a.parquet_writer] ✓ Wrote 26,549,572 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-12
2025-12-23 13:45:53,029 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 13:45:53,029 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 13:45:53,029 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 13:45:53,029 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 13:45:53,029 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 13:45:53,029 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 13:45:53,029 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 13:45:55,107 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 13:45:55,108 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-12...
2025-12-23 13:45:55,261 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240212 for 519 symbols
2025-12-23 13:49:53,418 INFO [src.stage_a.wrds_extractor]   Chunk 1: 6,324,406 NBBO records
2025-12-23 13:49:53,418 INFO [src.stage_a.parquet_writer]   Chunk 1: 6,324,406 rows
2025-12-23 13:52:13,903 INFO [src.stage_a.wrds_extractor]   Chunk 2: 4,317,563 NBBO records
2025-12-23 13:52:13,904 INFO [src.stage_a.parquet_writer]   Chunk 2: 4,317,563 rows
2025-12-23 13:55:30,933 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,248,498 NBBO records
2025-12-23 13:55:30,933 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,248,498 rows
2025-12-23 13:57:48,875 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,915,474 NBBO records
2025-12-23 13:57:48,875 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,915,474 rows
2025-12-23 13:59:44,469 INFO [src.stage_a.wrds_extractor]   Chunk 5: 6,174,006 NBBO records
2025-12-23 13:59:44,469 INFO [src.stage_a.parquet_writer]   Chunk 5: 6,174,006 rows
2025-12-23 14:03:26,266 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,749,317 NBBO records
2025-12-23 14:03:26,267 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,749,317 rows
2025-12-23 14:07:33,744 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,127,587 NBBO records
2025-12-23 14:07:33,745 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,127,587 rows
2025-12-23 14:10:51,446 INFO [src.stage_a.wrds_extractor]   Chunk 8: 7,875,642 NBBO records
2025-12-23 14:10:51,447 INFO [src.stage_a.parquet_writer]   Chunk 8: 7,875,642 rows
2025-12-23 14:13:33,715 INFO [src.stage_a.wrds_extractor]   Chunk 9: 6,866,856 NBBO records
2025-12-23 14:13:33,722 INFO [src.stage_a.parquet_writer]   Chunk 9: 6,866,856 rows
2025-12-23 14:16:52,967 INFO [src.stage_a.wrds_extractor]   Chunk 10: 5,803,959 NBBO records
2025-12-23 14:16:52,968 INFO [src.stage_a.parquet_writer]   Chunk 10: 5,803,959 rows
2025-12-23 14:16:53,394 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 58,403,308 total rows written
2025-12-23 14:21:12,037 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,987,385 NBBO records
2025-12-23 14:21:12,038 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,987,385 rows
2025-12-23 14:21:12,705 INFO [src.stage_a.parquet_writer] ✓ Wrote 65,390,693 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-12
2025-12-23 14:21:12,721 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 14:21:12,721 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 14:21:12,721 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 14:21:12,721 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 14:21:12,721 INFO [src.stage_a.stage_a] Trades: 26,549,572 rows
2025-12-23 14:21:12,721 INFO [src.stage_a.stage_a] Nbbo: 65,390,693 rows
2025-12-23 14:21:12,721 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 14:21:12,721 INFO [src.stage_a.stage_a] Processing date 30/83: 2024-02-13
2025-12-23 14:21:12,721 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 14:21:12,721 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 14:21:12,721 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-02-13 (519 symbols)
2025-12-23 14:21:12,721 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 14:21:12,721 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 14:21:12,721 INFO [src.stage_a.stage_a] Extract run ID: ee43545e-e45e-4f0b-a851-439c8fa974e5
2025-12-23 14:21:12,730 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 14:21:12,730 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 14:21:12,730 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 14:21:12,730 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 14:21:12,730 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 14:21:12,730 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 14:21:12,730 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 14:21:12,730 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 14:21:12,730 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 14:21:15,120 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 14:21:15,120 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-13...
2025-12-23 14:21:15,365 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240213 for 519 symbols
2025-12-23 14:23:10,023 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,027,427 trades
2025-12-23 14:23:10,023 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,027,427 rows
2025-12-23 14:23:59,713 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,365,368 trades
2025-12-23 14:23:59,713 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,365,368 rows
2025-12-23 14:26:15,568 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,401,687 trades
2025-12-23 14:26:15,568 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,401,687 rows
2025-12-23 14:28:26,318 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,210,289 trades
2025-12-23 14:28:26,319 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,210,289 rows
2025-12-23 14:31:49,883 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,840,259 trades
2025-12-23 14:31:49,884 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,840,259 rows
2025-12-23 14:34:49,768 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,945,590 trades
2025-12-23 14:34:49,768 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,945,590 rows
2025-12-23 14:36:10,919 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,229,363 trades
2025-12-23 14:36:10,919 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,229,363 rows
2025-12-23 14:37:11,155 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,111,828 trades
2025-12-23 14:37:11,156 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,111,828 rows
2025-12-23 14:39:33,155 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,726,255 trades
2025-12-23 14:39:33,155 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,726,255 rows
2025-12-23 14:42:24,767 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,445,117 trades
2025-12-23 14:42:24,767 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,445,117 rows
2025-12-23 14:42:25,225 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 30,303,183 total rows written
2025-12-23 14:43:54,393 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,434,249 trades
2025-12-23 14:43:54,393 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,434,249 rows
2025-12-23 14:43:54,799 INFO [src.stage_a.parquet_writer] ✓ Wrote 31,737,432 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-13
2025-12-23 14:43:54,804 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 14:43:54,804 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 14:43:54,804 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 14:43:54,804 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 14:43:54,804 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 14:43:54,804 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 14:43:54,804 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 14:43:56,877 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 14:43:56,877 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-13...
2025-12-23 14:43:56,934 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240213 for 519 symbols
2025-12-23 14:47:44,155 INFO [src.stage_a.wrds_extractor]   Chunk 1: 7,966,152 NBBO records
2025-12-23 14:47:44,155 INFO [src.stage_a.parquet_writer]   Chunk 1: 7,966,152 rows
2025-12-23 14:50:07,970 INFO [src.stage_a.wrds_extractor]   Chunk 2: 5,520,752 NBBO records
2025-12-23 14:50:07,972 INFO [src.stage_a.parquet_writer]   Chunk 2: 5,520,752 rows
2025-12-23 14:53:12,883 INFO [src.stage_a.wrds_extractor]   Chunk 3: 6,747,787 NBBO records
2025-12-23 14:53:12,883 INFO [src.stage_a.parquet_writer]   Chunk 3: 6,747,787 rows
2025-12-23 14:55:12,899 INFO [src.stage_a.wrds_extractor]   Chunk 4: 4,701,554 NBBO records
2025-12-23 14:55:12,900 INFO [src.stage_a.parquet_writer]   Chunk 4: 4,701,554 rows
2025-12-23 14:58:29,183 INFO [src.stage_a.wrds_extractor]   Chunk 5: 7,448,471 NBBO records
2025-12-23 14:58:29,183 INFO [src.stage_a.parquet_writer]   Chunk 5: 7,448,471 rows
2025-12-23 15:00:45,389 INFO [src.stage_a.wrds_extractor]   Chunk 6: 7,318,176 NBBO records
2025-12-23 15:00:45,393 INFO [src.stage_a.parquet_writer]   Chunk 6: 7,318,176 rows
2025-12-23 15:04:30,172 INFO [src.stage_a.wrds_extractor]   Chunk 7: 7,365,074 NBBO records
2025-12-23 15:04:30,173 INFO [src.stage_a.parquet_writer]   Chunk 7: 7,365,074 rows
2025-12-23 15:09:05,205 INFO [src.stage_a.wrds_extractor]   Chunk 8: 9,711,842 NBBO records
2025-12-23 15:09:05,212 INFO [src.stage_a.parquet_writer]   Chunk 8: 9,711,842 rows
2025-12-23 15:13:52,619 INFO [src.stage_a.wrds_extractor]   Chunk 9: 8,977,503 NBBO records
2025-12-23 15:13:52,623 INFO [src.stage_a.parquet_writer]   Chunk 9: 8,977,503 rows
2025-12-23 15:16:20,505 INFO [src.stage_a.wrds_extractor]   Chunk 10: 7,254,522 NBBO records
2025-12-23 15:16:20,515 INFO [src.stage_a.parquet_writer]   Chunk 10: 7,254,522 rows
2025-12-23 15:16:20,989 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 73,011,833 total rows written
2025-12-23 15:21:25,311 INFO [src.stage_a.wrds_extractor]   Chunk 11: 9,192,335 NBBO records
2025-12-23 15:21:25,312 INFO [src.stage_a.parquet_writer]   Chunk 11: 9,192,335 rows
2025-12-23 15:21:26,159 INFO [src.stage_a.parquet_writer] ✓ Wrote 82,204,168 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-13
2025-12-23 15:21:26,176 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 15:21:26,176 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 15:21:26,176 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 15:21:26,176 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 15:21:26,176 INFO [src.stage_a.stage_a] Trades: 31,737,432 rows
2025-12-23 15:21:26,176 INFO [src.stage_a.stage_a] Nbbo: 82,204,168 rows
2025-12-23 15:21:26,176 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 15:21:26,176 INFO [src.stage_a.stage_a] Processing date 31/83: 2024-02-14
2025-12-23 15:21:26,176 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 15:21:26,176 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 15:21:26,176 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-02-14 (519 symbols)
2025-12-23 15:21:26,176 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 15:21:26,176 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 15:21:26,176 INFO [src.stage_a.stage_a] Extract run ID: 430abf4f-7fe0-4f7c-8241-f7169a76a940
2025-12-23 15:21:26,184 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 15:21:26,184 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 15:21:26,184 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 15:21:26,184 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 15:21:26,184 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 15:21:26,184 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 15:21:26,184 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 15:21:26,184 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 15:21:26,184 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 15:21:27,403 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 15:21:27,403 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-14...
2025-12-23 15:21:27,464 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240214 for 519 symbols
2025-12-23 15:22:43,553 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,581,007 trades
2025-12-23 15:22:43,553 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,581,007 rows
2025-12-23 15:24:12,906 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,918,700 trades
2025-12-23 15:24:12,906 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,918,700 rows
2025-12-23 15:26:16,090 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,231,941 trades
2025-12-23 15:26:16,090 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,231,941 rows
2025-12-23 15:28:14,809 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,989,417 trades
2025-12-23 15:28:14,809 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,989,417 rows
2025-12-23 15:30:53,363 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,438,975 trades
2025-12-23 15:30:53,363 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,438,975 rows
2025-12-23 15:33:32,306 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,465,558 trades
2025-12-23 15:33:32,306 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,465,558 rows
2025-12-23 15:36:07,372 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,548,191 trades
2025-12-23 15:36:07,372 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,548,191 rows
2025-12-23 15:38:40,512 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,544,151 trades
2025-12-23 15:38:40,512 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,544,151 rows
2025-12-23 15:39:49,392 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,181,098 trades
2025-12-23 15:39:49,392 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,181,098 rows
2025-12-23 15:43:58,523 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,312,730 trades
2025-12-23 15:43:58,523 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,312,730 rows
2025-12-23 15:43:58,930 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,211,768 total rows written
2025-12-23 15:44:51,658 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,192,714 trades
2025-12-23 15:44:51,658 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,192,714 rows
2025-12-23 15:44:52,040 INFO [src.stage_a.parquet_writer] ✓ Wrote 27,404,482 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-14
2025-12-23 15:44:52,041 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 15:44:52,041 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 15:44:52,041 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 15:44:52,041 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 15:44:52,041 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 15:44:52,041 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 15:44:52,041 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 15:44:54,253 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 15:44:54,253 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-14...
2025-12-23 15:44:54,348 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240214 for 519 symbols
2025-12-23 15:49:10,815 INFO [src.stage_a.wrds_extractor]   Chunk 1: 6,154,100 NBBO records
2025-12-23 15:49:10,815 INFO [src.stage_a.parquet_writer]   Chunk 1: 6,154,100 rows
2025-12-23 15:51:43,468 INFO [src.stage_a.wrds_extractor]   Chunk 2: 4,459,266 NBBO records
2025-12-23 15:51:43,469 INFO [src.stage_a.parquet_writer]   Chunk 2: 4,459,266 rows
2025-12-23 15:55:17,333 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,736,094 NBBO records
2025-12-23 15:55:17,333 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,736,094 rows
2025-12-23 15:56:17,943 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,700,579 NBBO records
2025-12-23 15:56:17,943 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,700,579 rows
2025-12-23 16:00:14,872 INFO [src.stage_a.wrds_extractor]   Chunk 5: 6,134,849 NBBO records
2025-12-23 16:00:14,872 INFO [src.stage_a.parquet_writer]   Chunk 5: 6,134,849 rows
2025-12-23 16:03:56,209 INFO [src.stage_a.wrds_extractor]   Chunk 6: 6,070,979 NBBO records
2025-12-23 16:03:56,211 INFO [src.stage_a.parquet_writer]   Chunk 6: 6,070,979 rows
2025-12-23 16:07:26,370 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,316,479 NBBO records
2025-12-23 16:07:26,374 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,316,479 rows
2025-12-23 16:11:17,049 INFO [src.stage_a.wrds_extractor]   Chunk 8: 7,890,184 NBBO records
2025-12-23 16:11:17,051 INFO [src.stage_a.parquet_writer]   Chunk 8: 7,890,184 rows
2025-12-23 16:13:56,515 INFO [src.stage_a.wrds_extractor]   Chunk 9: 7,281,190 NBBO records
2025-12-23 16:13:56,516 INFO [src.stage_a.parquet_writer]   Chunk 9: 7,281,190 rows
2025-12-23 16:15:06,687 INFO [src.stage_a.wrds_extractor]   Chunk 10: 6,069,138 NBBO records
2025-12-23 16:15:06,688 INFO [src.stage_a.parquet_writer]   Chunk 10: 6,069,138 rows
2025-12-23 16:15:07,111 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 59,812,858 total rows written
2025-12-23 16:19:43,035 INFO [src.stage_a.wrds_extractor]   Chunk 11: 8,254,118 NBBO records
2025-12-23 16:19:43,035 INFO [src.stage_a.parquet_writer]   Chunk 11: 8,254,118 rows
2025-12-23 16:19:43,768 INFO [src.stage_a.parquet_writer] ✓ Wrote 68,066,976 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-14
2025-12-23 16:19:43,782 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 16:19:43,782 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 16:19:43,782 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 16:19:43,782 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 16:19:43,782 INFO [src.stage_a.stage_a] Trades: 27,404,482 rows
2025-12-23 16:19:43,782 INFO [src.stage_a.stage_a] Nbbo: 68,066,976 rows
2025-12-23 16:19:43,782 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 16:19:43,782 INFO [src.stage_a.stage_a] Processing date 32/83: 2024-02-15
2025-12-23 16:19:43,783 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 16:19:43,783 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 16:19:43,783 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-02-15 (519 symbols)
2025-12-23 16:19:43,783 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 16:19:43,783 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 16:19:43,783 INFO [src.stage_a.stage_a] Extract run ID: a8834bdb-6739-41ee-b618-699f187bc003
2025-12-23 16:19:43,791 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 16:19:43,791 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 16:19:43,791 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 16:19:43,791 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 16:19:43,791 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 16:19:43,791 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 16:19:43,791 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 16:19:43,791 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 16:19:43,791 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 16:19:46,655 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 16:19:46,656 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-15...
2025-12-23 16:19:46,800 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240215 for 519 symbols
2025-12-23 16:21:22,347 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,681,863 trades
2025-12-23 16:21:22,347 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,681,863 rows
2025-12-23 16:23:07,370 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,033,694 trades
2025-12-23 16:23:07,371 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,033,694 rows
2025-12-23 16:24:56,336 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,290,072 trades
2025-12-23 16:24:56,336 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,290,072 rows
2025-12-23 16:26:12,549 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,832,743 trades
2025-12-23 16:26:12,549 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,832,743 rows
2025-12-23 16:27:47,184 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,714,015 trades
2025-12-23 16:27:47,185 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,714,015 rows
2025-12-23 16:29:49,495 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,296,944 trades
2025-12-23 16:29:49,495 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,296,944 rows
2025-12-23 16:32:23,434 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,561,708 trades
2025-12-23 16:32:23,435 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,561,708 rows
2025-12-23 16:34:45,097 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,618,419 trades
2025-12-23 16:34:45,097 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,618,419 rows
2025-12-23 16:37:08,113 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,248,702 trades
2025-12-23 16:37:08,113 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,248,702 rows
2025-12-23 16:41:04,191 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,697,954 trades
2025-12-23 16:41:04,191 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,697,954 rows
2025-12-23 16:41:04,644 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,976,114 total rows written
2025-12-23 16:42:03,598 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,314,069 trades
2025-12-23 16:42:03,598 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,314,069 rows
2025-12-23 16:42:04,003 INFO [src.stage_a.parquet_writer] ✓ Wrote 28,290,183 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-15
2025-12-23 16:42:04,006 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 16:42:04,006 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 16:42:04,006 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 16:42:04,006 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 16:42:04,006 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 16:42:04,006 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 16:42:04,006 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 16:42:06,697 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 16:42:06,697 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-15...
2025-12-23 16:42:06,841 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240215 for 519 symbols
2025-12-23 16:45:41,048 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,869,210 NBBO records
2025-12-23 16:45:41,048 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,869,210 rows
2025-12-23 16:47:59,389 INFO [src.stage_a.wrds_extractor]   Chunk 2: 4,456,382 NBBO records
2025-12-23 16:47:59,389 INFO [src.stage_a.parquet_writer]   Chunk 2: 4,456,382 rows
2025-12-23 16:50:52,400 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,480,095 NBBO records
2025-12-23 16:50:52,400 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,480,095 rows
2025-12-23 16:53:04,201 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,597,275 NBBO records
2025-12-23 16:53:04,201 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,597,275 rows
2025-12-23 16:56:03,837 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,846,378 NBBO records
2025-12-23 16:56:03,837 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,846,378 rows
2025-12-23 16:59:30,226 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,728,014 NBBO records
2025-12-23 16:59:30,228 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,728,014 rows
2025-12-23 17:03:05,193 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,075,454 NBBO records
2025-12-23 17:03:05,194 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,075,454 rows
2025-12-23 17:04:51,812 INFO [src.stage_a.wrds_extractor]   Chunk 8: 7,481,363 NBBO records
2025-12-23 17:04:51,813 INFO [src.stage_a.parquet_writer]   Chunk 8: 7,481,363 rows
2025-12-23 17:07:35,271 INFO [src.stage_a.wrds_extractor]   Chunk 9: 7,284,731 NBBO records
2025-12-23 17:07:35,279 INFO [src.stage_a.parquet_writer]   Chunk 9: 7,284,731 rows
2025-12-23 17:10:38,413 INFO [src.stage_a.wrds_extractor]   Chunk 10: 6,210,121 NBBO records
2025-12-23 17:10:38,414 INFO [src.stage_a.parquet_writer]   Chunk 10: 6,210,121 rows
2025-12-23 17:10:38,846 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 58,029,023 total rows written
2025-12-23 17:13:31,024 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,900,581 NBBO records
2025-12-23 17:13:31,025 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,900,581 rows
2025-12-23 17:13:31,751 INFO [src.stage_a.parquet_writer] ✓ Wrote 65,929,604 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-15
2025-12-23 17:13:31,761 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 17:13:31,761 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 17:13:31,761 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 17:13:31,761 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 17:13:31,761 INFO [src.stage_a.stage_a] Trades: 28,290,183 rows
2025-12-23 17:13:31,761 INFO [src.stage_a.stage_a] Nbbo: 65,929,604 rows
2025-12-23 17:13:31,761 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 17:13:31,761 INFO [src.stage_a.stage_a] Processing date 33/83: 2024-02-16
2025-12-23 17:13:31,761 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 17:13:31,761 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 17:13:31,761 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-02-16 (519 symbols)
2025-12-23 17:13:31,761 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 17:13:31,761 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 17:13:31,761 INFO [src.stage_a.stage_a] Extract run ID: 86ff40a0-eabe-438d-8ede-038dd716b6ed
2025-12-23 17:13:31,770 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 17:13:31,770 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 17:13:31,770 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 17:13:31,770 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 17:13:31,770 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 17:13:31,770 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 17:13:31,770 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 17:13:31,770 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 17:13:31,770 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 17:13:33,498 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 17:13:33,498 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-16...
2025-12-23 17:13:33,602 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240216 for 519 symbols
2025-12-23 17:16:59,191 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,519,610 trades
2025-12-23 17:16:59,191 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,519,610 rows
2025-12-23 17:17:44,414 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,821,355 trades
2025-12-23 17:17:44,414 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,821,355 rows
2025-12-23 17:18:15,274 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,097,470 trades
2025-12-23 17:18:15,274 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,097,470 rows
2025-12-23 17:18:51,858 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,707,113 trades
2025-12-23 17:18:51,858 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,707,113 rows
2025-12-23 17:21:20,422 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,517,484 trades
2025-12-23 17:21:20,422 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,517,484 rows
2025-12-23 17:22:55,925 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,372,061 trades
2025-12-23 17:22:55,926 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,372,061 rows
2025-12-23 17:24:48,633 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,534,641 trades
2025-12-23 17:24:48,633 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,534,641 rows
2025-12-23 17:25:30,401 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,495,659 trades
2025-12-23 17:25:30,401 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,495,659 rows
2025-12-23 17:26:02,447 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,041,241 trades
2025-12-23 17:26:02,447 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,041,241 rows
2025-12-23 17:28:27,212 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,262,898 trades
2025-12-23 17:28:27,212 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,262,898 rows
2025-12-23 17:28:27,647 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,369,532 total rows written
2025-12-23 17:29:18,804 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,121,695 trades
2025-12-23 17:29:18,804 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,121,695 rows
2025-12-23 17:29:19,137 INFO [src.stage_a.parquet_writer] ✓ Wrote 26,491,227 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-16
2025-12-23 17:29:19,137 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 17:29:19,137 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 17:29:19,137 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 17:29:19,137 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 17:29:19,137 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 17:29:19,137 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 17:29:19,137 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 17:29:21,510 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 17:29:21,510 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-16...
2025-12-23 17:29:21,662 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240216 for 519 symbols
2025-12-23 17:31:59,829 INFO [src.stage_a.wrds_extractor]   Chunk 1: 6,371,191 NBBO records
2025-12-23 17:31:59,829 INFO [src.stage_a.parquet_writer]   Chunk 1: 6,371,191 rows
2025-12-23 17:32:42,474 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,985,580 NBBO records
2025-12-23 17:32:42,475 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,985,580 rows
2025-12-23 17:33:32,642 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,117,751 NBBO records
2025-12-23 17:33:32,642 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,117,751 rows
2025-12-23 17:35:16,887 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,433,919 NBBO records
2025-12-23 17:35:16,887 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,433,919 rows
2025-12-23 17:38:09,156 INFO [src.stage_a.wrds_extractor]   Chunk 5: 6,132,236 NBBO records
2025-12-23 17:38:09,156 INFO [src.stage_a.parquet_writer]   Chunk 5: 6,132,236 rows
2025-12-23 17:39:26,027 INFO [src.stage_a.wrds_extractor]   Chunk 6: 6,144,606 NBBO records
2025-12-23 17:39:26,033 INFO [src.stage_a.parquet_writer]   Chunk 6: 6,144,606 rows
2025-12-23 17:42:47,937 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,989,810 NBBO records
2025-12-23 17:42:47,938 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,989,810 rows
2025-12-23 17:46:03,311 INFO [src.stage_a.wrds_extractor]   Chunk 8: 7,621,457 NBBO records
2025-12-23 17:46:03,312 INFO [src.stage_a.parquet_writer]   Chunk 8: 7,621,457 rows
2025-12-23 17:50:01,306 INFO [src.stage_a.wrds_extractor]   Chunk 9: 7,279,910 NBBO records
2025-12-23 17:50:01,308 INFO [src.stage_a.parquet_writer]   Chunk 9: 7,279,910 rows
2025-12-23 17:53:51,090 INFO [src.stage_a.wrds_extractor]   Chunk 10: 5,920,361 NBBO records
2025-12-23 17:53:51,092 INFO [src.stage_a.parquet_writer]   Chunk 10: 5,920,361 rows
2025-12-23 17:53:51,507 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 57,996,821 total rows written
2025-12-23 17:56:46,702 INFO [src.stage_a.wrds_extractor]   Chunk 11: 8,392,748 NBBO records
2025-12-23 17:56:46,703 INFO [src.stage_a.parquet_writer]   Chunk 11: 8,392,748 rows
2025-12-23 17:56:47,499 INFO [src.stage_a.parquet_writer] ✓ Wrote 66,389,569 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-16
2025-12-23 17:56:47,516 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 17:56:47,516 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 17:56:47,516 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 17:56:47,516 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 17:56:47,516 INFO [src.stage_a.stage_a] Trades: 26,491,227 rows
2025-12-23 17:56:47,516 INFO [src.stage_a.stage_a] Nbbo: 66,389,569 rows
2025-12-23 17:56:47,516 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 17:56:47,516 INFO [src.stage_a.stage_a] Processing date 34/83: 2024-02-20
2025-12-23 17:56:47,516 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 17:56:47,516 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 17:56:47,516 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-02-20 (519 symbols)
2025-12-23 17:56:47,516 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 17:56:47,516 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 17:56:47,516 INFO [src.stage_a.stage_a] Extract run ID: d1fb4076-1ba0-495b-8f57-1216871e8dd7
2025-12-23 17:56:47,524 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 17:56:47,524 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 17:56:47,524 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 17:56:47,524 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 17:56:47,524 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 17:56:47,524 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 17:56:47,524 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 17:56:47,524 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 17:56:47,524 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 17:56:50,946 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 17:56:50,946 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-20...
2025-12-23 17:56:51,091 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240220 for 519 symbols
2025-12-23 18:00:26,481 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,908,257 trades
2025-12-23 18:00:26,481 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,908,257 rows
2025-12-23 18:01:48,553 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,002,665 trades
2025-12-23 18:01:48,553 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,002,665 rows
2025-12-23 18:04:02,860 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,523,457 trades
2025-12-23 18:04:02,861 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,523,457 rows
2025-12-23 18:05:31,121 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,662,930 trades
2025-12-23 18:05:31,121 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,662,930 rows
2025-12-23 18:07:36,768 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,592,151 trades
2025-12-23 18:07:36,768 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,592,151 rows
2025-12-23 18:10:03,588 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,471,748 trades
2025-12-23 18:10:03,588 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,471,748 rows
2025-12-23 18:13:30,602 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,212,106 trades
2025-12-23 18:13:30,602 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,212,106 rows
2025-12-23 18:14:19,462 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,814,422 trades
2025-12-23 18:14:19,464 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,814,422 rows
2025-12-23 18:15:11,468 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,285,011 trades
2025-12-23 18:15:11,469 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,285,011 rows
2025-12-23 18:16:22,702 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,585,437 trades
2025-12-23 18:16:22,702 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,585,437 rows
2025-12-23 18:16:23,163 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 28,058,184 total rows written
2025-12-23 18:16:43,892 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,183,304 trades
2025-12-23 18:16:43,892 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,183,304 rows
2025-12-23 18:16:44,268 INFO [src.stage_a.parquet_writer] ✓ Wrote 29,241,488 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-20
2025-12-23 18:16:44,269 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 18:16:44,269 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 18:16:44,269 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 18:16:44,269 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 18:16:44,269 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 18:16:44,269 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 18:16:44,269 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 18:16:45,536 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 18:16:45,536 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-20...
2025-12-23 18:16:45,582 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240220 for 519 symbols
2025-12-23 18:18:35,112 INFO [src.stage_a.wrds_extractor]   Chunk 1: 7,140,080 NBBO records
2025-12-23 18:18:35,112 INFO [src.stage_a.parquet_writer]   Chunk 1: 7,140,080 rows
2025-12-23 18:19:22,360 INFO [src.stage_a.wrds_extractor]   Chunk 2: 4,268,018 NBBO records
2025-12-23 18:19:22,361 INFO [src.stage_a.parquet_writer]   Chunk 2: 4,268,018 rows
2025-12-23 18:22:12,773 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,472,314 NBBO records
2025-12-23 18:22:12,773 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,472,314 rows
2025-12-23 18:24:28,227 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,638,547 NBBO records
2025-12-23 18:24:28,228 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,638,547 rows
2025-12-23 18:25:51,704 INFO [src.stage_a.wrds_extractor]   Chunk 5: 6,072,991 NBBO records
2025-12-23 18:25:51,704 INFO [src.stage_a.parquet_writer]   Chunk 5: 6,072,991 rows
2025-12-23 18:28:47,417 INFO [src.stage_a.wrds_extractor]   Chunk 6: 6,086,381 NBBO records
2025-12-23 18:28:47,418 INFO [src.stage_a.parquet_writer]   Chunk 6: 6,086,381 rows
2025-12-23 18:31:50,102 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,521,118 NBBO records
2025-12-23 18:31:50,103 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,521,118 rows
2025-12-23 18:35:35,406 INFO [src.stage_a.wrds_extractor]   Chunk 8: 8,810,064 NBBO records
2025-12-23 18:35:35,407 INFO [src.stage_a.parquet_writer]   Chunk 8: 8,810,064 rows
2025-12-23 18:39:09,233 INFO [src.stage_a.wrds_extractor]   Chunk 9: 8,112,643 NBBO records
2025-12-23 18:39:09,246 INFO [src.stage_a.parquet_writer]   Chunk 9: 8,112,643 rows
2025-12-23 18:42:21,066 INFO [src.stage_a.wrds_extractor]   Chunk 10: 6,076,761 NBBO records
2025-12-23 18:42:21,074 INFO [src.stage_a.parquet_writer]   Chunk 10: 6,076,761 rows
2025-12-23 18:42:21,488 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 62,198,917 total rows written
2025-12-23 18:47:01,883 INFO [src.stage_a.wrds_extractor]   Chunk 11: 9,419,318 NBBO records
2025-12-23 18:47:01,884 INFO [src.stage_a.parquet_writer]   Chunk 11: 9,419,318 rows
2025-12-23 18:47:02,727 INFO [src.stage_a.parquet_writer] ✓ Wrote 71,618,235 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-20
2025-12-23 18:47:02,749 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 18:47:02,749 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 18:47:02,749 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 18:47:02,749 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 18:47:02,749 INFO [src.stage_a.stage_a] Trades: 29,241,488 rows
2025-12-23 18:47:02,749 INFO [src.stage_a.stage_a] Nbbo: 71,618,235 rows
2025-12-23 18:47:02,749 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 18:47:02,749 INFO [src.stage_a.stage_a] Processing date 35/83: 2024-02-21
2025-12-23 18:47:02,749 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 18:47:02,749 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 18:47:02,749 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-02-21 (519 symbols)
2025-12-23 18:47:02,749 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 18:47:02,749 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 18:47:02,749 INFO [src.stage_a.stage_a] Extract run ID: c63b325b-83a8-4891-b108-59a361935c3c
2025-12-23 18:47:02,757 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 18:47:02,757 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 18:47:02,758 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 18:47:02,758 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 18:47:02,758 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 18:47:02,758 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 18:47:02,758 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 18:47:02,758 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 18:47:02,758 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 18:47:04,440 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 18:47:04,441 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-21...
2025-12-23 18:47:04,559 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240221 for 519 symbols
2025-12-23 18:49:39,916 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,134,641 trades
2025-12-23 18:49:39,916 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,134,641 rows
2025-12-23 18:50:55,797 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,704,825 trades
2025-12-23 18:50:55,797 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,704,825 rows
2025-12-23 18:52:55,986 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,166,358 trades
2025-12-23 18:52:55,986 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,166,358 rows
2025-12-23 18:54:41,154 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,827,119 trades
2025-12-23 18:54:41,154 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,827,119 rows
2025-12-23 18:57:01,754 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,577,147 trades
2025-12-23 18:57:01,754 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,577,147 rows
2025-12-23 18:59:24,356 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,088,552 trades
2025-12-23 18:59:24,357 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,088,552 rows
2025-12-23 19:02:48,007 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,573,606 trades
2025-12-23 19:02:48,007 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,573,606 rows
2025-12-23 19:05:58,871 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,094,260 trades
2025-12-23 19:05:58,871 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,094,260 rows
2025-12-23 19:07:30,190 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,042,597 trades
2025-12-23 19:07:30,190 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,042,597 rows
2025-12-23 19:10:08,710 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,045,621 trades
2025-12-23 19:10:08,710 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,045,621 rows
2025-12-23 19:10:09,107 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,254,726 total rows written
2025-12-23 19:10:47,149 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,134,232 trades
2025-12-23 19:10:47,149 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,134,232 rows
2025-12-23 19:10:47,468 INFO [src.stage_a.parquet_writer] ✓ Wrote 26,388,958 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-21
2025-12-23 19:10:47,469 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 19:10:47,469 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 19:10:47,469 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 19:10:47,469 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 19:10:47,469 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 19:10:47,469 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 19:10:47,469 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 19:10:51,348 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 19:10:51,349 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-21...
2025-12-23 19:10:51,550 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240221 for 519 symbols
2025-12-23 19:14:42,558 INFO [src.stage_a.wrds_extractor]   Chunk 1: 6,107,758 NBBO records
2025-12-23 19:14:42,558 INFO [src.stage_a.parquet_writer]   Chunk 1: 6,107,758 rows
2025-12-23 19:15:37,874 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,994,017 NBBO records
2025-12-23 19:15:37,874 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,994,017 rows
2025-12-23 19:16:51,382 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,187,479 NBBO records
2025-12-23 19:16:51,382 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,187,479 rows
2025-12-23 19:19:25,560 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,841,278 NBBO records
2025-12-23 19:19:25,560 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,841,278 rows
2025-12-23 19:22:52,168 INFO [src.stage_a.wrds_extractor]   Chunk 5: 6,208,549 NBBO records
2025-12-23 19:22:52,168 INFO [src.stage_a.parquet_writer]   Chunk 5: 6,208,549 rows
2025-12-23 19:26:54,962 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,549,855 NBBO records
2025-12-23 19:26:54,963 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,549,855 rows
2025-12-23 19:30:47,861 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,997,211 NBBO records
2025-12-23 19:30:47,861 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,997,211 rows
2025-12-23 19:35:38,529 INFO [src.stage_a.wrds_extractor]   Chunk 8: 7,887,328 NBBO records
2025-12-23 19:35:38,530 INFO [src.stage_a.parquet_writer]   Chunk 8: 7,887,328 rows
2025-12-23 19:40:45,740 INFO [src.stage_a.wrds_extractor]   Chunk 9: 8,055,222 NBBO records
2025-12-23 19:40:45,743 INFO [src.stage_a.parquet_writer]   Chunk 9: 8,055,222 rows
2025-12-23 19:44:04,443 INFO [src.stage_a.wrds_extractor]   Chunk 10: 5,760,731 NBBO records
2025-12-23 19:44:04,451 INFO [src.stage_a.parquet_writer]   Chunk 10: 5,760,731 rows
2025-12-23 19:44:04,876 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 58,589,428 total rows written
2025-12-23 19:49:11,953 INFO [src.stage_a.wrds_extractor]   Chunk 11: 8,939,178 NBBO records
2025-12-23 19:49:11,953 INFO [src.stage_a.parquet_writer]   Chunk 11: 8,939,178 rows
2025-12-23 19:49:12,752 INFO [src.stage_a.parquet_writer] ✓ Wrote 67,528,606 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-21
2025-12-23 19:49:12,764 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 19:49:12,764 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 19:49:12,764 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 19:49:12,764 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 19:49:12,765 INFO [src.stage_a.stage_a] Trades: 26,388,958 rows
2025-12-23 19:49:12,765 INFO [src.stage_a.stage_a] Nbbo: 67,528,606 rows
2025-12-23 19:49:12,765 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 19:49:12,765 INFO [src.stage_a.stage_a] Processing date 36/83: 2024-02-22
2025-12-23 19:49:12,765 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 19:49:12,765 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 19:49:12,765 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-02-22 (519 symbols)
2025-12-23 19:49:12,765 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 19:49:12,765 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 19:49:12,765 INFO [src.stage_a.stage_a] Extract run ID: f55ab3cb-4bdd-4533-9eb6-2b2e3b114a58
2025-12-23 19:49:12,773 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 19:49:12,773 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 19:49:12,773 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 19:49:12,773 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 19:49:12,773 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 19:49:12,773 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 19:49:12,773 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 19:49:12,773 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 19:49:12,773 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 19:49:14,735 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 19:49:14,735 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-22...
2025-12-23 19:49:14,928 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240222 for 519 symbols
2025-12-23 19:52:00,893 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,128,306 trades
2025-12-23 19:52:00,893 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,128,306 rows
2025-12-23 19:53:45,046 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,971,936 trades
2025-12-23 19:53:45,046 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,971,936 rows
2025-12-23 19:54:32,419 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,252,575 trades
2025-12-23 19:54:32,420 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,252,575 rows
2025-12-23 19:55:51,980 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,803,385 trades
2025-12-23 19:55:51,980 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,803,385 rows
2025-12-23 19:57:49,816 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,735,615 trades
2025-12-23 19:57:49,816 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,735,615 rows
2025-12-23 19:59:27,459 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,299,714 trades
2025-12-23 19:59:27,459 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,299,714 rows
2025-12-23 20:01:02,836 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,702,550 trades
2025-12-23 20:01:02,836 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,702,550 rows
2025-12-23 20:13:23,510 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,000,286 trades
2025-12-23 20:13:23,511 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,000,286 rows
2025-12-23 20:15:30,370 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,410,945 trades
2025-12-23 20:15:30,372 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,410,945 rows
2025-12-23 20:17:44,233 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,218,571 trades
2025-12-23 20:17:44,234 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,218,571 rows
2025-12-23 20:17:44,669 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 28,523,883 total rows written
2025-12-23 20:18:37,718 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,206,135 trades
2025-12-23 20:18:37,718 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,206,135 rows
2025-12-23 20:18:38,065 INFO [src.stage_a.parquet_writer] ✓ Wrote 29,730,018 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-22
2025-12-23 20:18:38,066 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 20:18:38,066 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 20:18:38,066 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 20:18:38,066 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 20:18:38,066 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 20:18:38,066 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 20:18:38,066 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 20:18:39,941 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 20:18:39,941 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-22...
2025-12-23 20:18:40,112 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240222 for 519 symbols
2025-12-23 20:22:20,747 INFO [src.stage_a.wrds_extractor]   Chunk 1: 6,180,453 NBBO records
2025-12-23 20:22:20,747 INFO [src.stage_a.parquet_writer]   Chunk 1: 6,180,453 rows
2025-12-23 20:24:45,034 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,857,612 NBBO records
2025-12-23 20:24:45,034 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,857,612 rows
2025-12-23 20:26:00,693 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,040,087 NBBO records
2025-12-23 20:26:00,693 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,040,087 rows
2025-12-23 20:27:37,811 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,629,601 NBBO records
2025-12-23 20:27:37,811 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,629,601 rows
2025-12-23 20:31:05,533 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,765,729 NBBO records
2025-12-23 20:31:05,533 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,765,729 rows
2025-12-23 20:32:54,492 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,367,016 NBBO records
2025-12-23 20:32:54,493 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,367,016 rows
2025-12-23 20:36:42,652 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,481,923 NBBO records
2025-12-23 20:36:42,653 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,481,923 rows
2025-12-23 20:41:03,018 INFO [src.stage_a.wrds_extractor]   Chunk 8: 7,480,444 NBBO records
2025-12-23 20:41:03,019 INFO [src.stage_a.parquet_writer]   Chunk 8: 7,480,444 rows
2025-12-23 20:45:35,905 INFO [src.stage_a.wrds_extractor]   Chunk 9: 7,005,793 NBBO records
2025-12-23 20:45:35,912 INFO [src.stage_a.parquet_writer]   Chunk 9: 7,005,793 rows
2025-12-23 20:48:21,863 INFO [src.stage_a.wrds_extractor]   Chunk 10: 5,918,373 NBBO records
2025-12-23 20:48:21,864 INFO [src.stage_a.parquet_writer]   Chunk 10: 5,918,373 rows
2025-12-23 20:48:22,262 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 56,727,031 total rows written
2025-12-23 20:50:12,459 INFO [src.stage_a.wrds_extractor]   Chunk 11: 8,313,268 NBBO records
2025-12-23 20:50:12,459 INFO [src.stage_a.parquet_writer]   Chunk 11: 8,313,268 rows
2025-12-23 20:50:13,196 INFO [src.stage_a.parquet_writer] ✓ Wrote 65,040,299 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-22
2025-12-23 20:50:13,208 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 20:50:13,208 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 20:50:13,208 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 20:50:13,208 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 20:50:13,208 INFO [src.stage_a.stage_a] Trades: 29,730,018 rows
2025-12-23 20:50:13,208 INFO [src.stage_a.stage_a] Nbbo: 65,040,299 rows
2025-12-23 20:50:13,208 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 20:50:13,208 INFO [src.stage_a.stage_a] Processing date 37/83: 2024-02-23
2025-12-23 20:50:13,208 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 20:50:13,208 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 20:50:13,208 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-02-23 (519 symbols)
2025-12-23 20:50:13,208 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 20:50:13,208 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 20:50:13,208 INFO [src.stage_a.stage_a] Extract run ID: 8d467ef5-8e74-41b1-a902-a77b3b605116
2025-12-23 20:50:13,217 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 20:50:13,217 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 20:50:13,217 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 20:50:13,217 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 20:50:13,217 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 20:50:13,217 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 20:50:13,217 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 20:50:13,217 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 20:50:13,217 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 20:50:14,352 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 20:50:14,352 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-23...
2025-12-23 20:50:14,417 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240223 for 519 symbols
2025-12-23 20:51:10,542 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,268,592 trades
2025-12-23 20:51:10,542 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,268,592 rows
2025-12-23 20:52:31,803 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,797,855 trades
2025-12-23 20:52:31,804 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,797,855 rows
2025-12-23 20:54:10,744 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,075,491 trades
2025-12-23 20:54:10,744 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,075,491 rows
2025-12-23 20:55:24,916 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,612,325 trades
2025-12-23 20:55:24,916 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,612,325 rows
2025-12-23 20:57:33,017 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,207,909 trades
2025-12-23 20:57:33,017 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,207,909 rows
2025-12-23 20:59:18,754 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,037,616 trades
2025-12-23 20:59:18,754 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,037,616 rows
2025-12-23 21:02:37,623 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,928,473 trades
2025-12-23 21:02:37,623 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,928,473 rows
2025-12-23 21:04:58,010 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,531,015 trades
2025-12-23 21:04:58,011 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,531,015 rows
2025-12-23 21:06:34,328 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,974,383 trades
2025-12-23 21:06:34,328 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,974,383 rows
2025-12-23 21:07:36,475 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,915,964 trades
2025-12-23 21:07:36,475 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,915,964 rows
2025-12-23 21:07:36,869 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 24,349,623 total rows written
2025-12-23 21:08:24,111 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,057,983 trades
2025-12-23 21:08:24,112 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,057,983 rows
2025-12-23 21:08:24,452 INFO [src.stage_a.parquet_writer] ✓ Wrote 25,407,606 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-23
2025-12-23 21:08:24,453 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 21:08:24,453 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 21:08:24,453 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 21:08:24,453 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 21:08:24,453 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 21:08:24,453 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 21:08:24,453 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 21:08:26,110 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 21:08:26,111 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-23...
2025-12-23 21:08:26,278 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240223 for 519 symbols
2025-12-23 21:12:20,080 INFO [src.stage_a.wrds_extractor]   Chunk 1: 6,489,929 NBBO records
2025-12-23 21:12:20,081 INFO [src.stage_a.parquet_writer]   Chunk 1: 6,489,929 rows
2025-12-23 21:14:47,817 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,563,619 NBBO records
2025-12-23 21:14:47,818 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,563,619 rows
2025-12-23 21:18:18,897 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,862,094 NBBO records
2025-12-23 21:18:18,897 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,862,094 rows
2025-12-23 21:20:16,482 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,355,127 NBBO records
2025-12-23 21:20:16,483 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,355,127 rows
2025-12-23 21:23:41,717 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,594,637 NBBO records
2025-12-23 21:23:41,717 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,594,637 rows
2025-12-23 21:26:44,371 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,996,597 NBBO records
2025-12-23 21:26:44,371 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,996,597 rows
2025-12-23 21:30:51,887 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,884,138 NBBO records
2025-12-23 21:30:51,888 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,884,138 rows
2025-12-23 21:34:34,082 INFO [src.stage_a.wrds_extractor]   Chunk 8: 8,228,235 NBBO records
2025-12-23 21:34:34,083 INFO [src.stage_a.parquet_writer]   Chunk 8: 8,228,235 rows
2025-12-23 21:39:15,691 INFO [src.stage_a.wrds_extractor]   Chunk 9: 6,440,783 NBBO records
2025-12-23 21:39:15,699 INFO [src.stage_a.parquet_writer]   Chunk 9: 6,440,783 rows
2025-12-23 21:40:34,022 INFO [src.stage_a.wrds_extractor]   Chunk 10: 5,243,584 NBBO records
2025-12-23 21:40:34,023 INFO [src.stage_a.parquet_writer]   Chunk 10: 5,243,584 rows
2025-12-23 21:40:34,393 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 54,658,743 total rows written
2025-12-23 21:45:43,713 INFO [src.stage_a.wrds_extractor]   Chunk 11: 8,126,934 NBBO records
2025-12-23 21:45:43,713 INFO [src.stage_a.parquet_writer]   Chunk 11: 8,126,934 rows
2025-12-23 21:45:44,429 INFO [src.stage_a.parquet_writer] ✓ Wrote 62,785,677 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-23
2025-12-23 21:45:44,441 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 21:45:44,441 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 21:45:44,441 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 21:45:44,441 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 21:45:44,441 INFO [src.stage_a.stage_a] Trades: 25,407,606 rows
2025-12-23 21:45:44,441 INFO [src.stage_a.stage_a] Nbbo: 62,785,677 rows
2025-12-23 21:45:44,441 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 21:45:44,441 INFO [src.stage_a.stage_a] Processing date 38/83: 2024-02-26
2025-12-23 21:45:44,441 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 21:45:44,441 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 21:45:44,441 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-02-26 (519 symbols)
2025-12-23 21:45:44,441 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 21:45:44,441 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 21:45:44,441 INFO [src.stage_a.stage_a] Extract run ID: 8fa26ec1-cbe4-48d6-a086-de6380381235
2025-12-23 21:45:44,449 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 21:45:44,449 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 21:45:44,449 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 21:45:44,449 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 21:45:44,449 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 21:45:44,449 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 21:45:44,449 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 21:45:44,449 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 21:45:44,449 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 21:45:45,811 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 21:45:45,812 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-26...
2025-12-23 21:45:45,906 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240226 for 519 symbols
2025-12-23 21:49:19,290 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,137,109 trades
2025-12-23 21:49:19,290 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,137,109 rows
2025-12-23 21:51:22,158 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,820,278 trades
2025-12-23 21:51:22,158 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,820,278 rows
2025-12-23 21:53:29,205 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,974,591 trades
2025-12-23 21:53:29,205 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,974,591 rows
2025-12-23 21:54:52,029 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,565,132 trades
2025-12-23 21:54:52,029 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,565,132 rows
2025-12-23 21:57:50,289 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,749,719 trades
2025-12-23 21:57:50,289 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,749,719 rows
2025-12-23 22:00:05,245 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,977,931 trades
2025-12-23 22:00:05,246 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,977,931 rows
2025-12-23 22:01:29,833 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,477,963 trades
2025-12-23 22:01:29,833 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,477,963 rows
2025-12-23 22:02:14,526 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,665,486 trades
2025-12-23 22:02:14,527 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,665,486 rows
2025-12-23 22:02:43,573 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,958,356 trades
2025-12-23 22:02:43,574 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,958,356 rows
2025-12-23 22:05:05,536 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,276,768 trades
2025-12-23 22:05:05,536 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,276,768 rows
2025-12-23 22:05:05,954 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 24,603,333 total rows written
2025-12-23 22:05:53,526 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,000,573 trades
2025-12-23 22:05:53,526 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,000,573 rows
2025-12-23 22:05:53,857 INFO [src.stage_a.parquet_writer] ✓ Wrote 25,603,906 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-26
2025-12-23 22:05:53,858 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 22:05:53,858 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 22:05:53,858 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 22:05:53,858 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 22:05:53,858 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 22:05:53,858 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 22:05:53,858 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 22:05:55,373 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 22:05:55,373 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-26...
2025-12-23 22:05:55,463 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240226 for 519 symbols
2025-12-23 22:08:27,734 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,168,672 NBBO records
2025-12-23 22:08:27,734 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,168,672 rows
2025-12-23 22:09:18,870 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,420,298 NBBO records
2025-12-23 22:09:18,870 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,420,298 rows
2025-12-23 22:11:31,126 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,485,312 NBBO records
2025-12-23 22:11:31,126 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,485,312 rows
2025-12-23 22:13:06,839 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,104,631 NBBO records
2025-12-23 22:13:06,839 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,104,631 rows
2025-12-23 22:14:43,869 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,991,761 NBBO records
2025-12-23 22:14:43,870 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,991,761 rows
2025-12-23 22:15:28,816 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,486,188 NBBO records
2025-12-23 22:15:28,816 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,486,188 rows
2025-12-23 22:18:03,266 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,094,001 NBBO records
2025-12-23 22:18:03,266 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,094,001 rows
2025-12-23 22:21:13,931 INFO [src.stage_a.wrds_extractor]   Chunk 8: 6,707,806 NBBO records
2025-12-23 22:21:13,931 INFO [src.stage_a.parquet_writer]   Chunk 8: 6,707,806 rows
2025-12-23 22:23:59,577 INFO [src.stage_a.wrds_extractor]   Chunk 9: 5,742,098 NBBO records
2025-12-23 22:23:59,578 INFO [src.stage_a.parquet_writer]   Chunk 9: 5,742,098 rows
2025-12-23 22:26:32,865 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,907,522 NBBO records
2025-12-23 22:26:32,866 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,907,522 rows
2025-12-23 22:26:33,218 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 48,108,289 total rows written
2025-12-23 22:30:17,977 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,096,107 NBBO records
2025-12-23 22:30:17,977 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,096,107 rows
2025-12-23 22:30:18,630 INFO [src.stage_a.parquet_writer] ✓ Wrote 55,204,396 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-26
2025-12-23 22:30:18,639 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 22:30:18,639 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 22:30:18,639 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 22:30:18,639 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 22:30:18,639 INFO [src.stage_a.stage_a] Trades: 25,603,906 rows
2025-12-23 22:30:18,639 INFO [src.stage_a.stage_a] Nbbo: 55,204,396 rows
2025-12-23 22:30:18,639 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 22:30:18,639 INFO [src.stage_a.stage_a] Processing date 39/83: 2024-02-27
2025-12-23 22:30:18,639 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 22:30:18,639 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 22:30:18,639 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-02-27 (519 symbols)
2025-12-23 22:30:18,639 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 22:30:18,639 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 22:30:18,639 INFO [src.stage_a.stage_a] Extract run ID: 53dcc71b-624e-46db-ad07-5ddebf585cf0
2025-12-23 22:30:18,647 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 22:30:18,647 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 22:30:18,647 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 22:30:18,647 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 22:30:18,647 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 22:30:18,647 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 22:30:18,647 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 22:30:18,647 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 22:30:18,647 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 22:30:21,497 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 22:30:21,497 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-27...
2025-12-23 22:30:21,683 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240227 for 519 symbols
2025-12-23 22:33:00,255 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,034,443 trades
2025-12-23 22:33:00,255 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,034,443 rows
2025-12-23 22:34:37,592 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,882,310 trades
2025-12-23 22:34:37,592 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,882,310 rows
2025-12-23 22:36:37,908 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,057,016 trades
2025-12-23 22:36:37,908 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,057,016 rows
2025-12-23 22:37:59,244 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,558,109 trades
2025-12-23 22:37:59,244 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,558,109 rows
2025-12-23 22:39:56,673 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,384,946 trades
2025-12-23 22:39:56,673 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,384,946 rows
2025-12-23 22:41:34,684 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,967,303 trades
2025-12-23 22:41:34,684 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,967,303 rows
2025-12-23 22:43:57,514 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,222,631 trades
2025-12-23 22:43:57,514 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,222,631 rows
2025-12-23 22:46:12,817 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,664,964 trades
2025-12-23 22:46:12,817 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,664,964 rows
2025-12-23 22:48:26,142 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,990,584 trades
2025-12-23 22:48:26,143 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,990,584 rows
2025-12-23 22:50:38,968 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,023,859 trades
2025-12-23 22:50:38,969 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,023,859 rows
2025-12-23 22:50:39,379 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,786,165 total rows written
2025-12-23 22:51:32,559 INFO [src.stage_a.wrds_extractor]   Chunk 11: 989,262 trades
2025-12-23 22:51:32,559 INFO [src.stage_a.parquet_writer]   Chunk 11: 989,262 rows
2025-12-23 22:51:32,859 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,775,427 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-27
2025-12-23 22:51:32,860 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 22:51:32,860 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 22:51:32,860 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 22:51:32,860 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 22:51:32,860 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 22:51:32,860 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 22:51:32,860 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 22:51:34,986 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 22:51:34,987 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-27...
2025-12-23 22:51:35,070 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240227 for 519 symbols
2025-12-23 22:53:08,317 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,198,823 NBBO records
2025-12-23 22:53:08,318 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,198,823 rows
2025-12-23 22:53:52,564 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,447,921 NBBO records
2025-12-23 22:53:52,564 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,447,921 rows
2025-12-23 22:55:54,851 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,324,464 NBBO records
2025-12-23 22:55:54,852 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,324,464 rows
2025-12-23 22:57:47,446 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,062,066 NBBO records
2025-12-23 22:57:47,446 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,062,066 rows
2025-12-23 23:00:00,665 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,102,587 NBBO records
2025-12-23 23:00:00,665 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,102,587 rows
2025-12-23 23:03:17,571 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,604,585 NBBO records
2025-12-23 23:03:17,571 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,604,585 rows
2025-12-23 23:05:50,737 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,016,423 NBBO records
2025-12-23 23:05:50,737 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,016,423 rows
2025-12-23 23:08:40,843 INFO [src.stage_a.wrds_extractor]   Chunk 8: 6,599,360 NBBO records
2025-12-23 23:08:40,843 INFO [src.stage_a.parquet_writer]   Chunk 8: 6,599,360 rows
2025-12-23 23:12:06,214 INFO [src.stage_a.wrds_extractor]   Chunk 9: 5,417,336 NBBO records
2025-12-23 23:12:06,215 INFO [src.stage_a.parquet_writer]   Chunk 9: 5,417,336 rows
2025-12-23 23:15:04,966 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,688,864 NBBO records
2025-12-23 23:15:04,966 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,688,864 rows
2025-12-23 23:15:05,346 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 47,462,429 total rows written
2025-12-23 23:17:45,643 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,169,673 NBBO records
2025-12-23 23:17:45,643 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,169,673 rows
2025-12-23 23:17:46,293 INFO [src.stage_a.parquet_writer] ✓ Wrote 54,632,102 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-27
2025-12-23 23:17:46,299 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 23:17:46,299 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 23:17:46,299 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 23:17:46,299 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 23:17:46,299 INFO [src.stage_a.stage_a] Trades: 24,775,427 rows
2025-12-23 23:17:46,300 INFO [src.stage_a.stage_a] Nbbo: 54,632,102 rows
2025-12-23 23:17:46,300 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 23:17:46,300 INFO [src.stage_a.stage_a] Processing date 40/83: 2024-02-28
2025-12-23 23:17:46,300 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 23:17:46,300 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 23:17:46,300 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-02-28 (519 symbols)
2025-12-23 23:17:46,300 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 23:17:46,300 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 23:17:46,300 INFO [src.stage_a.stage_a] Extract run ID: dbeeb42f-e9a1-4d07-b013-220bddefa290
2025-12-23 23:17:46,308 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 23:17:46,308 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 23:17:46,308 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 23:17:46,308 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 23:17:46,308 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 23:17:46,308 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 23:17:46,308 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 23:17:46,308 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 23:17:46,308 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 23:17:47,857 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 23:17:47,857 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-28...
2025-12-23 23:17:47,966 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240228 for 519 symbols
2025-12-23 23:19:56,015 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,844,837 trades
2025-12-23 23:19:56,015 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,844,837 rows
2025-12-23 23:21:39,820 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,792,518 trades
2025-12-23 23:21:39,820 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,792,518 rows
2025-12-23 23:23:45,072 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,014,682 trades
2025-12-23 23:23:45,072 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,014,682 rows
2025-12-23 23:25:23,181 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,730,832 trades
2025-12-23 23:25:23,182 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,730,832 rows
2025-12-23 23:28:03,042 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,471,035 trades
2025-12-23 23:28:03,042 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,471,035 rows
2025-12-23 23:30:26,007 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,831,818 trades
2025-12-23 23:30:26,007 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,831,818 rows
2025-12-23 23:33:20,020 INFO [src.stage_a.wrds_extractor]   Chunk 7: 2,991,885 trades
2025-12-23 23:33:20,020 INFO [src.stage_a.parquet_writer]   Chunk 7: 2,991,885 rows
2025-12-23 23:34:29,382 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,312,463 trades
2025-12-23 23:34:29,382 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,312,463 rows
2025-12-23 23:35:07,631 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,967,948 trades
2025-12-23 23:35:07,631 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,967,948 rows
2025-12-23 23:36:25,563 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,061,635 trades
2025-12-23 23:36:25,563 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,061,635 rows
2025-12-23 23:36:25,989 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,019,653 total rows written
2025-12-23 23:36:39,223 INFO [src.stage_a.wrds_extractor]   Chunk 11: 901,081 trades
2025-12-23 23:36:39,223 INFO [src.stage_a.parquet_writer]   Chunk 11: 901,081 rows
2025-12-23 23:36:39,529 INFO [src.stage_a.parquet_writer] ✓ Wrote 23,920,734 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-28
2025-12-23 23:36:39,530 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 23:36:39,530 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 23:36:39,530 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-23 23:36:39,530 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 23:36:39,530 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 23:36:39,530 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 23:36:39,530 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 23:36:40,811 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 23:36:40,811 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-28...
2025-12-23 23:36:40,873 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240228 for 519 symbols
2025-12-23 23:37:35,727 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,645,595 NBBO records
2025-12-23 23:37:35,727 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,645,595 rows
2025-12-23 23:38:06,586 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,087,190 NBBO records
2025-12-23 23:38:06,586 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,087,190 rows
2025-12-23 23:40:10,233 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,806,854 NBBO records
2025-12-23 23:40:10,233 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,806,854 rows
2025-12-23 23:41:40,421 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,001,749 NBBO records
2025-12-23 23:41:40,421 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,001,749 rows
2025-12-23 23:44:24,645 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,849,343 NBBO records
2025-12-23 23:44:24,645 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,849,343 rows
2025-12-23 23:46:42,271 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,125,203 NBBO records
2025-12-23 23:46:42,271 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,125,203 rows
2025-12-23 23:48:58,089 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,195,609 NBBO records
2025-12-23 23:48:58,090 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,195,609 rows
2025-12-23 23:51:58,874 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,688,708 NBBO records
2025-12-23 23:51:58,874 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,688,708 rows
2025-12-23 23:54:21,844 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,992,646 NBBO records
2025-12-23 23:54:21,845 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,992,646 rows
2025-12-23 23:55:07,738 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,122,098 NBBO records
2025-12-23 23:55:07,738 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,122,098 rows
2025-12-23 23:55:08,087 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 42,514,995 total rows written
2025-12-23 23:56:18,086 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,270,956 NBBO records
2025-12-23 23:56:18,086 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,270,956 rows
2025-12-23 23:56:18,648 INFO [src.stage_a.parquet_writer] ✓ Wrote 48,785,951 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-28
2025-12-23 23:56:18,653 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-23 23:56:18,654 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 23:56:18,654 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-23 23:56:18,654 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 23:56:18,654 INFO [src.stage_a.stage_a] Trades: 23,920,734 rows
2025-12-23 23:56:18,654 INFO [src.stage_a.stage_a] Nbbo: 48,785,951 rows
2025-12-23 23:56:18,654 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 23:56:18,654 INFO [src.stage_a.stage_a] Processing date 41/83: 2024-02-29
2025-12-23 23:56:18,654 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 23:56:18,654 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 23:56:18,654 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-02-29 (519 symbols)
2025-12-23 23:56:18,654 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-23 23:56:18,654 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 23:56:18,654 INFO [src.stage_a.stage_a] Extract run ID: 68e79a02-0239-446a-a8ba-7e4d6c3e3427
2025-12-23 23:56:18,662 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-23 23:56:18,662 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-23 23:56:18,662 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-23 23:56:18,662 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-23 23:56:18,662 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-23 23:56:18,662 INFO [src.stage_a.stage_a] ================================================================================
2025-12-23 23:56:18,662 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-23 23:56:18,662 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-23 23:56:18,662 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-23 23:56:19,812 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-23 23:56:19,812 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-29...
2025-12-23 23:56:19,876 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240229 for 519 symbols
2025-12-23 23:57:28,542 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,021,122 trades
2025-12-23 23:57:28,543 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,021,122 rows
2025-12-23 23:59:11,905 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,150,225 trades
2025-12-23 23:59:11,906 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,150,225 rows
2025-12-24 00:01:20,639 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,319,683 trades
2025-12-24 00:01:20,639 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,319,683 rows
2025-12-24 00:02:39,477 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,885,096 trades
2025-12-24 00:02:39,477 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,885,096 rows
2025-12-24 00:03:45,324 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,734,038 trades
2025-12-24 00:03:45,324 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,734,038 rows
2025-12-24 00:04:19,633 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,217,609 trades
2025-12-24 00:04:19,633 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,217,609 rows
2025-12-24 00:05:21,346 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,386,894 trades
2025-12-24 00:05:21,346 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,386,894 rows
2025-12-24 00:06:03,055 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,776,183 trades
2025-12-24 00:06:03,055 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,776,183 rows
2025-12-24 00:08:11,824 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,302,523 trades
2025-12-24 00:08:11,824 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,302,523 rows
2025-12-24 00:11:03,759 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,319,091 trades
2025-12-24 00:11:03,759 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,319,091 rows
2025-12-24 00:11:04,228 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 27,112,464 total rows written
2025-12-24 00:11:36,152 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,072,828 trades
2025-12-24 00:11:36,152 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,072,828 rows
2025-12-24 00:11:36,524 INFO [src.stage_a.parquet_writer] ✓ Wrote 28,185,292 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-02-29
2025-12-24 00:11:36,525 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 00:11:36,525 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 00:11:36,525 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 00:11:36,525 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 00:11:36,525 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 00:11:36,525 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 00:11:36,525 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 00:11:37,786 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 00:11:37,787 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-29...
2025-12-24 00:11:37,853 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240229 for 519 symbols
2025-12-24 00:15:25,497 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,781,038 NBBO records
2025-12-24 00:15:25,497 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,781,038 rows
2025-12-24 00:17:25,434 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,329,009 NBBO records
2025-12-24 00:17:25,434 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,329,009 rows
2025-12-24 00:19:43,558 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,394,520 NBBO records
2025-12-24 00:19:43,558 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,394,520 rows
2025-12-24 00:21:31,033 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,236,957 NBBO records
2025-12-24 00:21:31,033 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,236,957 rows
2025-12-24 00:22:58,276 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,954,083 NBBO records
2025-12-24 00:22:58,276 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,954,083 rows
2025-12-24 00:24:41,816 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,778,117 NBBO records
2025-12-24 00:24:41,816 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,778,117 rows
2025-12-24 00:27:04,269 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,734,393 NBBO records
2025-12-24 00:27:04,269 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,734,393 rows
2025-12-24 00:29:28,770 INFO [src.stage_a.wrds_extractor]   Chunk 8: 6,282,322 NBBO records
2025-12-24 00:29:28,770 INFO [src.stage_a.parquet_writer]   Chunk 8: 6,282,322 rows
2025-12-24 00:30:45,071 INFO [src.stage_a.wrds_extractor]   Chunk 9: 5,625,907 NBBO records
2025-12-24 00:30:45,071 INFO [src.stage_a.parquet_writer]   Chunk 9: 5,625,907 rows
2025-12-24 00:32:18,222 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,880,418 NBBO records
2025-12-24 00:32:18,223 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,880,418 rows
2025-12-24 00:32:18,601 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 47,996,764 total rows written
2025-12-24 00:35:52,492 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,291,269 NBBO records
2025-12-24 00:35:52,493 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,291,269 rows
2025-12-24 00:35:53,087 INFO [src.stage_a.parquet_writer] ✓ Wrote 54,288,033 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-02-29
2025-12-24 00:35:53,095 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 00:35:53,095 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 00:35:53,095 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 00:35:53,095 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 00:35:53,095 INFO [src.stage_a.stage_a] Trades: 28,185,292 rows
2025-12-24 00:35:53,095 INFO [src.stage_a.stage_a] Nbbo: 54,288,033 rows
2025-12-24 00:35:53,095 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 00:35:53,095 INFO [src.stage_a.stage_a] Processing date 42/83: 2024-03-01
2025-12-24 00:35:53,095 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 00:35:53,095 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 00:35:53,095 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-03-01 (519 symbols)
2025-12-24 00:35:53,095 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 00:35:53,095 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 00:35:53,095 INFO [src.stage_a.stage_a] Extract run ID: 9e270662-4491-48b1-bade-9e43629ee646
2025-12-24 00:35:53,103 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 00:35:53,103 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 00:35:53,103 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 00:35:53,103 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 00:35:53,103 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 00:35:53,103 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 00:35:53,103 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 00:35:53,103 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 00:35:53,103 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 00:35:54,495 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 00:35:54,495 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-01...
2025-12-24 00:35:54,574 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240301 for 519 symbols
2025-12-24 00:37:39,276 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,168,739 trades
2025-12-24 00:37:39,276 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,168,739 rows
2025-12-24 00:38:11,593 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,033,774 trades
2025-12-24 00:38:11,593 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,033,774 rows
2025-12-24 00:38:50,955 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,294,897 trades
2025-12-24 00:38:50,955 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,294,897 rows
2025-12-24 00:40:27,095 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,718,558 trades
2025-12-24 00:40:27,095 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,718,558 rows
2025-12-24 00:42:37,274 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,647,157 trades
2025-12-24 00:42:37,274 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,647,157 rows
2025-12-24 00:44:20,742 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,397,766 trades
2025-12-24 00:44:20,742 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,397,766 rows
2025-12-24 00:47:38,841 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,906,104 trades
2025-12-24 00:47:38,841 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,906,104 rows
2025-12-24 00:50:07,117 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,878,698 trades
2025-12-24 00:50:07,120 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,878,698 rows
2025-12-24 00:51:58,538 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,296,948 trades
2025-12-24 00:51:58,538 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,296,948 rows
2025-12-24 00:54:17,366 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,284,219 trades
2025-12-24 00:54:17,366 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,284,219 rows
2025-12-24 00:54:17,794 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 27,626,860 total rows written
2025-12-24 00:55:36,117 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,180,434 trades
2025-12-24 00:55:36,117 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,180,434 rows
2025-12-24 00:55:36,465 INFO [src.stage_a.parquet_writer] ✓ Wrote 28,807,294 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-01
2025-12-24 00:55:36,466 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 00:55:36,466 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 00:55:36,466 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 00:55:36,466 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 00:55:36,466 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 00:55:36,466 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 00:55:36,466 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 00:55:38,609 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 00:55:38,609 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-01...
2025-12-24 00:55:38,686 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240301 for 519 symbols
2025-12-24 00:58:44,642 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,898,387 NBBO records
2025-12-24 00:58:44,642 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,898,387 rows
2025-12-24 01:00:48,525 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,623,018 NBBO records
2025-12-24 01:00:48,526 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,623,018 rows
2025-12-24 01:03:18,350 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,653,732 NBBO records
2025-12-24 01:03:18,350 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,653,732 rows
2025-12-24 01:05:12,561 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,354,466 NBBO records
2025-12-24 01:05:12,562 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,354,466 rows
2025-12-24 01:07:52,151 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,408,067 NBBO records
2025-12-24 01:07:52,151 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,408,067 rows
2025-12-24 01:10:38,789 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,835,188 NBBO records
2025-12-24 01:10:38,790 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,835,188 rows
2025-12-24 01:13:28,714 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,409,018 NBBO records
2025-12-24 01:13:28,714 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,409,018 rows
2025-12-24 01:16:58,374 INFO [src.stage_a.wrds_extractor]   Chunk 8: 6,518,483 NBBO records
2025-12-24 01:16:58,375 INFO [src.stage_a.parquet_writer]   Chunk 8: 6,518,483 rows
2025-12-24 01:20:07,446 INFO [src.stage_a.wrds_extractor]   Chunk 9: 5,945,865 NBBO records
2025-12-24 01:20:07,447 INFO [src.stage_a.parquet_writer]   Chunk 9: 5,945,865 rows
2025-12-24 01:22:25,544 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,835,660 NBBO records
2025-12-24 01:22:25,545 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,835,660 rows
2025-12-24 01:22:25,905 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 50,481,884 total rows written
2025-12-24 01:26:19,906 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,754,515 NBBO records
2025-12-24 01:26:19,906 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,754,515 rows
2025-12-24 01:26:20,536 INFO [src.stage_a.parquet_writer] ✓ Wrote 57,236,399 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-01
2025-12-24 01:26:20,543 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 01:26:20,543 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 01:26:20,543 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 01:26:20,543 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 01:26:20,543 INFO [src.stage_a.stage_a] Trades: 28,807,294 rows
2025-12-24 01:26:20,543 INFO [src.stage_a.stage_a] Nbbo: 57,236,399 rows
2025-12-24 01:26:20,543 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 01:26:20,543 INFO [src.stage_a.stage_a] Processing date 43/83: 2024-03-04
2025-12-24 01:26:20,543 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 01:26:20,543 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 01:26:20,543 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-03-04 (519 symbols)
2025-12-24 01:26:20,543 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 01:26:20,543 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 01:26:20,543 INFO [src.stage_a.stage_a] Extract run ID: 8d0cb98e-5e2a-4e46-ab63-5b26b6cd8a50
2025-12-24 01:26:20,551 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 01:26:20,551 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 01:26:20,551 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 01:26:20,551 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 01:26:20,551 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 01:26:20,551 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 01:26:20,551 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 01:26:20,551 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 01:26:20,551 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 01:26:22,664 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 01:26:22,665 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-04...
2025-12-24 01:26:22,752 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240304 for 519 symbols
2025-12-24 01:29:28,974 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,368,724 trades
2025-12-24 01:29:28,974 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,368,724 rows
2025-12-24 01:31:29,460 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,374,765 trades
2025-12-24 01:31:29,461 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,374,765 rows
2025-12-24 01:33:28,654 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,405,968 trades
2025-12-24 01:33:28,654 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,405,968 rows
2025-12-24 01:34:52,386 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,930,780 trades
2025-12-24 01:34:52,386 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,930,780 rows
2025-12-24 01:37:42,781 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,413,004 trades
2025-12-24 01:37:42,781 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,413,004 rows
2025-12-24 01:39:28,653 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,402,852 trades
2025-12-24 01:39:28,653 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,402,852 rows
2025-12-24 01:42:53,886 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,535,503 trades
2025-12-24 01:42:53,886 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,535,503 rows
2025-12-24 01:45:23,728 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,962,604 trades
2025-12-24 01:45:23,729 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,962,604 rows
2025-12-24 01:47:33,172 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,323,126 trades
2025-12-24 01:47:33,172 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,323,126 rows
2025-12-24 01:50:53,725 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,969,244 trades
2025-12-24 01:50:53,726 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,969,244 rows
2025-12-24 01:50:54,199 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 30,686,570 total rows written
2025-12-24 01:52:03,467 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,339,110 trades
2025-12-24 01:52:03,468 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,339,110 rows
2025-12-24 01:52:03,833 INFO [src.stage_a.parquet_writer] ✓ Wrote 32,025,680 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-04
2025-12-24 01:52:03,837 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 01:52:03,837 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 01:52:03,837 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 01:52:03,837 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 01:52:03,837 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 01:52:03,837 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 01:52:03,837 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 01:52:05,982 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 01:52:05,982 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-04...
2025-12-24 01:52:06,069 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240304 for 519 symbols
2025-12-24 01:54:39,007 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,537,179 NBBO records
2025-12-24 01:54:39,007 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,537,179 rows
2025-12-24 01:56:28,981 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,533,917 NBBO records
2025-12-24 01:56:28,981 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,533,917 rows
2025-12-24 01:58:36,788 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,391,797 NBBO records
2025-12-24 01:58:36,788 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,391,797 rows
2025-12-24 02:00:19,052 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,177,379 NBBO records
2025-12-24 02:00:19,052 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,177,379 rows
2025-12-24 02:03:09,891 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,558,729 NBBO records
2025-12-24 02:03:09,891 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,558,729 rows
2025-12-24 02:05:30,737 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,408,803 NBBO records
2025-12-24 02:05:30,737 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,408,803 rows
2025-12-24 02:08:26,458 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,087,215 NBBO records
2025-12-24 02:08:26,458 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,087,215 rows
2025-12-24 02:12:04,413 INFO [src.stage_a.wrds_extractor]   Chunk 8: 6,169,558 NBBO records
2025-12-24 02:12:04,414 INFO [src.stage_a.parquet_writer]   Chunk 8: 6,169,558 rows
2025-12-24 02:14:55,160 INFO [src.stage_a.wrds_extractor]   Chunk 9: 5,295,923 NBBO records
2025-12-24 02:14:55,161 INFO [src.stage_a.parquet_writer]   Chunk 9: 5,295,923 rows
2025-12-24 02:17:58,551 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,768,245 NBBO records
2025-12-24 02:17:58,551 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,768,245 rows
2025-12-24 02:17:58,918 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 47,928,745 total rows written
2025-12-24 02:21:56,289 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,022,816 NBBO records
2025-12-24 02:21:56,290 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,022,816 rows
2025-12-24 02:21:56,829 INFO [src.stage_a.parquet_writer] ✓ Wrote 53,951,561 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-04
2025-12-24 02:21:56,834 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 02:21:56,834 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 02:21:56,834 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 02:21:56,834 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 02:21:56,834 INFO [src.stage_a.stage_a] Trades: 32,025,680 rows
2025-12-24 02:21:56,834 INFO [src.stage_a.stage_a] Nbbo: 53,951,561 rows
2025-12-24 02:21:56,834 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 02:21:56,834 INFO [src.stage_a.stage_a] Processing date 44/83: 2024-03-05
2025-12-24 02:21:56,834 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 02:21:56,834 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 02:21:56,834 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-03-05 (519 symbols)
2025-12-24 02:21:56,834 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 02:21:56,834 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 02:21:56,834 INFO [src.stage_a.stage_a] Extract run ID: 0c157e93-9a5f-48f9-bf60-d55927596a68
2025-12-24 02:21:56,842 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 02:21:56,842 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 02:21:56,842 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 02:21:56,842 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 02:21:56,842 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 02:21:56,842 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 02:21:56,842 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 02:21:56,842 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 02:21:56,842 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 02:21:58,984 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 02:21:58,985 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-05...
2025-12-24 02:21:59,067 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240305 for 519 symbols
2025-12-24 02:25:43,984 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,251,360 trades
2025-12-24 02:25:43,984 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,251,360 rows
2025-12-24 02:27:54,301 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,234,134 trades
2025-12-24 02:27:54,302 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,234,134 rows
2025-12-24 02:29:54,548 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,395,553 trades
2025-12-24 02:29:54,548 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,395,553 rows
2025-12-24 02:31:28,369 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,889,075 trades
2025-12-24 02:31:28,369 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,889,075 rows
2025-12-24 02:33:51,302 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,939,363 trades
2025-12-24 02:33:51,303 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,939,363 rows
2025-12-24 02:35:38,359 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,330,505 trades
2025-12-24 02:35:38,359 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,330,505 rows
2025-12-24 02:39:34,351 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,186,479 trades
2025-12-24 02:39:34,351 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,186,479 rows
2025-12-24 02:42:17,262 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,976,662 trades
2025-12-24 02:42:17,263 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,976,662 rows
2025-12-24 02:44:43,970 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,605,141 trades
2025-12-24 02:44:43,970 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,605,141 rows
2025-12-24 02:48:24,975 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,808,204 trades
2025-12-24 02:48:24,975 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,808,204 rows
2025-12-24 02:48:25,430 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 29,616,476 total rows written
2025-12-24 02:49:32,513 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,359,410 trades
2025-12-24 02:49:32,514 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,359,410 rows
2025-12-24 02:49:32,881 INFO [src.stage_a.parquet_writer] ✓ Wrote 30,975,886 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-05
2025-12-24 02:49:32,884 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 02:49:32,884 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 02:49:32,884 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 02:49:32,884 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 02:49:32,884 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 02:49:32,884 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 02:49:32,885 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 02:49:34,611 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 02:49:34,611 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-05...
2025-12-24 02:49:34,746 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240305 for 519 symbols
2025-12-24 02:52:40,006 INFO [src.stage_a.wrds_extractor]   Chunk 1: 6,032,041 NBBO records
2025-12-24 02:52:40,006 INFO [src.stage_a.parquet_writer]   Chunk 1: 6,032,041 rows
2025-12-24 02:54:53,167 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,850,449 NBBO records
2025-12-24 02:54:53,167 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,850,449 rows
2025-12-24 02:57:30,449 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,912,107 NBBO records
2025-12-24 02:57:30,450 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,912,107 rows
2025-12-24 02:59:40,629 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,632,129 NBBO records
2025-12-24 02:59:40,629 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,632,129 rows
2025-12-24 03:03:10,126 INFO [src.stage_a.wrds_extractor]   Chunk 5: 6,158,462 NBBO records
2025-12-24 03:03:10,126 INFO [src.stage_a.parquet_writer]   Chunk 5: 6,158,462 rows
2025-12-24 03:06:11,962 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,340,234 NBBO records
2025-12-24 03:06:11,963 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,340,234 rows
2025-12-24 03:09:41,769 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,756,282 NBBO records
2025-12-24 03:09:41,770 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,756,282 rows
2025-12-24 03:14:11,183 INFO [src.stage_a.wrds_extractor]   Chunk 8: 7,108,149 NBBO records
2025-12-24 03:14:11,184 INFO [src.stage_a.parquet_writer]   Chunk 8: 7,108,149 rows
2025-12-24 03:18:58,083 INFO [src.stage_a.wrds_extractor]   Chunk 9: 7,312,813 NBBO records
2025-12-24 03:18:58,084 INFO [src.stage_a.parquet_writer]   Chunk 9: 7,312,813 rows
2025-12-24 03:22:45,855 INFO [src.stage_a.wrds_extractor]   Chunk 10: 5,324,489 NBBO records
2025-12-24 03:22:45,857 INFO [src.stage_a.parquet_writer]   Chunk 10: 5,324,489 rows
2025-12-24 03:22:46,260 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 55,427,155 total rows written
2025-12-24 03:28:26,105 INFO [src.stage_a.wrds_extractor]   Chunk 11: 8,141,097 NBBO records
2025-12-24 03:28:26,105 INFO [src.stage_a.parquet_writer]   Chunk 11: 8,141,097 rows
2025-12-24 03:28:26,828 INFO [src.stage_a.parquet_writer] ✓ Wrote 63,568,252 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-05
2025-12-24 03:28:26,841 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 03:28:26,841 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 03:28:26,841 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 03:28:26,841 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 03:28:26,841 INFO [src.stage_a.stage_a] Trades: 30,975,886 rows
2025-12-24 03:28:26,841 INFO [src.stage_a.stage_a] Nbbo: 63,568,252 rows
2025-12-24 03:28:26,841 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 03:28:26,841 INFO [src.stage_a.stage_a] Processing date 45/83: 2024-03-06
2025-12-24 03:28:26,841 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 03:28:26,841 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 03:28:26,841 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-03-06 (519 symbols)
2025-12-24 03:28:26,841 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 03:28:26,841 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 03:28:26,841 INFO [src.stage_a.stage_a] Extract run ID: ebd7edd0-4fdd-4c98-87cb-87db1258daf1
2025-12-24 03:28:26,849 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 03:28:26,849 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 03:28:26,849 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 03:28:26,849 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 03:28:26,849 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 03:28:26,849 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 03:28:26,849 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 03:28:26,849 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 03:28:26,849 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 03:28:29,510 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 03:28:29,510 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-06...
2025-12-24 03:28:29,616 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240306 for 519 symbols
2025-12-24 03:32:33,248 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,832,561 trades
2025-12-24 03:32:33,248 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,832,561 rows
2025-12-24 03:35:08,810 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,224,571 trades
2025-12-24 03:35:08,810 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,224,571 rows
2025-12-24 03:37:56,887 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,381,206 trades
2025-12-24 03:37:56,887 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,381,206 rows
2025-12-24 03:39:24,391 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,648,518 trades
2025-12-24 03:39:24,391 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,648,518 rows
2025-12-24 03:42:30,926 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,942,584 trades
2025-12-24 03:42:30,926 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,942,584 rows
2025-12-24 03:44:45,133 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,172,762 trades
2025-12-24 03:44:45,133 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,172,762 rows
2025-12-24 03:48:58,999 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,085,817 trades
2025-12-24 03:48:58,999 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,085,817 rows
2025-12-24 03:52:05,149 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,012,008 trades
2025-12-24 03:52:05,150 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,012,008 rows
2025-12-24 03:54:33,415 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,519,662 trades
2025-12-24 03:54:33,416 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,519,662 rows
2025-12-24 03:57:49,876 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,543,523 trades
2025-12-24 03:57:49,876 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,543,523 rows
2025-12-24 03:57:50,324 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 28,363,212 total rows written
2025-12-24 03:59:16,015 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,319,293 trades
2025-12-24 03:59:16,015 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,319,293 rows
2025-12-24 03:59:16,406 INFO [src.stage_a.parquet_writer] ✓ Wrote 29,682,505 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-06
2025-12-24 03:59:16,411 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 03:59:16,411 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 03:59:16,411 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 03:59:16,411 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 03:59:16,411 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 03:59:16,411 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 03:59:16,411 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 03:59:19,010 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 03:59:19,011 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-06...
2025-12-24 03:59:19,152 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240306 for 519 symbols
2025-12-24 04:03:28,752 INFO [src.stage_a.wrds_extractor]   Chunk 1: 7,126,105 NBBO records
2025-12-24 04:03:28,752 INFO [src.stage_a.parquet_writer]   Chunk 1: 7,126,105 rows
2025-12-24 04:06:24,107 INFO [src.stage_a.wrds_extractor]   Chunk 2: 4,543,679 NBBO records
2025-12-24 04:06:24,107 INFO [src.stage_a.parquet_writer]   Chunk 2: 4,543,679 rows
2025-12-24 04:09:41,360 INFO [src.stage_a.wrds_extractor]   Chunk 3: 6,040,345 NBBO records
2025-12-24 04:09:41,360 INFO [src.stage_a.parquet_writer]   Chunk 3: 6,040,345 rows
2025-12-24 04:12:17,639 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,985,614 NBBO records
2025-12-24 04:12:17,640 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,985,614 rows
2025-12-24 04:16:49,065 INFO [src.stage_a.wrds_extractor]   Chunk 5: 7,560,680 NBBO records
2025-12-24 04:16:49,065 INFO [src.stage_a.parquet_writer]   Chunk 5: 7,560,680 rows
2025-12-24 04:20:22,945 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,970,529 NBBO records
2025-12-24 04:20:22,947 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,970,529 rows
2025-12-24 04:24:31,786 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,728,523 NBBO records
2025-12-24 04:24:31,789 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,728,523 rows
2025-12-24 04:30:09,517 INFO [src.stage_a.wrds_extractor]   Chunk 8: 8,689,453 NBBO records
2025-12-24 04:30:09,521 INFO [src.stage_a.parquet_writer]   Chunk 8: 8,689,453 rows
2025-12-24 04:35:51,361 INFO [src.stage_a.wrds_extractor]   Chunk 9: 8,783,492 NBBO records
2025-12-24 04:35:51,370 INFO [src.stage_a.parquet_writer]   Chunk 9: 8,783,492 rows
2025-12-24 04:40:15,649 INFO [src.stage_a.wrds_extractor]   Chunk 10: 6,717,052 NBBO records
2025-12-24 04:40:15,653 INFO [src.stage_a.parquet_writer]   Chunk 10: 6,717,052 rows
2025-12-24 04:40:16,080 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 66,145,472 total rows written
2025-12-24 04:47:02,318 INFO [src.stage_a.wrds_extractor]   Chunk 11: 10,066,795 NBBO records
2025-12-24 04:47:02,319 INFO [src.stage_a.parquet_writer]   Chunk 11: 10,066,795 rows
2025-12-24 04:47:03,207 INFO [src.stage_a.parquet_writer] ✓ Wrote 76,212,267 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-06
2025-12-24 04:47:03,227 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 04:47:03,227 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 04:47:03,227 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 04:47:03,227 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 04:47:03,227 INFO [src.stage_a.stage_a] Trades: 29,682,505 rows
2025-12-24 04:47:03,227 INFO [src.stage_a.stage_a] Nbbo: 76,212,267 rows
2025-12-24 04:47:03,227 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 04:47:03,227 INFO [src.stage_a.stage_a] Processing date 46/83: 2024-03-07
2025-12-24 04:47:03,227 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 04:47:03,227 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 04:47:03,227 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-03-07 (519 symbols)
2025-12-24 04:47:03,227 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 04:47:03,227 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 04:47:03,227 INFO [src.stage_a.stage_a] Extract run ID: 1353d9e7-6850-43ea-92a6-22dccfc50bc3
2025-12-24 04:47:03,235 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 04:47:03,235 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 04:47:03,235 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 04:47:03,235 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 04:47:03,235 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 04:47:03,235 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 04:47:03,235 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 04:47:03,235 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 04:47:03,235 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 04:47:09,997 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 04:47:09,998 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-07...
2025-12-24 04:47:10,351 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240307 for 519 symbols
2025-12-24 04:51:00,573 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,558,276 trades
2025-12-24 04:51:00,573 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,558,276 rows
2025-12-24 04:53:10,641 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,949,383 trades
2025-12-24 04:53:10,641 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,949,383 rows
2025-12-24 04:55:14,442 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,188,819 trades
2025-12-24 04:55:14,443 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,188,819 rows
2025-12-24 04:56:40,819 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,636,162 trades
2025-12-24 04:56:40,819 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,636,162 rows
2025-12-24 04:59:09,415 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,621,400 trades
2025-12-24 04:59:09,415 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,621,400 rows
2025-12-24 05:01:29,373 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,149,323 trades
2025-12-24 05:01:29,373 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,149,323 rows
2025-12-24 05:05:11,698 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,903,497 trades
2025-12-24 05:05:11,698 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,903,497 rows
2025-12-24 05:07:16,887 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,711,809 trades
2025-12-24 05:07:16,887 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,711,809 rows
2025-12-24 05:09:13,762 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,170,065 trades
2025-12-24 05:09:13,762 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,170,065 rows
2025-12-24 05:11:59,039 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,055,550 trades
2025-12-24 05:11:59,040 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,055,550 rows
2025-12-24 05:11:59,446 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,944,284 total rows written
2025-12-24 05:12:53,869 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,023,017 trades
2025-12-24 05:12:53,869 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,023,017 rows
2025-12-24 05:12:54,203 INFO [src.stage_a.parquet_writer] ✓ Wrote 26,967,301 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-07
2025-12-24 05:12:54,204 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 05:12:54,204 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 05:12:54,204 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 05:12:54,204 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 05:12:54,204 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 05:12:54,204 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 05:12:54,204 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 05:12:56,395 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 05:12:56,395 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-07...
2025-12-24 05:12:56,586 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240307 for 519 symbols
2025-12-24 05:16:30,054 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,406,942 NBBO records
2025-12-24 05:16:30,054 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,406,942 rows
2025-12-24 05:18:33,019 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,372,342 NBBO records
2025-12-24 05:18:33,020 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,372,342 rows
2025-12-24 05:21:15,846 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,429,213 NBBO records
2025-12-24 05:21:15,846 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,429,213 rows
2025-12-24 05:23:23,766 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,288,979 NBBO records
2025-12-24 05:23:23,766 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,288,979 rows
2025-12-24 05:26:50,977 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,796,827 NBBO records
2025-12-24 05:26:50,978 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,796,827 rows
2025-12-24 05:30:08,146 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,742,701 NBBO records
2025-12-24 05:30:08,146 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,742,701 rows
2025-12-24 05:33:20,158 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,379,688 NBBO records
2025-12-24 05:33:20,158 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,379,688 rows
2025-12-24 05:37:30,453 INFO [src.stage_a.wrds_extractor]   Chunk 8: 6,978,564 NBBO records
2025-12-24 05:37:30,453 INFO [src.stage_a.parquet_writer]   Chunk 8: 6,978,564 rows
2025-12-24 05:41:47,042 INFO [src.stage_a.wrds_extractor]   Chunk 9: 6,265,556 NBBO records
2025-12-24 05:41:47,043 INFO [src.stage_a.parquet_writer]   Chunk 9: 6,265,556 rows
2025-12-24 05:44:50,832 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,738,671 NBBO records
2025-12-24 05:44:50,838 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,738,671 rows
2025-12-24 05:44:51,202 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 50,399,483 total rows written
2025-12-24 05:48:36,683 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,634,471 NBBO records
2025-12-24 05:48:36,683 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,634,471 rows
2025-12-24 05:48:37,363 INFO [src.stage_a.parquet_writer] ✓ Wrote 58,033,954 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-07
2025-12-24 05:48:37,386 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 05:48:37,386 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 05:48:37,386 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 05:48:37,386 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 05:48:37,387 INFO [src.stage_a.stage_a] Trades: 26,967,301 rows
2025-12-24 05:48:37,387 INFO [src.stage_a.stage_a] Nbbo: 58,033,954 rows
2025-12-24 05:48:37,387 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 05:48:37,387 INFO [src.stage_a.stage_a] Processing date 47/83: 2024-03-08
2025-12-24 05:48:37,387 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 05:48:37,387 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 05:48:37,387 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-03-08 (519 symbols)
2025-12-24 05:48:37,387 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 05:48:37,387 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 05:48:37,387 INFO [src.stage_a.stage_a] Extract run ID: a1902a2b-bef5-41c7-85bf-683f927d97b7
2025-12-24 05:48:37,395 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 05:48:37,395 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 05:48:37,395 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 05:48:37,395 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 05:48:37,395 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 05:48:37,395 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 05:48:37,395 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 05:48:37,395 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 05:48:37,395 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 05:48:38,646 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 05:48:38,646 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-08...
2025-12-24 05:48:38,719 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240308 for 519 symbols
2025-12-24 05:53:08,074 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,286,821 trades
2025-12-24 05:53:08,074 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,286,821 rows
2025-12-24 05:55:15,751 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,057,261 trades
2025-12-24 05:55:15,751 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,057,261 rows
2025-12-24 05:57:30,297 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,239,144 trades
2025-12-24 05:57:30,297 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,239,144 rows
2025-12-24 05:59:32,007 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,740,269 trades
2025-12-24 05:59:32,007 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,740,269 rows
2025-12-24 06:02:28,363 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,732,163 trades
2025-12-24 06:02:28,363 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,732,163 rows
2025-12-24 06:04:36,029 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,260,451 trades
2025-12-24 06:04:36,030 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,260,451 rows
2025-12-24 06:10:18,657 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,174,455 trades
2025-12-24 06:10:18,657 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,174,455 rows
2025-12-24 06:13:01,014 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,929,220 trades
2025-12-24 06:13:01,016 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,929,220 rows
2025-12-24 06:16:01,226 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,416,984 trades
2025-12-24 06:16:01,226 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,416,984 rows
2025-12-24 06:19:08,175 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,087,491 trades
2025-12-24 06:19:08,175 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,087,491 rows
2025-12-24 06:19:08,570 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 28,924,259 total rows written
2025-12-24 06:20:24,840 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,303,615 trades
2025-12-24 06:20:24,840 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,303,615 rows
2025-12-24 06:20:25,229 INFO [src.stage_a.parquet_writer] ✓ Wrote 30,227,874 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-08
2025-12-24 06:20:25,233 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 06:20:25,234 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 06:20:25,234 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 06:20:25,234 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 06:20:25,234 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 06:20:25,234 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 06:20:25,234 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 06:20:27,025 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 06:20:27,025 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-08...
2025-12-24 06:20:27,121 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240308 for 519 symbols
2025-12-24 06:24:30,901 INFO [src.stage_a.wrds_extractor]   Chunk 1: 8,217,148 NBBO records
2025-12-24 06:24:30,901 INFO [src.stage_a.parquet_writer]   Chunk 1: 8,217,148 rows
2025-12-24 06:26:54,470 INFO [src.stage_a.wrds_extractor]   Chunk 2: 4,636,361 NBBO records
2025-12-24 06:26:54,475 INFO [src.stage_a.parquet_writer]   Chunk 2: 4,636,361 rows
2025-12-24 06:30:14,801 INFO [src.stage_a.wrds_extractor]   Chunk 3: 6,001,691 NBBO records
2025-12-24 06:30:14,801 INFO [src.stage_a.parquet_writer]   Chunk 3: 6,001,691 rows
2025-12-24 06:32:15,935 INFO [src.stage_a.wrds_extractor]   Chunk 4: 4,353,744 NBBO records
2025-12-24 06:32:15,936 INFO [src.stage_a.parquet_writer]   Chunk 4: 4,353,744 rows
2025-12-24 06:36:36,084 INFO [src.stage_a.wrds_extractor]   Chunk 5: 7,858,044 NBBO records
2025-12-24 06:36:36,084 INFO [src.stage_a.parquet_writer]   Chunk 5: 7,858,044 rows
2025-12-24 06:39:51,580 INFO [src.stage_a.wrds_extractor]   Chunk 6: 6,362,306 NBBO records
2025-12-24 06:39:51,587 INFO [src.stage_a.parquet_writer]   Chunk 6: 6,362,306 rows
2025-12-24 06:44:13,353 INFO [src.stage_a.wrds_extractor]   Chunk 7: 7,552,426 NBBO records
2025-12-24 06:44:13,358 INFO [src.stage_a.parquet_writer]   Chunk 7: 7,552,426 rows
2025-12-24 06:49:38,199 INFO [src.stage_a.wrds_extractor]   Chunk 8: 9,788,450 NBBO records
2025-12-24 06:49:38,200 INFO [src.stage_a.parquet_writer]   Chunk 8: 9,788,450 rows
2025-12-24 06:54:53,821 INFO [src.stage_a.wrds_extractor]   Chunk 9: 9,346,335 NBBO records
2025-12-24 06:54:53,830 INFO [src.stage_a.parquet_writer]   Chunk 9: 9,346,335 rows
2025-12-24 06:58:30,534 INFO [src.stage_a.wrds_extractor]   Chunk 10: 6,351,213 NBBO records
2025-12-24 06:58:30,547 INFO [src.stage_a.parquet_writer]   Chunk 10: 6,351,213 rows
2025-12-24 06:58:30,971 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 70,467,718 total rows written
2025-12-24 07:04:08,163 INFO [src.stage_a.wrds_extractor]   Chunk 11: 10,501,111 NBBO records
2025-12-24 07:04:08,164 INFO [src.stage_a.parquet_writer]   Chunk 11: 10,501,111 rows
2025-12-24 07:04:09,077 INFO [src.stage_a.parquet_writer] ✓ Wrote 80,968,829 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-08
2025-12-24 07:04:09,092 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 07:04:09,092 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 07:04:09,092 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 07:04:09,092 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 07:04:09,092 INFO [src.stage_a.stage_a] Trades: 30,227,874 rows
2025-12-24 07:04:09,092 INFO [src.stage_a.stage_a] Nbbo: 80,968,829 rows
2025-12-24 07:04:09,092 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 07:04:09,092 INFO [src.stage_a.stage_a] Processing date 48/83: 2024-03-11
2025-12-24 07:04:09,092 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 07:04:09,092 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 07:04:09,092 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-03-11 (519 symbols)
2025-12-24 07:04:09,092 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 07:04:09,092 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 07:04:09,092 INFO [src.stage_a.stage_a] Extract run ID: 66e5807b-3dfb-4745-91ef-15e65f7aa280
2025-12-24 07:04:09,100 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 07:04:09,100 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 07:04:09,100 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 07:04:09,100 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 07:04:09,100 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 07:04:09,100 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 07:04:09,100 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 07:04:09,100 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 07:04:09,100 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 07:04:11,012 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 07:04:11,012 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-11...
2025-12-24 07:04:11,093 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240311 for 519 symbols
2025-12-24 07:08:03,512 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,659,237 trades
2025-12-24 07:08:03,512 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,659,237 rows
2025-12-24 07:09:56,434 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,960,046 trades
2025-12-24 07:09:56,434 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,960,046 rows
2025-12-24 07:11:59,140 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,093,122 trades
2025-12-24 07:11:59,140 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,093,122 rows
2025-12-24 07:13:42,915 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,787,107 trades
2025-12-24 07:13:42,915 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,787,107 rows
2025-12-24 07:16:37,600 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,605,738 trades
2025-12-24 07:16:37,600 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,605,738 rows
2025-12-24 07:19:01,859 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,185,949 trades
2025-12-24 07:19:01,859 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,185,949 rows
2025-12-24 07:23:10,738 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,130,145 trades
2025-12-24 07:23:10,738 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,130,145 rows
2025-12-24 07:25:53,213 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,655,125 trades
2025-12-24 07:25:53,213 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,655,125 rows
2025-12-24 07:27:40,941 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,229,483 trades
2025-12-24 07:27:40,941 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,229,483 rows
2025-12-24 07:30:36,754 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,145,490 trades
2025-12-24 07:30:36,754 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,145,490 rows
2025-12-24 07:30:37,166 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,451,442 total rows written
2025-12-24 07:31:48,252 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,174,841 trades
2025-12-24 07:31:48,252 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,174,841 rows
2025-12-24 07:31:48,603 INFO [src.stage_a.parquet_writer] ✓ Wrote 27,626,283 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-11
2025-12-24 07:31:48,605 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 07:31:48,605 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 07:31:48,605 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 07:31:48,605 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 07:31:48,605 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 07:31:48,605 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 07:31:48,605 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 07:31:50,649 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 07:31:50,649 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-11...
2025-12-24 07:31:50,795 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240311 for 519 symbols
2025-12-24 07:35:38,769 INFO [src.stage_a.wrds_extractor]   Chunk 1: 6,179,227 NBBO records
2025-12-24 07:35:38,769 INFO [src.stage_a.parquet_writer]   Chunk 1: 6,179,227 rows
2025-12-24 07:37:48,066 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,607,760 NBBO records
2025-12-24 07:37:48,067 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,607,760 rows
2025-12-24 07:40:23,111 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,679,823 NBBO records
2025-12-24 07:40:23,112 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,679,823 rows
2025-12-24 07:42:29,360 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,446,804 NBBO records
2025-12-24 07:42:29,360 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,446,804 rows
2025-12-24 07:46:14,490 INFO [src.stage_a.wrds_extractor]   Chunk 5: 6,309,272 NBBO records
2025-12-24 07:46:14,490 INFO [src.stage_a.parquet_writer]   Chunk 5: 6,309,272 rows
2025-12-24 07:49:27,226 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,722,327 NBBO records
2025-12-24 07:49:27,227 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,722,327 rows
2025-12-24 07:53:32,285 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,837,268 NBBO records
2025-12-24 07:53:32,285 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,837,268 rows
2025-12-24 07:58:53,600 INFO [src.stage_a.wrds_extractor]   Chunk 8: 8,009,441 NBBO records
2025-12-24 07:58:53,601 INFO [src.stage_a.parquet_writer]   Chunk 8: 8,009,441 rows
2025-12-24 08:03:32,138 INFO [src.stage_a.wrds_extractor]   Chunk 9: 7,141,656 NBBO records
2025-12-24 08:03:32,139 INFO [src.stage_a.parquet_writer]   Chunk 9: 7,141,656 rows
2025-12-24 08:07:02,996 INFO [src.stage_a.wrds_extractor]   Chunk 10: 5,475,223 NBBO records
2025-12-24 08:07:02,997 INFO [src.stage_a.parquet_writer]   Chunk 10: 5,475,223 rows
2025-12-24 08:07:03,394 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 55,408,801 total rows written
2025-12-24 08:13:30,554 INFO [src.stage_a.wrds_extractor]   Chunk 11: 9,212,568 NBBO records
2025-12-24 08:13:30,554 INFO [src.stage_a.parquet_writer]   Chunk 11: 9,212,568 rows
2025-12-24 08:13:31,355 INFO [src.stage_a.parquet_writer] ✓ Wrote 64,621,369 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-11
2025-12-24 08:13:31,375 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 08:13:31,375 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 08:13:31,375 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 08:13:31,375 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 08:13:31,375 INFO [src.stage_a.stage_a] Trades: 27,626,283 rows
2025-12-24 08:13:31,375 INFO [src.stage_a.stage_a] Nbbo: 64,621,369 rows
2025-12-24 08:13:31,375 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 08:13:31,375 INFO [src.stage_a.stage_a] Processing date 49/83: 2024-03-12
2025-12-24 08:13:31,376 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 08:13:31,376 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 08:13:31,376 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-03-12 (519 symbols)
2025-12-24 08:13:31,376 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 08:13:31,376 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 08:13:31,376 INFO [src.stage_a.stage_a] Extract run ID: 81b60992-2ded-4c20-b8e0-bb52a5076cfe
2025-12-24 08:13:31,384 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 08:13:31,384 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 08:13:31,384 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 08:13:31,384 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 08:13:31,384 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 08:13:31,384 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 08:13:31,384 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 08:13:31,384 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 08:13:31,384 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 08:13:32,833 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 08:13:32,833 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-12...
2025-12-24 08:13:32,939 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240312 for 519 symbols
2025-12-24 08:16:23,731 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,591,386 trades
2025-12-24 08:16:23,731 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,591,386 rows
2025-12-24 08:17:44,490 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,930,461 trades
2025-12-24 08:17:44,490 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,930,461 rows
2025-12-24 08:19:30,495 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,119,376 trades
2025-12-24 08:19:30,496 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,119,376 rows
2025-12-24 08:20:56,468 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,666,809 trades
2025-12-24 08:20:56,468 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,666,809 rows
2025-12-24 08:22:51,756 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,409,400 trades
2025-12-24 08:22:51,756 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,409,400 rows
2025-12-24 08:24:38,391 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,290,385 trades
2025-12-24 08:24:38,391 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,290,385 rows
2025-12-24 08:27:32,681 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,924,015 trades
2025-12-24 08:27:32,681 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,924,015 rows
2025-12-24 08:29:42,364 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,846,318 trades
2025-12-24 08:29:42,365 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,846,318 rows
2025-12-24 08:31:40,771 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,142,604 trades
2025-12-24 08:31:40,771 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,142,604 rows
2025-12-24 08:33:59,273 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,078,646 trades
2025-12-24 08:33:59,273 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,078,646 rows
2025-12-24 08:33:59,690 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,999,400 total rows written
2025-12-24 08:34:45,007 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,109,825 trades
2025-12-24 08:34:45,007 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,109,825 rows
2025-12-24 08:34:45,343 INFO [src.stage_a.parquet_writer] ✓ Wrote 27,109,225 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-12
2025-12-24 08:34:45,344 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 08:34:45,344 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 08:34:45,344 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 08:34:45,344 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 08:34:45,344 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 08:34:45,344 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 08:34:45,344 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 08:34:46,706 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 08:34:46,706 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-12...
2025-12-24 08:34:46,776 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240312 for 519 symbols
2025-12-24 08:37:46,220 INFO [src.stage_a.wrds_extractor]   Chunk 1: 6,185,603 NBBO records
2025-12-24 08:37:46,220 INFO [src.stage_a.parquet_writer]   Chunk 1: 6,185,603 rows
2025-12-24 08:39:40,072 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,339,286 NBBO records
2025-12-24 08:39:40,073 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,339,286 rows
2025-12-24 08:42:03,118 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,809,706 NBBO records
2025-12-24 08:42:03,119 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,809,706 rows
2025-12-24 08:43:36,656 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,317,352 NBBO records
2025-12-24 08:43:36,656 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,317,352 rows
2025-12-24 08:46:25,572 INFO [src.stage_a.wrds_extractor]   Chunk 5: 6,157,535 NBBO records
2025-12-24 08:46:25,572 INFO [src.stage_a.parquet_writer]   Chunk 5: 6,157,535 rows
2025-12-24 08:48:58,441 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,127,633 NBBO records
2025-12-24 08:48:58,441 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,127,633 rows
2025-12-24 08:51:40,100 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,908,940 NBBO records
2025-12-24 08:51:40,100 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,908,940 rows
2025-12-24 08:55:40,271 INFO [src.stage_a.wrds_extractor]   Chunk 8: 8,140,026 NBBO records
2025-12-24 08:55:40,272 INFO [src.stage_a.parquet_writer]   Chunk 8: 8,140,026 rows
2025-12-24 08:58:46,605 INFO [src.stage_a.wrds_extractor]   Chunk 9: 6,637,089 NBBO records
2025-12-24 08:58:46,613 INFO [src.stage_a.parquet_writer]   Chunk 9: 6,637,089 rows
2025-12-24 09:01:29,744 INFO [src.stage_a.wrds_extractor]   Chunk 10: 5,572,479 NBBO records
2025-12-24 09:01:29,745 INFO [src.stage_a.parquet_writer]   Chunk 10: 5,572,479 rows
2025-12-24 09:01:30,159 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 55,195,649 total rows written
2025-12-24 09:05:08,411 INFO [src.stage_a.wrds_extractor]   Chunk 11: 8,482,769 NBBO records
2025-12-24 09:05:08,412 INFO [src.stage_a.parquet_writer]   Chunk 11: 8,482,769 rows
2025-12-24 09:05:09,181 INFO [src.stage_a.parquet_writer] ✓ Wrote 63,678,418 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-12
2025-12-24 09:05:09,200 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 09:05:09,200 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 09:05:09,200 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 09:05:09,200 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 09:05:09,200 INFO [src.stage_a.stage_a] Trades: 27,109,225 rows
2025-12-24 09:05:09,200 INFO [src.stage_a.stage_a] Nbbo: 63,678,418 rows
2025-12-24 09:05:09,200 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 09:05:09,200 INFO [src.stage_a.stage_a] Processing date 50/83: 2024-03-13
2025-12-24 09:05:09,200 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 09:05:09,200 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 09:05:09,200 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-03-13 (519 symbols)
2025-12-24 09:05:09,200 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 09:05:09,200 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 09:05:09,200 INFO [src.stage_a.stage_a] Extract run ID: 9ec588af-bc8f-4f6c-afbb-352dfd36b0a3
2025-12-24 09:05:09,208 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 09:05:09,208 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 09:05:09,208 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 09:05:09,208 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 09:05:09,208 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 09:05:09,208 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 09:05:09,208 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 09:05:09,208 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 09:05:09,208 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 09:05:14,122 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 09:05:14,122 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-13...
2025-12-24 09:05:14,289 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240313 for 519 symbols
2025-12-24 09:07:27,980 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,398,406 trades
2025-12-24 09:07:27,980 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,398,406 rows
2025-12-24 09:08:56,613 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,011,566 trades
2025-12-24 09:08:56,614 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,011,566 rows
2025-12-24 09:10:35,064 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,326,697 trades
2025-12-24 09:10:35,064 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,326,697 rows
2025-12-24 09:12:43,841 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,901,293 trades
2025-12-24 09:12:43,841 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,901,293 rows
2025-12-24 09:15:16,325 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,544,765 trades
2025-12-24 09:15:16,325 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,544,765 rows
2025-12-24 09:17:22,978 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,343,078 trades
2025-12-24 09:17:22,979 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,343,078 rows
2025-12-24 09:20:46,361 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,894,204 trades
2025-12-24 09:20:46,361 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,894,204 rows
2025-12-24 09:22:58,641 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,600,321 trades
2025-12-24 09:22:58,643 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,600,321 rows
2025-12-24 09:25:18,196 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,111,872 trades
2025-12-24 09:25:18,196 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,111,872 rows
2025-12-24 09:28:33,394 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,295,387 trades
2025-12-24 09:28:33,394 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,295,387 rows
2025-12-24 09:28:33,808 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,427,589 total rows written
2025-12-24 09:29:40,258 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,117,796 trades
2025-12-24 09:29:40,258 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,117,796 rows
2025-12-24 09:29:40,605 INFO [src.stage_a.parquet_writer] ✓ Wrote 27,545,385 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-13
2025-12-24 09:29:40,606 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 09:29:40,606 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 09:29:40,606 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 09:29:40,606 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 09:29:40,606 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 09:29:40,606 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 09:29:40,607 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 09:29:41,846 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 09:29:41,846 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-13...
2025-12-24 09:29:41,929 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240313 for 519 symbols
2025-12-24 09:32:31,355 INFO [src.stage_a.wrds_extractor]   Chunk 1: 6,025,010 NBBO records
2025-12-24 09:32:31,355 INFO [src.stage_a.parquet_writer]   Chunk 1: 6,025,010 rows
2025-12-24 09:34:03,715 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,395,918 NBBO records
2025-12-24 09:34:03,715 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,395,918 rows
2025-12-24 09:37:05,869 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,552,541 NBBO records
2025-12-24 09:37:05,869 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,552,541 rows
2025-12-24 09:38:56,847 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,444,993 NBBO records
2025-12-24 09:38:56,847 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,444,993 rows
2025-12-24 09:42:00,785 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,559,167 NBBO records
2025-12-24 09:42:00,785 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,559,167 rows
2025-12-24 09:44:42,534 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,606,524 NBBO records
2025-12-24 09:44:42,535 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,606,524 rows
2025-12-24 09:48:34,806 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,701,998 NBBO records
2025-12-24 09:48:34,806 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,701,998 rows
2025-12-24 09:52:46,357 INFO [src.stage_a.wrds_extractor]   Chunk 8: 7,445,000 NBBO records
2025-12-24 09:52:46,357 INFO [src.stage_a.parquet_writer]   Chunk 8: 7,445,000 rows
2025-12-24 09:56:33,630 INFO [src.stage_a.wrds_extractor]   Chunk 9: 6,340,103 NBBO records
2025-12-24 09:56:33,634 INFO [src.stage_a.parquet_writer]   Chunk 9: 6,340,103 rows
2025-12-24 09:59:42,433 INFO [src.stage_a.wrds_extractor]   Chunk 10: 5,128,765 NBBO records
2025-12-24 09:59:42,434 INFO [src.stage_a.parquet_writer]   Chunk 10: 5,128,765 rows
2025-12-24 09:59:42,803 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 52,200,019 total rows written
2025-12-24 10:04:23,050 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,960,822 NBBO records
2025-12-24 10:04:23,050 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,960,822 rows
2025-12-24 10:04:23,783 INFO [src.stage_a.parquet_writer] ✓ Wrote 60,160,841 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-13
2025-12-24 10:04:23,801 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 10:04:23,801 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 10:04:23,801 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 10:04:23,801 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 10:04:23,801 INFO [src.stage_a.stage_a] Trades: 27,545,385 rows
2025-12-24 10:04:23,801 INFO [src.stage_a.stage_a] Nbbo: 60,160,841 rows
2025-12-24 10:04:23,801 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 10:04:23,801 INFO [src.stage_a.stage_a] Processing date 51/83: 2024-03-14
2025-12-24 10:04:23,801 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 10:04:23,801 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 10:04:23,801 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-03-14 (519 symbols)
2025-12-24 10:04:23,801 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 10:04:23,801 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 10:04:23,801 INFO [src.stage_a.stage_a] Extract run ID: 715c0aa7-746b-4b57-be18-6457682d3df7
2025-12-24 10:04:23,809 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 10:04:23,809 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 10:04:23,809 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 10:04:23,809 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 10:04:23,809 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 10:04:23,809 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 10:04:23,809 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 10:04:23,809 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 10:04:23,809 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 10:04:25,075 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 10:04:25,075 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-14...
2025-12-24 10:04:25,319 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240314 for 519 symbols
2025-12-24 10:08:31,560 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,816,898 trades
2025-12-24 10:08:31,560 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,816,898 rows
2025-12-24 10:10:53,257 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,139,647 trades
2025-12-24 10:10:53,258 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,139,647 rows
2025-12-24 10:13:35,431 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,399,462 trades
2025-12-24 10:13:35,431 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,399,462 rows
2025-12-24 10:15:31,237 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,941,065 trades
2025-12-24 10:15:31,237 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,941,065 rows
2025-12-24 10:19:07,632 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,943,617 trades
2025-12-24 10:19:07,632 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,943,617 rows
2025-12-24 10:21:42,172 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,612,043 trades
2025-12-24 10:21:42,172 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,612,043 rows
2025-12-24 10:23:54,462 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,373,175 trades
2025-12-24 10:23:54,462 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,373,175 rows
2025-12-24 10:24:52,569 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,859,008 trades
2025-12-24 10:24:52,572 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,859,008 rows
2025-12-24 10:26:26,489 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,552,989 trades
2025-12-24 10:26:26,489 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,552,989 rows
2025-12-24 10:29:37,988 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,781,982 trades
2025-12-24 10:29:37,988 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,781,982 rows
2025-12-24 10:29:38,450 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 29,419,886 total rows written
2025-12-24 10:30:42,161 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,359,560 trades
2025-12-24 10:30:42,162 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,359,560 rows
2025-12-24 10:30:42,595 INFO [src.stage_a.parquet_writer] ✓ Wrote 30,779,446 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-14
2025-12-24 10:30:42,601 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 10:30:42,601 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 10:30:42,601 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 10:30:42,602 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 10:30:42,602 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 10:30:42,602 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 10:30:42,602 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 10:30:43,993 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 10:30:43,993 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-14...
2025-12-24 10:30:44,056 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240314 for 519 symbols
2025-12-24 10:34:41,836 INFO [src.stage_a.wrds_extractor]   Chunk 1: 7,091,250 NBBO records
2025-12-24 10:34:41,836 INFO [src.stage_a.parquet_writer]   Chunk 1: 7,091,250 rows
2025-12-24 10:36:53,020 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,997,259 NBBO records
2025-12-24 10:36:53,021 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,997,259 rows
2025-12-24 10:40:09,986 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,167,305 NBBO records
2025-12-24 10:40:09,986 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,167,305 rows
2025-12-24 10:42:27,133 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,705,389 NBBO records
2025-12-24 10:42:27,133 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,705,389 rows
2025-12-24 10:43:40,522 INFO [src.stage_a.wrds_extractor]   Chunk 5: 6,877,577 NBBO records
2025-12-24 10:43:40,522 INFO [src.stage_a.parquet_writer]   Chunk 5: 6,877,577 rows
2025-12-24 10:44:43,089 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,328,316 NBBO records
2025-12-24 10:44:43,094 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,328,316 rows
2025-12-24 10:49:00,631 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,343,463 NBBO records
2025-12-24 10:49:00,631 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,343,463 rows
2025-12-24 10:51:40,597 INFO [src.stage_a.wrds_extractor]   Chunk 8: 9,611,547 NBBO records
2025-12-24 10:51:40,598 INFO [src.stage_a.parquet_writer]   Chunk 8: 9,611,547 rows
2025-12-24 10:56:14,582 INFO [src.stage_a.wrds_extractor]   Chunk 9: 8,421,686 NBBO records
2025-12-24 10:56:14,590 INFO [src.stage_a.parquet_writer]   Chunk 9: 8,421,686 rows
2025-12-24 10:59:34,830 INFO [src.stage_a.wrds_extractor]   Chunk 10: 6,007,720 NBBO records
2025-12-24 10:59:34,841 INFO [src.stage_a.parquet_writer]   Chunk 10: 6,007,720 rows
2025-12-24 10:59:35,279 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 62,551,512 total rows written
2025-12-24 11:05:43,079 INFO [src.stage_a.wrds_extractor]   Chunk 11: 9,343,691 NBBO records
2025-12-24 11:05:43,080 INFO [src.stage_a.parquet_writer]   Chunk 11: 9,343,691 rows
2025-12-24 11:05:43,908 INFO [src.stage_a.parquet_writer] ✓ Wrote 71,895,203 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-14
2025-12-24 11:05:43,923 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 11:05:43,923 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 11:05:43,923 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 11:05:43,923 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 11:05:43,923 INFO [src.stage_a.stage_a] Trades: 30,779,446 rows
2025-12-24 11:05:43,923 INFO [src.stage_a.stage_a] Nbbo: 71,895,203 rows
2025-12-24 11:05:43,923 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 11:05:43,923 INFO [src.stage_a.stage_a] Processing date 52/83: 2024-03-15
2025-12-24 11:05:43,923 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 11:05:43,924 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 11:05:43,924 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-03-15 (519 symbols)
2025-12-24 11:05:43,924 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 11:05:43,924 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 11:05:43,924 INFO [src.stage_a.stage_a] Extract run ID: 70e005fd-d934-4c9f-a29a-a2c8eca1f7fb
2025-12-24 11:05:43,932 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 11:05:43,932 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 11:05:43,932 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 11:05:43,932 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 11:05:43,932 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 11:05:43,932 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 11:05:43,932 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 11:05:43,932 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 11:05:43,932 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 11:05:45,141 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 11:05:45,142 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-15...
2025-12-24 11:05:45,222 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240315 for 519 symbols
2025-12-24 11:09:26,660 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,200,061 trades
2025-12-24 11:09:26,660 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,200,061 rows
2025-12-24 11:11:38,094 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,150,030 trades
2025-12-24 11:11:38,095 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,150,030 rows
2025-12-24 11:14:07,624 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,309,674 trades
2025-12-24 11:14:07,624 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,309,674 rows
2025-12-24 11:15:46,123 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,948,743 trades
2025-12-24 11:15:46,123 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,948,743 rows
2025-12-24 11:18:19,886 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,715,164 trades
2025-12-24 11:18:19,887 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,715,164 rows
2025-12-24 11:20:37,956 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,627,792 trades
2025-12-24 11:20:37,956 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,627,792 rows
2025-12-24 11:24:31,253 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,239,546 trades
2025-12-24 11:24:31,253 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,239,546 rows
2025-12-24 11:26:45,722 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,788,893 trades
2025-12-24 11:26:45,723 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,788,893 rows
2025-12-24 11:29:12,427 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,485,666 trades
2025-12-24 11:29:12,428 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,485,666 rows
2025-12-24 11:32:24,832 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,326,378 trades
2025-12-24 11:32:24,832 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,326,378 rows
2025-12-24 11:32:25,255 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 28,791,947 total rows written
2025-12-24 11:33:37,823 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,354,939 trades
2025-12-24 11:33:37,823 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,354,939 rows
2025-12-24 11:33:38,210 INFO [src.stage_a.parquet_writer] ✓ Wrote 30,146,886 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-15
2025-12-24 11:33:38,214 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 11:33:38,214 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 11:33:38,214 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 11:33:38,214 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 11:33:38,214 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 11:33:38,214 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 11:33:38,214 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 11:33:40,777 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 11:33:40,777 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-15...
2025-12-24 11:33:40,977 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240315 for 519 symbols
2025-12-24 11:38:44,932 INFO [src.stage_a.wrds_extractor]   Chunk 1: 6,789,814 NBBO records
2025-12-24 11:38:44,932 INFO [src.stage_a.parquet_writer]   Chunk 1: 6,789,814 rows
2025-12-24 11:41:02,444 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,654,913 NBBO records
2025-12-24 11:41:02,445 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,654,913 rows
2025-12-24 11:44:57,025 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,928,855 NBBO records
2025-12-24 11:44:57,025 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,928,855 rows
2025-12-24 11:47:33,463 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,737,590 NBBO records
2025-12-24 11:47:33,463 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,737,590 rows
2025-12-24 11:51:05,912 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,416,450 NBBO records
2025-12-24 11:51:05,912 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,416,450 rows
2025-12-24 11:54:44,640 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,354,264 NBBO records
2025-12-24 11:54:44,641 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,354,264 rows
2025-12-24 11:58:44,818 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,832,697 NBBO records
2025-12-24 11:58:44,819 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,832,697 rows
2025-12-24 12:05:09,234 INFO [src.stage_a.wrds_extractor]   Chunk 8: 8,341,328 NBBO records
2025-12-24 12:05:09,234 INFO [src.stage_a.parquet_writer]   Chunk 8: 8,341,328 rows
2025-12-24 12:10:45,558 INFO [src.stage_a.wrds_extractor]   Chunk 9: 7,497,353 NBBO records
2025-12-24 12:10:45,564 INFO [src.stage_a.parquet_writer]   Chunk 9: 7,497,353 rows
2025-12-24 12:14:40,415 INFO [src.stage_a.wrds_extractor]   Chunk 10: 5,331,031 NBBO records
2025-12-24 12:14:40,426 INFO [src.stage_a.parquet_writer]   Chunk 10: 5,331,031 rows
2025-12-24 12:14:40,828 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 56,884,295 total rows written
2025-12-24 12:19:53,088 INFO [src.stage_a.wrds_extractor]   Chunk 11: 8,496,938 NBBO records
2025-12-24 12:19:53,088 INFO [src.stage_a.parquet_writer]   Chunk 11: 8,496,938 rows
2025-12-24 12:19:53,846 INFO [src.stage_a.parquet_writer] ✓ Wrote 65,381,233 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-15
2025-12-24 12:19:53,861 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 12:19:53,861 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 12:19:53,861 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 12:19:53,861 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 12:19:53,861 INFO [src.stage_a.stage_a] Trades: 30,146,886 rows
2025-12-24 12:19:53,861 INFO [src.stage_a.stage_a] Nbbo: 65,381,233 rows
2025-12-24 12:19:53,861 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 12:19:53,861 INFO [src.stage_a.stage_a] Processing date 53/83: 2024-03-18
2025-12-24 12:19:53,861 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 12:19:53,861 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 12:19:53,861 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-03-18 (519 symbols)
2025-12-24 12:19:53,861 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 12:19:53,861 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 12:19:53,861 INFO [src.stage_a.stage_a] Extract run ID: 7eabd029-e3c5-4545-921c-45f0bae5c789
2025-12-24 12:19:53,870 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 12:19:53,870 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 12:19:53,870 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 12:19:53,870 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 12:19:53,870 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 12:19:53,870 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 12:19:53,870 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 12:19:53,870 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 12:19:53,870 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 12:19:55,563 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 12:19:55,564 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-18...
2025-12-24 12:19:55,659 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240318 for 519 symbols
2025-12-24 12:22:55,398 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,391,849 trades
2025-12-24 12:22:55,398 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,391,849 rows
2025-12-24 12:24:37,060 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,845,591 trades
2025-12-24 12:24:37,060 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,845,591 rows
2025-12-24 12:26:24,159 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,009,566 trades
2025-12-24 12:26:24,159 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,009,566 rows
2025-12-24 12:27:45,159 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,529,616 trades
2025-12-24 12:27:45,160 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,529,616 rows
2025-12-24 12:30:41,471 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,101,040 trades
2025-12-24 12:30:41,472 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,101,040 rows
2025-12-24 12:32:20,163 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,061,592 trades
2025-12-24 12:32:20,163 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,061,592 rows
2025-12-24 12:35:48,077 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,810,781 trades
2025-12-24 12:35:48,078 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,810,781 rows
2025-12-24 12:37:59,556 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,427,461 trades
2025-12-24 12:37:59,556 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,427,461 rows
2025-12-24 12:39:22,125 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,051,644 trades
2025-12-24 12:39:22,125 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,051,644 rows
2025-12-24 12:42:12,349 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,132,515 trades
2025-12-24 12:42:12,350 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,132,515 rows
2025-12-24 12:42:12,752 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,361,655 total rows written
2025-12-24 12:43:12,525 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,057,262 trades
2025-12-24 12:43:12,525 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,057,262 rows
2025-12-24 12:43:12,868 INFO [src.stage_a.parquet_writer] ✓ Wrote 26,418,917 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-18
2025-12-24 12:43:12,868 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 12:43:12,868 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 12:43:12,868 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 12:43:12,868 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 12:43:12,868 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 12:43:12,868 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 12:43:12,868 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 12:43:15,588 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 12:43:15,589 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-18...
2025-12-24 12:43:15,772 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240318 for 519 symbols
2025-12-24 12:46:49,481 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,727,323 NBBO records
2025-12-24 12:46:49,481 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,727,323 rows
2025-12-24 12:48:42,089 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,317,873 NBBO records
2025-12-24 12:48:42,089 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,317,873 rows
2025-12-24 12:51:04,120 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,315,174 NBBO records
2025-12-24 12:51:04,120 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,315,174 rows
2025-12-24 12:52:54,392 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,082,898 NBBO records
2025-12-24 12:52:54,392 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,082,898 rows
2025-12-24 12:56:24,104 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,886,409 NBBO records
2025-12-24 12:56:24,104 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,886,409 rows
2025-12-24 12:58:58,409 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,463,381 NBBO records
2025-12-24 12:58:58,410 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,463,381 rows
2025-12-24 13:02:14,391 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,462,042 NBBO records
2025-12-24 13:02:14,391 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,462,042 rows
2025-12-24 13:06:48,825 INFO [src.stage_a.wrds_extractor]   Chunk 8: 7,548,586 NBBO records
2025-12-24 13:06:48,825 INFO [src.stage_a.parquet_writer]   Chunk 8: 7,548,586 rows
2025-12-24 13:10:22,159 INFO [src.stage_a.wrds_extractor]   Chunk 9: 6,218,772 NBBO records
2025-12-24 13:10:22,160 INFO [src.stage_a.parquet_writer]   Chunk 9: 6,218,772 rows
2025-12-24 13:13:23,464 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,676,171 NBBO records
2025-12-24 13:13:23,472 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,676,171 rows
2025-12-24 13:13:23,839 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 50,698,629 total rows written
2025-12-24 13:17:34,562 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,171,211 NBBO records
2025-12-24 13:17:34,562 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,171,211 rows
2025-12-24 13:17:35,185 INFO [src.stage_a.parquet_writer] ✓ Wrote 57,869,840 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-18
2025-12-24 13:17:35,192 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 13:17:35,192 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 13:17:35,192 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 13:17:35,192 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 13:17:35,192 INFO [src.stage_a.stage_a] Trades: 26,418,917 rows
2025-12-24 13:17:35,192 INFO [src.stage_a.stage_a] Nbbo: 57,869,840 rows
2025-12-24 13:17:35,192 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 13:17:35,192 INFO [src.stage_a.stage_a] Processing date 54/83: 2024-03-19
2025-12-24 13:17:35,192 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 13:17:35,192 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 13:17:35,192 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-03-19 (519 symbols)
2025-12-24 13:17:35,192 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 13:17:35,192 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 13:17:35,192 INFO [src.stage_a.stage_a] Extract run ID: bf7fa85b-3336-4c08-8056-2748aabf1178
2025-12-24 13:17:35,201 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 13:17:35,201 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 13:17:35,201 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 13:17:35,201 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 13:17:35,201 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 13:17:35,201 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 13:17:35,201 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 13:17:35,201 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 13:17:35,201 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 13:17:36,374 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 13:17:36,374 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-19...
2025-12-24 13:17:36,447 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240319 for 519 symbols
2025-12-24 13:20:15,757 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,243,655 trades
2025-12-24 13:20:15,757 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,243,655 rows
2025-12-24 13:21:50,920 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,721,931 trades
2025-12-24 13:21:50,920 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,721,931 rows
2025-12-24 13:23:31,160 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,860,321 trades
2025-12-24 13:23:31,160 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,860,321 rows
2025-12-24 13:24:35,288 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,508,636 trades
2025-12-24 13:24:35,288 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,508,636 rows
2025-12-24 13:26:22,275 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,205,943 trades
2025-12-24 13:26:22,275 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,205,943 rows
2025-12-24 13:28:00,140 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,886,270 trades
2025-12-24 13:28:00,140 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,886,270 rows
2025-12-24 13:30:47,317 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,638,719 trades
2025-12-24 13:30:47,317 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,638,719 rows
2025-12-24 13:32:38,135 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,219,505 trades
2025-12-24 13:32:38,135 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,219,505 rows
2025-12-24 13:34:10,183 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,969,806 trades
2025-12-24 13:34:10,183 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,969,806 rows
2025-12-24 13:36:00,649 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,597,511 trades
2025-12-24 13:36:00,649 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,597,511 rows
2025-12-24 13:36:01,013 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 22,852,297 total rows written
2025-12-24 13:36:47,990 INFO [src.stage_a.wrds_extractor]   Chunk 11: 967,769 trades
2025-12-24 13:36:47,990 INFO [src.stage_a.parquet_writer]   Chunk 11: 967,769 rows
2025-12-24 13:36:48,300 INFO [src.stage_a.parquet_writer] ✓ Wrote 23,820,066 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-19
2025-12-24 13:36:48,301 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 13:36:48,301 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 13:36:48,301 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 13:36:48,301 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 13:36:48,301 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 13:36:48,301 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 13:36:48,301 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 13:36:50,102 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 13:36:50,103 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-19...
2025-12-24 13:36:50,177 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240319 for 519 symbols
2025-12-24 13:40:26,810 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,470,780 NBBO records
2025-12-24 13:40:26,810 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,470,780 rows
2025-12-24 13:41:50,959 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,135,601 NBBO records
2025-12-24 13:41:50,959 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,135,601 rows
2025-12-24 13:44:24,712 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,317,720 NBBO records
2025-12-24 13:44:24,713 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,317,720 rows
2025-12-24 13:46:16,632 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,007,532 NBBO records
2025-12-24 13:46:16,633 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,007,532 rows
2025-12-24 13:49:40,391 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,211,303 NBBO records
2025-12-24 13:49:40,391 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,211,303 rows
2025-12-24 13:52:03,975 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,269,191 NBBO records
2025-12-24 13:52:03,975 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,269,191 rows
2025-12-24 13:55:07,484 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,134,688 NBBO records
2025-12-24 13:55:07,484 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,134,688 rows
2025-12-24 13:59:36,738 INFO [src.stage_a.wrds_extractor]   Chunk 8: 7,673,949 NBBO records
2025-12-24 13:59:36,738 INFO [src.stage_a.parquet_writer]   Chunk 8: 7,673,949 rows
2025-12-24 14:03:33,530 INFO [src.stage_a.wrds_extractor]   Chunk 9: 6,351,521 NBBO records
2025-12-24 14:03:33,532 INFO [src.stage_a.parquet_writer]   Chunk 9: 6,351,521 rows
2025-12-24 14:06:03,460 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,434,616 NBBO records
2025-12-24 14:06:03,462 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,434,616 rows
2025-12-24 14:06:03,806 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 49,006,901 total rows written
2025-12-24 14:10:48,335 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,304,765 NBBO records
2025-12-24 14:10:48,335 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,304,765 rows
2025-12-24 14:10:48,989 INFO [src.stage_a.parquet_writer] ✓ Wrote 56,311,666 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-19
2025-12-24 14:10:48,996 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 14:10:48,996 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 14:10:48,996 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 14:10:48,996 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 14:10:48,996 INFO [src.stage_a.stage_a] Trades: 23,820,066 rows
2025-12-24 14:10:48,996 INFO [src.stage_a.stage_a] Nbbo: 56,311,666 rows
2025-12-24 14:10:48,996 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 14:10:48,996 INFO [src.stage_a.stage_a] Processing date 55/83: 2024-03-20
2025-12-24 14:10:48,996 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 14:10:48,996 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 14:10:48,996 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-03-20 (519 symbols)
2025-12-24 14:10:48,996 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 14:10:48,996 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 14:10:48,996 INFO [src.stage_a.stage_a] Extract run ID: b96b4099-bf59-44da-8bb5-6005c0cd27d2
2025-12-24 14:10:49,005 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 14:10:49,005 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 14:10:49,005 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 14:10:49,005 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 14:10:49,005 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 14:10:49,005 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 14:10:49,005 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 14:10:49,005 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 14:10:49,005 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 14:10:50,215 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 14:10:50,215 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-20...
2025-12-24 14:10:50,292 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240320 for 519 symbols
2025-12-24 14:13:56,484 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,410,884 trades
2025-12-24 14:13:56,484 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,410,884 rows
2025-12-24 14:15:46,390 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,884,033 trades
2025-12-24 14:15:46,390 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,884,033 rows
2025-12-24 14:17:05,654 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,001,441 trades
2025-12-24 14:17:05,654 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,001,441 rows
2025-12-24 14:18:51,198 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,735,559 trades
2025-12-24 14:18:51,198 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,735,559 rows
2025-12-24 14:20:44,686 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,511,046 trades
2025-12-24 14:20:44,686 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,511,046 rows
2025-12-24 14:22:39,612 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,134,810 trades
2025-12-24 14:22:39,612 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,134,810 rows
2025-12-24 14:25:49,629 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,571,496 trades
2025-12-24 14:25:49,629 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,571,496 rows
2025-12-24 14:27:41,578 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,402,531 trades
2025-12-24 14:27:41,578 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,402,531 rows
2025-12-24 14:29:39,466 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,060,072 trades
2025-12-24 14:29:39,466 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,060,072 rows
2025-12-24 14:32:50,316 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,714,475 trades
2025-12-24 14:32:50,316 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,714,475 rows
2025-12-24 14:32:50,707 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 24,426,347 total rows written
2025-12-24 14:33:46,091 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,205,582 trades
2025-12-24 14:33:46,091 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,205,582 rows
2025-12-24 14:33:46,455 INFO [src.stage_a.parquet_writer] ✓ Wrote 25,631,929 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-20
2025-12-24 14:33:46,455 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 14:33:46,455 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 14:33:46,455 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 14:33:46,455 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 14:33:46,455 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 14:33:46,455 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 14:33:46,455 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 14:33:49,008 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 14:33:49,008 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-20...
2025-12-24 14:33:49,203 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240320 for 519 symbols
2025-12-24 14:36:43,191 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,495,190 NBBO records
2025-12-24 14:36:43,191 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,495,190 rows
2025-12-24 14:38:26,130 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,446,397 NBBO records
2025-12-24 14:38:26,130 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,446,397 rows
2025-12-24 14:40:49,155 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,529,964 NBBO records
2025-12-24 14:40:49,155 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,529,964 rows
2025-12-24 14:42:28,924 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,550,031 NBBO records
2025-12-24 14:42:28,924 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,550,031 rows
2025-12-24 14:45:14,868 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,279,563 NBBO records
2025-12-24 14:45:14,868 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,279,563 rows
2025-12-24 14:47:36,898 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,741,269 NBBO records
2025-12-24 14:47:36,898 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,741,269 rows
2025-12-24 14:50:52,850 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,346,565 NBBO records
2025-12-24 14:50:52,850 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,346,565 rows
2025-12-24 14:54:27,754 INFO [src.stage_a.wrds_extractor]   Chunk 8: 7,597,081 NBBO records
2025-12-24 14:54:27,754 INFO [src.stage_a.parquet_writer]   Chunk 8: 7,597,081 rows
2025-12-24 14:58:30,378 INFO [src.stage_a.wrds_extractor]   Chunk 9: 6,828,928 NBBO records
2025-12-24 14:58:30,379 INFO [src.stage_a.parquet_writer]   Chunk 9: 6,828,928 rows
2025-12-24 15:02:07,272 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,945,895 NBBO records
2025-12-24 15:02:07,273 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,945,895 rows
2025-12-24 15:02:07,636 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 51,760,883 total rows written
2025-12-24 15:07:22,285 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,924,586 NBBO records
2025-12-24 15:07:22,285 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,924,586 rows
2025-12-24 15:07:22,961 INFO [src.stage_a.parquet_writer] ✓ Wrote 59,685,469 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-20
2025-12-24 15:07:22,972 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 15:07:22,972 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 15:07:22,972 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 15:07:22,972 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 15:07:22,972 INFO [src.stage_a.stage_a] Trades: 25,631,929 rows
2025-12-24 15:07:22,972 INFO [src.stage_a.stage_a] Nbbo: 59,685,469 rows
2025-12-24 15:07:22,972 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 15:07:22,972 INFO [src.stage_a.stage_a] Processing date 56/83: 2024-03-21
2025-12-24 15:07:22,972 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 15:07:22,972 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 15:07:22,972 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-03-21 (519 symbols)
2025-12-24 15:07:22,972 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 15:07:22,972 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 15:07:22,972 INFO [src.stage_a.stage_a] Extract run ID: ab41a84f-94f9-409f-88bf-bd0b0f3d2dcf
2025-12-24 15:07:22,981 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 15:07:22,981 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 15:07:22,981 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 15:07:22,981 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 15:07:22,981 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 15:07:22,981 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 15:07:22,981 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 15:07:22,981 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 15:07:22,981 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 15:07:24,589 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 15:07:24,590 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-21...
2025-12-24 15:07:24,683 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240321 for 519 symbols
2025-12-24 15:11:06,245 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,216,604 trades
2025-12-24 15:11:06,245 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,216,604 rows
2025-12-24 15:12:59,335 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,023,264 trades
2025-12-24 15:12:59,335 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,023,264 rows
2025-12-24 15:15:10,993 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,110,375 trades
2025-12-24 15:15:10,993 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,110,375 rows
2025-12-24 15:16:37,221 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,729,806 trades
2025-12-24 15:16:37,221 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,729,806 rows
2025-12-24 15:19:13,971 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,510,660 trades
2025-12-24 15:19:13,971 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,510,660 rows
2025-12-24 15:21:33,679 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,253,894 trades
2025-12-24 15:21:33,679 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,253,894 rows
2025-12-24 15:25:40,892 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,074,233 trades
2025-12-24 15:25:40,892 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,074,233 rows
2025-12-24 15:27:42,063 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,555,058 trades
2025-12-24 15:27:42,066 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,555,058 rows
2025-12-24 15:30:10,389 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,146,738 trades
2025-12-24 15:30:10,389 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,146,738 rows
2025-12-24 15:32:59,163 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,909,532 trades
2025-12-24 15:32:59,163 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,909,532 rows
2025-12-24 15:32:59,549 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,530,164 total rows written
2025-12-24 15:33:56,323 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,066,720 trades
2025-12-24 15:33:56,323 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,066,720 rows
2025-12-24 15:33:56,649 INFO [src.stage_a.parquet_writer] ✓ Wrote 27,596,884 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-21
2025-12-24 15:33:56,650 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 15:33:56,650 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 15:33:56,650 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 15:33:56,650 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 15:33:56,650 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 15:33:56,650 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 15:33:56,650 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 15:33:57,811 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 15:33:57,811 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-21...
2025-12-24 15:33:57,895 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240321 for 519 symbols
2025-12-24 15:37:20,518 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,501,710 NBBO records
2025-12-24 15:37:20,518 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,501,710 rows
2025-12-24 15:39:02,538 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,079,619 NBBO records
2025-12-24 15:39:02,539 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,079,619 rows
2025-12-24 15:41:43,710 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,173,442 NBBO records
2025-12-24 15:41:43,710 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,173,442 rows
2025-12-24 15:43:43,319 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,065,200 NBBO records
2025-12-24 15:43:43,319 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,065,200 rows
2025-12-24 15:47:07,039 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,295,310 NBBO records
2025-12-24 15:47:07,039 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,295,310 rows
2025-12-24 15:49:44,528 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,294,618 NBBO records
2025-12-24 15:49:44,528 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,294,618 rows
2025-12-24 15:52:58,003 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,390,838 NBBO records
2025-12-24 15:52:58,003 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,390,838 rows
2025-12-24 15:57:13,125 INFO [src.stage_a.wrds_extractor]   Chunk 8: 6,726,516 NBBO records
2025-12-24 15:57:13,126 INFO [src.stage_a.parquet_writer]   Chunk 8: 6,726,516 rows
2025-12-24 16:00:45,141 INFO [src.stage_a.wrds_extractor]   Chunk 9: 6,000,725 NBBO records
2025-12-24 16:00:45,142 INFO [src.stage_a.parquet_writer]   Chunk 9: 6,000,725 rows
2025-12-24 16:03:27,448 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,528,785 NBBO records
2025-12-24 16:03:27,449 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,528,785 rows
2025-12-24 16:03:27,816 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 48,056,763 total rows written
2025-12-24 16:07:39,301 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,186,041 NBBO records
2025-12-24 16:07:39,301 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,186,041 rows
2025-12-24 16:07:39,936 INFO [src.stage_a.parquet_writer] ✓ Wrote 55,242,804 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-21
2025-12-24 16:07:39,946 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 16:07:39,946 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 16:07:39,946 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 16:07:39,946 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 16:07:39,946 INFO [src.stage_a.stage_a] Trades: 27,596,884 rows
2025-12-24 16:07:39,946 INFO [src.stage_a.stage_a] Nbbo: 55,242,804 rows
2025-12-24 16:07:39,946 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 16:07:39,946 INFO [src.stage_a.stage_a] Processing date 57/83: 2024-03-22
2025-12-24 16:07:39,946 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 16:07:39,946 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 16:07:39,946 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-03-22 (519 symbols)
2025-12-24 16:07:39,946 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 16:07:39,946 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 16:07:39,946 INFO [src.stage_a.stage_a] Extract run ID: de85d260-e5a8-4256-9e29-efd4ccbfb92b
2025-12-24 16:07:39,955 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 16:07:39,955 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 16:07:39,955 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 16:07:39,955 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 16:07:39,955 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 16:07:39,955 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 16:07:39,955 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 16:07:39,955 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 16:07:39,955 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 16:07:43,190 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 16:07:43,190 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-22...
2025-12-24 16:07:43,360 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240322 for 519 symbols
2025-12-24 16:10:33,208 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,101,119 trades
2025-12-24 16:10:33,208 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,101,119 rows
2025-12-24 16:12:15,619 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,686,954 trades
2025-12-24 16:12:15,619 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,686,954 rows
2025-12-24 16:13:56,606 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,679,532 trades
2025-12-24 16:13:56,606 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,679,532 rows
2025-12-24 16:15:25,899 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,476,703 trades
2025-12-24 16:15:25,899 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,476,703 rows
2025-12-24 16:16:55,146 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,036,600 trades
2025-12-24 16:16:55,146 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,036,600 rows
2025-12-24 16:19:10,905 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,062,164 trades
2025-12-24 16:19:10,906 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,062,164 rows
2025-12-24 16:22:16,186 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,645,132 trades
2025-12-24 16:22:16,186 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,645,132 rows
2025-12-24 16:24:13,216 INFO [src.stage_a.wrds_extractor]   Chunk 8: 1,937,037 trades
2025-12-24 16:24:13,216 INFO [src.stage_a.parquet_writer]   Chunk 8: 1,937,037 rows
2025-12-24 16:25:37,172 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,914,992 trades
2025-12-24 16:25:37,172 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,914,992 rows
2025-12-24 16:28:10,120 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,496,304 trades
2025-12-24 16:28:10,121 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,496,304 rows
2025-12-24 16:28:10,487 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 22,036,537 total rows written
2025-12-24 16:28:43,481 INFO [src.stage_a.wrds_extractor]   Chunk 11: 863,158 trades
2025-12-24 16:28:43,481 INFO [src.stage_a.parquet_writer]   Chunk 11: 863,158 rows
2025-12-24 16:28:43,774 INFO [src.stage_a.parquet_writer] ✓ Wrote 22,899,695 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-22
2025-12-24 16:28:43,775 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 16:28:43,775 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 16:28:43,775 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 16:28:43,775 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 16:28:43,775 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 16:28:43,775 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 16:28:43,775 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 16:28:45,664 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 16:28:45,664 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-22...
2025-12-24 16:28:45,761 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240322 for 519 symbols
2025-12-24 16:31:30,679 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,513,602 NBBO records
2025-12-24 16:31:30,679 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,513,602 rows
2025-12-24 16:32:59,265 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,671,913 NBBO records
2025-12-24 16:32:59,265 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,671,913 rows
2025-12-24 16:35:11,971 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,473,224 NBBO records
2025-12-24 16:35:11,971 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,473,224 rows
2025-12-24 16:36:44,010 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,464,382 NBBO records
2025-12-24 16:36:44,011 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,464,382 rows
2025-12-24 16:39:24,145 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,029,506 NBBO records
2025-12-24 16:39:24,145 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,029,506 rows
2025-12-24 16:41:56,308 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,407,119 NBBO records
2025-12-24 16:41:56,308 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,407,119 rows
2025-12-24 16:45:14,050 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,439,734 NBBO records
2025-12-24 16:45:14,050 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,439,734 rows
2025-12-24 16:49:28,088 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,500,559 NBBO records
2025-12-24 16:49:28,088 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,500,559 rows
2025-12-24 16:53:38,039 INFO [src.stage_a.wrds_extractor]   Chunk 9: 5,281,772 NBBO records
2025-12-24 16:53:38,039 INFO [src.stage_a.parquet_writer]   Chunk 9: 5,281,772 rows
2025-12-24 16:56:19,507 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,664,736 NBBO records
2025-12-24 16:56:19,508 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,664,736 rows
2025-12-24 16:56:19,817 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 39,446,547 total rows written
2025-12-24 17:01:07,560 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,133,455 NBBO records
2025-12-24 17:01:07,560 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,133,455 rows
2025-12-24 17:01:08,116 INFO [src.stage_a.parquet_writer] ✓ Wrote 45,580,002 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-22
2025-12-24 17:01:08,125 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 17:01:08,125 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 17:01:08,125 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 17:01:08,125 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 17:01:08,125 INFO [src.stage_a.stage_a] Trades: 22,899,695 rows
2025-12-24 17:01:08,125 INFO [src.stage_a.stage_a] Nbbo: 45,580,002 rows
2025-12-24 17:01:08,125 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 17:01:08,125 INFO [src.stage_a.stage_a] Processing date 58/83: 2024-03-25
2025-12-24 17:01:08,125 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 17:01:08,125 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 17:01:08,125 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-03-25 (519 symbols)
2025-12-24 17:01:08,125 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 17:01:08,125 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 17:01:08,125 INFO [src.stage_a.stage_a] Extract run ID: 7931ba06-f574-499e-8e33-1571c9d4fcb9
2025-12-24 17:01:08,133 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 17:01:08,133 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 17:01:08,133 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 17:01:08,133 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 17:01:08,133 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 17:01:08,133 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 17:01:08,133 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 17:01:08,134 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 17:01:08,134 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 17:01:10,899 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 17:01:10,899 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-25...
2025-12-24 17:01:11,123 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240325 for 519 symbols
2025-12-24 17:04:21,143 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,199,441 trades
2025-12-24 17:04:21,143 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,199,441 rows
2025-12-24 17:05:55,144 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,743,741 trades
2025-12-24 17:05:55,144 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,743,741 rows
2025-12-24 17:08:00,240 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,787,547 trades
2025-12-24 17:08:00,240 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,787,547 rows
2025-12-24 17:09:29,275 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,453,626 trades
2025-12-24 17:09:29,275 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,453,626 rows
2025-12-24 17:11:25,053 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,101,650 trades
2025-12-24 17:11:25,053 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,101,650 rows
2025-12-24 17:13:06,007 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,859,769 trades
2025-12-24 17:13:06,007 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,859,769 rows
2025-12-24 17:16:21,781 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,678,689 trades
2025-12-24 17:16:21,781 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,678,689 rows
2025-12-24 17:18:27,158 INFO [src.stage_a.wrds_extractor]   Chunk 8: 1,986,468 trades
2025-12-24 17:18:27,159 INFO [src.stage_a.parquet_writer]   Chunk 8: 1,986,468 rows
2025-12-24 17:19:59,068 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,847,215 trades
2025-12-24 17:19:59,068 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,847,215 rows
2025-12-24 17:22:08,257 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,607,984 trades
2025-12-24 17:22:08,257 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,607,984 rows
2025-12-24 17:22:08,626 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 22,266,130 total rows written
2025-12-24 17:22:53,509 INFO [src.stage_a.wrds_extractor]   Chunk 11: 946,851 trades
2025-12-24 17:22:53,509 INFO [src.stage_a.parquet_writer]   Chunk 11: 946,851 rows
2025-12-24 17:22:53,793 INFO [src.stage_a.parquet_writer] ✓ Wrote 23,212,981 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-25
2025-12-24 17:22:53,794 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 17:22:53,794 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 17:22:53,794 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 17:22:53,794 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 17:22:53,794 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 17:22:53,794 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 17:22:53,794 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 17:22:55,292 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 17:22:55,292 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-25...
2025-12-24 17:22:55,418 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240325 for 519 symbols
2025-12-24 17:26:21,331 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,559,942 NBBO records
2025-12-24 17:26:21,332 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,559,942 rows
2025-12-24 17:27:52,860 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,866,417 NBBO records
2025-12-24 17:27:52,860 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,866,417 rows
2025-12-24 17:31:11,359 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,802,145 NBBO records
2025-12-24 17:31:11,359 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,802,145 rows
2025-12-24 17:32:58,262 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,577,148 NBBO records
2025-12-24 17:32:58,262 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,577,148 rows
2025-12-24 17:35:56,072 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,084,785 NBBO records
2025-12-24 17:35:56,072 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,084,785 rows
2025-12-24 17:38:13,335 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,362,245 NBBO records
2025-12-24 17:38:13,335 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,362,245 rows
2025-12-24 17:41:01,558 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,348,540 NBBO records
2025-12-24 17:41:01,559 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,348,540 rows
2025-12-24 17:44:17,861 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,479,100 NBBO records
2025-12-24 17:44:17,861 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,479,100 rows
2025-12-24 17:47:35,961 INFO [src.stage_a.wrds_extractor]   Chunk 9: 5,170,449 NBBO records
2025-12-24 17:47:35,962 INFO [src.stage_a.parquet_writer]   Chunk 9: 5,170,449 rows
2025-12-24 17:50:24,208 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,937,453 NBBO records
2025-12-24 17:50:24,208 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,937,453 rows
2025-12-24 17:50:24,524 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 40,188,224 total rows written
2025-12-24 17:53:34,632 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,336,902 NBBO records
2025-12-24 17:53:34,632 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,336,902 rows
2025-12-24 17:53:35,112 INFO [src.stage_a.parquet_writer] ✓ Wrote 45,525,126 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-25
2025-12-24 17:53:35,117 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 17:53:35,117 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 17:53:35,117 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 17:53:35,117 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 17:53:35,117 INFO [src.stage_a.stage_a] Trades: 23,212,981 rows
2025-12-24 17:53:35,117 INFO [src.stage_a.stage_a] Nbbo: 45,525,126 rows
2025-12-24 17:53:35,117 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 17:53:35,117 INFO [src.stage_a.stage_a] Processing date 59/83: 2024-03-26
2025-12-24 17:53:35,117 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 17:53:35,118 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 17:53:35,118 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-03-26 (519 symbols)
2025-12-24 17:53:35,118 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 17:53:35,118 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 17:53:35,118 INFO [src.stage_a.stage_a] Extract run ID: 8e1a5d1d-15b1-46cb-9ff4-3e7d2df1e79b
2025-12-24 17:53:35,126 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 17:53:35,126 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 17:53:35,126 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 17:53:35,126 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 17:53:35,126 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 17:53:35,126 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 17:53:35,126 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 17:53:35,126 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 17:53:35,126 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 17:53:37,064 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 17:53:37,064 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-26...
2025-12-24 17:53:37,156 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240326 for 519 symbols
2025-12-24 17:56:49,691 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,091,927 trades
2025-12-24 17:56:49,691 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,091,927 rows
2025-12-24 17:58:19,117 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,868,431 trades
2025-12-24 17:58:19,117 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,868,431 rows
2025-12-24 17:59:58,842 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,856,032 trades
2025-12-24 17:59:58,842 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,856,032 rows
2025-12-24 18:01:43,513 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,541,007 trades
2025-12-24 18:01:43,513 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,541,007 rows
2025-12-24 18:04:38,013 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,230,180 trades
2025-12-24 18:04:38,013 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,230,180 rows
2025-12-24 18:06:20,284 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,892,926 trades
2025-12-24 18:06:20,284 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,892,926 rows
2025-12-24 18:09:55,295 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,614,419 trades
2025-12-24 18:09:55,295 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,614,419 rows
2025-12-24 18:11:49,752 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,096,622 trades
2025-12-24 18:11:49,752 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,096,622 rows
2025-12-24 18:13:32,607 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,892,163 trades
2025-12-24 18:13:32,607 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,892,163 rows
2025-12-24 18:16:24,137 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,216,040 trades
2025-12-24 18:16:24,137 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,216,040 rows
2025-12-24 18:16:24,553 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,299,747 total rows written
2025-12-24 18:17:46,393 INFO [src.stage_a.wrds_extractor]   Chunk 11: 955,494 trades
2025-12-24 18:17:46,393 INFO [src.stage_a.parquet_writer]   Chunk 11: 955,494 rows
2025-12-24 18:17:46,692 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,255,241 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-26
2025-12-24 18:17:46,693 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 18:17:46,693 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 18:17:46,693 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 18:17:46,693 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 18:17:46,693 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 18:17:46,693 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 18:17:46,693 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 18:17:48,772 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 18:17:48,772 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-26...
2025-12-24 18:17:48,879 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240326 for 519 symbols
2025-12-24 18:20:57,491 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,840,223 NBBO records
2025-12-24 18:20:57,491 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,840,223 rows
2025-12-24 18:21:34,138 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,828,717 NBBO records
2025-12-24 18:21:34,138 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,828,717 rows
2025-12-24 18:23:18,837 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,640,854 NBBO records
2025-12-24 18:23:18,837 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,640,854 rows
2025-12-24 18:24:56,819 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,527,452 NBBO records
2025-12-24 18:24:56,819 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,527,452 rows
2025-12-24 18:27:59,405 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,201,068 NBBO records
2025-12-24 18:27:59,405 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,201,068 rows
2025-12-24 18:30:26,279 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,553,235 NBBO records
2025-12-24 18:30:26,279 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,553,235 rows
2025-12-24 18:32:53,378 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,865,332 NBBO records
2025-12-24 18:32:53,378 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,865,332 rows
2025-12-24 18:34:10,209 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,717,822 NBBO records
2025-12-24 18:34:10,209 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,717,822 rows
2025-12-24 18:35:18,025 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,999,988 NBBO records
2025-12-24 18:35:18,031 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,999,988 rows
2025-12-24 18:36:02,039 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,831,012 NBBO records
2025-12-24 18:36:02,039 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,831,012 rows
2025-12-24 18:36:02,376 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 41,005,703 total rows written
2025-12-24 18:38:59,502 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,318,565 NBBO records
2025-12-24 18:38:59,502 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,318,565 rows
2025-12-24 18:38:59,976 INFO [src.stage_a.parquet_writer] ✓ Wrote 46,324,268 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-26
2025-12-24 18:38:59,983 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 18:38:59,983 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 18:38:59,983 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 18:38:59,983 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 18:38:59,983 INFO [src.stage_a.stage_a] Trades: 24,255,241 rows
2025-12-24 18:38:59,983 INFO [src.stage_a.stage_a] Nbbo: 46,324,268 rows
2025-12-24 18:38:59,984 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 18:38:59,984 INFO [src.stage_a.stage_a] Processing date 60/83: 2024-03-27
2025-12-24 18:38:59,984 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 18:38:59,984 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 18:38:59,984 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-03-27 (519 symbols)
2025-12-24 18:38:59,984 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 18:38:59,984 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 18:38:59,984 INFO [src.stage_a.stage_a] Extract run ID: 177d08a4-3e71-49f5-90ff-7ca41bc8d5f2
2025-12-24 18:38:59,992 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 18:38:59,992 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 18:38:59,992 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 18:38:59,992 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 18:38:59,992 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 18:38:59,992 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 18:38:59,992 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 18:38:59,992 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 18:38:59,992 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 18:39:01,798 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 18:39:01,798 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-27...
2025-12-24 18:39:01,903 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240327 for 519 symbols
2025-12-24 18:41:27,206 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,142,771 trades
2025-12-24 18:41:27,206 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,142,771 rows
2025-12-24 18:42:04,325 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,121,666 trades
2025-12-24 18:42:04,325 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,121,666 rows
2025-12-24 18:42:32,631 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,872,289 trades
2025-12-24 18:42:32,632 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,872,289 rows
2025-12-24 18:43:01,945 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,674,730 trades
2025-12-24 18:43:01,945 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,674,730 rows
2025-12-24 18:43:39,256 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,335,851 trades
2025-12-24 18:43:39,256 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,335,851 rows
2025-12-24 18:45:11,616 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,998,043 trades
2025-12-24 18:45:11,616 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,998,043 rows
2025-12-24 18:48:28,825 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,818,296 trades
2025-12-24 18:48:28,825 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,818,296 rows
2025-12-24 18:49:34,790 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,215,708 trades
2025-12-24 18:49:34,790 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,215,708 rows
2025-12-24 18:50:51,821 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,059,714 trades
2025-12-24 18:50:51,821 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,059,714 rows
2025-12-24 18:53:45,148 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,840,172 trades
2025-12-24 18:53:45,149 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,840,172 rows
2025-12-24 18:53:45,536 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 24,079,240 total rows written
2025-12-24 18:55:12,025 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,036,367 trades
2025-12-24 18:55:12,025 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,036,367 rows
2025-12-24 18:55:12,332 INFO [src.stage_a.parquet_writer] ✓ Wrote 25,115,607 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-27
2025-12-24 18:55:12,334 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 18:55:12,334 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 18:55:12,334 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 18:55:12,334 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 18:55:12,334 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 18:55:12,334 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 18:55:12,334 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 18:55:14,405 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 18:55:14,405 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-27...
2025-12-24 18:55:14,618 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240327 for 519 symbols
2025-12-24 18:58:40,544 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,283,168 NBBO records
2025-12-24 18:58:40,544 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,283,168 rows
2025-12-24 19:00:29,543 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,522,280 NBBO records
2025-12-24 19:00:29,543 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,522,280 rows
2025-12-24 19:01:23,784 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,834,507 NBBO records
2025-12-24 19:01:23,785 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,834,507 rows
2025-12-24 19:01:53,237 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,949,773 NBBO records
2025-12-24 19:01:53,237 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,949,773 rows
2025-12-24 19:03:02,021 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,216,845 NBBO records
2025-12-24 19:03:02,021 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,216,845 rows
2025-12-24 19:03:45,621 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,858,117 NBBO records
2025-12-24 19:03:45,621 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,858,117 rows
2025-12-24 19:07:20,009 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,981,532 NBBO records
2025-12-24 19:07:20,010 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,981,532 rows
2025-12-24 19:09:50,155 INFO [src.stage_a.wrds_extractor]   Chunk 8: 6,142,312 NBBO records
2025-12-24 19:09:50,155 INFO [src.stage_a.parquet_writer]   Chunk 8: 6,142,312 rows
2025-12-24 19:12:33,221 INFO [src.stage_a.wrds_extractor]   Chunk 9: 5,787,809 NBBO records
2025-12-24 19:12:33,223 INFO [src.stage_a.parquet_writer]   Chunk 9: 5,787,809 rows
2025-12-24 19:15:05,121 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,288,442 NBBO records
2025-12-24 19:15:05,122 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,288,442 rows
2025-12-24 19:15:05,460 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 45,864,785 total rows written
2025-12-24 19:16:43,242 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,455,917 NBBO records
2025-12-24 19:16:43,242 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,455,917 rows
2025-12-24 19:16:43,842 INFO [src.stage_a.parquet_writer] ✓ Wrote 52,320,702 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-27
2025-12-24 19:16:43,847 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 19:16:43,847 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 19:16:43,847 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 19:16:43,847 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 19:16:43,847 INFO [src.stage_a.stage_a] Trades: 25,115,607 rows
2025-12-24 19:16:43,847 INFO [src.stage_a.stage_a] Nbbo: 52,320,702 rows
2025-12-24 19:16:43,847 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 19:16:43,847 INFO [src.stage_a.stage_a] Processing date 61/83: 2024-03-28
2025-12-24 19:16:43,847 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 19:16:43,847 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 19:16:43,847 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-03-28 (519 symbols)
2025-12-24 19:16:43,847 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 19:16:43,847 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 19:16:43,847 INFO [src.stage_a.stage_a] Extract run ID: 59cfb44a-c5cf-4995-b8e5-c4d2f339399f
2025-12-24 19:16:43,855 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 19:16:43,855 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 19:16:43,855 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 19:16:43,855 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 19:16:43,855 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 19:16:43,855 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 19:16:43,855 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 19:16:43,855 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 19:16:43,855 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 19:16:45,213 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 19:16:45,214 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-28...
2025-12-24 19:16:45,280 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240328 for 519 symbols
2025-12-24 19:17:57,717 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,080,172 trades
2025-12-24 19:17:57,717 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,080,172 rows
2025-12-24 19:19:52,497 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,832,015 trades
2025-12-24 19:19:52,498 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,832,015 rows
2025-12-24 19:21:50,957 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,925,142 trades
2025-12-24 19:21:50,957 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,925,142 rows
2025-12-24 19:23:46,168 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,696,404 trades
2025-12-24 19:23:46,168 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,696,404 rows
2025-12-24 19:26:20,747 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,266,542 trades
2025-12-24 19:26:20,747 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,266,542 rows
2025-12-24 19:27:58,178 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,989,963 trades
2025-12-24 19:27:58,178 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,989,963 rows
2025-12-24 19:30:53,441 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,215,246 trades
2025-12-24 19:30:53,441 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,215,246 rows
2025-12-24 19:32:35,878 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,156,886 trades
2025-12-24 19:32:35,878 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,156,886 rows
2025-12-24 19:34:17,240 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,969,356 trades
2025-12-24 19:34:17,240 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,969,356 rows
2025-12-24 19:36:42,719 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,834,604 trades
2025-12-24 19:36:42,719 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,834,604 rows
2025-12-24 19:36:43,093 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 22,966,330 total rows written
2025-12-24 19:37:35,591 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,054,398 trades
2025-12-24 19:37:35,591 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,054,398 rows
2025-12-24 19:37:35,915 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,020,728 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-03-28
2025-12-24 19:37:35,916 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 19:37:35,917 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 19:37:35,917 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 19:37:35,917 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 19:37:35,917 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 19:37:35,917 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 19:37:35,917 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 19:37:38,288 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 19:37:38,288 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-28...
2025-12-24 19:37:38,447 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240328 for 519 symbols
2025-12-24 19:39:35,209 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,765,147 NBBO records
2025-12-24 19:39:35,209 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,765,147 rows
2025-12-24 19:40:16,016 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,903,517 NBBO records
2025-12-24 19:40:16,016 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,903,517 rows
2025-12-24 19:42:37,966 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,001,042 NBBO records
2025-12-24 19:42:37,966 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,001,042 rows
2025-12-24 19:44:33,662 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,002,292 NBBO records
2025-12-24 19:44:33,662 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,002,292 rows
2025-12-24 19:48:34,256 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,351,715 NBBO records
2025-12-24 19:48:34,256 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,351,715 rows
2025-12-24 19:51:27,512 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,093,107 NBBO records
2025-12-24 19:51:27,512 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,093,107 rows
2025-12-24 19:55:02,895 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,927,492 NBBO records
2025-12-24 19:55:02,896 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,927,492 rows
2025-12-24 19:59:06,461 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,701,223 NBBO records
2025-12-24 19:59:06,461 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,701,223 rows
2025-12-24 20:02:16,647 INFO [src.stage_a.wrds_extractor]   Chunk 9: 5,265,996 NBBO records
2025-12-24 20:02:16,648 INFO [src.stage_a.parquet_writer]   Chunk 9: 5,265,996 rows
2025-12-24 20:04:49,607 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,109,274 NBBO records
2025-12-24 20:04:49,608 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,109,274 rows
2025-12-24 20:04:49,938 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 43,120,805 total rows written
2025-12-24 20:07:20,920 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,633,803 NBBO records
2025-12-24 20:07:20,920 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,633,803 rows
2025-12-24 20:07:21,431 INFO [src.stage_a.parquet_writer] ✓ Wrote 48,754,608 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-03-28
2025-12-24 20:07:21,436 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 20:07:21,436 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 20:07:21,436 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 20:07:21,436 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 20:07:21,436 INFO [src.stage_a.stage_a] Trades: 24,020,728 rows
2025-12-24 20:07:21,436 INFO [src.stage_a.stage_a] Nbbo: 48,754,608 rows
2025-12-24 20:07:21,436 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 20:07:21,436 INFO [src.stage_a.stage_a] Processing date 62/83: 2024-04-01
2025-12-24 20:07:21,436 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 20:07:21,436 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 20:07:21,436 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-04-01 (519 symbols)
2025-12-24 20:07:21,436 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 20:07:21,436 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 20:07:21,436 INFO [src.stage_a.stage_a] Extract run ID: f9b1c630-8399-4755-802f-84236a83f6ab
2025-12-24 20:07:21,444 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 20:07:21,444 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 20:07:21,444 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 20:07:21,444 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 20:07:21,444 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 20:07:21,444 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 20:07:21,444 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 20:07:21,444 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 20:07:21,444 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 20:07:23,019 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 20:07:23,019 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-01...
2025-12-24 20:07:23,109 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240401 for 519 symbols
2025-12-24 20:09:34,398 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,996,169 trades
2025-12-24 20:09:34,398 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,996,169 rows
2025-12-24 20:10:55,713 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,718,115 trades
2025-12-24 20:10:55,713 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,718,115 rows
2025-12-24 20:12:28,763 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,844,793 trades
2025-12-24 20:12:28,763 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,844,793 rows
2025-12-24 20:13:02,412 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,498,135 trades
2025-12-24 20:13:02,413 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,498,135 rows
2025-12-24 20:13:44,608 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,243,935 trades
2025-12-24 20:13:44,608 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,243,935 rows
2025-12-24 20:14:17,604 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,984,871 trades
2025-12-24 20:14:17,604 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,984,871 rows
2025-12-24 20:16:29,693 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,577,802 trades
2025-12-24 20:16:29,693 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,577,802 rows
2025-12-24 20:18:14,999 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,189,068 trades
2025-12-24 20:18:14,999 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,189,068 rows
2025-12-24 20:20:16,558 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,942,686 trades
2025-12-24 20:20:16,558 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,942,686 rows
2025-12-24 20:23:03,141 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,072,099 trades
2025-12-24 20:23:03,141 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,072,099 rows
2025-12-24 20:23:03,569 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,067,673 total rows written
2025-12-24 20:24:02,260 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,064,828 trades
2025-12-24 20:24:02,260 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,064,828 rows
2025-12-24 20:24:02,577 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,132,501 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-01
2025-12-24 20:24:02,578 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 20:24:02,578 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 20:24:02,578 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 20:24:02,578 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 20:24:02,578 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 20:24:02,578 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 20:24:02,578 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 20:24:04,348 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 20:24:04,349 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-01...
2025-12-24 20:24:04,465 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240401 for 519 symbols
2025-12-24 20:25:46,928 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,584,927 NBBO records
2025-12-24 20:25:46,928 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,584,927 rows
2025-12-24 20:26:19,718 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,063,178 NBBO records
2025-12-24 20:26:19,718 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,063,178 rows
2025-12-24 20:27:01,443 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,832,208 NBBO records
2025-12-24 20:27:01,444 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,832,208 rows
2025-12-24 20:27:40,096 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,889,599 NBBO records
2025-12-24 20:27:40,096 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,889,599 rows
2025-12-24 20:28:36,588 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,785,824 NBBO records
2025-12-24 20:28:36,588 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,785,824 rows
2025-12-24 20:31:34,708 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,801,819 NBBO records
2025-12-24 20:31:34,708 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,801,819 rows
2025-12-24 20:34:19,826 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,907,314 NBBO records
2025-12-24 20:34:19,826 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,907,314 rows
2025-12-24 20:38:10,907 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,698,558 NBBO records
2025-12-24 20:38:10,907 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,698,558 rows
2025-12-24 20:41:23,503 INFO [src.stage_a.wrds_extractor]   Chunk 9: 5,508,142 NBBO records
2025-12-24 20:41:23,503 INFO [src.stage_a.parquet_writer]   Chunk 9: 5,508,142 rows
2025-12-24 20:44:07,082 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,250,131 NBBO records
2025-12-24 20:44:07,083 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,250,131 rows
2025-12-24 20:44:07,428 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 43,321,700 total rows written
2025-12-24 20:47:58,934 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,730,945 NBBO records
2025-12-24 20:47:58,934 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,730,945 rows
2025-12-24 20:47:59,463 INFO [src.stage_a.parquet_writer] ✓ Wrote 49,052,645 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-01
2025-12-24 20:47:59,468 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 20:47:59,468 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 20:47:59,468 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 20:47:59,468 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 20:47:59,468 INFO [src.stage_a.stage_a] Trades: 24,132,501 rows
2025-12-24 20:47:59,468 INFO [src.stage_a.stage_a] Nbbo: 49,052,645 rows
2025-12-24 20:47:59,468 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 20:47:59,468 INFO [src.stage_a.stage_a] Processing date 63/83: 2024-04-02
2025-12-24 20:47:59,468 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 20:47:59,468 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 20:47:59,468 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-04-02 (519 symbols)
2025-12-24 20:47:59,468 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 20:47:59,468 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 20:47:59,468 INFO [src.stage_a.stage_a] Extract run ID: 50c902ba-1f90-4a3f-8604-61a119b1a247
2025-12-24 20:47:59,476 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 20:47:59,476 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 20:47:59,476 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 20:47:59,476 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 20:47:59,476 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 20:47:59,476 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 20:47:59,476 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 20:47:59,476 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 20:47:59,476 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 20:48:00,631 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 20:48:00,632 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-02...
2025-12-24 20:48:00,713 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240402 for 519 symbols
2025-12-24 20:51:00,520 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,036,314 trades
2025-12-24 20:51:00,520 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,036,314 rows
2025-12-24 20:52:19,888 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,800,451 trades
2025-12-24 20:52:19,889 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,800,451 rows
2025-12-24 20:54:11,621 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,153,834 trades
2025-12-24 20:54:11,621 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,153,834 rows
2025-12-24 20:55:37,343 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,768,530 trades
2025-12-24 20:55:37,343 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,768,530 rows
2025-12-24 20:57:27,095 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,402,208 trades
2025-12-24 20:57:27,095 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,402,208 rows
2025-12-24 20:59:31,103 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,164,794 trades
2025-12-24 20:59:31,103 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,164,794 rows
2025-12-24 21:02:30,337 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,414,007 trades
2025-12-24 21:02:30,337 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,414,007 rows
2025-12-24 21:04:32,042 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,413,190 trades
2025-12-24 21:04:32,042 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,413,190 rows
2025-12-24 21:06:56,324 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,308,305 trades
2025-12-24 21:06:56,324 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,308,305 rows
2025-12-24 21:10:09,151 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,657,299 trades
2025-12-24 21:10:09,151 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,657,299 rows
2025-12-24 21:10:09,614 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,118,932 total rows written
2025-12-24 21:11:20,647 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,277,751 trades
2025-12-24 21:11:20,647 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,277,751 rows
2025-12-24 21:11:21,037 INFO [src.stage_a.parquet_writer] ✓ Wrote 26,396,683 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-02
2025-12-24 21:11:21,040 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 21:11:21,040 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 21:11:21,040 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 21:11:21,040 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 21:11:21,040 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 21:11:21,040 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 21:11:21,040 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 21:11:22,805 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 21:11:22,805 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-02...
2025-12-24 21:11:22,970 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240402 for 519 symbols
2025-12-24 21:14:28,112 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,951,052 NBBO records
2025-12-24 21:14:28,113 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,951,052 rows
2025-12-24 21:16:31,207 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,984,310 NBBO records
2025-12-24 21:16:31,207 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,984,310 rows
2025-12-24 21:18:50,517 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,883,421 NBBO records
2025-12-24 21:18:50,517 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,883,421 rows
2025-12-24 21:20:46,805 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,078,906 NBBO records
2025-12-24 21:20:46,805 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,078,906 rows
2025-12-24 21:23:37,843 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,359,705 NBBO records
2025-12-24 21:23:37,843 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,359,705 rows
2025-12-24 21:26:21,654 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,090,974 NBBO records
2025-12-24 21:26:21,654 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,090,974 rows
2025-12-24 21:29:13,786 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,595,215 NBBO records
2025-12-24 21:29:13,786 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,595,215 rows
2025-12-24 21:33:26,082 INFO [src.stage_a.wrds_extractor]   Chunk 8: 6,728,589 NBBO records
2025-12-24 21:33:26,082 INFO [src.stage_a.parquet_writer]   Chunk 8: 6,728,589 rows
2025-12-24 21:37:17,720 INFO [src.stage_a.wrds_extractor]   Chunk 9: 5,862,244 NBBO records
2025-12-24 21:37:17,721 INFO [src.stage_a.parquet_writer]   Chunk 9: 5,862,244 rows
2025-12-24 21:39:43,990 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,246,729 NBBO records
2025-12-24 21:39:43,991 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,246,729 rows
2025-12-24 21:39:44,320 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 44,781,145 total rows written
2025-12-24 21:44:08,686 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,179,348 NBBO records
2025-12-24 21:44:08,686 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,179,348 rows
2025-12-24 21:44:09,341 INFO [src.stage_a.parquet_writer] ✓ Wrote 51,960,493 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-02
2025-12-24 21:44:09,360 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 21:44:09,360 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 21:44:09,360 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 21:44:09,360 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 21:44:09,360 INFO [src.stage_a.stage_a] Trades: 26,396,683 rows
2025-12-24 21:44:09,360 INFO [src.stage_a.stage_a] Nbbo: 51,960,493 rows
2025-12-24 21:44:09,360 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 21:44:09,360 INFO [src.stage_a.stage_a] Processing date 64/83: 2024-04-03
2025-12-24 21:44:09,360 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 21:44:09,360 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 21:44:09,360 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-04-03 (519 symbols)
2025-12-24 21:44:09,360 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 21:44:09,360 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 21:44:09,360 INFO [src.stage_a.stage_a] Extract run ID: c6b59edd-9360-42e9-97a6-7ef489eb9a53
2025-12-24 21:44:09,369 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 21:44:09,369 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 21:44:09,369 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 21:44:09,369 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 21:44:09,369 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 21:44:09,369 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 21:44:09,369 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 21:44:09,369 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 21:44:09,369 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 21:44:11,453 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 21:44:11,453 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-03...
2025-12-24 21:44:11,594 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240403 for 519 symbols
2025-12-24 21:47:28,297 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,875,199 trades
2025-12-24 21:47:28,297 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,875,199 rows
2025-12-24 21:49:12,312 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,878,530 trades
2025-12-24 21:49:12,312 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,878,530 rows
2025-12-24 21:51:23,981 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,125,123 trades
2025-12-24 21:51:23,981 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,125,123 rows
2025-12-24 21:53:08,227 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,833,197 trades
2025-12-24 21:53:08,227 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,833,197 rows
2025-12-24 21:55:17,394 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,598,800 trades
2025-12-24 21:55:17,394 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,598,800 rows
2025-12-24 21:57:22,600 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,125,731 trades
2025-12-24 21:57:22,600 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,125,731 rows
2025-12-24 22:00:31,161 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,399,156 trades
2025-12-24 22:00:31,161 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,399,156 rows
2025-12-24 22:03:06,288 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,507,407 trades
2025-12-24 22:03:06,288 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,507,407 rows
2025-12-24 22:05:24,195 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,108,588 trades
2025-12-24 22:05:24,195 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,108,588 rows
2025-12-24 22:08:17,766 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,128,363 trades
2025-12-24 22:08:17,766 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,128,363 rows
2025-12-24 22:08:18,192 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 24,580,094 total rows written
2025-12-24 22:09:22,390 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,087,792 trades
2025-12-24 22:09:22,390 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,087,792 rows
2025-12-24 22:09:22,723 INFO [src.stage_a.parquet_writer] ✓ Wrote 25,667,886 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-03
2025-12-24 22:09:22,724 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 22:09:22,724 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 22:09:22,724 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 22:09:22,724 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 22:09:22,724 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 22:09:22,724 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 22:09:22,724 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 22:09:25,237 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 22:09:25,237 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-03...
2025-12-24 22:09:25,341 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240403 for 519 symbols
2025-12-24 22:12:05,678 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,509,808 NBBO records
2025-12-24 22:12:05,678 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,509,808 rows
2025-12-24 22:14:06,218 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,151,801 NBBO records
2025-12-24 22:14:06,219 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,151,801 rows
2025-12-24 22:16:24,957 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,069,139 NBBO records
2025-12-24 22:16:24,958 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,069,139 rows
2025-12-24 22:18:19,323 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,892,827 NBBO records
2025-12-24 22:18:19,323 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,892,827 rows
2025-12-24 22:21:29,401 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,693,415 NBBO records
2025-12-24 22:21:29,401 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,693,415 rows
2025-12-24 22:23:57,908 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,058,484 NBBO records
2025-12-24 22:23:57,908 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,058,484 rows
2025-12-24 22:26:39,342 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,640,013 NBBO records
2025-12-24 22:26:39,343 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,640,013 rows
2025-12-24 22:29:58,467 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,703,654 NBBO records
2025-12-24 22:29:58,467 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,703,654 rows
2025-12-24 22:33:27,072 INFO [src.stage_a.wrds_extractor]   Chunk 9: 6,042,135 NBBO records
2025-12-24 22:33:27,072 INFO [src.stage_a.parquet_writer]   Chunk 9: 6,042,135 rows
2025-12-24 22:36:05,698 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,405,485 NBBO records
2025-12-24 22:36:05,699 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,405,485 rows
2025-12-24 22:36:06,060 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 44,166,761 total rows written
2025-12-24 22:40:31,268 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,571,434 NBBO records
2025-12-24 22:40:31,268 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,571,434 rows
2025-12-24 22:40:31,871 INFO [src.stage_a.parquet_writer] ✓ Wrote 50,738,195 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-03
2025-12-24 22:40:31,882 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 22:40:31,882 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 22:40:31,882 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 22:40:31,882 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 22:40:31,882 INFO [src.stage_a.stage_a] Trades: 25,667,886 rows
2025-12-24 22:40:31,882 INFO [src.stage_a.stage_a] Nbbo: 50,738,195 rows
2025-12-24 22:40:31,882 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 22:40:31,882 INFO [src.stage_a.stage_a] Processing date 65/83: 2024-04-04
2025-12-24 22:40:31,882 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 22:40:31,882 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 22:40:31,882 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-04-04 (519 symbols)
2025-12-24 22:40:31,882 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 22:40:31,882 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 22:40:31,882 INFO [src.stage_a.stage_a] Extract run ID: e55f3f0b-2af8-4fa7-89ec-a144eefdffa5
2025-12-24 22:40:31,890 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 22:40:31,890 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 22:40:31,890 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 22:40:31,890 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 22:40:31,891 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 22:40:31,891 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 22:40:31,891 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 22:40:31,891 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 22:40:31,891 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 22:40:34,153 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 22:40:34,153 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-04...
2025-12-24 22:40:34,299 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240404 for 519 symbols
2025-12-24 22:44:13,646 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,630,444 trades
2025-12-24 22:44:13,646 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,630,444 rows
2025-12-24 22:46:08,855 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,032,031 trades
2025-12-24 22:46:08,856 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,032,031 rows
2025-12-24 22:48:18,765 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,222,863 trades
2025-12-24 22:48:18,765 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,222,863 rows
2025-12-24 22:50:03,074 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,924,825 trades
2025-12-24 22:50:03,074 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,924,825 rows
2025-12-24 22:52:26,372 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,695,152 trades
2025-12-24 22:52:26,373 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,695,152 rows
2025-12-24 22:54:48,929 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,458,914 trades
2025-12-24 22:54:48,929 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,458,914 rows
2025-12-24 22:58:24,005 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,932,192 trades
2025-12-24 22:58:24,005 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,932,192 rows
2025-12-24 23:01:07,879 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,686,684 trades
2025-12-24 23:01:07,886 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,686,684 rows
2025-12-24 23:03:25,637 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,551,096 trades
2025-12-24 23:03:25,637 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,551,096 rows
2025-12-24 23:06:13,035 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,365,126 trades
2025-12-24 23:06:13,035 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,365,126 rows
2025-12-24 23:06:13,496 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 27,499,327 total rows written
2025-12-24 23:07:31,712 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,301,652 trades
2025-12-24 23:07:31,712 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,301,652 rows
2025-12-24 23:07:32,083 INFO [src.stage_a.parquet_writer] ✓ Wrote 28,800,979 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-04
2025-12-24 23:07:32,086 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 23:07:32,086 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 23:07:32,087 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-24 23:07:32,087 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 23:07:32,087 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 23:07:32,087 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 23:07:32,087 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 23:07:33,822 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 23:07:33,822 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-04...
2025-12-24 23:07:33,890 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240404 for 519 symbols
2025-12-24 23:11:02,195 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,707,995 NBBO records
2025-12-24 23:11:02,195 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,707,995 rows
2025-12-24 23:13:15,200 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,905,890 NBBO records
2025-12-24 23:13:15,200 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,905,890 rows
2025-12-24 23:16:23,785 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,090,508 NBBO records
2025-12-24 23:16:23,785 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,090,508 rows
2025-12-24 23:18:22,342 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,703,191 NBBO records
2025-12-24 23:18:22,343 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,703,191 rows
2025-12-24 23:21:45,981 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,979,745 NBBO records
2025-12-24 23:21:45,982 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,979,745 rows
2025-12-24 23:24:22,767 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,203,588 NBBO records
2025-12-24 23:24:22,767 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,203,588 rows
2025-12-24 23:27:42,558 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,788,303 NBBO records
2025-12-24 23:27:42,563 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,788,303 rows
2025-12-24 23:32:20,193 INFO [src.stage_a.wrds_extractor]   Chunk 8: 8,297,919 NBBO records
2025-12-24 23:32:20,193 INFO [src.stage_a.parquet_writer]   Chunk 8: 8,297,919 rows
2025-12-24 23:36:58,619 INFO [src.stage_a.wrds_extractor]   Chunk 9: 8,267,577 NBBO records
2025-12-24 23:36:58,626 INFO [src.stage_a.parquet_writer]   Chunk 9: 8,267,577 rows
2025-12-24 23:39:54,091 INFO [src.stage_a.wrds_extractor]   Chunk 10: 5,187,445 NBBO records
2025-12-24 23:39:54,097 INFO [src.stage_a.parquet_writer]   Chunk 10: 5,187,445 rows
2025-12-24 23:39:54,466 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 57,132,161 total rows written
2025-12-24 23:45:58,561 INFO [src.stage_a.wrds_extractor]   Chunk 11: 9,239,612 NBBO records
2025-12-24 23:45:58,561 INFO [src.stage_a.parquet_writer]   Chunk 11: 9,239,612 rows
2025-12-24 23:45:59,363 INFO [src.stage_a.parquet_writer] ✓ Wrote 66,371,773 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-04
2025-12-24 23:45:59,376 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-24 23:45:59,376 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 23:45:59,376 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-24 23:45:59,376 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 23:45:59,376 INFO [src.stage_a.stage_a] Trades: 28,800,979 rows
2025-12-24 23:45:59,376 INFO [src.stage_a.stage_a] Nbbo: 66,371,773 rows
2025-12-24 23:45:59,376 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 23:45:59,376 INFO [src.stage_a.stage_a] Processing date 66/83: 2024-04-05
2025-12-24 23:45:59,376 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 23:45:59,376 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 23:45:59,376 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-04-05 (519 symbols)
2025-12-24 23:45:59,376 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-24 23:45:59,376 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 23:45:59,376 INFO [src.stage_a.stage_a] Extract run ID: 789fafa7-8031-4202-acf6-e39c1d546905
2025-12-24 23:45:59,385 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-24 23:45:59,385 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-24 23:45:59,385 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-24 23:45:59,385 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-24 23:45:59,385 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-24 23:45:59,385 INFO [src.stage_a.stage_a] ================================================================================
2025-12-24 23:45:59,385 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-24 23:45:59,385 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-24 23:45:59,385 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-24 23:46:01,062 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-24 23:46:01,063 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-05...
2025-12-24 23:46:01,195 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240405 for 519 symbols
2025-12-24 23:48:30,625 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,123,090 trades
2025-12-24 23:48:30,625 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,123,090 rows
2025-12-24 23:50:15,373 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,815,819 trades
2025-12-24 23:50:15,373 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,815,819 rows
2025-12-24 23:51:54,470 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,901,654 trades
2025-12-24 23:51:54,470 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,901,654 rows
2025-12-24 23:53:17,147 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,707,346 trades
2025-12-24 23:53:17,148 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,707,346 rows
2025-12-24 23:55:33,092 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,353,347 trades
2025-12-24 23:55:33,092 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,353,347 rows
2025-12-24 23:57:35,879 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,134,645 trades
2025-12-24 23:57:35,879 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,134,645 rows
2025-12-25 00:00:48,628 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,417,110 trades
2025-12-25 00:00:48,628 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,417,110 rows
2025-12-25 00:03:02,823 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,445,173 trades
2025-12-25 00:03:02,823 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,445,173 rows
2025-12-25 00:04:44,819 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,226,942 trades
2025-12-25 00:04:44,819 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,226,942 rows
2025-12-25 00:07:47,328 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,463,032 trades
2025-12-25 00:07:47,328 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,463,032 rows
2025-12-25 00:07:47,745 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 24,588,158 total rows written
2025-12-25 00:08:52,236 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,199,850 trades
2025-12-25 00:08:52,236 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,199,850 rows
2025-12-25 00:08:52,565 INFO [src.stage_a.parquet_writer] ✓ Wrote 25,788,008 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-05
2025-12-25 00:08:52,565 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 00:08:52,565 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 00:08:52,565 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 00:08:52,565 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 00:08:52,565 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 00:08:52,565 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 00:08:52,565 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 00:08:54,460 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 00:08:54,460 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-05...
2025-12-25 00:08:54,590 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240405 for 519 symbols
2025-12-25 00:11:57,885 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,306,425 NBBO records
2025-12-25 00:11:57,895 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,306,425 rows
2025-12-25 00:14:36,826 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,783,904 NBBO records
2025-12-25 00:14:36,826 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,783,904 rows
2025-12-25 00:17:46,756 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,999,994 NBBO records
2025-12-25 00:17:46,756 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,999,994 rows
2025-12-25 00:19:52,918 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,255,289 NBBO records
2025-12-25 00:19:52,918 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,255,289 rows
2025-12-25 00:23:13,139 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,666,422 NBBO records
2025-12-25 00:23:13,139 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,666,422 rows
2025-12-25 00:26:02,673 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,743,846 NBBO records
2025-12-25 00:26:02,674 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,743,846 rows
2025-12-25 00:28:56,235 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,316,419 NBBO records
2025-12-25 00:28:56,235 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,316,419 rows
2025-12-25 00:33:38,475 INFO [src.stage_a.wrds_extractor]   Chunk 8: 8,141,883 NBBO records
2025-12-25 00:33:38,475 INFO [src.stage_a.parquet_writer]   Chunk 8: 8,141,883 rows
2025-12-25 00:37:43,671 INFO [src.stage_a.wrds_extractor]   Chunk 9: 7,517,127 NBBO records
2025-12-25 00:37:43,674 INFO [src.stage_a.parquet_writer]   Chunk 9: 7,517,127 rows
2025-12-25 00:40:26,645 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,923,392 NBBO records
2025-12-25 00:40:26,654 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,923,392 rows
2025-12-25 00:40:27,022 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 53,654,701 total rows written
2025-12-25 00:46:25,658 INFO [src.stage_a.wrds_extractor]   Chunk 11: 9,799,076 NBBO records
2025-12-25 00:46:25,658 INFO [src.stage_a.parquet_writer]   Chunk 11: 9,799,076 rows
2025-12-25 00:46:26,538 INFO [src.stage_a.parquet_writer] ✓ Wrote 63,453,777 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-05
2025-12-25 00:46:26,563 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 00:46:26,563 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 00:46:26,563 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 00:46:26,563 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 00:46:26,563 INFO [src.stage_a.stage_a] Trades: 25,788,008 rows
2025-12-25 00:46:26,563 INFO [src.stage_a.stage_a] Nbbo: 63,453,777 rows
2025-12-25 00:46:26,563 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 00:46:26,563 INFO [src.stage_a.stage_a] Processing date 67/83: 2024-04-08
2025-12-25 00:46:26,563 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 00:46:26,563 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 00:46:26,563 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-04-08 (519 symbols)
2025-12-25 00:46:26,563 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 00:46:26,563 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 00:46:26,563 INFO [src.stage_a.stage_a] Extract run ID: c52f06e0-eda0-4d39-9b9c-66d3755fb9b3
2025-12-25 00:46:26,571 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 00:46:26,571 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 00:46:26,571 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 00:46:26,571 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 00:46:26,571 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 00:46:26,571 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 00:46:26,571 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 00:46:26,571 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 00:46:26,571 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 00:46:29,366 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 00:46:29,366 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-08...
2025-12-25 00:46:29,547 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240408 for 519 symbols
2025-12-25 00:49:08,497 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,838,917 trades
2025-12-25 00:49:08,497 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,838,917 rows
2025-12-25 00:50:34,624 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,701,841 trades
2025-12-25 00:50:34,624 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,701,841 rows
2025-12-25 00:51:51,992 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,772,474 trades
2025-12-25 00:51:51,992 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,772,474 rows
2025-12-25 00:53:16,769 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,502,866 trades
2025-12-25 00:53:16,770 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,502,866 rows
2025-12-25 00:54:51,137 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,165,237 trades
2025-12-25 00:54:51,137 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,165,237 rows
2025-12-25 00:56:21,387 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,947,548 trades
2025-12-25 00:56:21,387 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,947,548 rows
2025-12-25 00:58:53,318 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,101,057 trades
2025-12-25 00:58:53,318 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,101,057 rows
2025-12-25 01:00:39,234 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,064,546 trades
2025-12-25 01:00:39,234 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,064,546 rows
2025-12-25 01:02:05,408 INFO [src.stage_a.wrds_extractor]   Chunk 9: 1,981,556 trades
2025-12-25 01:02:05,409 INFO [src.stage_a.parquet_writer]   Chunk 9: 1,981,556 rows
2025-12-25 01:04:32,680 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,995,961 trades
2025-12-25 01:04:32,680 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,995,961 rows
2025-12-25 01:04:33,104 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 22,072,003 total rows written
2025-12-25 01:05:11,222 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,019,185 trades
2025-12-25 01:05:11,222 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,019,185 rows
2025-12-25 01:05:11,541 INFO [src.stage_a.parquet_writer] ✓ Wrote 23,091,188 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-08
2025-12-25 01:05:11,542 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 01:05:11,542 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 01:05:11,542 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 01:05:11,542 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 01:05:11,542 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 01:05:11,542 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 01:05:11,542 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 01:05:13,309 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 01:05:13,309 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-08...
2025-12-25 01:05:13,448 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240408 for 519 symbols
2025-12-25 01:07:31,456 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,433,025 NBBO records
2025-12-25 01:07:31,456 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,433,025 rows
2025-12-25 01:09:08,036 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,768,902 NBBO records
2025-12-25 01:09:08,037 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,768,902 rows
2025-12-25 01:10:38,953 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,630,008 NBBO records
2025-12-25 01:10:38,953 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,630,008 rows
2025-12-25 01:12:02,643 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,474,017 NBBO records
2025-12-25 01:12:02,643 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,474,017 rows
2025-12-25 01:14:30,135 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,576,870 NBBO records
2025-12-25 01:14:30,135 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,576,870 rows
2025-12-25 01:16:22,835 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,014,809 NBBO records
2025-12-25 01:16:22,835 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,014,809 rows
2025-12-25 01:18:23,689 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,007,746 NBBO records
2025-12-25 01:18:23,689 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,007,746 rows
2025-12-25 01:21:15,527 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,077,612 NBBO records
2025-12-25 01:21:15,527 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,077,612 rows
2025-12-25 01:24:14,736 INFO [src.stage_a.wrds_extractor]   Chunk 9: 6,014,874 NBBO records
2025-12-25 01:24:14,737 INFO [src.stage_a.parquet_writer]   Chunk 9: 6,014,874 rows
2025-12-25 01:26:18,720 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,912,122 NBBO records
2025-12-25 01:26:18,721 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,912,122 rows
2025-12-25 01:26:19,043 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 40,909,985 total rows written
2025-12-25 01:30:09,956 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,129,436 NBBO records
2025-12-25 01:30:09,956 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,129,436 rows
2025-12-25 01:30:10,582 INFO [src.stage_a.parquet_writer] ✓ Wrote 48,039,421 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-08
2025-12-25 01:30:10,590 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 01:30:10,590 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 01:30:10,590 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 01:30:10,590 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 01:30:10,590 INFO [src.stage_a.stage_a] Trades: 23,091,188 rows
2025-12-25 01:30:10,590 INFO [src.stage_a.stage_a] Nbbo: 48,039,421 rows
2025-12-25 01:30:10,590 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 01:30:10,590 INFO [src.stage_a.stage_a] Processing date 68/83: 2024-04-09
2025-12-25 01:30:10,590 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 01:30:10,590 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 01:30:10,590 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-04-09 (519 symbols)
2025-12-25 01:30:10,590 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 01:30:10,590 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 01:30:10,590 INFO [src.stage_a.stage_a] Extract run ID: 8ef2187b-140c-4347-891c-dea08cbab5fb
2025-12-25 01:30:10,598 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 01:30:10,598 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 01:30:10,598 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 01:30:10,598 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 01:30:10,598 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 01:30:10,598 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 01:30:10,598 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 01:30:10,598 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 01:30:10,598 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 01:30:12,808 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 01:30:12,808 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-09...
2025-12-25 01:30:12,913 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240409 for 519 symbols
2025-12-25 01:32:21,764 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,891,921 trades
2025-12-25 01:32:21,764 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,891,921 rows
2025-12-25 01:33:46,110 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,791,809 trades
2025-12-25 01:33:46,110 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,791,809 rows
2025-12-25 01:35:13,423 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,855,730 trades
2025-12-25 01:35:13,424 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,855,730 rows
2025-12-25 01:36:38,502 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,670,736 trades
2025-12-25 01:36:38,502 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,670,736 rows
2025-12-25 01:38:40,395 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,543,699 trades
2025-12-25 01:38:40,395 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,543,699 rows
2025-12-25 01:40:17,796 INFO [src.stage_a.wrds_extractor]   Chunk 6: 1,933,999 trades
2025-12-25 01:40:17,796 INFO [src.stage_a.parquet_writer]   Chunk 6: 1,933,999 rows
2025-12-25 01:42:53,024 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,580,546 trades
2025-12-25 01:42:53,024 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,580,546 rows
2025-12-25 01:44:26,907 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,323,824 trades
2025-12-25 01:44:26,908 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,323,824 rows
2025-12-25 01:46:18,598 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,091,210 trades
2025-12-25 01:46:18,598 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,091,210 rows
2025-12-25 01:48:31,589 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,831,370 trades
2025-12-25 01:48:31,589 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,831,370 rows
2025-12-25 01:48:31,976 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 23,514,844 total rows written
2025-12-25 01:49:21,530 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,134,509 trades
2025-12-25 01:49:21,530 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,134,509 rows
2025-12-25 01:49:21,849 INFO [src.stage_a.parquet_writer] ✓ Wrote 24,649,353 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-09
2025-12-25 01:49:21,850 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 01:49:21,850 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 01:49:21,850 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 01:49:21,850 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 01:49:21,850 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 01:49:21,850 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 01:49:21,850 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 01:49:23,183 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 01:49:23,183 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-09...
2025-12-25 01:49:23,300 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240409 for 519 symbols
2025-12-25 01:53:29,200 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,300,054 NBBO records
2025-12-25 01:53:29,200 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,300,054 rows
2025-12-25 01:55:53,589 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,198,220 NBBO records
2025-12-25 01:55:53,589 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,198,220 rows
2025-12-25 01:58:57,950 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,657,421 NBBO records
2025-12-25 01:58:57,950 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,657,421 rows
2025-12-25 02:01:10,511 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,197,924 NBBO records
2025-12-25 02:01:10,511 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,197,924 rows
2025-12-25 02:04:40,157 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,087,339 NBBO records
2025-12-25 02:04:40,157 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,087,339 rows
2025-12-25 02:08:04,068 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,579,884 NBBO records
2025-12-25 02:08:04,068 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,579,884 rows
2025-12-25 02:11:04,880 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,075,735 NBBO records
2025-12-25 02:11:04,880 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,075,735 rows
2025-12-25 02:16:15,387 INFO [src.stage_a.wrds_extractor]   Chunk 8: 7,019,763 NBBO records
2025-12-25 02:16:15,387 INFO [src.stage_a.parquet_writer]   Chunk 8: 7,019,763 rows
2025-12-25 02:19:49,091 INFO [src.stage_a.wrds_extractor]   Chunk 9: 6,469,507 NBBO records
2025-12-25 02:19:49,099 INFO [src.stage_a.parquet_writer]   Chunk 9: 6,469,507 rows
2025-12-25 02:22:13,960 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,209,916 NBBO records
2025-12-25 02:22:13,961 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,209,916 rows
2025-12-25 02:22:14,321 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 48,795,763 total rows written
2025-12-25 02:26:57,561 INFO [src.stage_a.wrds_extractor]   Chunk 11: 8,120,910 NBBO records
2025-12-25 02:26:57,561 INFO [src.stage_a.parquet_writer]   Chunk 11: 8,120,910 rows
2025-12-25 02:26:58,249 INFO [src.stage_a.parquet_writer] ✓ Wrote 56,916,673 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-09
2025-12-25 02:26:58,254 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 02:26:58,254 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 02:26:58,254 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 02:26:58,254 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 02:26:58,254 INFO [src.stage_a.stage_a] Trades: 24,649,353 rows
2025-12-25 02:26:58,254 INFO [src.stage_a.stage_a] Nbbo: 56,916,673 rows
2025-12-25 02:26:58,254 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 02:26:58,254 INFO [src.stage_a.stage_a] Processing date 69/83: 2024-04-10
2025-12-25 02:26:58,254 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 02:26:58,255 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 02:26:58,255 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-04-10 (519 symbols)
2025-12-25 02:26:58,255 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 02:26:58,255 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 02:26:58,255 INFO [src.stage_a.stage_a] Extract run ID: 95f54413-e3b6-4f8c-b4ff-d9753343637e
2025-12-25 02:26:58,263 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 02:26:58,263 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 02:26:58,263 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 02:26:58,263 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 02:26:58,263 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 02:26:58,263 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 02:26:58,263 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 02:26:58,263 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 02:26:58,263 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 02:27:01,010 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 02:27:01,011 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-10...
2025-12-25 02:27:01,219 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240410 for 519 symbols
2025-12-25 02:29:45,858 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,405,481 trades
2025-12-25 02:29:45,858 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,405,481 rows
2025-12-25 02:31:51,967 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,202,497 trades
2025-12-25 02:31:51,967 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,202,497 rows
2025-12-25 02:33:55,963 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,255,563 trades
2025-12-25 02:33:55,963 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,255,563 rows
2025-12-25 02:35:32,421 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,875,227 trades
2025-12-25 02:35:32,421 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,875,227 rows
2025-12-25 02:37:45,955 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,565,814 trades
2025-12-25 02:37:45,955 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,565,814 rows
2025-12-25 02:39:59,067 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,592,033 trades
2025-12-25 02:39:59,067 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,592,033 rows
2025-12-25 02:43:11,339 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,577,058 trades
2025-12-25 02:43:11,339 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,577,058 rows
2025-12-25 02:46:22,469 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,879,161 trades
2025-12-25 02:46:22,469 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,879,161 rows
2025-12-25 02:49:29,418 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,581,483 trades
2025-12-25 02:49:29,418 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,581,483 rows
2025-12-25 02:53:20,649 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,285,155 trades
2025-12-25 02:53:20,649 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,285,155 rows
2025-12-25 02:53:21,079 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 27,219,472 total rows written
2025-12-25 02:54:48,935 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,489,839 trades
2025-12-25 02:54:48,936 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,489,839 rows
2025-12-25 02:54:49,357 INFO [src.stage_a.parquet_writer] ✓ Wrote 28,709,311 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-10
2025-12-25 02:54:49,360 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 02:54:49,360 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 02:54:49,360 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 02:54:49,360 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 02:54:49,361 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 02:54:49,361 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 02:54:49,361 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 02:54:51,556 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 02:54:51,556 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-10...
2025-12-25 02:54:51,681 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240410 for 519 symbols
2025-12-25 02:58:38,093 INFO [src.stage_a.wrds_extractor]   Chunk 1: 6,066,027 NBBO records
2025-12-25 02:58:38,093 INFO [src.stage_a.parquet_writer]   Chunk 1: 6,066,027 rows
2025-12-25 03:01:21,983 INFO [src.stage_a.wrds_extractor]   Chunk 2: 4,506,893 NBBO records
2025-12-25 03:01:21,983 INFO [src.stage_a.parquet_writer]   Chunk 2: 4,506,893 rows
2025-12-25 03:05:14,649 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,690,124 NBBO records
2025-12-25 03:05:14,649 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,690,124 rows
2025-12-25 03:07:47,417 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,782,708 NBBO records
2025-12-25 03:07:47,418 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,782,708 rows
2025-12-25 03:11:10,695 INFO [src.stage_a.wrds_extractor]   Chunk 5: 6,338,840 NBBO records
2025-12-25 03:11:10,695 INFO [src.stage_a.parquet_writer]   Chunk 5: 6,338,840 rows
2025-12-25 03:14:19,823 INFO [src.stage_a.wrds_extractor]   Chunk 6: 6,010,046 NBBO records
2025-12-25 03:14:19,824 INFO [src.stage_a.parquet_writer]   Chunk 6: 6,010,046 rows
2025-12-25 03:17:24,665 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,230,614 NBBO records
2025-12-25 03:17:24,666 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,230,614 rows
2025-12-25 03:22:41,043 INFO [src.stage_a.wrds_extractor]   Chunk 8: 10,003,407 NBBO records
2025-12-25 03:22:41,044 INFO [src.stage_a.parquet_writer]   Chunk 8: 10,003,407 rows
2025-12-25 03:26:44,074 INFO [src.stage_a.wrds_extractor]   Chunk 9: 8,166,323 NBBO records
2025-12-25 03:26:44,085 INFO [src.stage_a.parquet_writer]   Chunk 9: 8,166,323 rows
2025-12-25 03:29:39,894 INFO [src.stage_a.wrds_extractor]   Chunk 10: 5,970,435 NBBO records
2025-12-25 03:29:39,898 INFO [src.stage_a.parquet_writer]   Chunk 10: 5,970,435 rows
2025-12-25 03:29:40,312 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 62,765,417 total rows written
2025-12-25 03:35:05,838 INFO [src.stage_a.wrds_extractor]   Chunk 11: 10,178,037 NBBO records
2025-12-25 03:35:05,839 INFO [src.stage_a.parquet_writer]   Chunk 11: 10,178,037 rows
2025-12-25 03:35:06,682 INFO [src.stage_a.parquet_writer] ✓ Wrote 72,943,454 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-10
2025-12-25 03:35:06,696 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 03:35:06,696 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 03:35:06,696 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 03:35:06,696 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 03:35:06,696 INFO [src.stage_a.stage_a] Trades: 28,709,311 rows
2025-12-25 03:35:06,696 INFO [src.stage_a.stage_a] Nbbo: 72,943,454 rows
2025-12-25 03:35:06,696 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 03:35:06,696 INFO [src.stage_a.stage_a] Processing date 70/83: 2024-04-11
2025-12-25 03:35:06,696 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 03:35:06,696 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 03:35:06,696 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-04-11 (519 symbols)
2025-12-25 03:35:06,696 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 03:35:06,696 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 03:35:06,696 INFO [src.stage_a.stage_a] Extract run ID: 34a9b2eb-e674-4389-b6a8-b42c28379f50
2025-12-25 03:35:06,704 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 03:35:06,704 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 03:35:06,705 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 03:35:06,705 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 03:35:06,705 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 03:35:06,705 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 03:35:06,705 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 03:35:06,705 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 03:35:06,705 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 03:35:09,193 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 03:35:09,193 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-11...
2025-12-25 03:35:09,294 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240411 for 519 symbols
2025-12-25 03:37:37,321 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,278,039 trades
2025-12-25 03:37:37,322 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,278,039 rows
2025-12-25 03:39:24,223 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,941,335 trades
2025-12-25 03:39:24,223 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,941,335 rows
2025-12-25 03:40:44,043 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,902,431 trades
2025-12-25 03:40:44,043 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,902,431 rows
2025-12-25 03:42:02,292 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,590,776 trades
2025-12-25 03:42:02,292 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,590,776 rows
2025-12-25 03:44:18,401 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,618,778 trades
2025-12-25 03:44:18,401 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,618,778 rows
2025-12-25 03:46:05,731 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,303,830 trades
2025-12-25 03:46:05,731 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,303,830 rows
2025-12-25 03:48:49,358 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,537,381 trades
2025-12-25 03:48:49,358 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,537,381 rows
2025-12-25 03:50:37,936 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,371,906 trades
2025-12-25 03:50:37,937 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,371,906 rows
2025-12-25 03:52:19,819 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,251,831 trades
2025-12-25 03:52:19,819 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,251,831 rows
2025-12-25 03:54:59,658 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,036,903 trades
2025-12-25 03:54:59,658 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,036,903 rows
2025-12-25 03:55:00,090 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 24,833,210 total rows written
2025-12-25 03:55:54,877 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,117,218 trades
2025-12-25 03:55:54,878 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,117,218 rows
2025-12-25 03:55:55,193 INFO [src.stage_a.parquet_writer] ✓ Wrote 25,950,428 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-11
2025-12-25 03:55:55,194 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 03:55:55,194 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 03:55:55,194 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 03:55:55,194 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 03:55:55,194 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 03:55:55,194 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 03:55:55,194 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 03:55:57,874 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 03:55:57,874 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-11...
2025-12-25 03:55:58,053 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240411 for 519 symbols
2025-12-25 03:58:51,049 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,915,823 NBBO records
2025-12-25 03:58:51,049 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,915,823 rows
2025-12-25 04:00:39,526 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,447,269 NBBO records
2025-12-25 04:00:39,526 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,447,269 rows
2025-12-25 04:03:06,556 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,476,182 NBBO records
2025-12-25 04:03:06,556 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,476,182 rows
2025-12-25 04:05:25,618 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,155,213 NBBO records
2025-12-25 04:05:25,618 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,155,213 rows
2025-12-25 04:08:23,666 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,654,947 NBBO records
2025-12-25 04:08:23,666 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,654,947 rows
2025-12-25 04:11:21,848 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,131,029 NBBO records
2025-12-25 04:11:21,848 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,131,029 rows
2025-12-25 04:14:35,389 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,698,666 NBBO records
2025-12-25 04:14:35,389 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,698,666 rows
2025-12-25 04:18:25,402 INFO [src.stage_a.wrds_extractor]   Chunk 8: 6,305,565 NBBO records
2025-12-25 04:18:25,402 INFO [src.stage_a.parquet_writer]   Chunk 8: 6,305,565 rows
2025-12-25 04:23:14,544 INFO [src.stage_a.wrds_extractor]   Chunk 9: 7,149,805 NBBO records
2025-12-25 04:23:14,545 INFO [src.stage_a.parquet_writer]   Chunk 9: 7,149,805 rows
2025-12-25 04:26:26,458 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,681,341 NBBO records
2025-12-25 04:26:26,461 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,681,341 rows
2025-12-25 04:26:26,828 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 48,615,840 total rows written
2025-12-25 04:31:10,477 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,099,659 NBBO records
2025-12-25 04:31:10,477 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,099,659 rows
2025-12-25 04:31:11,115 INFO [src.stage_a.parquet_writer] ✓ Wrote 55,715,499 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-11
2025-12-25 04:31:11,124 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 04:31:11,124 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 04:31:11,124 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 04:31:11,124 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 04:31:11,124 INFO [src.stage_a.stage_a] Trades: 25,950,428 rows
2025-12-25 04:31:11,124 INFO [src.stage_a.stage_a] Nbbo: 55,715,499 rows
2025-12-25 04:31:11,124 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 04:31:11,124 INFO [src.stage_a.stage_a] Processing date 71/83: 2024-04-12
2025-12-25 04:31:11,124 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 04:31:11,124 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 04:31:11,124 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-04-12 (519 symbols)
2025-12-25 04:31:11,124 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 04:31:11,124 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 04:31:11,124 INFO [src.stage_a.stage_a] Extract run ID: 53cdd63b-fc27-4549-bdd3-73e389b12167
2025-12-25 04:31:11,132 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 04:31:11,132 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 04:31:11,132 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 04:31:11,132 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 04:31:11,132 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 04:31:11,132 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 04:31:11,132 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 04:31:11,132 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 04:31:11,132 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 04:31:13,316 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 04:31:13,316 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-12...
2025-12-25 04:31:13,480 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240412 for 519 symbols
2025-12-25 04:34:38,330 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,787,548 trades
2025-12-25 04:34:38,330 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,787,548 rows
2025-12-25 04:36:58,925 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,193,662 trades
2025-12-25 04:36:58,925 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,193,662 rows
2025-12-25 04:39:01,475 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,166,692 trades
2025-12-25 04:39:01,475 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,166,692 rows
2025-12-25 04:42:05,953 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,701,898 trades
2025-12-25 04:42:05,953 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,701,898 rows
2025-12-25 04:44:37,228 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,728,500 trades
2025-12-25 04:44:37,228 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,728,500 rows
2025-12-25 04:47:15,422 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,524,152 trades
2025-12-25 04:47:15,422 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,524,152 rows
2025-12-25 04:50:41,098 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,623,839 trades
2025-12-25 04:50:41,098 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,623,839 rows
2025-12-25 04:53:01,660 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,713,421 trades
2025-12-25 04:53:01,661 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,713,421 rows
2025-12-25 04:55:27,365 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,559,154 trades
2025-12-25 04:55:27,365 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,559,154 rows
2025-12-25 04:58:07,248 INFO [src.stage_a.wrds_extractor]   Chunk 10: 2,903,710 trades
2025-12-25 04:58:07,248 INFO [src.stage_a.parquet_writer]   Chunk 10: 2,903,710 rows
2025-12-25 04:58:07,649 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,902,576 total rows written
2025-12-25 04:59:22,289 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,602,963 trades
2025-12-25 04:59:22,289 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,602,963 rows
2025-12-25 04:59:22,725 INFO [src.stage_a.parquet_writer] ✓ Wrote 28,505,539 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-12
2025-12-25 04:59:22,732 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 04:59:22,732 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 04:59:22,732 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 04:59:22,732 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 04:59:22,732 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 04:59:22,732 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 04:59:22,733 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 04:59:24,618 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 04:59:24,618 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-12...
2025-12-25 04:59:24,722 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240412 for 519 symbols
2025-12-25 05:02:45,853 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,738,617 NBBO records
2025-12-25 05:02:45,853 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,738,617 rows
2025-12-25 05:04:51,848 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,592,189 NBBO records
2025-12-25 05:04:51,848 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,592,189 rows
2025-12-25 05:08:02,460 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,895,528 NBBO records
2025-12-25 05:08:02,460 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,895,528 rows
2025-12-25 05:10:17,282 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,399,663 NBBO records
2025-12-25 05:10:17,282 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,399,663 rows
2025-12-25 05:13:50,460 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,475,378 NBBO records
2025-12-25 05:13:50,460 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,475,378 rows
2025-12-25 05:16:48,716 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,822,980 NBBO records
2025-12-25 05:16:48,716 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,822,980 rows
2025-12-25 05:20:07,157 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,407,638 NBBO records
2025-12-25 05:20:07,157 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,407,638 rows
2025-12-25 05:24:37,407 INFO [src.stage_a.wrds_extractor]   Chunk 8: 7,335,264 NBBO records
2025-12-25 05:24:37,407 INFO [src.stage_a.parquet_writer]   Chunk 8: 7,335,264 rows
2025-12-25 05:28:47,647 INFO [src.stage_a.wrds_extractor]   Chunk 9: 6,754,508 NBBO records
2025-12-25 05:28:47,652 INFO [src.stage_a.parquet_writer]   Chunk 9: 6,754,508 rows
2025-12-25 05:31:41,941 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,543,431 NBBO records
2025-12-25 05:31:41,942 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,543,431 rows
2025-12-25 05:31:42,312 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 51,965,196 total rows written
2025-12-25 05:38:27,562 INFO [src.stage_a.wrds_extractor]   Chunk 11: 9,935,728 NBBO records
2025-12-25 05:38:27,562 INFO [src.stage_a.parquet_writer]   Chunk 11: 9,935,728 rows
2025-12-25 05:38:28,384 INFO [src.stage_a.parquet_writer] ✓ Wrote 61,900,924 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-12
2025-12-25 05:38:28,399 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 05:38:28,399 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 05:38:28,399 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 05:38:28,399 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 05:38:28,399 INFO [src.stage_a.stage_a] Trades: 28,505,539 rows
2025-12-25 05:38:28,399 INFO [src.stage_a.stage_a] Nbbo: 61,900,924 rows
2025-12-25 05:38:28,399 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 05:38:28,399 INFO [src.stage_a.stage_a] Processing date 72/83: 2024-04-15
2025-12-25 05:38:28,399 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 05:38:28,399 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 05:38:28,399 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-04-15 (519 symbols)
2025-12-25 05:38:28,399 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 05:38:28,399 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 05:38:28,399 INFO [src.stage_a.stage_a] Extract run ID: 2dfee099-f606-4cde-afc7-b951c189969d
2025-12-25 05:38:28,408 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 05:38:28,408 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 05:38:28,408 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 05:38:28,408 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 05:38:28,408 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 05:38:28,408 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 05:38:28,408 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 05:38:28,408 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 05:38:28,408 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 05:38:32,046 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 05:38:32,046 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-15...
2025-12-25 05:38:32,253 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240415 for 519 symbols
2025-12-25 05:41:57,483 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,615,931 trades
2025-12-25 05:41:57,483 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,615,931 rows
2025-12-25 05:43:57,270 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,153,077 trades
2025-12-25 05:43:57,270 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,153,077 rows
2025-12-25 05:45:59,023 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,265,032 trades
2025-12-25 05:45:59,023 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,265,032 rows
2025-12-25 05:47:25,794 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,736,896 trades
2025-12-25 05:47:25,794 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,736,896 rows
2025-12-25 05:49:21,067 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,613,432 trades
2025-12-25 05:49:21,068 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,613,432 rows
2025-12-25 05:51:15,369 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,441,005 trades
2025-12-25 05:51:15,369 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,441,005 rows
2025-12-25 05:54:43,568 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,805,159 trades
2025-12-25 05:54:43,568 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,805,159 rows
2025-12-25 05:57:08,837 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,731,062 trades
2025-12-25 05:57:08,837 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,731,062 rows
2025-12-25 05:59:19,247 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,679,119 trades
2025-12-25 05:59:19,247 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,679,119 rows
2025-12-25 06:02:06,710 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,384,048 trades
2025-12-25 06:02:06,711 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,384,048 rows
2025-12-25 06:02:07,141 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 27,424,761 total rows written
2025-12-25 06:03:20,759 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,441,623 trades
2025-12-25 06:03:20,760 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,441,623 rows
2025-12-25 06:03:21,160 INFO [src.stage_a.parquet_writer] ✓ Wrote 28,866,384 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-15
2025-12-25 06:03:21,165 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 06:03:21,165 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 06:03:21,165 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 06:03:21,165 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 06:03:21,165 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 06:03:21,165 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 06:03:21,165 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 06:03:23,177 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 06:03:23,177 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-15...
2025-12-25 06:03:23,231 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240415 for 519 symbols
2025-12-25 06:06:57,849 INFO [src.stage_a.wrds_extractor]   Chunk 1: 6,206,611 NBBO records
2025-12-25 06:06:57,849 INFO [src.stage_a.parquet_writer]   Chunk 1: 6,206,611 rows
2025-12-25 06:09:09,746 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,887,414 NBBO records
2025-12-25 06:09:09,746 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,887,414 rows
2025-12-25 06:11:59,838 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,564,964 NBBO records
2025-12-25 06:11:59,838 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,564,964 rows
2025-12-25 06:14:09,221 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,766,295 NBBO records
2025-12-25 06:14:09,222 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,766,295 rows
2025-12-25 06:17:45,609 INFO [src.stage_a.wrds_extractor]   Chunk 5: 7,279,992 NBBO records
2025-12-25 06:17:45,610 INFO [src.stage_a.parquet_writer]   Chunk 5: 7,279,992 rows
2025-12-25 06:20:48,118 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,987,254 NBBO records
2025-12-25 06:20:48,127 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,987,254 rows
2025-12-25 06:23:46,809 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,018,660 NBBO records
2025-12-25 06:23:46,810 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,018,660 rows
2025-12-25 06:27:30,623 INFO [src.stage_a.wrds_extractor]   Chunk 8: 7,883,409 NBBO records
2025-12-25 06:27:30,624 INFO [src.stage_a.parquet_writer]   Chunk 8: 7,883,409 rows
2025-12-25 06:31:25,315 INFO [src.stage_a.wrds_extractor]   Chunk 9: 7,840,488 NBBO records
2025-12-25 06:31:25,317 INFO [src.stage_a.parquet_writer]   Chunk 9: 7,840,488 rows
2025-12-25 06:33:55,836 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,916,473 NBBO records
2025-12-25 06:33:55,842 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,916,473 rows
2025-12-25 06:33:56,236 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 59,351,560 total rows written
2025-12-25 06:39:21,087 INFO [src.stage_a.wrds_extractor]   Chunk 11: 10,561,838 NBBO records
2025-12-25 06:39:21,087 INFO [src.stage_a.parquet_writer]   Chunk 11: 10,561,838 rows
2025-12-25 06:39:22,009 INFO [src.stage_a.parquet_writer] ✓ Wrote 69,913,398 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-15
2025-12-25 06:39:22,035 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 06:39:22,035 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 06:39:22,036 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 06:39:22,036 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 06:39:22,036 INFO [src.stage_a.stage_a] Trades: 28,866,384 rows
2025-12-25 06:39:22,036 INFO [src.stage_a.stage_a] Nbbo: 69,913,398 rows
2025-12-25 06:39:22,036 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 06:39:22,036 INFO [src.stage_a.stage_a] Processing date 73/83: 2024-04-16
2025-12-25 06:39:22,036 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 06:39:22,036 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 06:39:22,036 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-04-16 (519 symbols)
2025-12-25 06:39:22,036 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 06:39:22,036 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 06:39:22,036 INFO [src.stage_a.stage_a] Extract run ID: 3997ba93-1be8-4a59-bb11-5d219d74ea95
2025-12-25 06:39:22,044 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 06:39:22,044 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 06:39:22,044 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 06:39:22,044 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 06:39:22,044 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 06:39:22,044 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 06:39:22,044 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 06:39:22,044 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 06:39:22,044 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 06:39:23,998 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 06:39:23,998 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-16...
2025-12-25 06:39:24,164 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240416 for 519 symbols
2025-12-25 06:42:15,292 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,490,740 trades
2025-12-25 06:42:15,292 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,490,740 rows
2025-12-25 06:44:55,371 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,478,287 trades
2025-12-25 06:44:55,371 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,478,287 rows
2025-12-25 06:46:48,169 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,130,198 trades
2025-12-25 06:46:48,169 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,130,198 rows
2025-12-25 06:48:16,363 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,812,694 trades
2025-12-25 06:48:16,363 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,812,694 rows
2025-12-25 06:50:33,391 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,481,999 trades
2025-12-25 06:50:33,391 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,481,999 rows
2025-12-25 06:53:12,500 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,601,724 trades
2025-12-25 06:53:12,500 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,601,724 rows
2025-12-25 06:56:32,838 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,437,477 trades
2025-12-25 06:56:32,838 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,437,477 rows
2025-12-25 06:58:48,660 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,621,470 trades
2025-12-25 06:58:48,660 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,621,470 rows
2025-12-25 07:01:22,039 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,551,506 trades
2025-12-25 07:01:22,040 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,551,506 rows
2025-12-25 07:04:21,282 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,529,254 trades
2025-12-25 07:04:21,282 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,529,254 rows
2025-12-25 07:04:21,715 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 27,135,349 total rows written
2025-12-25 07:05:39,949 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,488,298 trades
2025-12-25 07:05:39,949 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,488,298 rows
2025-12-25 07:05:40,395 INFO [src.stage_a.parquet_writer] ✓ Wrote 28,623,647 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-16
2025-12-25 07:05:40,400 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 07:05:40,401 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 07:05:40,401 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 07:05:40,401 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 07:05:40,401 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 07:05:40,401 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 07:05:40,401 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 07:05:42,467 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 07:05:42,467 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-16...
2025-12-25 07:05:42,630 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240416 for 519 symbols
2025-12-25 07:10:06,800 INFO [src.stage_a.wrds_extractor]   Chunk 1: 6,903,918 NBBO records
2025-12-25 07:10:06,800 INFO [src.stage_a.parquet_writer]   Chunk 1: 6,903,918 rows
2025-12-25 07:12:48,602 INFO [src.stage_a.wrds_extractor]   Chunk 2: 4,914,701 NBBO records
2025-12-25 07:12:48,604 INFO [src.stage_a.parquet_writer]   Chunk 2: 4,914,701 rows
2025-12-25 07:15:43,008 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,862,094 NBBO records
2025-12-25 07:15:43,009 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,862,094 rows
2025-12-25 07:17:36,690 INFO [src.stage_a.wrds_extractor]   Chunk 4: 4,254,528 NBBO records
2025-12-25 07:17:36,691 INFO [src.stage_a.parquet_writer]   Chunk 4: 4,254,528 rows
2025-12-25 07:20:17,652 INFO [src.stage_a.wrds_extractor]   Chunk 5: 6,683,224 NBBO records
2025-12-25 07:20:17,652 INFO [src.stage_a.parquet_writer]   Chunk 5: 6,683,224 rows
2025-12-25 07:23:18,316 INFO [src.stage_a.wrds_extractor]   Chunk 6: 6,542,736 NBBO records
2025-12-25 07:23:18,320 INFO [src.stage_a.parquet_writer]   Chunk 6: 6,542,736 rows
2025-12-25 07:25:59,284 INFO [src.stage_a.wrds_extractor]   Chunk 7: 6,168,220 NBBO records
2025-12-25 07:25:59,294 INFO [src.stage_a.parquet_writer]   Chunk 7: 6,168,220 rows
2025-12-25 07:30:42,008 INFO [src.stage_a.wrds_extractor]   Chunk 8: 10,134,768 NBBO records
2025-12-25 07:30:42,009 INFO [src.stage_a.parquet_writer]   Chunk 8: 10,134,768 rows
2025-12-25 07:35:02,042 INFO [src.stage_a.wrds_extractor]   Chunk 9: 8,791,995 NBBO records
2025-12-25 07:35:02,052 INFO [src.stage_a.parquet_writer]   Chunk 9: 8,791,995 rows
2025-12-25 07:38:16,661 INFO [src.stage_a.wrds_extractor]   Chunk 10: 6,215,277 NBBO records
2025-12-25 07:38:16,666 INFO [src.stage_a.parquet_writer]   Chunk 10: 6,215,277 rows
2025-12-25 07:38:17,102 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 66,471,461 total rows written
2025-12-25 07:45:42,532 INFO [src.stage_a.wrds_extractor]   Chunk 11: 12,273,088 NBBO records
2025-12-25 07:45:42,533 INFO [src.stage_a.parquet_writer]   Chunk 11: 12,273,088 rows
2025-12-25 07:45:43,534 INFO [src.stage_a.parquet_writer] ✓ Wrote 78,744,549 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-16
2025-12-25 07:45:43,573 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 07:45:43,573 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 07:45:43,573 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 07:45:43,573 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 07:45:43,573 INFO [src.stage_a.stage_a] Trades: 28,623,647 rows
2025-12-25 07:45:43,573 INFO [src.stage_a.stage_a] Nbbo: 78,744,549 rows
2025-12-25 07:45:43,573 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 07:45:43,573 INFO [src.stage_a.stage_a] Processing date 74/83: 2024-04-17
2025-12-25 07:45:43,573 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 07:45:43,573 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 07:45:43,573 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-04-17 (519 symbols)
2025-12-25 07:45:43,573 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 07:45:43,573 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 07:45:43,573 INFO [src.stage_a.stage_a] Extract run ID: fa2bfb8d-1f05-48cc-8fa5-950cff66950d
2025-12-25 07:45:43,581 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 07:45:43,581 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 07:45:43,581 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 07:45:43,581 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 07:45:43,581 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 07:45:43,581 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 07:45:43,581 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 07:45:43,581 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 07:45:43,581 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 07:45:45,672 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 07:45:45,672 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-17...
2025-12-25 07:45:45,787 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240417 for 519 symbols
2025-12-25 07:49:01,974 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,503,749 trades
2025-12-25 07:49:01,974 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,503,749 rows
2025-12-25 07:50:59,853 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,101,259 trades
2025-12-25 07:50:59,853 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,101,259 rows
2025-12-25 07:53:15,237 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,978,017 trades
2025-12-25 07:53:15,238 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,978,017 rows
2025-12-25 07:54:59,348 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,703,864 trades
2025-12-25 07:54:59,348 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,703,864 rows
2025-12-25 07:57:08,950 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,386,087 trades
2025-12-25 07:57:08,950 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,386,087 rows
2025-12-25 07:59:09,940 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,380,965 trades
2025-12-25 07:59:09,941 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,380,965 rows
2025-12-25 08:03:16,902 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,634,050 trades
2025-12-25 08:03:16,902 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,634,050 rows
2025-12-25 08:06:07,411 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,673,187 trades
2025-12-25 08:06:07,411 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,673,187 rows
2025-12-25 08:08:57,702 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,450,856 trades
2025-12-25 08:08:57,703 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,450,856 rows
2025-12-25 08:12:14,317 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,522,350 trades
2025-12-25 08:12:14,317 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,522,350 rows
2025-12-25 08:12:14,776 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,334,384 total rows written
2025-12-25 08:13:35,339 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,248,359 trades
2025-12-25 08:13:35,339 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,248,359 rows
2025-12-25 08:13:35,706 INFO [src.stage_a.parquet_writer] ✓ Wrote 27,582,743 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-17
2025-12-25 08:13:35,707 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 08:13:35,707 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 08:13:35,707 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 08:13:35,707 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 08:13:35,707 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 08:13:35,707 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 08:13:35,707 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 08:13:37,745 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 08:13:37,746 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-17...
2025-12-25 08:13:37,813 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240417 for 519 symbols
2025-12-25 08:16:41,552 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,981,795 NBBO records
2025-12-25 08:16:41,552 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,981,795 rows
2025-12-25 08:18:31,154 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,685,797 NBBO records
2025-12-25 08:18:31,155 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,685,797 rows
2025-12-25 08:21:19,947 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,090,796 NBBO records
2025-12-25 08:21:19,947 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,090,796 rows
2025-12-25 08:23:28,094 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,434,654 NBBO records
2025-12-25 08:23:28,094 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,434,654 rows
2025-12-25 08:26:41,273 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,917,391 NBBO records
2025-12-25 08:26:41,273 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,917,391 rows
2025-12-25 08:29:58,072 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,539,430 NBBO records
2025-12-25 08:29:58,073 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,539,430 rows
2025-12-25 08:32:52,408 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,107,899 NBBO records
2025-12-25 08:32:52,408 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,107,899 rows
2025-12-25 08:37:21,627 INFO [src.stage_a.wrds_extractor]   Chunk 8: 8,102,999 NBBO records
2025-12-25 08:37:21,627 INFO [src.stage_a.parquet_writer]   Chunk 8: 8,102,999 rows
2025-12-25 08:41:55,978 INFO [src.stage_a.wrds_extractor]   Chunk 9: 8,161,795 NBBO records
2025-12-25 08:41:55,984 INFO [src.stage_a.parquet_writer]   Chunk 9: 8,161,795 rows
2025-12-25 08:44:53,166 INFO [src.stage_a.wrds_extractor]   Chunk 10: 5,210,827 NBBO records
2025-12-25 08:44:53,171 INFO [src.stage_a.parquet_writer]   Chunk 10: 5,210,827 rows
2025-12-25 08:44:53,575 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 56,233,383 total rows written
2025-12-25 08:50:10,537 INFO [src.stage_a.wrds_extractor]   Chunk 11: 9,738,872 NBBO records
2025-12-25 08:50:10,538 INFO [src.stage_a.parquet_writer]   Chunk 11: 9,738,872 rows
2025-12-25 08:50:11,365 INFO [src.stage_a.parquet_writer] ✓ Wrote 65,972,255 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-17
2025-12-25 08:50:11,387 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 08:50:11,387 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 08:50:11,387 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 08:50:11,387 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 08:50:11,387 INFO [src.stage_a.stage_a] Trades: 27,582,743 rows
2025-12-25 08:50:11,387 INFO [src.stage_a.stage_a] Nbbo: 65,972,255 rows
2025-12-25 08:50:11,387 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 08:50:11,387 INFO [src.stage_a.stage_a] Processing date 75/83: 2024-04-18
2025-12-25 08:50:11,387 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 08:50:11,387 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 08:50:11,387 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-04-18 (519 symbols)
2025-12-25 08:50:11,387 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 08:50:11,387 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 08:50:11,387 INFO [src.stage_a.stage_a] Extract run ID: 46899725-4f08-4a35-ae5d-20aaa21790bd
2025-12-25 08:50:11,395 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 08:50:11,395 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 08:50:11,395 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 08:50:11,395 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 08:50:11,395 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 08:50:11,395 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 08:50:11,395 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 08:50:11,395 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 08:50:11,395 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 08:50:13,213 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 08:50:13,213 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-18...
2025-12-25 08:50:13,385 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240418 for 519 symbols
2025-12-25 08:52:48,172 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,188,285 trades
2025-12-25 08:52:48,172 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,188,285 rows
2025-12-25 08:54:33,767 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,959,387 trades
2025-12-25 08:54:33,767 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,959,387 rows
2025-12-25 08:56:11,406 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,085,649 trades
2025-12-25 08:56:11,407 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,085,649 rows
2025-12-25 08:57:20,812 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,751,799 trades
2025-12-25 08:57:20,813 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,751,799 rows
2025-12-25 08:59:19,331 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,349,565 trades
2025-12-25 08:59:19,332 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,349,565 rows
2025-12-25 09:01:16,071 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,470,901 trades
2025-12-25 09:01:16,071 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,470,901 rows
2025-12-25 09:03:54,995 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,597,627 trades
2025-12-25 09:03:54,995 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,597,627 rows
2025-12-25 09:05:38,613 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,563,321 trades
2025-12-25 09:05:38,613 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,563,321 rows
2025-12-25 09:07:48,282 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,360,981 trades
2025-12-25 09:07:48,282 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,360,981 rows
2025-12-25 09:10:52,895 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,409,177 trades
2025-12-25 09:10:52,895 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,409,177 rows
2025-12-25 09:10:53,322 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,736,692 total rows written
2025-12-25 09:11:56,970 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,204,855 trades
2025-12-25 09:11:56,970 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,204,855 rows
2025-12-25 09:11:57,322 INFO [src.stage_a.parquet_writer] ✓ Wrote 26,941,547 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-18
2025-12-25 09:11:57,324 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 09:11:57,324 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 09:11:57,324 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 09:11:57,324 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 09:11:57,324 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 09:11:57,324 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 09:11:57,324 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 09:11:59,490 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 09:11:59,490 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-18...
2025-12-25 09:11:59,593 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240418 for 519 symbols
2025-12-25 09:15:11,993 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,614,369 NBBO records
2025-12-25 09:15:11,993 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,614,369 rows
2025-12-25 09:17:04,883 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,423,674 NBBO records
2025-12-25 09:17:04,883 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,423,674 rows
2025-12-25 09:19:18,168 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,652,814 NBBO records
2025-12-25 09:19:18,168 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,652,814 rows
2025-12-25 09:20:54,765 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,366,313 NBBO records
2025-12-25 09:20:54,765 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,366,313 rows
2025-12-25 09:23:49,749 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,401,164 NBBO records
2025-12-25 09:23:49,749 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,401,164 rows
2025-12-25 09:27:03,335 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,956,951 NBBO records
2025-12-25 09:27:03,335 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,956,951 rows
2025-12-25 09:30:02,692 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,710,469 NBBO records
2025-12-25 09:30:02,692 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,710,469 rows
2025-12-25 09:34:54,167 INFO [src.stage_a.wrds_extractor]   Chunk 8: 7,473,888 NBBO records
2025-12-25 09:34:54,167 INFO [src.stage_a.parquet_writer]   Chunk 8: 7,473,888 rows
2025-12-25 09:39:57,518 INFO [src.stage_a.wrds_extractor]   Chunk 9: 7,290,636 NBBO records
2025-12-25 09:39:57,524 INFO [src.stage_a.parquet_writer]   Chunk 9: 7,290,636 rows
2025-12-25 09:42:45,539 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,659,056 NBBO records
2025-12-25 09:42:45,543 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,659,056 rows
2025-12-25 09:42:45,896 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 51,549,334 total rows written
2025-12-25 09:48:23,785 INFO [src.stage_a.wrds_extractor]   Chunk 11: 9,243,015 NBBO records
2025-12-25 09:48:23,785 INFO [src.stage_a.parquet_writer]   Chunk 11: 9,243,015 rows
2025-12-25 09:48:24,594 INFO [src.stage_a.parquet_writer] ✓ Wrote 60,792,349 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-18
2025-12-25 09:48:24,610 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 09:48:24,610 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 09:48:24,610 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 09:48:24,610 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 09:48:24,610 INFO [src.stage_a.stage_a] Trades: 26,941,547 rows
2025-12-25 09:48:24,610 INFO [src.stage_a.stage_a] Nbbo: 60,792,349 rows
2025-12-25 09:48:24,610 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 09:48:24,610 INFO [src.stage_a.stage_a] Processing date 76/83: 2024-04-19
2025-12-25 09:48:24,610 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 09:48:24,610 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 09:48:24,610 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-04-19 (519 symbols)
2025-12-25 09:48:24,610 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 09:48:24,610 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 09:48:24,610 INFO [src.stage_a.stage_a] Extract run ID: 17d922a0-9b0f-4e82-9f63-061a854ebfc9
2025-12-25 09:48:24,618 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 09:48:24,618 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 09:48:24,618 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 09:48:24,618 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 09:48:24,618 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 09:48:24,618 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 09:48:24,618 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 09:48:24,618 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 09:48:24,618 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 09:48:25,832 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 09:48:25,832 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-19...
2025-12-25 09:48:25,896 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240419 for 519 symbols
2025-12-25 09:51:24,843 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,869,742 trades
2025-12-25 09:51:24,843 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,869,742 rows
2025-12-25 09:53:04,113 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,079,567 trades
2025-12-25 09:53:04,113 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,079,567 rows
2025-12-25 09:54:46,319 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,030,792 trades
2025-12-25 09:54:46,319 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,030,792 rows
2025-12-25 09:56:21,657 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,893,821 trades
2025-12-25 09:56:21,657 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,893,821 rows
2025-12-25 09:58:39,529 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,654,177 trades
2025-12-25 09:58:39,529 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,654,177 rows
2025-12-25 10:00:54,277 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,474,526 trades
2025-12-25 10:00:54,277 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,474,526 rows
2025-12-25 10:05:10,310 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,992,918 trades
2025-12-25 10:05:10,310 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,992,918 rows
2025-12-25 10:07:49,380 INFO [src.stage_a.wrds_extractor]   Chunk 8: 3,173,025 trades
2025-12-25 10:07:49,382 INFO [src.stage_a.parquet_writer]   Chunk 8: 3,173,025 rows
2025-12-25 10:10:26,544 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,643,143 trades
2025-12-25 10:10:26,544 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,643,143 rows
2025-12-25 10:13:43,064 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,407,270 trades
2025-12-25 10:13:43,064 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,407,270 rows
2025-12-25 10:13:43,495 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 29,218,981 total rows written
2025-12-25 10:14:52,931 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,499,902 trades
2025-12-25 10:14:52,931 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,499,902 rows
2025-12-25 10:14:53,376 INFO [src.stage_a.parquet_writer] ✓ Wrote 30,718,883 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-19
2025-12-25 10:14:53,380 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 10:14:53,380 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 10:14:53,380 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 10:14:53,380 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 10:14:53,380 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 10:14:53,380 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 10:14:53,380 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 10:14:55,142 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 10:14:55,142 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-19...
2025-12-25 10:14:55,273 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240419 for 519 symbols
2025-12-25 10:19:22,253 INFO [src.stage_a.wrds_extractor]   Chunk 1: 6,269,094 NBBO records
2025-12-25 10:19:22,253 INFO [src.stage_a.parquet_writer]   Chunk 1: 6,269,094 rows
2025-12-25 10:21:52,395 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,736,915 NBBO records
2025-12-25 10:21:52,395 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,736,915 rows
2025-12-25 10:25:35,586 INFO [src.stage_a.wrds_extractor]   Chunk 3: 5,314,525 NBBO records
2025-12-25 10:25:35,586 INFO [src.stage_a.parquet_writer]   Chunk 3: 5,314,525 rows
2025-12-25 10:28:18,508 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,789,720 NBBO records
2025-12-25 10:28:18,508 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,789,720 rows
2025-12-25 10:32:03,203 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,579,492 NBBO records
2025-12-25 10:32:03,204 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,579,492 rows
2025-12-25 10:35:15,606 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,210,145 NBBO records
2025-12-25 10:35:15,607 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,210,145 rows
2025-12-25 10:38:53,270 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,325,981 NBBO records
2025-12-25 10:38:53,270 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,325,981 rows
2025-12-25 10:43:50,180 INFO [src.stage_a.wrds_extractor]   Chunk 8: 9,508,270 NBBO records
2025-12-25 10:43:50,180 INFO [src.stage_a.parquet_writer]   Chunk 8: 9,508,270 rows
2025-12-25 10:47:58,794 INFO [src.stage_a.wrds_extractor]   Chunk 9: 8,069,285 NBBO records
2025-12-25 10:47:58,799 INFO [src.stage_a.parquet_writer]   Chunk 9: 8,069,285 rows
2025-12-25 10:50:20,610 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,913,828 NBBO records
2025-12-25 10:50:20,615 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,913,828 rows
2025-12-25 10:50:21,001 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 57,717,255 total rows written
2025-12-25 10:55:53,362 INFO [src.stage_a.wrds_extractor]   Chunk 11: 10,839,929 NBBO records
2025-12-25 10:55:53,363 INFO [src.stage_a.parquet_writer]   Chunk 11: 10,839,929 rows
2025-12-25 10:55:54,322 INFO [src.stage_a.parquet_writer] ✓ Wrote 68,557,184 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-19
2025-12-25 10:55:54,352 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 10:55:54,352 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 10:55:54,352 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 10:55:54,352 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 10:55:54,352 INFO [src.stage_a.stage_a] Trades: 30,718,883 rows
2025-12-25 10:55:54,352 INFO [src.stage_a.stage_a] Nbbo: 68,557,184 rows
2025-12-25 10:55:54,352 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 10:55:54,352 INFO [src.stage_a.stage_a] Processing date 77/83: 2024-04-22
2025-12-25 10:55:54,352 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 10:55:54,352 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 10:55:54,352 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-04-22 (519 symbols)
2025-12-25 10:55:54,352 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 10:55:54,352 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 10:55:54,352 INFO [src.stage_a.stage_a] Extract run ID: 6eab290d-0bdf-434c-8574-7812fad1934a
2025-12-25 10:55:54,361 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 10:55:54,361 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 10:55:54,361 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 10:55:54,361 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 10:55:54,361 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 10:55:54,361 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 10:55:54,361 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 10:55:54,361 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 10:55:54,361 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 10:55:55,672 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 10:55:55,672 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-22...
2025-12-25 10:55:55,764 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240422 for 519 symbols
2025-12-25 10:58:22,881 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,062,802 trades
2025-12-25 10:58:22,881 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,062,802 rows
2025-12-25 11:00:06,564 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,027,274 trades
2025-12-25 11:00:06,564 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,027,274 rows
2025-12-25 11:01:33,997 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,002,735 trades
2025-12-25 11:01:33,997 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,002,735 rows
2025-12-25 11:03:21,946 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,841,755 trades
2025-12-25 11:03:21,946 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,841,755 rows
2025-12-25 11:05:04,192 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,413,126 trades
2025-12-25 11:05:04,192 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,413,126 rows
2025-12-25 11:06:57,421 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,324,313 trades
2025-12-25 11:06:57,421 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,324,313 rows
2025-12-25 11:10:10,771 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,940,340 trades
2025-12-25 11:10:10,771 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,940,340 rows
2025-12-25 11:12:15,954 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,542,618 trades
2025-12-25 11:12:15,954 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,542,618 rows
2025-12-25 11:14:18,772 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,439,740 trades
2025-12-25 11:14:18,772 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,439,740 rows
2025-12-25 11:17:11,848 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,597,030 trades
2025-12-25 11:17:11,848 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,597,030 rows
2025-12-25 11:17:12,300 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,191,733 total rows written
2025-12-25 11:18:04,020 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,185,490 trades
2025-12-25 11:18:04,020 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,185,490 rows
2025-12-25 11:18:04,407 INFO [src.stage_a.parquet_writer] ✓ Wrote 27,377,223 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-22
2025-12-25 11:18:04,408 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 11:18:04,408 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 11:18:04,408 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 11:18:04,408 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 11:18:04,408 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 11:18:04,408 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 11:18:04,408 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 11:18:05,822 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 11:18:05,822 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-22...
2025-12-25 11:18:05,901 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240422 for 519 symbols
2025-12-25 11:20:27,753 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,554,313 NBBO records
2025-12-25 11:20:27,753 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,554,313 rows
2025-12-25 11:21:54,383 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,122,302 NBBO records
2025-12-25 11:21:54,383 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,122,302 rows
2025-12-25 11:23:48,727 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,939,033 NBBO records
2025-12-25 11:23:48,727 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,939,033 rows
2025-12-25 11:25:07,441 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,959,302 NBBO records
2025-12-25 11:25:07,441 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,959,302 rows
2025-12-25 11:27:07,669 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,438,041 NBBO records
2025-12-25 11:27:07,669 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,438,041 rows
2025-12-25 11:29:20,204 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,126,076 NBBO records
2025-12-25 11:29:20,204 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,126,076 rows
2025-12-25 11:31:25,451 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,270,533 NBBO records
2025-12-25 11:31:25,452 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,270,533 rows
2025-12-25 11:34:32,538 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,828,626 NBBO records
2025-12-25 11:34:32,538 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,828,626 rows
2025-12-25 11:38:12,765 INFO [src.stage_a.wrds_extractor]   Chunk 9: 6,851,086 NBBO records
2025-12-25 11:38:12,765 INFO [src.stage_a.parquet_writer]   Chunk 9: 6,851,086 rows
2025-12-25 11:40:36,586 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,350,558 NBBO records
2025-12-25 11:40:36,587 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,350,558 rows
2025-12-25 11:40:36,915 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 44,439,870 total rows written
2025-12-25 11:44:40,095 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,823,262 NBBO records
2025-12-25 11:44:40,095 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,823,262 rows
2025-12-25 11:44:40,784 INFO [src.stage_a.parquet_writer] ✓ Wrote 52,263,132 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-22
2025-12-25 11:44:40,800 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 11:44:40,800 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 11:44:40,800 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 11:44:40,800 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 11:44:40,800 INFO [src.stage_a.stage_a] Trades: 27,377,223 rows
2025-12-25 11:44:40,800 INFO [src.stage_a.stage_a] Nbbo: 52,263,132 rows
2025-12-25 11:44:40,800 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 11:44:40,800 INFO [src.stage_a.stage_a] Processing date 78/83: 2024-04-23
2025-12-25 11:44:40,800 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 11:44:40,800 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 11:44:40,800 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-04-23 (519 symbols)
2025-12-25 11:44:40,800 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 11:44:40,800 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 11:44:40,800 INFO [src.stage_a.stage_a] Extract run ID: 3b234416-9642-4ae6-90b5-188110714d5b
2025-12-25 11:44:40,808 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 11:44:40,808 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 11:44:40,808 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 11:44:40,808 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 11:44:40,808 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 11:44:40,808 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 11:44:40,808 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 11:44:40,808 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 11:44:40,808 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 11:44:42,498 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 11:44:42,499 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-23...
2025-12-25 11:44:42,610 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240423 for 519 symbols
2025-12-25 11:46:52,290 INFO [src.stage_a.wrds_extractor]   Chunk 1: 2,994,079 trades
2025-12-25 11:46:52,290 INFO [src.stage_a.parquet_writer]   Chunk 1: 2,994,079 rows
2025-12-25 11:48:34,557 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,070,442 trades
2025-12-25 11:48:34,557 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,070,442 rows
2025-12-25 11:50:06,262 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,009,388 trades
2025-12-25 11:50:06,262 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,009,388 rows
2025-12-25 11:51:28,392 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,934,796 trades
2025-12-25 11:51:28,393 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,934,796 rows
2025-12-25 11:53:18,615 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,510,492 trades
2025-12-25 11:53:18,615 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,510,492 rows
2025-12-25 11:55:13,803 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,390,563 trades
2025-12-25 11:55:13,804 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,390,563 rows
2025-12-25 11:57:48,351 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,539,203 trades
2025-12-25 11:57:48,351 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,539,203 rows
2025-12-25 11:59:49,872 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,516,159 trades
2025-12-25 11:59:49,872 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,516,159 rows
2025-12-25 12:01:51,246 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,558,685 trades
2025-12-25 12:01:51,247 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,558,685 rows
2025-12-25 12:04:19,381 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,317,761 trades
2025-12-25 12:04:19,382 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,317,761 rows
2025-12-25 12:04:19,815 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,841,568 total rows written
2025-12-25 12:05:08,687 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,122,500 trades
2025-12-25 12:05:08,687 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,122,500 rows
2025-12-25 12:05:09,045 INFO [src.stage_a.parquet_writer] ✓ Wrote 26,964,068 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-23
2025-12-25 12:05:09,046 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 12:05:09,046 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 12:05:09,046 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 12:05:09,046 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 12:05:09,046 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 12:05:09,046 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 12:05:09,046 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 12:05:11,464 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 12:05:11,465 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-23...
2025-12-25 12:05:11,626 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240423 for 519 symbols
2025-12-25 12:07:31,839 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,236,608 NBBO records
2025-12-25 12:07:31,839 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,236,608 rows
2025-12-25 12:09:08,938 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,961,939 NBBO records
2025-12-25 12:09:08,939 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,961,939 rows
2025-12-25 12:10:59,612 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,802,502 NBBO records
2025-12-25 12:10:59,612 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,802,502 rows
2025-12-25 12:12:25,608 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,803,055 NBBO records
2025-12-25 12:12:25,608 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,803,055 rows
2025-12-25 12:14:31,550 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,195,386 NBBO records
2025-12-25 12:14:31,551 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,195,386 rows
2025-12-25 12:16:38,718 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,940,345 NBBO records
2025-12-25 12:16:38,718 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,940,345 rows
2025-12-25 12:18:37,205 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,704,213 NBBO records
2025-12-25 12:18:37,205 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,704,213 rows
2025-12-25 12:21:21,823 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,578,662 NBBO records
2025-12-25 12:21:21,823 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,578,662 rows
2025-12-25 12:24:05,466 INFO [src.stage_a.wrds_extractor]   Chunk 9: 5,515,284 NBBO records
2025-12-25 12:24:05,467 INFO [src.stage_a.parquet_writer]   Chunk 9: 5,515,284 rows
2025-12-25 12:26:06,834 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,014,737 NBBO records
2025-12-25 12:26:06,835 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,014,737 rows
2025-12-25 12:26:07,163 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 40,752,731 total rows written
2025-12-25 12:29:32,672 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,304,774 NBBO records
2025-12-25 12:29:32,672 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,304,774 rows
2025-12-25 12:29:33,253 INFO [src.stage_a.parquet_writer] ✓ Wrote 47,057,505 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-23
2025-12-25 12:29:33,260 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 12:29:33,260 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 12:29:33,260 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 12:29:33,260 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 12:29:33,260 INFO [src.stage_a.stage_a] Trades: 26,964,068 rows
2025-12-25 12:29:33,260 INFO [src.stage_a.stage_a] Nbbo: 47,057,505 rows
2025-12-25 12:29:33,260 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 12:29:33,260 INFO [src.stage_a.stage_a] Processing date 79/83: 2024-04-24
2025-12-25 12:29:33,260 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 12:29:33,260 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 12:29:33,260 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-04-24 (519 symbols)
2025-12-25 12:29:33,260 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 12:29:33,260 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 12:29:33,260 INFO [src.stage_a.stage_a] Extract run ID: 134fec4d-c2cb-4015-98da-f1e88423ee3a
2025-12-25 12:29:33,268 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 12:29:33,268 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 12:29:33,268 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 12:29:33,268 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 12:29:33,268 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 12:29:33,268 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 12:29:33,268 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 12:29:33,268 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 12:29:33,268 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 12:29:34,611 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 12:29:34,611 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-24...
2025-12-25 12:29:34,701 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240424 for 519 symbols
2025-12-25 12:32:30,805 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,150,940 trades
2025-12-25 12:32:30,806 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,150,940 rows
2025-12-25 12:34:25,487 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,243,045 trades
2025-12-25 12:34:25,487 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,243,045 rows
2025-12-25 12:36:07,709 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,085,798 trades
2025-12-25 12:36:07,710 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,085,798 rows
2025-12-25 12:37:54,274 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,071,633 trades
2025-12-25 12:37:54,274 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,071,633 rows
2025-12-25 12:40:07,688 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,734,007 trades
2025-12-25 12:40:07,688 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,734,007 rows
2025-12-25 12:42:38,847 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,436,945 trades
2025-12-25 12:42:38,848 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,436,945 rows
2025-12-25 12:46:23,162 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,861,319 trades
2025-12-25 12:46:23,162 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,861,319 rows
2025-12-25 12:49:11,435 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,618,007 trades
2025-12-25 12:49:11,436 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,618,007 rows
2025-12-25 12:52:04,126 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,567,422 trades
2025-12-25 12:52:04,126 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,567,422 rows
2025-12-25 12:56:11,911 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,153,223 trades
2025-12-25 12:56:11,911 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,153,223 rows
2025-12-25 12:56:12,396 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 27,922,339 total rows written
2025-12-25 12:57:31,899 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,099,544 trades
2025-12-25 12:57:31,905 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,099,544 rows
2025-12-25 12:57:32,280 INFO [src.stage_a.parquet_writer] ✓ Wrote 29,021,883 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-24
2025-12-25 12:57:32,280 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 12:57:32,280 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 12:57:32,280 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 12:57:32,281 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 12:57:32,281 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 12:57:32,281 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 12:57:32,281 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 12:57:33,819 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 12:57:33,819 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-24...
2025-12-25 12:57:33,923 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240424 for 519 symbols
2025-12-25 13:00:10,145 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,391,440 NBBO records
2025-12-25 13:00:10,145 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,391,440 rows
2025-12-25 13:02:18,484 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,212,376 NBBO records
2025-12-25 13:02:18,484 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,212,376 rows
2025-12-25 13:04:31,459 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,132,323 NBBO records
2025-12-25 13:04:31,460 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,132,323 rows
2025-12-25 13:06:16,615 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,027,105 NBBO records
2025-12-25 13:06:16,615 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,027,105 rows
2025-12-25 13:09:01,668 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,503,624 NBBO records
2025-12-25 13:09:01,668 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,503,624 rows
2025-12-25 13:11:42,799 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,794,561 NBBO records
2025-12-25 13:11:42,799 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,794,561 rows
2025-12-25 13:14:12,463 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,235,193 NBBO records
2025-12-25 13:14:12,463 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,235,193 rows
2025-12-25 13:17:38,995 INFO [src.stage_a.wrds_extractor]   Chunk 8: 6,618,314 NBBO records
2025-12-25 13:17:38,995 INFO [src.stage_a.parquet_writer]   Chunk 8: 6,618,314 rows
2025-12-25 13:21:00,291 INFO [src.stage_a.wrds_extractor]   Chunk 9: 5,669,774 NBBO records
2025-12-25 13:21:00,291 INFO [src.stage_a.parquet_writer]   Chunk 9: 5,669,774 rows
2025-12-25 13:22:41,454 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,546,255 NBBO records
2025-12-25 13:22:41,455 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,546,255 rows
2025-12-25 13:22:41,824 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 45,130,965 total rows written
2025-12-25 13:24:34,457 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,248,918 NBBO records
2025-12-25 13:24:34,457 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,248,918 rows
2025-12-25 13:24:35,122 INFO [src.stage_a.parquet_writer] ✓ Wrote 52,379,883 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-24
2025-12-25 13:24:35,132 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 13:24:35,132 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 13:24:35,132 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 13:24:35,132 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 13:24:35,132 INFO [src.stage_a.stage_a] Trades: 29,021,883 rows
2025-12-25 13:24:35,132 INFO [src.stage_a.stage_a] Nbbo: 52,379,883 rows
2025-12-25 13:24:35,132 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 13:24:35,132 INFO [src.stage_a.stage_a] Processing date 80/83: 2024-04-25
2025-12-25 13:24:35,133 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 13:24:35,133 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 13:24:35,133 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-04-25 (519 symbols)
2025-12-25 13:24:35,133 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 13:24:35,133 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 13:24:35,133 INFO [src.stage_a.stage_a] Extract run ID: bb02fab9-8718-4dad-aa26-0a64c676b201
2025-12-25 13:24:35,141 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 13:24:35,141 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 13:24:35,141 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 13:24:35,141 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 13:24:35,141 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 13:24:35,141 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 13:24:35,141 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 13:24:35,141 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 13:24:35,141 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 13:24:37,264 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 13:24:37,264 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-25...
2025-12-25 13:24:37,360 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240425 for 519 symbols
2025-12-25 13:27:18,139 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,335,246 trades
2025-12-25 13:27:18,139 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,335,246 rows
2025-12-25 13:29:00,378 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,387,301 trades
2025-12-25 13:29:00,378 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,387,301 rows
2025-12-25 13:29:48,889 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,208,217 trades
2025-12-25 13:29:48,890 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,208,217 rows
2025-12-25 13:30:21,739 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,914,450 trades
2025-12-25 13:30:21,739 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,914,450 rows
2025-12-25 13:31:33,012 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,176,475 trades
2025-12-25 13:31:33,012 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,176,475 rows
2025-12-25 13:32:18,337 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,515,864 trades
2025-12-25 13:32:18,337 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,515,864 rows
2025-12-25 13:34:06,433 INFO [src.stage_a.wrds_extractor]   Chunk 7: 5,141,008 trades
2025-12-25 13:34:06,433 INFO [src.stage_a.parquet_writer]   Chunk 7: 5,141,008 rows
2025-12-25 13:36:27,266 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,824,736 trades
2025-12-25 13:36:27,272 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,824,736 rows
2025-12-25 13:38:42,261 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,523,256 trades
2025-12-25 13:38:42,261 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,523,256 rows
2025-12-25 13:39:45,430 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,712,704 trades
2025-12-25 13:39:45,430 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,712,704 rows
2025-12-25 13:39:45,926 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 29,739,257 total rows written
2025-12-25 13:40:11,791 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,364,303 trades
2025-12-25 13:40:11,791 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,364,303 rows
2025-12-25 13:40:12,222 INFO [src.stage_a.parquet_writer] ✓ Wrote 31,103,560 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-25
2025-12-25 13:40:12,225 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 13:40:12,225 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 13:40:12,226 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 13:40:12,226 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 13:40:12,226 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 13:40:12,226 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 13:40:12,226 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 13:40:13,325 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 13:40:13,325 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-25...
2025-12-25 13:40:13,399 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240425 for 519 symbols
2025-12-25 13:41:17,048 INFO [src.stage_a.wrds_extractor]   Chunk 1: 5,048,266 NBBO records
2025-12-25 13:41:17,049 INFO [src.stage_a.parquet_writer]   Chunk 1: 5,048,266 rows
2025-12-25 13:43:19,881 INFO [src.stage_a.wrds_extractor]   Chunk 2: 3,554,443 NBBO records
2025-12-25 13:43:19,882 INFO [src.stage_a.parquet_writer]   Chunk 2: 3,554,443 rows
2025-12-25 13:46:04,652 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,353,490 NBBO records
2025-12-25 13:46:04,652 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,353,490 rows
2025-12-25 13:48:10,387 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,325,803 NBBO records
2025-12-25 13:48:10,387 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,325,803 rows
2025-12-25 13:51:37,552 INFO [src.stage_a.wrds_extractor]   Chunk 5: 5,385,884 NBBO records
2025-12-25 13:51:37,552 INFO [src.stage_a.parquet_writer]   Chunk 5: 5,385,884 rows
2025-12-25 13:52:51,110 INFO [src.stage_a.wrds_extractor]   Chunk 6: 5,382,305 NBBO records
2025-12-25 13:52:51,110 INFO [src.stage_a.parquet_writer]   Chunk 6: 5,382,305 rows
2025-12-25 13:54:54,308 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,903,183 NBBO records
2025-12-25 13:54:54,309 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,903,183 rows
2025-12-25 13:59:31,419 INFO [src.stage_a.wrds_extractor]   Chunk 8: 8,390,203 NBBO records
2025-12-25 13:59:31,419 INFO [src.stage_a.parquet_writer]   Chunk 8: 8,390,203 rows
2025-12-25 14:04:07,576 INFO [src.stage_a.wrds_extractor]   Chunk 9: 7,527,246 NBBO records
2025-12-25 14:04:07,586 INFO [src.stage_a.parquet_writer]   Chunk 9: 7,527,246 rows
2025-12-25 14:06:24,628 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,978,427 NBBO records
2025-12-25 14:06:24,631 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,978,427 rows
2025-12-25 14:06:24,999 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 52,849,250 total rows written
2025-12-25 14:10:38,188 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,686,825 NBBO records
2025-12-25 14:10:38,188 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,686,825 rows
2025-12-25 14:10:38,885 INFO [src.stage_a.parquet_writer] ✓ Wrote 60,536,075 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-25
2025-12-25 14:10:38,896 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 14:10:38,896 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 14:10:38,896 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 14:10:38,896 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 14:10:38,896 INFO [src.stage_a.stage_a] Trades: 31,103,560 rows
2025-12-25 14:10:38,896 INFO [src.stage_a.stage_a] Nbbo: 60,536,075 rows
2025-12-25 14:10:38,896 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 14:10:38,896 INFO [src.stage_a.stage_a] Processing date 81/83: 2024-04-26
2025-12-25 14:10:38,896 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 14:10:38,896 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 14:10:38,896 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-04-26 (519 symbols)
2025-12-25 14:10:38,896 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 14:10:38,896 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 14:10:38,896 INFO [src.stage_a.stage_a] Extract run ID: 0903ea73-798c-4dc8-b9b3-6d1989d74d46
2025-12-25 14:10:38,904 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 14:10:38,904 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 14:10:38,904 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 14:10:38,904 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 14:10:38,904 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 14:10:38,904 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 14:10:38,904 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 14:10:38,904 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 14:10:38,904 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 14:10:40,843 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 14:10:40,843 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-26...
2025-12-25 14:10:40,972 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240426 for 519 symbols
2025-12-25 14:13:16,311 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,187,840 trades
2025-12-25 14:13:16,312 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,187,840 rows
2025-12-25 14:15:12,104 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,969,229 trades
2025-12-25 14:15:12,104 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,969,229 rows
2025-12-25 14:16:47,691 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,009,627 trades
2025-12-25 14:16:47,691 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,009,627 rows
2025-12-25 14:18:09,714 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,738,442 trades
2025-12-25 14:18:09,714 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,738,442 rows
2025-12-25 14:20:34,420 INFO [src.stage_a.wrds_extractor]   Chunk 5: 3,591,547 trades
2025-12-25 14:20:34,421 INFO [src.stage_a.parquet_writer]   Chunk 5: 3,591,547 rows
2025-12-25 14:22:09,282 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,099,093 trades
2025-12-25 14:22:09,283 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,099,093 rows
2025-12-25 14:25:04,405 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,125,595 trades
2025-12-25 14:25:04,405 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,125,595 rows
2025-12-25 14:26:57,367 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,547,734 trades
2025-12-25 14:26:57,369 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,547,734 rows
2025-12-25 14:28:39,512 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,226,995 trades
2025-12-25 14:28:39,512 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,226,995 rows
2025-12-25 14:31:19,363 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,164,617 trades
2025-12-25 14:31:19,363 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,164,617 rows
2025-12-25 14:31:19,782 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 26,660,719 total rows written
2025-12-25 14:32:12,233 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,265,536 trades
2025-12-25 14:32:12,233 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,265,536 rows
2025-12-25 14:32:12,584 INFO [src.stage_a.parquet_writer] ✓ Wrote 27,926,255 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-26
2025-12-25 14:32:12,588 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 14:32:12,588 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 14:32:12,588 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 14:32:12,588 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 14:32:12,588 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 14:32:12,588 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 14:32:12,588 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 14:32:14,719 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 14:32:14,720 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-26...
2025-12-25 14:32:14,826 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240426 for 519 symbols
2025-12-25 14:34:13,104 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,244,092 NBBO records
2025-12-25 14:34:13,105 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,244,092 rows
2025-12-25 14:35:39,850 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,906,260 NBBO records
2025-12-25 14:35:39,850 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,906,260 rows
2025-12-25 14:36:42,499 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,581,757 NBBO records
2025-12-25 14:36:42,499 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,581,757 rows
2025-12-25 14:37:54,506 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,706,706 NBBO records
2025-12-25 14:37:54,506 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,706,706 rows
2025-12-25 14:40:12,825 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,574,657 NBBO records
2025-12-25 14:40:12,825 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,574,657 rows
2025-12-25 14:42:00,219 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,906,460 NBBO records
2025-12-25 14:42:00,219 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,906,460 rows
2025-12-25 14:42:44,556 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,940,772 NBBO records
2025-12-25 14:42:44,556 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,940,772 rows
2025-12-25 14:44:36,352 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,844,868 NBBO records
2025-12-25 14:44:36,352 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,844,868 rows
2025-12-25 14:47:09,970 INFO [src.stage_a.wrds_extractor]   Chunk 9: 5,373,703 NBBO records
2025-12-25 14:47:09,970 INFO [src.stage_a.parquet_writer]   Chunk 9: 5,373,703 rows
2025-12-25 14:48:55,205 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,073,356 NBBO records
2025-12-25 14:48:55,206 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,073,356 rows
2025-12-25 14:48:55,540 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 41,152,631 total rows written
2025-12-25 14:50:50,871 INFO [src.stage_a.wrds_extractor]   Chunk 11: 6,340,883 NBBO records
2025-12-25 14:50:50,871 INFO [src.stage_a.parquet_writer]   Chunk 11: 6,340,883 rows
2025-12-25 14:50:51,435 INFO [src.stage_a.parquet_writer] ✓ Wrote 47,493,514 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-26
2025-12-25 14:50:51,442 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 14:50:51,442 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 14:50:51,442 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 14:50:51,442 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 14:50:51,442 INFO [src.stage_a.stage_a] Trades: 27,926,255 rows
2025-12-25 14:50:51,442 INFO [src.stage_a.stage_a] Nbbo: 47,493,514 rows
2025-12-25 14:50:51,442 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 14:50:51,442 INFO [src.stage_a.stage_a] Processing date 82/83: 2024-04-29
2025-12-25 14:50:51,442 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 14:50:51,442 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 14:50:51,442 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-04-29 (519 symbols)
2025-12-25 14:50:51,442 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 14:50:51,442 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 14:50:51,442 INFO [src.stage_a.stage_a] Extract run ID: 6a1d19db-0b36-475f-9fc1-e29a34f20818
2025-12-25 14:50:51,450 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 14:50:51,450 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 14:50:51,450 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 14:50:51,450 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 14:50:51,450 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 14:50:51,450 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 14:50:51,450 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 14:50:51,450 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 14:50:51,450 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 14:50:53,347 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 14:50:53,347 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-29...
2025-12-25 14:50:53,449 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240429 for 519 symbols
2025-12-25 14:53:32,899 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,393,791 trades
2025-12-25 14:53:32,899 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,393,791 rows
2025-12-25 14:54:58,234 INFO [src.stage_a.wrds_extractor]   Chunk 2: 1,895,213 trades
2025-12-25 14:54:58,234 INFO [src.stage_a.parquet_writer]   Chunk 2: 1,895,213 rows
2025-12-25 14:55:34,023 INFO [src.stage_a.wrds_extractor]   Chunk 3: 1,878,835 trades
2025-12-25 14:55:34,023 INFO [src.stage_a.parquet_writer]   Chunk 3: 1,878,835 rows
2025-12-25 14:56:03,767 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,675,924 trades
2025-12-25 14:56:03,767 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,675,924 rows
2025-12-25 14:58:04,113 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,860,370 trades
2025-12-25 14:58:04,113 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,860,370 rows
2025-12-25 14:59:34,762 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,039,798 trades
2025-12-25 14:59:34,762 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,039,798 rows
2025-12-25 15:01:55,742 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,392,794 trades
2025-12-25 15:01:55,742 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,392,794 rows
2025-12-25 15:02:39,650 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,365,385 trades
2025-12-25 15:02:39,650 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,365,385 rows
2025-12-25 15:04:22,103 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,087,487 trades
2025-12-25 15:04:22,103 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,087,487 rows
2025-12-25 15:07:20,010 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,237,357 trades
2025-12-25 15:07:20,010 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,237,357 rows
2025-12-25 15:07:20,512 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 25,826,954 total rows written
2025-12-25 15:08:15,472 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,061,610 trades
2025-12-25 15:08:15,475 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,061,610 rows
2025-12-25 15:08:15,829 INFO [src.stage_a.parquet_writer] ✓ Wrote 26,888,564 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-29
2025-12-25 15:08:15,830 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 15:08:15,830 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 15:08:15,830 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 15:08:15,830 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 15:08:15,830 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 15:08:15,830 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 15:08:15,830 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 15:08:16,970 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 15:08:16,970 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-29...
2025-12-25 15:08:17,041 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240429 for 519 symbols
2025-12-25 15:09:04,567 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,019,927 NBBO records
2025-12-25 15:09:04,567 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,019,927 rows
2025-12-25 15:09:44,274 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,528,699 NBBO records
2025-12-25 15:09:44,274 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,528,699 rows
2025-12-25 15:11:49,092 INFO [src.stage_a.wrds_extractor]   Chunk 3: 3,418,359 NBBO records
2025-12-25 15:11:49,092 INFO [src.stage_a.parquet_writer]   Chunk 3: 3,418,359 rows
2025-12-25 15:13:13,459 INFO [src.stage_a.wrds_extractor]   Chunk 4: 2,418,658 NBBO records
2025-12-25 15:13:13,459 INFO [src.stage_a.parquet_writer]   Chunk 4: 2,418,658 rows
2025-12-25 15:16:00,960 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,205,127 NBBO records
2025-12-25 15:16:00,961 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,205,127 rows
2025-12-25 15:17:51,294 INFO [src.stage_a.wrds_extractor]   Chunk 6: 3,433,408 NBBO records
2025-12-25 15:17:51,294 INFO [src.stage_a.parquet_writer]   Chunk 6: 3,433,408 rows
2025-12-25 15:20:01,320 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,274,552 NBBO records
2025-12-25 15:20:01,320 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,274,552 rows
2025-12-25 15:23:13,648 INFO [src.stage_a.wrds_extractor]   Chunk 8: 5,292,559 NBBO records
2025-12-25 15:23:13,649 INFO [src.stage_a.parquet_writer]   Chunk 8: 5,292,559 rows
2025-12-25 15:26:11,873 INFO [src.stage_a.wrds_extractor]   Chunk 9: 4,683,793 NBBO records
2025-12-25 15:26:11,873 INFO [src.stage_a.parquet_writer]   Chunk 9: 4,683,793 rows
2025-12-25 15:28:11,804 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,062,072 NBBO records
2025-12-25 15:28:11,804 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,062,072 rows
2025-12-25 15:28:12,129 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 37,337,154 total rows written
2025-12-25 15:31:09,406 INFO [src.stage_a.wrds_extractor]   Chunk 11: 5,718,665 NBBO records
2025-12-25 15:31:09,406 INFO [src.stage_a.parquet_writer]   Chunk 11: 5,718,665 rows
2025-12-25 15:31:09,938 INFO [src.stage_a.parquet_writer] ✓ Wrote 43,055,819 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-29
2025-12-25 15:31:09,943 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 15:31:09,943 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 15:31:09,943 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 15:31:09,943 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 15:31:09,943 INFO [src.stage_a.stage_a] Trades: 26,888,564 rows
2025-12-25 15:31:09,943 INFO [src.stage_a.stage_a] Nbbo: 43,055,819 rows
2025-12-25 15:31:09,943 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 15:31:09,943 INFO [src.stage_a.stage_a] Processing date 83/83: 2024-04-30
2025-12-25 15:31:09,943 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 15:31:09,943 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 15:31:09,943 INFO [src.stage_a.stage_a] Stage A: Extract raw data for 2024-04-30 (519 symbols)
2025-12-25 15:31:09,943 INFO [src.stage_a.stage_a] Data types: trades, nbbo
2025-12-25 15:31:09,943 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 15:31:09,943 INFO [src.stage_a.stage_a] Extract run ID: e12c7bd0-8a55-4b6d-8448-e32a00594e3c
2025-12-25 15:31:09,952 INFO [src.stage_a.stage_a] Ingestion status:
2025-12-25 15:31:09,952 INFO [src.stage_a.stage_a]   Missing trades: 519 symbols
2025-12-25 15:31:09,952 INFO [src.stage_a.stage_a]   Missing nbbo: 519 symbols
2025-12-25 15:31:09,952 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 15:31:09,952 INFO [src.stage_a.stage_a] Processing TRADES
2025-12-25 15:31:09,952 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 15:31:09,952 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 15:31:09,952 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 15:31:09,952 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 15:31:18,505 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 15:31:18,505 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-30...
2025-12-25 15:31:18,579 INFO [src.stage_a.wrds_extractor] Extracting trades from taqm_2024.ctm_20240430 for 519 symbols
2025-12-25 15:32:28,733 INFO [src.stage_a.wrds_extractor]   Chunk 1: 3,608,136 trades
2025-12-25 15:32:28,733 INFO [src.stage_a.parquet_writer]   Chunk 1: 3,608,136 rows
2025-12-25 15:33:06,570 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,043,766 trades
2025-12-25 15:33:06,571 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,043,766 rows
2025-12-25 15:35:09,204 INFO [src.stage_a.wrds_extractor]   Chunk 3: 2,177,593 trades
2025-12-25 15:35:09,204 INFO [src.stage_a.parquet_writer]   Chunk 3: 2,177,593 rows
2025-12-25 15:36:44,516 INFO [src.stage_a.wrds_extractor]   Chunk 4: 1,931,783 trades
2025-12-25 15:36:44,516 INFO [src.stage_a.parquet_writer]   Chunk 4: 1,931,783 rows
2025-12-25 15:38:45,365 INFO [src.stage_a.wrds_extractor]   Chunk 5: 2,909,726 trades
2025-12-25 15:38:45,365 INFO [src.stage_a.parquet_writer]   Chunk 5: 2,909,726 rows
2025-12-25 15:40:26,350 INFO [src.stage_a.wrds_extractor]   Chunk 6: 2,477,425 trades
2025-12-25 15:40:26,350 INFO [src.stage_a.parquet_writer]   Chunk 6: 2,477,425 rows
2025-12-25 15:43:36,674 INFO [src.stage_a.wrds_extractor]   Chunk 7: 3,754,648 trades
2025-12-25 15:43:36,675 INFO [src.stage_a.parquet_writer]   Chunk 7: 3,754,648 rows
2025-12-25 15:46:04,096 INFO [src.stage_a.wrds_extractor]   Chunk 8: 2,841,949 trades
2025-12-25 15:46:04,096 INFO [src.stage_a.parquet_writer]   Chunk 8: 2,841,949 rows
2025-12-25 15:48:04,218 INFO [src.stage_a.wrds_extractor]   Chunk 9: 2,477,706 trades
2025-12-25 15:48:04,218 INFO [src.stage_a.parquet_writer]   Chunk 9: 2,477,706 rows
2025-12-25 15:50:04,145 INFO [src.stage_a.wrds_extractor]   Chunk 10: 3,537,018 trades
2025-12-25 15:50:04,145 INFO [src.stage_a.parquet_writer]   Chunk 10: 3,537,018 rows
2025-12-25 15:50:04,608 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 27,759,750 total rows written
2025-12-25 15:51:13,988 INFO [src.stage_a.wrds_extractor]   Chunk 11: 1,273,857 trades
2025-12-25 15:51:13,988 INFO [src.stage_a.parquet_writer]   Chunk 11: 1,273,857 rows
2025-12-25 15:51:14,355 INFO [src.stage_a.parquet_writer] ✓ Wrote 29,033,607 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/trades/trade_date=2024-04-30
2025-12-25 15:51:14,358 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 15:51:14,358 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 15:51:14,358 INFO [src.stage_a.stage_a] Processing NBBO
2025-12-25 15:51:14,358 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 15:51:14,358 INFO [src.stage_a.stage_a] No CSV root configured: extracting directly from WRDS
2025-12-25 15:51:14,358 INFO [src.stage_a.stage_a] No CSV file found. Extracting from WRDS (streaming mode)...
2025-12-25 15:51:14,358 INFO [src.stage_a.wrds_extractor] Connecting to WRDS...
2025-12-25 15:51:15,871 INFO [src.stage_a.wrds_extractor] ✓ Connected to WRDS
2025-12-25 15:51:15,871 INFO [src.stage_a.parquet_writer] Writing chunks incrementally to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-30...
2025-12-25 15:51:15,965 INFO [src.stage_a.wrds_extractor] Extracting NBBO from taqm_2024.complete_nbbo_20240430 for 519 symbols
2025-12-25 15:53:43,887 INFO [src.stage_a.wrds_extractor]   Chunk 1: 4,629,290 NBBO records
2025-12-25 15:53:43,887 INFO [src.stage_a.parquet_writer]   Chunk 1: 4,629,290 rows
2025-12-25 15:55:16,593 INFO [src.stage_a.wrds_extractor]   Chunk 2: 2,957,518 NBBO records
2025-12-25 15:55:16,593 INFO [src.stage_a.parquet_writer]   Chunk 2: 2,957,518 rows
2025-12-25 15:57:32,055 INFO [src.stage_a.wrds_extractor]   Chunk 3: 4,530,824 NBBO records
2025-12-25 15:57:32,055 INFO [src.stage_a.parquet_writer]   Chunk 3: 4,530,824 rows
2025-12-25 15:59:06,192 INFO [src.stage_a.wrds_extractor]   Chunk 4: 3,117,023 NBBO records
2025-12-25 15:59:06,192 INFO [src.stage_a.parquet_writer]   Chunk 4: 3,117,023 rows
2025-12-25 16:00:56,743 INFO [src.stage_a.wrds_extractor]   Chunk 5: 4,618,342 NBBO records
2025-12-25 16:00:56,743 INFO [src.stage_a.parquet_writer]   Chunk 5: 4,618,342 rows
2025-12-25 16:03:14,329 INFO [src.stage_a.wrds_extractor]   Chunk 6: 4,316,026 NBBO records
2025-12-25 16:03:14,329 INFO [src.stage_a.parquet_writer]   Chunk 6: 4,316,026 rows
2025-12-25 16:05:13,204 INFO [src.stage_a.wrds_extractor]   Chunk 7: 4,378,880 NBBO records
2025-12-25 16:05:13,204 INFO [src.stage_a.parquet_writer]   Chunk 7: 4,378,880 rows
2025-12-25 16:08:47,948 INFO [src.stage_a.wrds_extractor]   Chunk 8: 6,731,904 NBBO records
2025-12-25 16:08:47,948 INFO [src.stage_a.parquet_writer]   Chunk 8: 6,731,904 rows
2025-12-25 16:11:36,706 INFO [src.stage_a.wrds_extractor]   Chunk 9: 6,608,267 NBBO records
2025-12-25 16:11:36,707 INFO [src.stage_a.parquet_writer]   Chunk 9: 6,608,267 rows
2025-12-25 16:12:34,762 INFO [src.stage_a.wrds_extractor]   Chunk 10: 4,320,565 NBBO records
2025-12-25 16:12:34,763 INFO [src.stage_a.parquet_writer]   Chunk 10: 4,320,565 rows
2025-12-25 16:12:35,118 INFO [src.stage_a.parquet_writer]   Progress: 10 chunks processed, 46,208,639 total rows written
2025-12-25 16:13:58,550 INFO [src.stage_a.wrds_extractor]   Chunk 11: 7,386,932 NBBO records
2025-12-25 16:13:58,550 INFO [src.stage_a.parquet_writer]   Chunk 11: 7,386,932 rows
2025-12-25 16:13:59,220 INFO [src.stage_a.parquet_writer] ✓ Wrote 53,595,571 rows in 11 chunks to /home/mingyuan/data/taq/parquet_raw/nbbo/trade_date=2024-04-30
2025-12-25 16:13:59,226 INFO [src.stage_a.wrds_extractor] ✓ WRDS connection closed
2025-12-25 16:13:59,226 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 16:13:59,226 INFO [src.stage_a.stage_a] Stage A Complete!
2025-12-25 16:13:59,226 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 16:13:59,226 INFO [src.stage_a.stage_a] Trades: 29,033,607 rows
2025-12-25 16:13:59,226 INFO [src.stage_a.stage_a] Nbbo: 53,595,571 rows
2025-12-25 16:13:59,226 INFO [src.stage_a.stage_a] 
================================================================================
2025-12-25 16:13:59,226 INFO [src.stage_a.stage_a] Date Range Extraction Summary
2025-12-25 16:13:59,226 INFO [src.stage_a.stage_a] ================================================================================
2025-12-25 16:13:59,226 INFO [src.stage_a.stage_a] Dates processed: 83
2025-12-25 16:13:59,226 INFO [src.stage_a.stage_a] Dates skipped: 4
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a] 
Total rows extracted:
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   Trades: 2,271,215,030 rows
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   Nbbo: 5,571,766,490 rows
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a] 
Per-date breakdown:
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-01-02: trades: 28,729,699, nbbo: 90,538,058
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-01-03: trades: 27,430,138, nbbo: 99,038,825
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-01-04: trades: 24,872,630, nbbo: 83,126,451
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-01-05: trades: 23,794,170, nbbo: 85,583,037
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-01-08: trades: 25,667,027, nbbo: 73,077,519
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-01-09: trades: 24,800,237, nbbo: 80,235,129
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-01-10: trades: 24,335,840, nbbo: 73,229,846
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-01-11: trades: 26,207,281, nbbo: 95,139,795
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-01-12: trades: 23,985,044, nbbo: 85,082,820
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-01-16: trades: 28,879,143, nbbo: 91,784,010
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-01-17: trades: 26,700,844, nbbo: 81,473,830
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-01-18: trades: 27,680,653, nbbo: 84,406,276
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-01-19: trades: 28,566,715, nbbo: 84,698,852
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-01-22: trades: 28,168,076, nbbo: 81,431,210
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-01-23: trades: 25,723,062, nbbo: 69,829,249
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-01-24: trades: 29,303,720, nbbo: 84,273,199
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-01-25: trades: 32,373,663, nbbo: 91,061,175
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-01-26: trades: 26,112,787, nbbo: 75,147,938
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-01-29: trades: 25,535,028, nbbo: 65,842,277
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-01-30: trades: 27,398,856, nbbo: 68,621,303
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-01-31: trades: 33,646,870, nbbo: 101,614,202
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-02-01: trades: 31,019,104, nbbo: 96,713,681
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-02-02: trades: 32,387,064, nbbo: 97,161,647
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-02-05: trades: 29,462,272, nbbo: 75,789,145
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-02-06: trades: 27,074,356, nbbo: 74,495,072
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-02-07: trades: 27,008,225, nbbo: 69,024,881
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-02-08: trades: 26,740,936, nbbo: 64,008,192
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-02-09: trades: 26,279,212, nbbo: 60,697,663
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-02-12: trades: 26,549,572, nbbo: 65,390,693
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-02-13: trades: 31,737,432, nbbo: 82,204,168
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-02-14: trades: 27,404,482, nbbo: 68,066,976
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-02-15: trades: 28,290,183, nbbo: 65,929,604
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-02-16: trades: 26,491,227, nbbo: 66,389,569
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-02-20: trades: 29,241,488, nbbo: 71,618,235
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-02-21: trades: 26,388,958, nbbo: 67,528,606
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-02-22: trades: 29,730,018, nbbo: 65,040,299
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-02-23: trades: 25,407,606, nbbo: 62,785,677
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-02-26: trades: 25,603,906, nbbo: 55,204,396
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-02-27: trades: 24,775,427, nbbo: 54,632,102
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-02-28: trades: 23,920,734, nbbo: 48,785,951
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-02-29: trades: 28,185,292, nbbo: 54,288,033
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-03-01: trades: 28,807,294, nbbo: 57,236,399
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-03-04: trades: 32,025,680, nbbo: 53,951,561
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-03-05: trades: 30,975,886, nbbo: 63,568,252
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-03-06: trades: 29,682,505, nbbo: 76,212,267
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-03-07: trades: 26,967,301, nbbo: 58,033,954
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-03-08: trades: 30,227,874, nbbo: 80,968,829
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-03-11: trades: 27,626,283, nbbo: 64,621,369
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-03-12: trades: 27,109,225, nbbo: 63,678,418
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-03-13: trades: 27,545,385, nbbo: 60,160,841
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-03-14: trades: 30,779,446, nbbo: 71,895,203
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-03-15: trades: 30,146,886, nbbo: 65,381,233
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-03-18: trades: 26,418,917, nbbo: 57,869,840
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-03-19: trades: 23,820,066, nbbo: 56,311,666
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-03-20: trades: 25,631,929, nbbo: 59,685,469
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-03-21: trades: 27,596,884, nbbo: 55,242,804
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-03-22: trades: 22,899,695, nbbo: 45,580,002
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-03-25: trades: 23,212,981, nbbo: 45,525,126
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-03-26: trades: 24,255,241, nbbo: 46,324,268
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-03-27: trades: 25,115,607, nbbo: 52,320,702
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-03-28: trades: 24,020,728, nbbo: 48,754,608
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-04-01: trades: 24,132,501, nbbo: 49,052,645
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-04-02: trades: 26,396,683, nbbo: 51,960,493
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-04-03: trades: 25,667,886, nbbo: 50,738,195
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-04-04: trades: 28,800,979, nbbo: 66,371,773
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-04-05: trades: 25,788,008, nbbo: 63,453,777
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-04-08: trades: 23,091,188, nbbo: 48,039,421
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-04-09: trades: 24,649,353, nbbo: 56,916,673
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-04-10: trades: 28,709,311, nbbo: 72,943,454
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-04-11: trades: 25,950,428, nbbo: 55,715,499
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-04-12: trades: 28,505,539, nbbo: 61,900,924
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-04-15: trades: 28,866,384, nbbo: 69,913,398
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-04-16: trades: 28,623,647, nbbo: 78,744,549
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-04-17: trades: 27,582,743, nbbo: 65,972,255
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-04-18: trades: 26,941,547, nbbo: 60,792,349
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-04-19: trades: 30,718,883, nbbo: 68,557,184
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-04-22: trades: 27,377,223, nbbo: 52,263,132
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-04-23: trades: 26,964,068, nbbo: 47,057,505
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-04-24: trades: 29,021,883, nbbo: 52,379,883
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-04-25: trades: 31,103,560, nbbo: 60,536,075
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-04-26: trades: 27,926,255, nbbo: 47,493,514
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-04-29: trades: 26,888,564, nbbo: 43,055,819
2025-12-25 16:13:59,227 INFO [src.stage_a.stage_a]   2024-04-30: trades: 29,033,607, nbbo: 53,595,571
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
Loading library list...
Done
